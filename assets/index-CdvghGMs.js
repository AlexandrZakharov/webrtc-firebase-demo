var Wo=Object.defineProperty;var Ho=(i,e,o)=>e in i?Wo(i,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[e]=o;var qt=(i,e,o)=>Ho(i,typeof e!="symbol"?e+"":e,o);function _mergeNamespaces(i,e){for(var o=0;o<e.length;o++){const s=e[o];if(typeof s!="string"&&!Array.isArray(s)){for(const c in s)if(c!=="default"&&!(c in i)){const h=Object.getOwnPropertyDescriptor(s,c);h&&Object.defineProperty(i,c,h.get?h:{enumerable:!0,get:()=>s[c]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const _ of h.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&s(_)}).observe(document,{childList:!0,subtree:!0});function o(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(c){if(c.ep)return;c.ep=!0;const h=o(c);fetch(c.href,h)}})();function getDefaultExportFromCjs(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function getAugmentedNamespace(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var o=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};o.prototype=e.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(i).forEach(function(s){var c=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(o,s,c.get?c:{enumerable:!0,get:function(){return i[s]}})}),o}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(i){return i===null||typeof i!="object"?null:(i=z$1&&i[z$1]||i["@@iterator"],typeof i=="function"?i:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$1(i,e,o){this.props=i,this.context=e,this.refs=D$2,this.updater=o||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};E$1.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(i,e,o){this.props=i,this.context=e,this.refs=D$2,this.updater=o||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$2(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(i,e,o){var s,c={},h=null,_=null;if(e!=null)for(s in e.ref!==void 0&&(_=e.ref),e.key!==void 0&&(h=""+e.key),e)J.call(e,s)&&!L$1.hasOwnProperty(s)&&(c[s]=e[s]);var $=arguments.length-2;if($===1)c.children=o;else if(1<$){for(var nt=Array($),tt=0;tt<$;tt++)nt[tt]=arguments[tt+2];c.children=nt}if(i&&i.defaultProps)for(s in $=i.defaultProps,$)c[s]===void 0&&(c[s]=$[s]);return{$$typeof:l$1,type:i,key:h,ref:_,props:c,_owner:K$1.current}}function N$1(i,e){return{$$typeof:l$1,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function O$1(i){return typeof i=="object"&&i!==null&&i.$$typeof===l$1}function escape(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(o){return e[o]})}var P$1=/\/+/g;function Q$1(i,e){return typeof i=="object"&&i!==null&&i.key!=null?escape(""+i.key):e.toString(36)}function R$1(i,e,o,s,c){var h=typeof i;(h==="undefined"||h==="boolean")&&(i=null);var _=!1;if(i===null)_=!0;else switch(h){case"string":case"number":_=!0;break;case"object":switch(i.$$typeof){case l$1:case n$1:_=!0}}if(_)return _=i,c=c(_),i=s===""?"."+Q$1(_,0):s,I$1(c)?(o="",i!=null&&(o=i.replace(P$1,"$&/")+"/"),R$1(c,e,o,"",function(tt){return tt})):c!=null&&(O$1(c)&&(c=N$1(c,o+(!c.key||_&&_.key===c.key?"":(""+c.key).replace(P$1,"$&/")+"/")+i)),e.push(c)),1;if(_=0,s=s===""?".":s+":",I$1(i))for(var $=0;$<i.length;$++){h=i[$];var nt=s+Q$1(h,$);_+=R$1(h,e,o,nt,c)}else if(nt=A$1(i),typeof nt=="function")for(i=nt.call(i),$=0;!(h=i.next()).done;)h=h.value,nt=s+Q$1(h,$++),_+=R$1(h,e,o,nt,c);else if(h==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return _}function S$2(i,e,o){if(i==null)return i;var s=[],c=0;return R$1(i,s,"","",function(h){return e.call(o,h,c++)}),s}function T$1(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(o){(i._status===0||i._status===-1)&&(i._status=1,i._result=o)},function(o){(i._status===0||i._status===-1)&&(i._status=2,i._result=o)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(i,e,o){S$2(i,function(){e.apply(this,arguments)},o)},count:function(i){var e=0;return S$2(i,function(){e++}),e},toArray:function(i){return S$2(i,function(e){return e})||[]},only:function(i){if(!O$1(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(i,e,o){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var s=C$2({},i.props),c=i.key,h=i.ref,_=i._owner;if(e!=null){if(e.ref!==void 0&&(h=e.ref,_=K$1.current),e.key!==void 0&&(c=""+e.key),i.type&&i.type.defaultProps)var $=i.type.defaultProps;for(nt in e)J.call(e,nt)&&!L$1.hasOwnProperty(nt)&&(s[nt]=e[nt]===void 0&&$!==void 0?$[nt]:e[nt])}var nt=arguments.length-2;if(nt===1)s.children=o;else if(1<nt){$=Array(nt);for(var tt=0;tt<nt;tt++)$[tt]=arguments[tt+2];s.children=$}return{$$typeof:l$1,type:i.type,key:c,ref:h,props:s,_owner:_}};react_production_min.createContext=function(i){return i={$$typeof:u,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:t,_context:i},i.Consumer=i};react_production_min.createElement=M$1;react_production_min.createFactory=function(i){var e=M$1.bind(null,i);return e.type=i,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(i){return{$$typeof:v$2,render:i}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(i){return{$$typeof:y,_payload:{_status:-1,_result:i},_init:T$1}};react_production_min.memo=function(i,e){return{$$typeof:x,type:i,compare:e===void 0?null:e}};react_production_min.startTransition=function(i){var e=V$1.transition;V$1.transition={};try{i()}finally{V$1.transition=e}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(i,e){return U$1.current.useCallback(i,e)};react_production_min.useContext=function(i){return U$1.current.useContext(i)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(i){return U$1.current.useDeferredValue(i)};react_production_min.useEffect=function(i,e){return U$1.current.useEffect(i,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(i,e,o){return U$1.current.useImperativeHandle(i,e,o)};react_production_min.useInsertionEffect=function(i,e){return U$1.current.useInsertionEffect(i,e)};react_production_min.useLayoutEffect=function(i,e){return U$1.current.useLayoutEffect(i,e)};react_production_min.useMemo=function(i,e){return U$1.current.useMemo(i,e)};react_production_min.useReducer=function(i,e,o){return U$1.current.useReducer(i,e,o)};react_production_min.useRef=function(i){return U$1.current.useRef(i)};react_production_min.useState=function(i){return U$1.current.useState(i)};react_production_min.useSyncExternalStore=function(i,e,o){return U$1.current.useSyncExternalStore(i,e,o)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(i,e,o){var s,c={},h=null,_=null;o!==void 0&&(h=""+o),e.key!==void 0&&(h=""+e.key),e.ref!==void 0&&(_=e.ref);for(s in e)m$1.call(e,s)&&!p$1.hasOwnProperty(s)&&(c[s]=e[s]);if(i&&i.defaultProps)for(s in e=i.defaultProps,e)c[s]===void 0&&(c[s]=e[s]);return{$$typeof:k,type:i,key:h,ref:_,props:c,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(Dt,Ct){var Gt=Dt.length;Dt.push(Ct);e:for(;0<Gt;){var Wt=Gt-1>>>1,Qt=Dt[Wt];if(0<c(Qt,Ct))Dt[Wt]=Ct,Dt[Gt]=Qt,Gt=Wt;else break e}}function o(Dt){return Dt.length===0?null:Dt[0]}function s(Dt){if(Dt.length===0)return null;var Ct=Dt[0],Gt=Dt.pop();if(Gt!==Ct){Dt[0]=Gt;e:for(var Wt=0,Qt=Dt.length,nn=Qt>>>1;Wt<nn;){var un=2*(Wt+1)-1,en=Dt[un],cn=un+1,an=Dt[cn];if(0>c(en,Gt))cn<Qt&&0>c(an,en)?(Dt[Wt]=an,Dt[cn]=Gt,Wt=cn):(Dt[Wt]=en,Dt[un]=Gt,Wt=un);else if(cn<Qt&&0>c(an,Gt))Dt[Wt]=an,Dt[cn]=Gt,Wt=cn;else break e}}return Ct}function c(Dt,Ct){var Gt=Dt.sortIndex-Ct.sortIndex;return Gt!==0?Gt:Dt.id-Ct.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;i.unstable_now=function(){return h.now()}}else{var _=Date,$=_.now();i.unstable_now=function(){return _.now()-$}}var nt=[],tt=[],et=1,d=null,a=3,g=!1,j=!1,rt=!1,ot=typeof setTimeout=="function"?setTimeout:null,it=typeof clearTimeout=="function"?clearTimeout:null,at=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function lt(Dt){for(var Ct=o(tt);Ct!==null;){if(Ct.callback===null)s(tt);else if(Ct.startTime<=Dt)s(tt),Ct.sortIndex=Ct.expirationTime,e(nt,Ct);else break;Ct=o(tt)}}function ct(Dt){if(rt=!1,lt(Dt),!j)if(o(nt)!==null)j=!0,Pt(dt);else{var Ct=o(tt);Ct!==null&&It(ct,Ct.startTime-Dt)}}function dt(Dt,Ct){j=!1,rt&&(rt=!1,it(ft),ft=-1),g=!0;var Gt=a;try{for(lt(Ct),d=o(nt);d!==null&&(!(d.expirationTime>Ct)||Dt&&!bt());){var Wt=d.callback;if(typeof Wt=="function"){d.callback=null,a=d.priorityLevel;var Qt=Wt(d.expirationTime<=Ct);Ct=i.unstable_now(),typeof Qt=="function"?d.callback=Qt:d===o(nt)&&s(nt),lt(Ct)}else s(nt);d=o(nt)}if(d!==null)var nn=!0;else{var un=o(tt);un!==null&&It(ct,un.startTime-Ct),nn=!1}return nn}finally{d=null,a=Gt,g=!1}}var mt=!1,ht=null,ft=-1,ut=5,_t=-1;function bt(){return!(i.unstable_now()-_t<ut)}function vt(){if(ht!==null){var Dt=i.unstable_now();_t=Dt;var Ct=!0;try{Ct=ht(!0,Dt)}finally{Ct?Tt():(mt=!1,ht=null)}}else mt=!1}var Tt;if(typeof at=="function")Tt=function(){at(vt)};else if(typeof MessageChannel<"u"){var Mt=new MessageChannel,xt=Mt.port2;Mt.port1.onmessage=vt,Tt=function(){xt.postMessage(null)}}else Tt=function(){ot(vt,0)};function Pt(Dt){ht=Dt,mt||(mt=!0,Tt())}function It(Dt,Ct){ft=ot(function(){Dt(i.unstable_now())},Ct)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Dt){Dt.callback=null},i.unstable_continueExecution=function(){j||g||(j=!0,Pt(dt))},i.unstable_forceFrameRate=function(Dt){0>Dt||125<Dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ut=0<Dt?Math.floor(1e3/Dt):5},i.unstable_getCurrentPriorityLevel=function(){return a},i.unstable_getFirstCallbackNode=function(){return o(nt)},i.unstable_next=function(Dt){switch(a){case 1:case 2:case 3:var Ct=3;break;default:Ct=a}var Gt=a;a=Ct;try{return Dt()}finally{a=Gt}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Dt,Ct){switch(Dt){case 1:case 2:case 3:case 4:case 5:break;default:Dt=3}var Gt=a;a=Dt;try{return Ct()}finally{a=Gt}},i.unstable_scheduleCallback=function(Dt,Ct,Gt){var Wt=i.unstable_now();switch(typeof Gt=="object"&&Gt!==null?(Gt=Gt.delay,Gt=typeof Gt=="number"&&0<Gt?Wt+Gt:Wt):Gt=Wt,Dt){case 1:var Qt=-1;break;case 2:Qt=250;break;case 5:Qt=1073741823;break;case 4:Qt=1e4;break;default:Qt=5e3}return Qt=Gt+Qt,Dt={id:et++,callback:Ct,priorityLevel:Dt,startTime:Gt,expirationTime:Qt,sortIndex:-1},Gt>Wt?(Dt.sortIndex=Gt,e(tt,Dt),o(nt)===null&&Dt===o(tt)&&(rt?(it(ft),ft=-1):rt=!0,It(ct,Gt-Wt))):(Dt.sortIndex=Qt,e(nt,Dt),j||g||(j=!0,Pt(dt))),Dt},i.unstable_shouldYield=bt,i.unstable_wrapCallback=function(Dt){var Ct=a;return function(){var Gt=a;a=Ct;try{return Dt.apply(this,arguments)}finally{a=Gt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,o=1;o<arguments.length;o++)e+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(i,e){ha(i,e),ha(i+"Capture",e)}function ha(i,e){for(ea[i]=e,i=0;i<e.length;i++)da.add(e[i])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(i){return ja.call(ma,i)?!0:ja.call(la,i)?!1:ka.test(i)?ma[i]=!0:(la[i]=!0,!1)}function pa(i,e,o,s){if(o!==null&&o.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:o!==null?!o.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function qa(i,e,o,s){if(e===null||typeof e>"u"||pa(i,e,o,s))return!0;if(s)return!1;if(o!==null)switch(o.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v$1(i,e,o,s,c,h,_){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=c,this.mustUseProperty=o,this.propertyName=i,this.type=e,this.sanitizeURL=h,this.removeEmptyString=_}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){z[i]=new v$1(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];z[e]=new v$1(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){z[i]=new v$1(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){z[i]=new v$1(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){z[i]=new v$1(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){z[i]=new v$1(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){z[i]=new v$1(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){z[i]=new v$1(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){z[i]=new v$1(i,5,!1,i.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(ra,sa);z[e]=new v$1(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(ra,sa);z[e]=new v$1(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(ra,sa);z[e]=new v$1(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){z[i]=new v$1(i,1,!1,i.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){z[i]=new v$1(i,1,!1,i.toLowerCase(),null,!0,!0)});function ta(i,e,o,s){var c=z.hasOwnProperty(e)?z[e]:null;(c!==null?c.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,o,c,s)&&(o=null),s||c===null?oa(e)&&(o===null?i.removeAttribute(e):i.setAttribute(e,""+o)):c.mustUseProperty?i[c.propertyName]=o===null?c.type===3?!1:"":o:(e=c.attributeName,s=c.attributeNamespace,o===null?i.removeAttribute(e):(c=c.type,o=c===3||c===4&&o===!0?"":""+o,s?i.setAttributeNS(s,e,o):i.setAttribute(e,o))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(i){return i===null||typeof i!="object"?null:(i=Ja&&i[Ja]||i["@@iterator"],typeof i=="function"?i:null)}var A=Object.assign,La;function Ma(i){if(La===void 0)try{throw Error()}catch(o){var e=o.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+i}var Na=!1;function Oa(i,e){if(!i||Na)return"";Na=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(tt){var s=tt}Reflect.construct(i,[],e)}else{try{e.call()}catch(tt){s=tt}i.call(e.prototype)}else{try{throw Error()}catch(tt){s=tt}i()}}catch(tt){if(tt&&s&&typeof tt.stack=="string"){for(var c=tt.stack.split(`
`),h=s.stack.split(`
`),_=c.length-1,$=h.length-1;1<=_&&0<=$&&c[_]!==h[$];)$--;for(;1<=_&&0<=$;_--,$--)if(c[_]!==h[$]){if(_!==1||$!==1)do if(_--,$--,0>$||c[_]!==h[$]){var nt=`
`+c[_].replace(" at new "," at ");return i.displayName&&nt.includes("<anonymous>")&&(nt=nt.replace("<anonymous>",i.displayName)),nt}while(1<=_&&0<=$);break}}}finally{Na=!1,Error.prepareStackTrace=o}return(i=i?i.displayName||i.name:"")?Ma(i):""}function Pa(i){switch(i.tag){case 5:return Ma(i.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return i=Oa(i.type,!1),i;case 11:return i=Oa(i.type.render,!1),i;case 1:return i=Oa(i.type,!0),i;default:return""}}function Qa(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Ca:return(i.displayName||"Context")+".Consumer";case Ba:return(i._context.displayName||"Context")+".Provider";case Da:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ga:return e=i.displayName||null,e!==null?e:Qa(i.type)||"Memo";case Ha:e=i._payload,i=i._init;try{return Qa(i(e))}catch{}}return null}function Ra(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ta(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(i){var e=Ta(i)?"checked":"value",o=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),s=""+i[e];if(!i.hasOwnProperty(e)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var c=o.get,h=o.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return c.call(this)},set:function(_){s=""+_,h.call(this,_)}}),Object.defineProperty(i,e,{enumerable:o.enumerable}),{getValue:function(){return s},setValue:function(_){s=""+_},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Va(i){i._valueTracker||(i._valueTracker=Ua(i))}function Wa(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var o=e.getValue(),s="";return i&&(s=Ta(i)?i.checked?"true":"false":i.value),i=s,i!==o?(e.setValue(i),!0):!1}function Xa(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ya(i,e){var o=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??i._wrapperState.initialChecked})}function Za(i,e){var o=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;o=Sa(e.value!=null?e.value:o),i._wrapperState={initialChecked:s,initialValue:o,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(i,e){e=e.checked,e!=null&&ta(i,"checked",e,!1)}function bb(i,e){ab(i,e);var o=Sa(e.value),s=e.type;if(o!=null)s==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+o):i.value!==""+o&&(i.value=""+o);else if(s==="submit"||s==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?cb(i,e.type,o):e.hasOwnProperty("defaultValue")&&cb(i,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function db(i,e,o){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,o||e===i.value||(i.value=e),i.defaultValue=e}o=i.name,o!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,o!==""&&(i.name=o)}function cb(i,e,o){(e!=="number"||Xa(i.ownerDocument)!==i)&&(o==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+o&&(i.defaultValue=""+o))}var eb=Array.isArray;function fb(i,e,o,s){if(i=i.options,e){e={};for(var c=0;c<o.length;c++)e["$"+o[c]]=!0;for(o=0;o<i.length;o++)c=e.hasOwnProperty("$"+i[o].value),i[o].selected!==c&&(i[o].selected=c),c&&s&&(i[o].defaultSelected=!0)}else{for(o=""+Sa(o),e=null,c=0;c<i.length;c++){if(i[c].value===o){i[c].selected=!0,s&&(i[c].defaultSelected=!0);return}e!==null||i[c].disabled||(e=i[c])}e!==null&&(e.selected=!0)}}function gb(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function hb(i,e){var o=e.value;if(o==null){if(o=e.children,e=e.defaultValue,o!=null){if(e!=null)throw Error(p(92));if(eb(o)){if(1<o.length)throw Error(p(93));o=o[0]}e=o}e==null&&(e=""),o=e}i._wrapperState={initialValue:Sa(o)}}function ib(i,e){var o=Sa(e.value),s=Sa(e.defaultValue);o!=null&&(o=""+o,o!==i.value&&(i.value=o),e.defaultValue==null&&i.defaultValue!==o&&(i.defaultValue=o)),s!=null&&(i.defaultValue=""+s)}function jb(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function kb(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?kb(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var mb,nb=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,o,s,c){MSApp.execUnsafeLocalFunction(function(){return i(e,o,s,c)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function ob(i,e){if(e){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=e;return}}i.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(i){qb.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),pb[e]=pb[i]})});function rb(i,e,o){return e==null||typeof e=="boolean"||e===""?"":o||typeof e!="number"||e===0||pb.hasOwnProperty(i)&&pb[i]?(""+e).trim():e+"px"}function sb(i,e){i=i.style;for(var o in e)if(e.hasOwnProperty(o)){var s=o.indexOf("--")===0,c=rb(o,e[o],s);o==="float"&&(o="cssFloat"),s?i.setProperty(o,c):i[o]=c}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(i,e){if(e){if(tb[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p(62))}}function vb(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var yb=null,zb=null,Ab=null;function Bb(i){if(i=Cb(i)){if(typeof yb!="function")throw Error(p(280));var e=i.stateNode;e&&(e=Db(e),yb(i.stateNode,i.type,e))}}function Eb(i){zb?Ab?Ab.push(i):Ab=[i]:zb=i}function Fb(){if(zb){var i=zb,e=Ab;if(Ab=zb=null,Bb(i),e)for(i=0;i<e.length;i++)Bb(e[i])}}function Gb(i,e){return i(e)}function Hb(){}var Ib=!1;function Jb(i,e,o){if(Ib)return i(e,o);Ib=!0;try{return Gb(i,e,o)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(i,e){var o=i.stateNode;if(o===null)return null;var s=Db(o);if(s===null)return null;o=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(i=i.type,s=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!s;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(p(231,e,typeof o));return o}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(i,e,o,s,c,h,_,$,nt){var tt=Array.prototype.slice.call(arguments,3);try{e.apply(o,tt)}catch(et){this.onError(et)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(i){Ob=!0,Pb=i}};function Tb(i,e,o,s,c,h,_,$,nt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(i,e,o,s,c,h,_,$,nt){if(Tb.apply(this,arguments),Ob){if(Ob){var tt=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=tt)}}function Vb(i){var e=i,o=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(o=e.return),i=e.return;while(i)}return e.tag===3?o:null}function Wb(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(i){if(Vb(i)!==i)throw Error(p(188))}function Yb(i){var e=i.alternate;if(!e){if(e=Vb(i),e===null)throw Error(p(188));return e!==i?null:i}for(var o=i,s=e;;){var c=o.return;if(c===null)break;var h=c.alternate;if(h===null){if(s=c.return,s!==null){o=s;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===o)return Xb(c),i;if(h===s)return Xb(c),e;h=h.sibling}throw Error(p(188))}if(o.return!==s.return)o=c,s=h;else{for(var _=!1,$=c.child;$;){if($===o){_=!0,o=c,s=h;break}if($===s){_=!0,s=c,o=h;break}$=$.sibling}if(!_){for($=h.child;$;){if($===o){_=!0,o=h,s=c;break}if($===s){_=!0,s=h,o=c;break}$=$.sibling}if(!_)throw Error(p(189))}}if(o.alternate!==s)throw Error(p(190))}if(o.tag!==3)throw Error(p(188));return o.stateNode.current===o?i:e}function Zb(i){return i=Yb(i),i!==null?$b(i):null}function $b(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=$b(i);if(e!==null)return e;i=i.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(i){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,i,void 0,(i.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(i){return i>>>=0,i===0?32:31-(pc(i)/qc|0)|0}var rc=64,sc=4194304;function tc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function uc(i,e){var o=i.pendingLanes;if(o===0)return 0;var s=0,c=i.suspendedLanes,h=i.pingedLanes,_=o&268435455;if(_!==0){var $=_&~c;$!==0?s=tc($):(h&=_,h!==0&&(s=tc(h)))}else _=o&~c,_!==0?s=tc(_):h!==0&&(s=tc(h));if(s===0)return 0;if(e!==0&&e!==s&&!(e&c)&&(c=s&-s,h=e&-e,c>=h||c===16&&(h&4194240)!==0))return e;if(s&4&&(s|=o&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=s;0<e;)o=31-oc(e),c=1<<o,s|=i[o],e&=~c;return s}function vc(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(i,e){for(var o=i.suspendedLanes,s=i.pingedLanes,c=i.expirationTimes,h=i.pendingLanes;0<h;){var _=31-oc(h),$=1<<_,nt=c[_];nt===-1?(!($&o)||$&s)&&(c[_]=vc($,e)):nt<=e&&(i.expiredLanes|=$),h&=~$}}function xc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function yc(){var i=rc;return rc<<=1,!(rc&4194240)&&(rc=64),i}function zc(i){for(var e=[],o=0;31>o;o++)e.push(i);return e}function Ac(i,e,o){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-oc(e),i[e]=o}function Bc(i,e){var o=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var s=i.eventTimes;for(i=i.expirationTimes;0<o;){var c=31-oc(o),h=1<<c;e[c]=0,s[c]=-1,i[c]=-1,o&=~h}}function Cc(i,e){var o=i.entangledLanes|=e;for(i=i.entanglements;o;){var s=31-oc(o),c=1<<s;c&e|i[s]&e&&(i[s]|=e),o&=~c}}var C$1=0;function Dc(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(i,e){switch(i){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(i,e,o,s,c,h){return i===null||i.nativeEvent!==h?(i={blockedOn:e,domEventName:o,eventSystemFlags:s,nativeEvent:h,targetContainers:[c]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),i):(i.eventSystemFlags|=s,e=i.targetContainers,c!==null&&e.indexOf(c)===-1&&e.push(c),i)}function Uc(i,e,o,s,c){switch(e){case"focusin":return Lc=Tc(Lc,i,e,o,s,c),!0;case"dragenter":return Mc=Tc(Mc,i,e,o,s,c),!0;case"mouseover":return Nc=Tc(Nc,i,e,o,s,c),!0;case"pointerover":var h=c.pointerId;return Oc.set(h,Tc(Oc.get(h)||null,i,e,o,s,c)),!0;case"gotpointercapture":return h=c.pointerId,Pc.set(h,Tc(Pc.get(h)||null,i,e,o,s,c)),!0}return!1}function Vc(i){var e=Wc(i.target);if(e!==null){var o=Vb(e);if(o!==null){if(e=o.tag,e===13){if(e=Wb(o),e!==null){i.blockedOn=e,Ic(i.priority,function(){Gc(o)});return}}else if(e===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Xc(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var o=Yc(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(o===null){o=i.nativeEvent;var s=new o.constructor(o.type,o);wb=s,o.target.dispatchEvent(s),wb=null}else return e=Cb(o),e!==null&&Fc(e),i.blockedOn=o,!1;e.shift()}return!0}function Zc(i,e,o){Xc(i)&&o.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(i,e){i.blockedOn===e&&(i.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(i){function e(c){return ad(c,i)}if(0<Kc.length){ad(Kc[0],i);for(var o=1;o<Kc.length;o++){var s=Kc[o];s.blockedOn===i&&(s.blockedOn=null)}}for(Lc!==null&&ad(Lc,i),Mc!==null&&ad(Mc,i),Nc!==null&&ad(Nc,i),Oc.forEach(e),Pc.forEach(e),o=0;o<Qc.length;o++)s=Qc[o],s.blockedOn===i&&(s.blockedOn=null);for(;0<Qc.length&&(o=Qc[0],o.blockedOn===null);)Vc(o),o.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(i,e,o,s){var c=C$1,h=cd.transition;cd.transition=null;try{C$1=1,fd(i,e,o,s)}finally{C$1=c,cd.transition=h}}function gd(i,e,o,s){var c=C$1,h=cd.transition;cd.transition=null;try{C$1=4,fd(i,e,o,s)}finally{C$1=c,cd.transition=h}}function fd(i,e,o,s){if(dd){var c=Yc(i,e,o,s);if(c===null)hd(i,e,s,id,o),Sc(i,s);else if(Uc(c,i,e,o,s))s.stopPropagation();else if(Sc(i,s),e&4&&-1<Rc.indexOf(i)){for(;c!==null;){var h=Cb(c);if(h!==null&&Ec(h),h=Yc(i,e,o,s),h===null&&hd(i,e,s,id,o),h===c)break;c=h}c!==null&&s.stopPropagation()}else hd(i,e,s,null,o)}}var id=null;function Yc(i,e,o,s){if(id=null,i=xb(s),i=Wc(i),i!==null)if(e=Vb(i),e===null)i=null;else if(o=e.tag,o===13){if(i=Wb(e),i!==null)return i;i=null}else if(o===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return id=i,null}function jd(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var i,e=ld,o=e.length,s,c="value"in kd?kd.value:kd.textContent,h=c.length;for(i=0;i<o&&e[i]===c[i];i++);var _=o-i;for(s=1;s<=_&&e[o-s]===c[h-s];s++);return md=c.slice(i,1<s?1-s:void 0)}function od(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function pd(){return!0}function qd(){return!1}function rd(i){function e(o,s,c,h,_){this._reactName=o,this._targetInst=c,this.type=s,this.nativeEvent=h,this.target=_,this.currentTarget=null;for(var $ in i)i.hasOwnProperty($)&&(o=i[$],this[$]=o?o(h):h[$]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==yd&&(yd&&i.type==="mousemove"?(wd=i.screenX-yd.screenX,xd=i.screenY-yd.screenY):xd=wd=0,yd=i),wd)},movementY:function(i){return"movementY"in i?i.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Od[i])?!!e[i]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(i){if(i.key){var e=Md[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=od(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Nd[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(i){return i.type==="keypress"?od(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?od(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee=" ",fe$1=!1;function ge$1(i,e){switch(i){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ie=!1;function je(i,e){switch(i){case"compositionend":return he$1(e);case"keypress":return e.which!==32?null:(fe$1=!0,ee);case"textInput":return i=e.data,i===ee&&fe$1?null:i;default:return null}}function ke(i,e){if(ie)return i==="compositionend"||!ae$1&&ge$1(i,e)?(i=nd(),md=ld=kd=null,ie=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de$1&&e.locale!=="ko"?null:e.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!le$1[i.type]:e==="textarea"}function ne$1(i,e,o,s){Eb(s),e=oe$1(e,"onChange"),0<e.length&&(o=new td("onChange","change",null,o,s),i.push({event:o,listeners:e}))}var pe$1=null,qe=null;function re$1(i){se(i,0)}function te(i){var e=ue$1(i);if(Wa(e))return i}function ve(i,e){if(i==="change")return e}var we$1=!1;if(ia){var xe;if(ia){var ye$1="oninput"in document;if(!ye$1){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye$1=typeof ze.oninput=="function"}xe=ye$1}else xe=!1;we$1=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe$1&&(pe$1.detachEvent("onpropertychange",Be),qe=pe$1=null)}function Be(i){if(i.propertyName==="value"&&te(qe)){var e=[];ne$1(e,qe,i,xb(i)),Jb(re$1,e)}}function Ce(i,e,o){i==="focusin"?(Ae(),pe$1=e,qe=o,pe$1.attachEvent("onpropertychange",Be)):i==="focusout"&&Ae()}function De$1(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return te(qe)}function Ee$1(i,e){if(i==="click")return te(e)}function Fe(i,e){if(i==="input"||i==="change")return te(e)}function Ge(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie$1(i,e){if(He(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var o=Object.keys(i),s=Object.keys(e);if(o.length!==s.length)return!1;for(s=0;s<o.length;s++){var c=o[s];if(!ja.call(e,c)||!He(i[c],e[c]))return!1}return!0}function Je(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ke(i,e){var o=Je(i);i=0;for(var s;o;){if(o.nodeType===3){if(s=i+o.textContent.length,i<=e&&s>=e)return{node:o,offset:e-i};i=s}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Je(o)}}function Le(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?Le(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var i=window,e=Xa();e instanceof i.HTMLIFrameElement;){try{var o=typeof e.contentWindow.location.href=="string"}catch{o=!1}if(o)i=e.contentWindow;else break;e=Xa(i.document)}return e}function Ne(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Oe(i){var e=Me(),o=i.focusedElem,s=i.selectionRange;if(e!==o&&o&&o.ownerDocument&&Le(o.ownerDocument.documentElement,o)){if(s!==null&&Ne(o)){if(e=s.start,i=s.end,i===void 0&&(i=e),"selectionStart"in o)o.selectionStart=e,o.selectionEnd=Math.min(i,o.value.length);else if(i=(e=o.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var c=o.textContent.length,h=Math.min(s.start,c);s=s.end===void 0?h:Math.min(s.end,c),!i.extend&&h>s&&(c=s,s=h,h=c),c=Ke(o,h);var _=Ke(o,s);c&&_&&(i.rangeCount!==1||i.anchorNode!==c.node||i.anchorOffset!==c.offset||i.focusNode!==_.node||i.focusOffset!==_.offset)&&(e=e.createRange(),e.setStart(c.node,c.offset),i.removeAllRanges(),h>s?(i.addRange(e),i.extend(_.node,_.offset)):(e.setEnd(_.node,_.offset),i.addRange(e)))}}for(e=[],i=o;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<e.length;o++)i=e[o],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re$1=null,Se=null,Te$1=!1;function Ue(i,e,o){var s=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Te$1||Qe==null||Qe!==Xa(s)||(s=Qe,"selectionStart"in s&&Ne(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Se&&Ie$1(Se,s)||(Se=s,s=oe$1(Re$1,"onSelect"),0<s.length&&(e=new td("onSelect","select",null,e,o),i.push({event:e,listeners:s}),e.target=Qe)))}function Ve(i,e){var o={};return o[i.toLowerCase()]=e.toLowerCase(),o["Webkit"+i]="webkit"+e,o["Moz"+i]="moz"+e,o}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(i){if(Xe[i])return Xe[i];if(!We[i])return i;var e=We[i],o;for(o in e)if(e.hasOwnProperty(o)&&o in Ye)return Xe[i]=e[o];return i}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(i,e){df.set(i,e),fa(e,[i])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(i,e,o){var s=i.type||"unknown-event";i.currentTarget=o,Ub(s,e,void 0,i),i.currentTarget=null}function se(i,e){e=(e&4)!==0;for(var o=0;o<i.length;o++){var s=i[o],c=s.event;s=s.listeners;e:{var h=void 0;if(e)for(var _=s.length-1;0<=_;_--){var $=s[_],nt=$.instance,tt=$.currentTarget;if($=$.listener,nt!==h&&c.isPropagationStopped())break e;nf(c,$,tt),h=nt}else for(_=0;_<s.length;_++){if($=s[_],nt=$.instance,tt=$.currentTarget,$=$.listener,nt!==h&&c.isPropagationStopped())break e;nf(c,$,tt),h=nt}}}if(Qb)throw i=Rb,Qb=!1,Rb=null,i}function D$1(i,e){var o=e[of];o===void 0&&(o=e[of]=new Set);var s=i+"__bubble";o.has(s)||(pf(e,i,2,!1),o.add(s))}function qf(i,e,o){var s=0;e&&(s|=4),pf(o,i,s,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(i){if(!i[rf]){i[rf]=!0,da.forEach(function(o){o!=="selectionchange"&&(mf.has(o)||qf(o,!1,i),qf(o,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(i,e,o,s){switch(jd(e)){case 1:var c=ed;break;case 4:c=gd;break;default:c=fd}o=c.bind(null,e,o,i),c=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(c=!0),s?c!==void 0?i.addEventListener(e,o,{capture:!0,passive:c}):i.addEventListener(e,o,!0):c!==void 0?i.addEventListener(e,o,{passive:c}):i.addEventListener(e,o,!1)}function hd(i,e,o,s,c){var h=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var _=s.tag;if(_===3||_===4){var $=s.stateNode.containerInfo;if($===c||$.nodeType===8&&$.parentNode===c)break;if(_===4)for(_=s.return;_!==null;){var nt=_.tag;if((nt===3||nt===4)&&(nt=_.stateNode.containerInfo,nt===c||nt.nodeType===8&&nt.parentNode===c))return;_=_.return}for(;$!==null;){if(_=Wc($),_===null)return;if(nt=_.tag,nt===5||nt===6){s=h=_;continue e}$=$.parentNode}}s=s.return}Jb(function(){var tt=h,et=xb(o),d=[];e:{var a=df.get(i);if(a!==void 0){var g=td,j=i;switch(i){case"keypress":if(od(o)===0)break e;case"keydown":case"keyup":g=Rd;break;case"focusin":j="focus",g=Fd;break;case"focusout":j="blur",g=Fd;break;case"beforeblur":case"afterblur":g=Fd;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Vd;break;case $e:case af:case bf:g=Hd;break;case cf:g=Xd;break;case"scroll":g=vd;break;case"wheel":g=Zd;break;case"copy":case"cut":case"paste":g=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Td}var rt=(e&4)!==0,ot=!rt&&i==="scroll",it=rt?a!==null?a+"Capture":null:a;rt=[];for(var at=tt,lt;at!==null;){lt=at;var ct=lt.stateNode;if(lt.tag===5&&ct!==null&&(lt=ct,it!==null&&(ct=Kb(at,it),ct!=null&&rt.push(tf(at,ct,lt)))),ot)break;at=at.return}0<rt.length&&(a=new g(a,j,null,o,et),d.push({event:a,listeners:rt}))}}if(!(e&7)){e:{if(a=i==="mouseover"||i==="pointerover",g=i==="mouseout"||i==="pointerout",a&&o!==wb&&(j=o.relatedTarget||o.fromElement)&&(Wc(j)||j[uf]))break e;if((g||a)&&(a=et.window===et?et:(a=et.ownerDocument)?a.defaultView||a.parentWindow:window,g?(j=o.relatedTarget||o.toElement,g=tt,j=j?Wc(j):null,j!==null&&(ot=Vb(j),j!==ot||j.tag!==5&&j.tag!==6)&&(j=null)):(g=null,j=tt),g!==j)){if(rt=Bd,ct="onMouseLeave",it="onMouseEnter",at="mouse",(i==="pointerout"||i==="pointerover")&&(rt=Td,ct="onPointerLeave",it="onPointerEnter",at="pointer"),ot=g==null?a:ue$1(g),lt=j==null?a:ue$1(j),a=new rt(ct,at+"leave",g,o,et),a.target=ot,a.relatedTarget=lt,ct=null,Wc(et)===tt&&(rt=new rt(it,at+"enter",j,o,et),rt.target=lt,rt.relatedTarget=ot,ct=rt),ot=ct,g&&j)t:{for(rt=g,it=j,at=0,lt=rt;lt;lt=vf(lt))at++;for(lt=0,ct=it;ct;ct=vf(ct))lt++;for(;0<at-lt;)rt=vf(rt),at--;for(;0<lt-at;)it=vf(it),lt--;for(;at--;){if(rt===it||it!==null&&rt===it.alternate)break t;rt=vf(rt),it=vf(it)}rt=null}else rt=null;g!==null&&wf(d,a,g,rt,!1),j!==null&&ot!==null&&wf(d,ot,j,rt,!0)}}e:{if(a=tt?ue$1(tt):window,g=a.nodeName&&a.nodeName.toLowerCase(),g==="select"||g==="input"&&a.type==="file")var dt=ve;else if(me$1(a))if(we$1)dt=Fe;else{dt=De$1;var mt=Ce}else(g=a.nodeName)&&g.toLowerCase()==="input"&&(a.type==="checkbox"||a.type==="radio")&&(dt=Ee$1);if(dt&&(dt=dt(i,tt))){ne$1(d,dt,o,et);break e}mt&&mt(i,a,tt),i==="focusout"&&(mt=a._wrapperState)&&mt.controlled&&a.type==="number"&&cb(a,"number",a.value)}switch(mt=tt?ue$1(tt):window,i){case"focusin":(me$1(mt)||mt.contentEditable==="true")&&(Qe=mt,Re$1=tt,Se=null);break;case"focusout":Se=Re$1=Qe=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue(d,o,et);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(d,o,et)}var ht;if(ae$1)e:{switch(i){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else ie?ge$1(i,o)&&(ft="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(ft="onCompositionStart");ft&&(de$1&&o.locale!=="ko"&&(ie||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&ie&&(ht=nd()):(kd=et,ld="value"in kd?kd.value:kd.textContent,ie=!0)),mt=oe$1(tt,ft),0<mt.length&&(ft=new Ld(ft,i,null,o,et),d.push({event:ft,listeners:mt}),ht?ft.data=ht:(ht=he$1(o),ht!==null&&(ft.data=ht)))),(ht=ce$1?je(i,o):ke(i,o))&&(tt=oe$1(tt,"onBeforeInput"),0<tt.length&&(et=new Ld("onBeforeInput","beforeinput",null,o,et),d.push({event:et,listeners:tt}),et.data=ht))}se(d,e)})}function tf(i,e,o){return{instance:i,listener:e,currentTarget:o}}function oe$1(i,e){for(var o=e+"Capture",s=[];i!==null;){var c=i,h=c.stateNode;c.tag===5&&h!==null&&(c=h,h=Kb(i,o),h!=null&&s.unshift(tf(i,h,c)),h=Kb(i,e),h!=null&&s.push(tf(i,h,c))),i=i.return}return s}function vf(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function wf(i,e,o,s,c){for(var h=e._reactName,_=[];o!==null&&o!==s;){var $=o,nt=$.alternate,tt=$.stateNode;if(nt!==null&&nt===s)break;$.tag===5&&tt!==null&&($=tt,c?(nt=Kb(o,h),nt!=null&&_.unshift(tf(o,nt,$))):c||(nt=Kb(o,h),nt!=null&&_.push(tf(o,nt,$)))),o=o.return}_.length!==0&&i.push({event:e,listeners:_})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(i){return(typeof i=="string"?i:""+i).replace(xf,`
`).replace(yf,"")}function Af(i,e,o){if(e=zf(e),zf(i)!==e&&o)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(i){return Hf.resolve(null).then(i).catch(If$1)}:Ff;function If$1(i){setTimeout(function(){throw i})}function Kf(i,e){var o=e,s=0;do{var c=o.nextSibling;if(i.removeChild(o),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0){i.removeChild(c),bd(e);return}s--}else o!=="$"&&o!=="$?"&&o!=="$!"||s++;o=c}while(o);bd(e)}function Lf(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Mf(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"){if(e===0)return i;e--}else o==="/$"&&e++}i=i.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(i){var e=i[Of];if(e)return e;for(var o=i.parentNode;o;){if(e=o[uf]||o[Of]){if(o=e.alternate,e.child!==null||o!==null&&o.child!==null)for(i=Mf(i);i!==null;){if(o=i[Of])return o;i=Mf(i)}return e}i=o,o=i.parentNode}return null}function Cb(i){return i=i[Of]||i[uf],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ue$1(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(p(33))}function Db(i){return i[Pf]||null}var Sf=[],Tf=-1;function Uf(i){return{current:i}}function E(i){0>Tf||(i.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(i,e){Tf++,Sf[Tf]=i.current,i.current=e}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(i,e){var o=i.type.contextTypes;if(!o)return Vf;var s=i.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var c={},h;for(h in o)c[h]=e[h];return s&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=c),c}function Zf(i){return i=i.childContextTypes,i!=null}function $f(){E(Wf),E(H)}function ag(i,e,o){if(H.current!==Vf)throw Error(p(168));G(H,e),G(Wf,o)}function bg(i,e,o){var s=i.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return o;s=s.getChildContext();for(var c in s)if(!(c in e))throw Error(p(108,Ra(i)||"Unknown",c));return A({},o,s)}function cg(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,i),G(Wf,Wf.current),!0}function dg(i,e,o){var s=i.stateNode;if(!s)throw Error(p(169));o?(i=bg(i,e,Xf),s.__reactInternalMemoizedMergedChildContext=i,E(Wf),E(H),G(H,i)):E(Wf),G(Wf,o)}var eg=null,fg=!1,gg=!1;function hg(i){eg===null?eg=[i]:eg.push(i)}function ig(i){fg=!0,hg(i)}function jg(){if(!gg&&eg!==null){gg=!0;var i=0,e=C$1;try{var o=eg;for(C$1=1;i<o.length;i++){var s=o[i];do s=s(!0);while(s!==null)}eg=null,fg=!1}catch(c){throw eg!==null&&(eg=eg.slice(i+1)),ac(fc,jg),c}finally{C$1=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(i,e){kg[lg++]=ng,kg[lg++]=mg,mg=i,ng=e}function ug(i,e,o){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=i;var s=rg;i=sg;var c=32-oc(s)-1;s&=~(1<<c),o+=1;var h=32-oc(e)+c;if(30<h){var _=c-c%5;h=(s&(1<<_)-1).toString(32),s>>=_,c-=_,rg=1<<32-oc(e)+c|o<<c|s,sg=h+i}else rg=1<<h|o<<c|s,sg=i}function vg(i){i.return!==null&&(tg(i,1),ug(i,1,0))}function wg(i){for(;i===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;i===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(i,e){var o=Bg(5,null,null,0);o.elementType="DELETED",o.stateNode=e,o.return=i,e=i.deletions,e===null?(i.deletions=[o],i.flags|=16):e.push(o)}function Cg(i,e){switch(i.tag){case 5:var o=i.type;return e=e.nodeType!==1||o.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,xg=i,yg=Lf(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,xg=i,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(o=qg!==null?{id:rg,overflow:sg}:null,i.memoizedState={dehydrated:e,treeContext:o,retryLane:1073741824},o=Bg(18,null,null,0),o.stateNode=e,o.return=i,i.child=o,xg=i,yg=null,!0):!1;default:return!1}}function Dg(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Eg(i){if(I){var e=yg;if(e){var o=e;if(!Cg(i,e)){if(Dg(i))throw Error(p(418));e=Lf(o.nextSibling);var s=xg;e&&Cg(i,e)?Ag(s,o):(i.flags=i.flags&-4097|2,I=!1,xg=i)}}else{if(Dg(i))throw Error(p(418));i.flags=i.flags&-4097|2,I=!1,xg=i}}}function Fg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;xg=i}function Gg(i){if(i!==xg)return!1;if(!I)return Fg(i),I=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!Ef(i.type,i.memoizedProps)),e&&(e=yg)){if(Dg(i))throw Hg(),Error(p(418));for(;e;)Ag(i,e),e=Lf(e.nextSibling)}if(Fg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(p(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"){if(e===0){yg=Lf(i.nextSibling);break e}e--}else o!=="$"&&o!=="$!"&&o!=="$?"||e++}i=i.nextSibling}yg=null}}else yg=xg?Lf(i.stateNode.nextSibling):null;return!0}function Hg(){for(var i=yg;i;)i=Lf(i.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(i){zg===null?zg=[i]:zg.push(i)}var Kg=ua.ReactCurrentBatchConfig;function Lg(i,e,o){if(i=o.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(p(309));var s=o.stateNode}if(!s)throw Error(p(147,i));var c=s,h=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===h?e.ref:(e=function(_){var $=c.refs;_===null?delete $[h]:$[h]=_},e._stringRef=h,e)}if(typeof i!="string")throw Error(p(284));if(!o._owner)throw Error(p(290,i))}return i}function Mg(i,e){throw i=Object.prototype.toString.call(e),Error(p(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function Ng(i){var e=i._init;return e(i._payload)}function Og(i){function e(it,at){if(i){var lt=it.deletions;lt===null?(it.deletions=[at],it.flags|=16):lt.push(at)}}function o(it,at){if(!i)return null;for(;at!==null;)e(it,at),at=at.sibling;return null}function s(it,at){for(it=new Map;at!==null;)at.key!==null?it.set(at.key,at):it.set(at.index,at),at=at.sibling;return it}function c(it,at){return it=Pg(it,at),it.index=0,it.sibling=null,it}function h(it,at,lt){return it.index=lt,i?(lt=it.alternate,lt!==null?(lt=lt.index,lt<at?(it.flags|=2,at):lt):(it.flags|=2,at)):(it.flags|=1048576,at)}function _(it){return i&&it.alternate===null&&(it.flags|=2),it}function $(it,at,lt,ct){return at===null||at.tag!==6?(at=Qg(lt,it.mode,ct),at.return=it,at):(at=c(at,lt),at.return=it,at)}function nt(it,at,lt,ct){var dt=lt.type;return dt===ya?et(it,at,lt.props.children,ct,lt.key):at!==null&&(at.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===at.type)?(ct=c(at,lt.props),ct.ref=Lg(it,at,lt),ct.return=it,ct):(ct=Rg(lt.type,lt.key,lt.props,null,it.mode,ct),ct.ref=Lg(it,at,lt),ct.return=it,ct)}function tt(it,at,lt,ct){return at===null||at.tag!==4||at.stateNode.containerInfo!==lt.containerInfo||at.stateNode.implementation!==lt.implementation?(at=Sg(lt,it.mode,ct),at.return=it,at):(at=c(at,lt.children||[]),at.return=it,at)}function et(it,at,lt,ct,dt){return at===null||at.tag!==7?(at=Tg(lt,it.mode,ct,dt),at.return=it,at):(at=c(at,lt),at.return=it,at)}function d(it,at,lt){if(typeof at=="string"&&at!==""||typeof at=="number")return at=Qg(""+at,it.mode,lt),at.return=it,at;if(typeof at=="object"&&at!==null){switch(at.$$typeof){case va:return lt=Rg(at.type,at.key,at.props,null,it.mode,lt),lt.ref=Lg(it,null,at),lt.return=it,lt;case wa:return at=Sg(at,it.mode,lt),at.return=it,at;case Ha:var ct=at._init;return d(it,ct(at._payload),lt)}if(eb(at)||Ka(at))return at=Tg(at,it.mode,lt,null),at.return=it,at;Mg(it,at)}return null}function a(it,at,lt,ct){var dt=at!==null?at.key:null;if(typeof lt=="string"&&lt!==""||typeof lt=="number")return dt!==null?null:$(it,at,""+lt,ct);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case va:return lt.key===dt?nt(it,at,lt,ct):null;case wa:return lt.key===dt?tt(it,at,lt,ct):null;case Ha:return dt=lt._init,a(it,at,dt(lt._payload),ct)}if(eb(lt)||Ka(lt))return dt!==null?null:et(it,at,lt,ct,null);Mg(it,lt)}return null}function g(it,at,lt,ct,dt){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return it=it.get(lt)||null,$(at,it,""+ct,dt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case va:return it=it.get(ct.key===null?lt:ct.key)||null,nt(at,it,ct,dt);case wa:return it=it.get(ct.key===null?lt:ct.key)||null,tt(at,it,ct,dt);case Ha:var mt=ct._init;return g(it,at,lt,mt(ct._payload),dt)}if(eb(ct)||Ka(ct))return it=it.get(lt)||null,et(at,it,ct,dt,null);Mg(at,ct)}return null}function j(it,at,lt,ct){for(var dt=null,mt=null,ht=at,ft=at=0,ut=null;ht!==null&&ft<lt.length;ft++){ht.index>ft?(ut=ht,ht=null):ut=ht.sibling;var _t=a(it,ht,lt[ft],ct);if(_t===null){ht===null&&(ht=ut);break}i&&ht&&_t.alternate===null&&e(it,ht),at=h(_t,at,ft),mt===null?dt=_t:mt.sibling=_t,mt=_t,ht=ut}if(ft===lt.length)return o(it,ht),I&&tg(it,ft),dt;if(ht===null){for(;ft<lt.length;ft++)ht=d(it,lt[ft],ct),ht!==null&&(at=h(ht,at,ft),mt===null?dt=ht:mt.sibling=ht,mt=ht);return I&&tg(it,ft),dt}for(ht=s(it,ht);ft<lt.length;ft++)ut=g(ht,it,ft,lt[ft],ct),ut!==null&&(i&&ut.alternate!==null&&ht.delete(ut.key===null?ft:ut.key),at=h(ut,at,ft),mt===null?dt=ut:mt.sibling=ut,mt=ut);return i&&ht.forEach(function(bt){return e(it,bt)}),I&&tg(it,ft),dt}function rt(it,at,lt,ct){var dt=Ka(lt);if(typeof dt!="function")throw Error(p(150));if(lt=dt.call(lt),lt==null)throw Error(p(151));for(var mt=dt=null,ht=at,ft=at=0,ut=null,_t=lt.next();ht!==null&&!_t.done;ft++,_t=lt.next()){ht.index>ft?(ut=ht,ht=null):ut=ht.sibling;var bt=a(it,ht,_t.value,ct);if(bt===null){ht===null&&(ht=ut);break}i&&ht&&bt.alternate===null&&e(it,ht),at=h(bt,at,ft),mt===null?dt=bt:mt.sibling=bt,mt=bt,ht=ut}if(_t.done)return o(it,ht),I&&tg(it,ft),dt;if(ht===null){for(;!_t.done;ft++,_t=lt.next())_t=d(it,_t.value,ct),_t!==null&&(at=h(_t,at,ft),mt===null?dt=_t:mt.sibling=_t,mt=_t);return I&&tg(it,ft),dt}for(ht=s(it,ht);!_t.done;ft++,_t=lt.next())_t=g(ht,it,ft,_t.value,ct),_t!==null&&(i&&_t.alternate!==null&&ht.delete(_t.key===null?ft:_t.key),at=h(_t,at,ft),mt===null?dt=_t:mt.sibling=_t,mt=_t);return i&&ht.forEach(function(vt){return e(it,vt)}),I&&tg(it,ft),dt}function ot(it,at,lt,ct){if(typeof lt=="object"&&lt!==null&&lt.type===ya&&lt.key===null&&(lt=lt.props.children),typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case va:e:{for(var dt=lt.key,mt=at;mt!==null;){if(mt.key===dt){if(dt=lt.type,dt===ya){if(mt.tag===7){o(it,mt.sibling),at=c(mt,lt.props.children),at.return=it,it=at;break e}}else if(mt.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===mt.type){o(it,mt.sibling),at=c(mt,lt.props),at.ref=Lg(it,mt,lt),at.return=it,it=at;break e}o(it,mt);break}else e(it,mt);mt=mt.sibling}lt.type===ya?(at=Tg(lt.props.children,it.mode,ct,lt.key),at.return=it,it=at):(ct=Rg(lt.type,lt.key,lt.props,null,it.mode,ct),ct.ref=Lg(it,at,lt),ct.return=it,it=ct)}return _(it);case wa:e:{for(mt=lt.key;at!==null;){if(at.key===mt)if(at.tag===4&&at.stateNode.containerInfo===lt.containerInfo&&at.stateNode.implementation===lt.implementation){o(it,at.sibling),at=c(at,lt.children||[]),at.return=it,it=at;break e}else{o(it,at);break}else e(it,at);at=at.sibling}at=Sg(lt,it.mode,ct),at.return=it,it=at}return _(it);case Ha:return mt=lt._init,ot(it,at,mt(lt._payload),ct)}if(eb(lt))return j(it,at,lt,ct);if(Ka(lt))return rt(it,at,lt,ct);Mg(it,lt)}return typeof lt=="string"&&lt!==""||typeof lt=="number"?(lt=""+lt,at!==null&&at.tag===6?(o(it,at.sibling),at=c(at,lt),at.return=it,it=at):(o(it,at),at=Qg(lt,it.mode,ct),at.return=it,it=at),_(it)):o(it,at)}return ot}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(i){var e=Wg.current;E(Wg),i._currentValue=e}function bh(i,e,o){for(;i!==null;){var s=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),i===o)break;i=i.return}}function ch(i,e){Xg=i,Zg=Yg=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(dh=!0),i.firstContext=null)}function eh(i){var e=i._currentValue;if(Zg!==i)if(i={context:i,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=i,Xg.dependencies={lanes:0,firstContext:i}}else Yg=Yg.next=i;return e}var fh=null;function gh(i){fh===null?fh=[i]:fh.push(i)}function hh(i,e,o,s){var c=e.interleaved;return c===null?(o.next=o,gh(e)):(o.next=c.next,c.next=o),e.interleaved=o,ih(i,s)}function ih(i,e){i.lanes|=e;var o=i.alternate;for(o!==null&&(o.lanes|=e),o=i,i=i.return;i!==null;)i.childLanes|=e,o=i.alternate,o!==null&&(o.childLanes|=e),o=i,i=i.return;return o.tag===3?o.stateNode:null}var jh=!1;function kh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function mh(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(i,e,o){var s=i.updateQueue;if(s===null)return null;if(s=s.shared,K&2){var c=s.pending;return c===null?e.next=e:(e.next=c.next,c.next=e),s.pending=e,ih(i,o)}return c=s.interleaved,c===null?(e.next=e,gh(s)):(e.next=c.next,c.next=e),s.interleaved=e,ih(i,o)}function oh(i,e,o){if(e=e.updateQueue,e!==null&&(e=e.shared,(o&4194240)!==0)){var s=e.lanes;s&=i.pendingLanes,o|=s,e.lanes=o,Cc(i,o)}}function ph(i,e){var o=i.updateQueue,s=i.alternate;if(s!==null&&(s=s.updateQueue,o===s)){var c=null,h=null;if(o=o.firstBaseUpdate,o!==null){do{var _={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};h===null?c=h=_:h=h.next=_,o=o.next}while(o!==null);h===null?c=h=e:h=h.next=e}else c=h=e;o={baseState:s.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:s.shared,effects:s.effects},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=e:i.next=e,o.lastBaseUpdate=e}function qh(i,e,o,s){var c=i.updateQueue;jh=!1;var h=c.firstBaseUpdate,_=c.lastBaseUpdate,$=c.shared.pending;if($!==null){c.shared.pending=null;var nt=$,tt=nt.next;nt.next=null,_===null?h=tt:_.next=tt,_=nt;var et=i.alternate;et!==null&&(et=et.updateQueue,$=et.lastBaseUpdate,$!==_&&($===null?et.firstBaseUpdate=tt:$.next=tt,et.lastBaseUpdate=nt))}if(h!==null){var d=c.baseState;_=0,et=tt=nt=null,$=h;do{var a=$.lane,g=$.eventTime;if((s&a)===a){et!==null&&(et=et.next={eventTime:g,lane:0,tag:$.tag,payload:$.payload,callback:$.callback,next:null});e:{var j=i,rt=$;switch(a=e,g=o,rt.tag){case 1:if(j=rt.payload,typeof j=="function"){d=j.call(g,d,a);break e}d=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=rt.payload,a=typeof j=="function"?j.call(g,d,a):j,a==null)break e;d=A({},d,a);break e;case 2:jh=!0}}$.callback!==null&&$.lane!==0&&(i.flags|=64,a=c.effects,a===null?c.effects=[$]:a.push($))}else g={eventTime:g,lane:a,tag:$.tag,payload:$.payload,callback:$.callback,next:null},et===null?(tt=et=g,nt=d):et=et.next=g,_|=a;if($=$.next,$===null){if($=c.shared.pending,$===null)break;a=$,$=a.next,a.next=null,c.lastBaseUpdate=a,c.shared.pending=null}}while(!0);if(et===null&&(nt=d),c.baseState=nt,c.firstBaseUpdate=tt,c.lastBaseUpdate=et,e=c.shared.interleaved,e!==null){c=e;do _|=c.lane,c=c.next;while(c!==e)}else h===null&&(c.shared.lanes=0);rh|=_,i.lanes=_,i.memoizedState=d}}function sh(i,e,o){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var s=i[e],c=s.callback;if(c!==null){if(s.callback=null,s=o,typeof c!="function")throw Error(p(191,c));c.call(s)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(i){if(i===th)throw Error(p(174));return i}function yh(i,e){switch(G(wh,e),G(vh,i),G(uh,th),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=lb(e,i)}E(uh),G(uh,e)}function zh(){E(uh),E(vh),E(wh)}function Ah(i){xh(wh.current);var e=xh(uh.current),o=lb(e,i.type);e!==o&&(G(vh,i),G(uh,o))}function Bh(i){vh.current===i&&(E(uh),E(vh))}var L=Uf(0);function Ch(i){for(var e=i;e!==null;){if(e.tag===13){var o=e.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var i=0;i<Dh.length;i++)Dh[i]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(i,e){if(e===null)return!1;for(var o=0;o<e.length&&o<i.length;o++)if(!He(i[o],e[o]))return!1;return!0}function Nh(i,e,o,s,c,h){if(Hh=h,M=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=i===null||i.memoizedState===null?Oh:Ph,i=o(s,c),Jh){h=0;do{if(Jh=!1,Kh=0,25<=h)throw Error(p(301));h+=1,O=N=null,e.updateQueue=null,Fh.current=Qh,i=o(s,c)}while(Jh)}if(Fh.current=Rh,e=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,e)throw Error(p(300));return i}function Sh(){var i=Kh!==0;return Kh=0,i}function Th(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=i:O=O.next=i,O}function Uh(){if(N===null){var i=M.alternate;i=i!==null?i.memoizedState:null}else i=N.next;var e=O===null?M.memoizedState:O.next;if(e!==null)O=e,N=i;else{if(i===null)throw Error(p(310));N=i,i={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=i:O=O.next=i}return O}function Vh(i,e){return typeof e=="function"?e(i):e}function Wh(i){var e=Uh(),o=e.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=i;var s=N,c=s.baseQueue,h=o.pending;if(h!==null){if(c!==null){var _=c.next;c.next=h.next,h.next=_}s.baseQueue=c=h,o.pending=null}if(c!==null){h=c.next,s=s.baseState;var $=_=null,nt=null,tt=h;do{var et=tt.lane;if((Hh&et)===et)nt!==null&&(nt=nt.next={lane:0,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),s=tt.hasEagerState?tt.eagerState:i(s,tt.action);else{var d={lane:et,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null};nt===null?($=nt=d,_=s):nt=nt.next=d,M.lanes|=et,rh|=et}tt=tt.next}while(tt!==null&&tt!==h);nt===null?_=s:nt.next=$,He(s,e.memoizedState)||(dh=!0),e.memoizedState=s,e.baseState=_,e.baseQueue=nt,o.lastRenderedState=s}if(i=o.interleaved,i!==null){c=i;do h=c.lane,M.lanes|=h,rh|=h,c=c.next;while(c!==i)}else c===null&&(o.lanes=0);return[e.memoizedState,o.dispatch]}function Xh(i){var e=Uh(),o=e.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=i;var s=o.dispatch,c=o.pending,h=e.memoizedState;if(c!==null){o.pending=null;var _=c=c.next;do h=i(h,_.action),_=_.next;while(_!==c);He(h,e.memoizedState)||(dh=!0),e.memoizedState=h,e.baseQueue===null&&(e.baseState=h),o.lastRenderedState=h}return[h,s]}function Yh(){}function Zh(i,e){var o=M,s=Uh(),c=e(),h=!He(s.memoizedState,c);if(h&&(s.memoizedState=c,dh=!0),s=s.queue,$h(ai.bind(null,o,s,i),[i]),s.getSnapshot!==e||h||O!==null&&O.memoizedState.tag&1){if(o.flags|=2048,bi(9,ci.bind(null,o,s,c,e),void 0,null),Q===null)throw Error(p(349));Hh&30||di(o,e,c)}return c}function di(i,e,o){i.flags|=16384,i={getSnapshot:e,value:o},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.stores=[i]):(o=e.stores,o===null?e.stores=[i]:o.push(i))}function ci(i,e,o,s){e.value=o,e.getSnapshot=s,ei(e)&&fi(i)}function ai(i,e,o){return o(function(){ei(e)&&fi(i)})}function ei(i){var e=i.getSnapshot;i=i.value;try{var o=e();return!He(i,o)}catch{return!0}}function fi(i){var e=ih(i,1);e!==null&&gi(e,i,1,-1)}function hi(i){var e=Th();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:i},e.queue=i,i=i.dispatch=ii.bind(null,M,i),[e.memoizedState,i]}function bi(i,e,o,s){return i={tag:i,create:e,destroy:o,deps:s,next:null},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.lastEffect=i.next=i):(o=e.lastEffect,o===null?e.lastEffect=i.next=i:(s=o.next,o.next=i,i.next=s,e.lastEffect=i)),i}function ji(){return Uh().memoizedState}function ki(i,e,o,s){var c=Th();M.flags|=i,c.memoizedState=bi(1|e,o,void 0,s===void 0?null:s)}function li(i,e,o,s){var c=Uh();s=s===void 0?null:s;var h=void 0;if(N!==null){var _=N.memoizedState;if(h=_.destroy,s!==null&&Mh(s,_.deps)){c.memoizedState=bi(e,o,h,s);return}}M.flags|=i,c.memoizedState=bi(1|e,o,h,s)}function mi(i,e){return ki(8390656,8,i,e)}function $h(i,e){return li(2048,8,i,e)}function ni(i,e){return li(4,2,i,e)}function oi(i,e){return li(4,4,i,e)}function pi(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function qi(i,e,o){return o=o!=null?o.concat([i]):null,li(4,4,pi.bind(null,e,i),o)}function ri(){}function si(i,e){var o=Uh();e=e===void 0?null:e;var s=o.memoizedState;return s!==null&&e!==null&&Mh(e,s[1])?s[0]:(o.memoizedState=[i,e],i)}function ti(i,e){var o=Uh();e=e===void 0?null:e;var s=o.memoizedState;return s!==null&&e!==null&&Mh(e,s[1])?s[0]:(i=i(),o.memoizedState=[i,e],i)}function ui(i,e,o){return Hh&21?(He(o,e)||(o=yc(),M.lanes|=o,rh|=o,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,dh=!0),i.memoizedState=o)}function vi(i,e){var o=C$1;C$1=o!==0&&4>o?o:4,i(!0);var s=Gh.transition;Gh.transition={};try{i(!1),e()}finally{C$1=o,Gh.transition=s}}function wi(){return Uh().memoizedState}function xi(i,e,o){var s=yi(i);if(o={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null},zi(i))Ai(e,o);else if(o=hh(i,e,o,s),o!==null){var c=R();gi(o,i,s,c),Bi(o,e,s)}}function ii(i,e,o){var s=yi(i),c={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null};if(zi(i))Ai(e,c);else{var h=i.alternate;if(i.lanes===0&&(h===null||h.lanes===0)&&(h=e.lastRenderedReducer,h!==null))try{var _=e.lastRenderedState,$=h(_,o);if(c.hasEagerState=!0,c.eagerState=$,He($,_)){var nt=e.interleaved;nt===null?(c.next=c,gh(e)):(c.next=nt.next,nt.next=c),e.interleaved=c;return}}catch{}finally{}o=hh(i,e,c,s),o!==null&&(c=R(),gi(o,i,s,c),Bi(o,e,s))}}function zi(i){var e=i.alternate;return i===M||e!==null&&e===M}function Ai(i,e){Jh=Ih=!0;var o=i.pending;o===null?e.next=e:(e.next=o.next,o.next=e),i.pending=e}function Bi(i,e,o){if(o&4194240){var s=e.lanes;s&=i.pendingLanes,o|=s,e.lanes=o,Cc(i,o)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(i,e){return Th().memoizedState=[i,e===void 0?null:e],i},useContext:eh,useEffect:mi,useImperativeHandle:function(i,e,o){return o=o!=null?o.concat([i]):null,ki(4194308,4,pi.bind(null,e,i),o)},useLayoutEffect:function(i,e){return ki(4194308,4,i,e)},useInsertionEffect:function(i,e){return ki(4,2,i,e)},useMemo:function(i,e){var o=Th();return e=e===void 0?null:e,i=i(),o.memoizedState=[i,e],i},useReducer:function(i,e,o){var s=Th();return e=o!==void 0?o(e):e,s.memoizedState=s.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},s.queue=i,i=i.dispatch=xi.bind(null,M,i),[s.memoizedState,i]},useRef:function(i){var e=Th();return i={current:i},e.memoizedState=i},useState:hi,useDebugValue:ri,useDeferredValue:function(i){return Th().memoizedState=i},useTransition:function(){var i=hi(!1),e=i[0];return i=vi.bind(null,i[1]),Th().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,o){var s=M,c=Th();if(I){if(o===void 0)throw Error(p(407));o=o()}else{if(o=e(),Q===null)throw Error(p(349));Hh&30||di(s,e,o)}c.memoizedState=o;var h={value:o,getSnapshot:e};return c.queue=h,mi(ai.bind(null,s,h,i),[i]),s.flags|=2048,bi(9,ci.bind(null,s,h,o,e),void 0,null),o},useId:function(){var i=Th(),e=Q.identifierPrefix;if(I){var o=sg,s=rg;o=(s&~(1<<32-oc(s)-1)).toString(32)+o,e=":"+e+"R"+o,o=Kh++,0<o&&(e+="H"+o.toString(32)),e+=":"}else o=Lh++,e=":"+e+"r"+o.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(i){var e=Uh();return ui(e,N.memoizedState,i)},useTransition:function(){var i=Wh(Vh)[0],e=Uh().memoizedState;return[i,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(i){var e=Uh();return N===null?e.memoizedState=i:ui(e,N.memoizedState,i)},useTransition:function(){var i=Xh(Vh)[0],e=Uh().memoizedState;return[i,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(i,e){if(i&&i.defaultProps){e=A({},e),i=i.defaultProps;for(var o in i)e[o]===void 0&&(e[o]=i[o]);return e}return e}function Di(i,e,o,s){e=i.memoizedState,o=o(s,e),o=o==null?e:A({},e,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var Ei={isMounted:function(i){return(i=i._reactInternals)?Vb(i)===i:!1},enqueueSetState:function(i,e,o){i=i._reactInternals;var s=R(),c=yi(i),h=mh(s,c);h.payload=e,o!=null&&(h.callback=o),e=nh(i,h,c),e!==null&&(gi(e,i,c,s),oh(e,i,c))},enqueueReplaceState:function(i,e,o){i=i._reactInternals;var s=R(),c=yi(i),h=mh(s,c);h.tag=1,h.payload=e,o!=null&&(h.callback=o),e=nh(i,h,c),e!==null&&(gi(e,i,c,s),oh(e,i,c))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var o=R(),s=yi(i),c=mh(o,s);c.tag=2,e!=null&&(c.callback=e),e=nh(i,c,s),e!==null&&(gi(e,i,s,o),oh(e,i,s))}};function Fi(i,e,o,s,c,h,_){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(s,h,_):e.prototype&&e.prototype.isPureReactComponent?!Ie$1(o,s)||!Ie$1(c,h):!0}function Gi(i,e,o){var s=!1,c=Vf,h=e.contextType;return typeof h=="object"&&h!==null?h=eh(h):(c=Zf(e)?Xf:H.current,s=e.contextTypes,h=(s=s!=null)?Yf(i,c):Vf),e=new e(o,h),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,i.stateNode=e,e._reactInternals=i,s&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=c,i.__reactInternalMemoizedMaskedChildContext=h),e}function Hi(i,e,o,s){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(o,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(o,s),e.state!==i&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(i,e,o,s){var c=i.stateNode;c.props=o,c.state=i.memoizedState,c.refs={},kh(i);var h=e.contextType;typeof h=="object"&&h!==null?c.context=eh(h):(h=Zf(e)?Xf:H.current,c.context=Yf(i,h)),c.state=i.memoizedState,h=e.getDerivedStateFromProps,typeof h=="function"&&(Di(i,e,h,o),c.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(e=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),e!==c.state&&Ei.enqueueReplaceState(c,c.state,null),qh(i,o,c,s),c.state=i.memoizedState),typeof c.componentDidMount=="function"&&(i.flags|=4194308)}function Ji(i,e){try{var o="",s=e;do o+=Pa(s),s=s.return;while(s);var c=o}catch(h){c=`
Error generating stack: `+h.message+`
`+h.stack}return{value:i,source:e,stack:c,digest:null}}function Ki(i,e,o){return{value:i,source:null,stack:o??null,digest:e??null}}function Li(i,e){try{console.error(e.value)}catch(o){setTimeout(function(){throw o})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(i,e,o){o=mh(-1,o),o.tag=3,o.payload={element:null};var s=e.value;return o.callback=function(){Oi||(Oi=!0,Pi=s),Li(i,e)},o}function Qi(i,e,o){o=mh(-1,o),o.tag=3;var s=i.type.getDerivedStateFromError;if(typeof s=="function"){var c=e.value;o.payload=function(){return s(c)},o.callback=function(){Li(i,e)}}var h=i.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(o.callback=function(){Li(i,e),typeof s!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var _=e.stack;this.componentDidCatch(e.value,{componentStack:_!==null?_:""})}),o}function Si(i,e,o){var s=i.pingCache;if(s===null){s=i.pingCache=new Mi;var c=new Set;s.set(e,c)}else c=s.get(e),c===void 0&&(c=new Set,s.set(e,c));c.has(o)||(c.add(o),i=Ti.bind(null,i,e,o),e.then(i,i))}function Ui(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function Vi(i,e,o,s,c){return i.mode&1?(i.flags|=65536,i.lanes=c,i):(i===e?i.flags|=65536:(i.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(e=mh(-1,1),e.tag=2,nh(o,e,1))),o.lanes|=1),i)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(i,e,o,s){e.child=i===null?Vg(e,null,o,s):Ug(e,i.child,o,s)}function Yi(i,e,o,s,c){o=o.render;var h=e.ref;return ch(e,c),s=Nh(i,e,o,s,h,c),o=Sh(),i!==null&&!dh?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~c,Zi(i,e,c)):(I&&o&&vg(e),e.flags|=1,Xi(i,e,s,c),e.child)}function $i(i,e,o,s,c){if(i===null){var h=o.type;return typeof h=="function"&&!aj(h)&&h.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(e.tag=15,e.type=h,bj(i,e,h,s,c)):(i=Rg(o.type,null,s,e,e.mode,c),i.ref=e.ref,i.return=e,e.child=i)}if(h=i.child,!(i.lanes&c)){var _=h.memoizedProps;if(o=o.compare,o=o!==null?o:Ie$1,o(_,s)&&i.ref===e.ref)return Zi(i,e,c)}return e.flags|=1,i=Pg(h,s),i.ref=e.ref,i.return=e,e.child=i}function bj(i,e,o,s,c){if(i!==null){var h=i.memoizedProps;if(Ie$1(h,s)&&i.ref===e.ref)if(dh=!1,e.pendingProps=s=h,(i.lanes&c)!==0)i.flags&131072&&(dh=!0);else return e.lanes=i.lanes,Zi(i,e,c)}return cj(i,e,o,s,c)}function dj(i,e,o){var s=e.pendingProps,c=s.children,h=i!==null?i.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=o;else{if(!(o&1073741824))return i=h!==null?h.baseLanes|o:o,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,G(ej,fj),fj|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=h!==null?h.baseLanes:o,G(ej,fj),fj|=s}else h!==null?(s=h.baseLanes|o,e.memoizedState=null):s=o,G(ej,fj),fj|=s;return Xi(i,e,c,o),e.child}function gj(i,e){var o=e.ref;(i===null&&o!==null||i!==null&&i.ref!==o)&&(e.flags|=512,e.flags|=2097152)}function cj(i,e,o,s,c){var h=Zf(o)?Xf:H.current;return h=Yf(e,h),ch(e,c),o=Nh(i,e,o,s,h,c),s=Sh(),i!==null&&!dh?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~c,Zi(i,e,c)):(I&&s&&vg(e),e.flags|=1,Xi(i,e,o,c),e.child)}function hj(i,e,o,s,c){if(Zf(o)){var h=!0;cg(e)}else h=!1;if(ch(e,c),e.stateNode===null)ij(i,e),Gi(e,o,s),Ii(e,o,s,c),s=!0;else if(i===null){var _=e.stateNode,$=e.memoizedProps;_.props=$;var nt=_.context,tt=o.contextType;typeof tt=="object"&&tt!==null?tt=eh(tt):(tt=Zf(o)?Xf:H.current,tt=Yf(e,tt));var et=o.getDerivedStateFromProps,d=typeof et=="function"||typeof _.getSnapshotBeforeUpdate=="function";d||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||($!==s||nt!==tt)&&Hi(e,_,s,tt),jh=!1;var a=e.memoizedState;_.state=a,qh(e,s,_,c),nt=e.memoizedState,$!==s||a!==nt||Wf.current||jh?(typeof et=="function"&&(Di(e,o,et,s),nt=e.memoizedState),($=jh||Fi(e,o,$,s,a,nt,tt))?(d||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(e.flags|=4194308)):(typeof _.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=nt),_.props=s,_.state=nt,_.context=tt,s=$):(typeof _.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{_=e.stateNode,lh(i,e),$=e.memoizedProps,tt=e.type===e.elementType?$:Ci(e.type,$),_.props=tt,d=e.pendingProps,a=_.context,nt=o.contextType,typeof nt=="object"&&nt!==null?nt=eh(nt):(nt=Zf(o)?Xf:H.current,nt=Yf(e,nt));var g=o.getDerivedStateFromProps;(et=typeof g=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||($!==d||a!==nt)&&Hi(e,_,s,nt),jh=!1,a=e.memoizedState,_.state=a,qh(e,s,_,c);var j=e.memoizedState;$!==d||a!==j||Wf.current||jh?(typeof g=="function"&&(Di(e,o,g,s),j=e.memoizedState),(tt=jh||Fi(e,o,tt,s,a,j,nt)||!1)?(et||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(s,j,nt),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(s,j,nt)),typeof _.componentDidUpdate=="function"&&(e.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof _.componentDidUpdate!="function"||$===i.memoizedProps&&a===i.memoizedState||(e.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||$===i.memoizedProps&&a===i.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=j),_.props=s,_.state=j,_.context=nt,s=tt):(typeof _.componentDidUpdate!="function"||$===i.memoizedProps&&a===i.memoizedState||(e.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||$===i.memoizedProps&&a===i.memoizedState||(e.flags|=1024),s=!1)}return jj(i,e,o,s,h,c)}function jj(i,e,o,s,c,h){gj(i,e);var _=(e.flags&128)!==0;if(!s&&!_)return c&&dg(e,o,!1),Zi(i,e,h);s=e.stateNode,Wi.current=e;var $=_&&typeof o.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,i!==null&&_?(e.child=Ug(e,i.child,null,h),e.child=Ug(e,null,$,h)):Xi(i,e,$,h),e.memoizedState=s.state,c&&dg(e,o,!0),e.child}function kj(i){var e=i.stateNode;e.pendingContext?ag(i,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(i,e.context,!1),yh(i,e.containerInfo)}function lj(i,e,o,s,c){return Ig(),Jg(c),e.flags|=256,Xi(i,e,o,s),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(i){return{baseLanes:i,cachePool:null,transitions:null}}function oj(i,e,o){var s=e.pendingProps,c=L.current,h=!1,_=(e.flags&128)!==0,$;if(($=_)||($=i!==null&&i.memoizedState===null?!1:(c&2)!==0),$?(h=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(c|=1),G(L,c&1),i===null)return Eg(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(_=s.children,i=s.fallback,h?(s=e.mode,h=e.child,_={mode:"hidden",children:_},!(s&1)&&h!==null?(h.childLanes=0,h.pendingProps=_):h=pj(_,s,0,null),i=Tg(i,s,o,null),h.return=e,i.return=e,h.sibling=i,e.child=h,e.child.memoizedState=nj(o),e.memoizedState=mj,i):qj(e,_));if(c=i.memoizedState,c!==null&&($=c.dehydrated,$!==null))return rj(i,e,_,s,$,c,o);if(h){h=s.fallback,_=e.mode,c=i.child,$=c.sibling;var nt={mode:"hidden",children:s.children};return!(_&1)&&e.child!==c?(s=e.child,s.childLanes=0,s.pendingProps=nt,e.deletions=null):(s=Pg(c,nt),s.subtreeFlags=c.subtreeFlags&14680064),$!==null?h=Pg($,h):(h=Tg(h,_,o,null),h.flags|=2),h.return=e,s.return=e,s.sibling=h,e.child=s,s=h,h=e.child,_=i.child.memoizedState,_=_===null?nj(o):{baseLanes:_.baseLanes|o,cachePool:null,transitions:_.transitions},h.memoizedState=_,h.childLanes=i.childLanes&~o,e.memoizedState=mj,s}return h=i.child,i=h.sibling,s=Pg(h,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=o),s.return=e,s.sibling=null,i!==null&&(o=e.deletions,o===null?(e.deletions=[i],e.flags|=16):o.push(i)),e.child=s,e.memoizedState=null,s}function qj(i,e){return e=pj({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function sj(i,e,o,s){return s!==null&&Jg(s),Ug(e,i.child,null,o),i=qj(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function rj(i,e,o,s,c,h,_){if(o)return e.flags&256?(e.flags&=-257,s=Ki(Error(p(422))),sj(i,e,_,s)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(h=s.fallback,c=e.mode,s=pj({mode:"visible",children:s.children},c,0,null),h=Tg(h,c,_,null),h.flags|=2,s.return=e,h.return=e,s.sibling=h,e.child=s,e.mode&1&&Ug(e,i.child,null,_),e.child.memoizedState=nj(_),e.memoizedState=mj,h);if(!(e.mode&1))return sj(i,e,_,null);if(c.data==="$!"){if(s=c.nextSibling&&c.nextSibling.dataset,s)var $=s.dgst;return s=$,h=Error(p(419)),s=Ki(h,s,void 0),sj(i,e,_,s)}if($=(_&i.childLanes)!==0,dh||$){if(s=Q,s!==null){switch(_&-_){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(s.suspendedLanes|_)?0:c,c!==0&&c!==h.retryLane&&(h.retryLane=c,ih(i,c),gi(s,i,c,-1))}return tj(),s=Ki(Error(p(421))),sj(i,e,_,s)}return c.data==="$?"?(e.flags|=128,e.child=i.child,e=uj.bind(null,i),c._reactRetry=e,null):(i=h.treeContext,yg=Lf(c.nextSibling),xg=e,I=!0,zg=null,i!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=i.id,sg=i.overflow,qg=e),e=qj(e,s.children),e.flags|=4096,e)}function vj(i,e,o){i.lanes|=e;var s=i.alternate;s!==null&&(s.lanes|=e),bh(i.return,e,o)}function wj(i,e,o,s,c){var h=i.memoizedState;h===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:o,tailMode:c}:(h.isBackwards=e,h.rendering=null,h.renderingStartTime=0,h.last=s,h.tail=o,h.tailMode=c)}function xj(i,e,o){var s=e.pendingProps,c=s.revealOrder,h=s.tail;if(Xi(i,e,s.children,o),s=L.current,s&2)s=s&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&vj(i,o,e);else if(i.tag===19)vj(i,o,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}s&=1}if(G(L,s),!(e.mode&1))e.memoizedState=null;else switch(c){case"forwards":for(o=e.child,c=null;o!==null;)i=o.alternate,i!==null&&Ch(i)===null&&(c=o),o=o.sibling;o=c,o===null?(c=e.child,e.child=null):(c=o.sibling,o.sibling=null),wj(e,!1,c,o,h);break;case"backwards":for(o=null,c=e.child,e.child=null;c!==null;){if(i=c.alternate,i!==null&&Ch(i)===null){e.child=c;break}i=c.sibling,c.sibling=o,o=c,c=i}wj(e,!0,o,null,h);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Zi(i,e,o){if(i!==null&&(e.dependencies=i.dependencies),rh|=e.lanes,!(o&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(p(153));if(e.child!==null){for(i=e.child,o=Pg(i,i.pendingProps),e.child=o,o.return=e;i.sibling!==null;)i=i.sibling,o=o.sibling=Pg(i,i.pendingProps),o.return=e;o.sibling=null}return e.child}function yj(i,e,o){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,c=e.memoizedProps.value;G(Wg,s._currentValue),s._currentValue=c;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(G(L,L.current&1),e.flags|=128,null):o&e.child.childLanes?oj(i,e,o):(G(L,L.current&1),i=Zi(i,e,o),i!==null?i.sibling:null);G(L,L.current&1);break;case 19:if(s=(o&e.childLanes)!==0,i.flags&128){if(s)return xj(i,e,o);e.flags|=128}if(c=e.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),G(L,L.current),s)break;return null;case 22:case 23:return e.lanes=0,dj(i,e,o)}return Zi(i,e,o)}var zj,Aj,Bj,Cj;zj=function(i,e){for(var o=e.child;o!==null;){if(o.tag===5||o.tag===6)i.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Aj=function(){};Bj=function(i,e,o,s){var c=i.memoizedProps;if(c!==s){i=e.stateNode,xh(uh.current);var h=null;switch(o){case"input":c=Ya(i,c),s=Ya(i,s),h=[];break;case"select":c=A({},c,{value:void 0}),s=A({},s,{value:void 0}),h=[];break;case"textarea":c=gb(i,c),s=gb(i,s),h=[];break;default:typeof c.onClick!="function"&&typeof s.onClick=="function"&&(i.onclick=Bf)}ub(o,s);var _;o=null;for(tt in c)if(!s.hasOwnProperty(tt)&&c.hasOwnProperty(tt)&&c[tt]!=null)if(tt==="style"){var $=c[tt];for(_ in $)$.hasOwnProperty(_)&&(o||(o={}),o[_]="")}else tt!=="dangerouslySetInnerHTML"&&tt!=="children"&&tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&tt!=="autoFocus"&&(ea.hasOwnProperty(tt)?h||(h=[]):(h=h||[]).push(tt,null));for(tt in s){var nt=s[tt];if($=c!=null?c[tt]:void 0,s.hasOwnProperty(tt)&&nt!==$&&(nt!=null||$!=null))if(tt==="style")if($){for(_ in $)!$.hasOwnProperty(_)||nt&&nt.hasOwnProperty(_)||(o||(o={}),o[_]="");for(_ in nt)nt.hasOwnProperty(_)&&$[_]!==nt[_]&&(o||(o={}),o[_]=nt[_])}else o||(h||(h=[]),h.push(tt,o)),o=nt;else tt==="dangerouslySetInnerHTML"?(nt=nt?nt.__html:void 0,$=$?$.__html:void 0,nt!=null&&$!==nt&&(h=h||[]).push(tt,nt)):tt==="children"?typeof nt!="string"&&typeof nt!="number"||(h=h||[]).push(tt,""+nt):tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&(ea.hasOwnProperty(tt)?(nt!=null&&tt==="onScroll"&&D$1("scroll",i),h||$===nt||(h=[])):(h=h||[]).push(tt,nt))}o&&(h=h||[]).push("style",o);var tt=h;(e.updateQueue=tt)&&(e.flags|=4)}};Cj=function(i,e,o,s){o!==s&&(e.flags|=4)};function Dj(i,e){if(!I)switch(i.tailMode){case"hidden":e=i.tail;for(var o=null;e!==null;)e.alternate!==null&&(o=e),e=e.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:s.sibling=null}}function S$1(i){var e=i.alternate!==null&&i.alternate.child===i.child,o=0,s=0;if(e)for(var c=i.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags&14680064,s|=c.flags&14680064,c.return=i,c=c.sibling;else for(c=i.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags,s|=c.flags,c.return=i,c=c.sibling;return i.subtreeFlags|=s,i.childLanes=o,e}function Ej(i,e,o){var s=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(e),null;case 1:return Zf(e.type)&&$f(),S$1(e),null;case 3:return s=e.stateNode,zh(),E(Wf),E(H),Eh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(i===null||i.child===null)&&(Gg(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(i,e),S$1(e),null;case 5:Bh(e);var c=xh(wh.current);if(o=e.type,i!==null&&e.stateNode!=null)Bj(i,e,o,s,c),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(p(166));return S$1(e),null}if(i=xh(uh.current),Gg(e)){s=e.stateNode,o=e.type;var h=e.memoizedProps;switch(s[Of]=e,s[Pf]=h,i=(e.mode&1)!==0,o){case"dialog":D$1("cancel",s),D$1("close",s);break;case"iframe":case"object":case"embed":D$1("load",s);break;case"video":case"audio":for(c=0;c<lf.length;c++)D$1(lf[c],s);break;case"source":D$1("error",s);break;case"img":case"image":case"link":D$1("error",s),D$1("load",s);break;case"details":D$1("toggle",s);break;case"input":Za(s,h),D$1("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!h.multiple},D$1("invalid",s);break;case"textarea":hb(s,h),D$1("invalid",s)}ub(o,h),c=null;for(var _ in h)if(h.hasOwnProperty(_)){var $=h[_];_==="children"?typeof $=="string"?s.textContent!==$&&(h.suppressHydrationWarning!==!0&&Af(s.textContent,$,i),c=["children",$]):typeof $=="number"&&s.textContent!==""+$&&(h.suppressHydrationWarning!==!0&&Af(s.textContent,$,i),c=["children",""+$]):ea.hasOwnProperty(_)&&$!=null&&_==="onScroll"&&D$1("scroll",s)}switch(o){case"input":Va(s),db(s,h,!0);break;case"textarea":Va(s),jb(s);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(s.onclick=Bf)}s=c,e.updateQueue=s,s!==null&&(e.flags|=4)}else{_=c.nodeType===9?c:c.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=kb(o)),i==="http://www.w3.org/1999/xhtml"?o==="script"?(i=_.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof s.is=="string"?i=_.createElement(o,{is:s.is}):(i=_.createElement(o),o==="select"&&(_=i,s.multiple?_.multiple=!0:s.size&&(_.size=s.size))):i=_.createElementNS(i,o),i[Of]=e,i[Pf]=s,zj(i,e,!1,!1),e.stateNode=i;e:{switch(_=vb(o,s),o){case"dialog":D$1("cancel",i),D$1("close",i),c=s;break;case"iframe":case"object":case"embed":D$1("load",i),c=s;break;case"video":case"audio":for(c=0;c<lf.length;c++)D$1(lf[c],i);c=s;break;case"source":D$1("error",i),c=s;break;case"img":case"image":case"link":D$1("error",i),D$1("load",i),c=s;break;case"details":D$1("toggle",i),c=s;break;case"input":Za(i,s),c=Ya(i,s),D$1("invalid",i);break;case"option":c=s;break;case"select":i._wrapperState={wasMultiple:!!s.multiple},c=A({},s,{value:void 0}),D$1("invalid",i);break;case"textarea":hb(i,s),c=gb(i,s),D$1("invalid",i);break;default:c=s}ub(o,c),$=c;for(h in $)if($.hasOwnProperty(h)){var nt=$[h];h==="style"?sb(i,nt):h==="dangerouslySetInnerHTML"?(nt=nt?nt.__html:void 0,nt!=null&&nb(i,nt)):h==="children"?typeof nt=="string"?(o!=="textarea"||nt!=="")&&ob(i,nt):typeof nt=="number"&&ob(i,""+nt):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ea.hasOwnProperty(h)?nt!=null&&h==="onScroll"&&D$1("scroll",i):nt!=null&&ta(i,h,nt,_))}switch(o){case"input":Va(i),db(i,s,!1);break;case"textarea":Va(i),jb(i);break;case"option":s.value!=null&&i.setAttribute("value",""+Sa(s.value));break;case"select":i.multiple=!!s.multiple,h=s.value,h!=null?fb(i,!!s.multiple,h,!1):s.defaultValue!=null&&fb(i,!!s.multiple,s.defaultValue,!0);break;default:typeof c.onClick=="function"&&(i.onclick=Bf)}switch(o){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S$1(e),null;case 6:if(i&&e.stateNode!=null)Cj(i,e,i.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(p(166));if(o=xh(wh.current),xh(uh.current),Gg(e)){if(s=e.stateNode,o=e.memoizedProps,s[Of]=e,(h=s.nodeValue!==o)&&(i=xg,i!==null))switch(i.tag){case 3:Af(s.nodeValue,o,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Af(s.nodeValue,o,(i.mode&1)!==0)}h&&(e.flags|=4)}else s=(o.nodeType===9?o:o.ownerDocument).createTextNode(s),s[Of]=e,e.stateNode=s}return S$1(e),null;case 13:if(E(L),s=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(I&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,h=!1;else if(h=Gg(e),s!==null&&s.dehydrated!==null){if(i===null){if(!h)throw Error(p(318));if(h=e.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(p(317));h[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S$1(e),h=!1}else zg!==null&&(Fj(zg),zg=null),h=!0;if(!h)return e.flags&65536?e:null}return e.flags&128?(e.lanes=o,e):(s=s!==null,s!==(i!==null&&i.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(i===null||L.current&1?T===0&&(T=3):tj())),e.updateQueue!==null&&(e.flags|=4),S$1(e),null);case 4:return zh(),Aj(i,e),i===null&&sf(e.stateNode.containerInfo),S$1(e),null;case 10:return ah(e.type._context),S$1(e),null;case 17:return Zf(e.type)&&$f(),S$1(e),null;case 19:if(E(L),h=e.memoizedState,h===null)return S$1(e),null;if(s=(e.flags&128)!==0,_=h.rendering,_===null)if(s)Dj(h,!1);else{if(T!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(_=Ch(i),_!==null){for(e.flags|=128,Dj(h,!1),s=_.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=o,o=e.child;o!==null;)h=o,i=s,h.flags&=14680066,_=h.alternate,_===null?(h.childLanes=0,h.lanes=i,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=_.childLanes,h.lanes=_.lanes,h.child=_.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=_.memoizedProps,h.memoizedState=_.memoizedState,h.updateQueue=_.updateQueue,h.type=_.type,i=_.dependencies,h.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),o=o.sibling;return G(L,L.current&1|2),e.child}i=i.sibling}h.tail!==null&&B()>Gj&&(e.flags|=128,s=!0,Dj(h,!1),e.lanes=4194304)}else{if(!s)if(i=Ch(_),i!==null){if(e.flags|=128,s=!0,o=i.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),Dj(h,!0),h.tail===null&&h.tailMode==="hidden"&&!_.alternate&&!I)return S$1(e),null}else 2*B()-h.renderingStartTime>Gj&&o!==1073741824&&(e.flags|=128,s=!0,Dj(h,!1),e.lanes=4194304);h.isBackwards?(_.sibling=e.child,e.child=_):(o=h.last,o!==null?o.sibling=_:e.child=_,h.last=_)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=B(),e.sibling=null,o=L.current,G(L,s?o&1|2:o&1),e):(S$1(e),null);case 22:case 23:return Hj(),s=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?fj&1073741824&&(S$1(e),e.subtreeFlags&6&&(e.flags|=8192)):S$1(e),null;case 24:return null;case 25:return null}throw Error(p(156,e.tag))}function Ij(i,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return zh(),E(Wf),E(H),Eh(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E(L),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(p(340));Ig()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(i,e){var o=i.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(s){W(i,e,s)}else o.current=null}function Mj(i,e,o){try{o()}catch(s){W(i,e,s)}}var Nj=!1;function Oj(i,e){if(Cf=dd,i=Me(),Ne(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var s=o.getSelection&&o.getSelection();if(s&&s.rangeCount!==0){o=s.anchorNode;var c=s.anchorOffset,h=s.focusNode;s=s.focusOffset;try{o.nodeType,h.nodeType}catch{o=null;break e}var _=0,$=-1,nt=-1,tt=0,et=0,d=i,a=null;t:for(;;){for(var g;d!==o||c!==0&&d.nodeType!==3||($=_+c),d!==h||s!==0&&d.nodeType!==3||(nt=_+s),d.nodeType===3&&(_+=d.nodeValue.length),(g=d.firstChild)!==null;)a=d,d=g;for(;;){if(d===i)break t;if(a===o&&++tt===c&&($=_),a===h&&++et===s&&(nt=_),(g=d.nextSibling)!==null)break;d=a,a=d.parentNode}d=g}o=$===-1||nt===-1?null:{start:$,end:nt}}else o=null}o=o||{start:0,end:0}}else o=null;for(Df={focusedElem:i,selectionRange:o},dd=!1,V=e;V!==null;)if(e=V,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,V=i;else for(;V!==null;){e=V;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var rt=j.memoizedProps,ot=j.memoizedState,it=e.stateNode,at=it.getSnapshotBeforeUpdate(e.elementType===e.type?rt:Ci(e.type,rt),ot);it.__reactInternalSnapshotBeforeUpdate=at}break;case 3:var lt=e.stateNode.containerInfo;lt.nodeType===1?lt.textContent="":lt.nodeType===9&&lt.documentElement&&lt.removeChild(lt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(ct){W(e,e.return,ct)}if(i=e.sibling,i!==null){i.return=e.return,V=i;break}V=e.return}return j=Nj,Nj=!1,j}function Pj(i,e,o){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&i)===i){var h=c.destroy;c.destroy=void 0,h!==void 0&&Mj(e,o,h)}c=c.next}while(c!==s)}}function Qj(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var o=e=e.next;do{if((o.tag&i)===i){var s=o.create;o.destroy=s()}o=o.next}while(o!==e)}}function Rj(i){var e=i.ref;if(e!==null){var o=i.stateNode;switch(i.tag){case 5:i=o;break;default:i=o}typeof e=="function"?e(i):e.current=i}}function Sj(i){var e=i.alternate;e!==null&&(i.alternate=null,Sj(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Tj(i){return i.tag===5||i.tag===3||i.tag===4}function Uj(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Tj(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Vj(i,e,o){var s=i.tag;if(s===5||s===6)i=i.stateNode,e?o.nodeType===8?o.parentNode.insertBefore(i,e):o.insertBefore(i,e):(o.nodeType===8?(e=o.parentNode,e.insertBefore(i,o)):(e=o,e.appendChild(i)),o=o._reactRootContainer,o!=null||e.onclick!==null||(e.onclick=Bf));else if(s!==4&&(i=i.child,i!==null))for(Vj(i,e,o),i=i.sibling;i!==null;)Vj(i,e,o),i=i.sibling}function Wj(i,e,o){var s=i.tag;if(s===5||s===6)i=i.stateNode,e?o.insertBefore(i,e):o.appendChild(i);else if(s!==4&&(i=i.child,i!==null))for(Wj(i,e,o),i=i.sibling;i!==null;)Wj(i,e,o),i=i.sibling}var X=null,Xj=!1;function Yj(i,e,o){for(o=o.child;o!==null;)Zj(i,e,o),o=o.sibling}function Zj(i,e,o){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,o)}catch{}switch(o.tag){case 5:U||Lj(o,e);case 6:var s=X,c=Xj;X=null,Yj(i,e,o),X=s,Xj=c,X!==null&&(Xj?(i=X,o=o.stateNode,i.nodeType===8?i.parentNode.removeChild(o):i.removeChild(o)):X.removeChild(o.stateNode));break;case 18:X!==null&&(Xj?(i=X,o=o.stateNode,i.nodeType===8?Kf(i.parentNode,o):i.nodeType===1&&Kf(i,o),bd(i)):Kf(X,o.stateNode));break;case 4:s=X,c=Xj,X=o.stateNode.containerInfo,Xj=!0,Yj(i,e,o),X=s,Xj=c;break;case 0:case 11:case 14:case 15:if(!U&&(s=o.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){c=s=s.next;do{var h=c,_=h.destroy;h=h.tag,_!==void 0&&(h&2||h&4)&&Mj(o,e,_),c=c.next}while(c!==s)}Yj(i,e,o);break;case 1:if(!U&&(Lj(o,e),s=o.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=o.memoizedProps,s.state=o.memoizedState,s.componentWillUnmount()}catch($){W(o,e,$)}Yj(i,e,o);break;case 21:Yj(i,e,o);break;case 22:o.mode&1?(U=(s=U)||o.memoizedState!==null,Yj(i,e,o),U=s):Yj(i,e,o);break;default:Yj(i,e,o)}}function ak(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var o=i.stateNode;o===null&&(o=i.stateNode=new Kj),e.forEach(function(s){var c=bk.bind(null,i,s);o.has(s)||(o.add(s),s.then(c,c))})}}function ck(i,e){var o=e.deletions;if(o!==null)for(var s=0;s<o.length;s++){var c=o[s];try{var h=i,_=e,$=_;e:for(;$!==null;){switch($.tag){case 5:X=$.stateNode,Xj=!1;break e;case 3:X=$.stateNode.containerInfo,Xj=!0;break e;case 4:X=$.stateNode.containerInfo,Xj=!0;break e}$=$.return}if(X===null)throw Error(p(160));Zj(h,_,c),X=null,Xj=!1;var nt=c.alternate;nt!==null&&(nt.return=null),c.return=null}catch(tt){W(c,e,tt)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,i),e=e.sibling}function dk(i,e){var o=i.alternate,s=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ck(e,i),ek(i),s&4){try{Pj(3,i,i.return),Qj(3,i)}catch(rt){W(i,i.return,rt)}try{Pj(5,i,i.return)}catch(rt){W(i,i.return,rt)}}break;case 1:ck(e,i),ek(i),s&512&&o!==null&&Lj(o,o.return);break;case 5:if(ck(e,i),ek(i),s&512&&o!==null&&Lj(o,o.return),i.flags&32){var c=i.stateNode;try{ob(c,"")}catch(rt){W(i,i.return,rt)}}if(s&4&&(c=i.stateNode,c!=null)){var h=i.memoizedProps,_=o!==null?o.memoizedProps:h,$=i.type,nt=i.updateQueue;if(i.updateQueue=null,nt!==null)try{$==="input"&&h.type==="radio"&&h.name!=null&&ab(c,h),vb($,_);var tt=vb($,h);for(_=0;_<nt.length;_+=2){var et=nt[_],d=nt[_+1];et==="style"?sb(c,d):et==="dangerouslySetInnerHTML"?nb(c,d):et==="children"?ob(c,d):ta(c,et,d,tt)}switch($){case"input":bb(c,h);break;case"textarea":ib(c,h);break;case"select":var a=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!h.multiple;var g=h.value;g!=null?fb(c,!!h.multiple,g,!1):a!==!!h.multiple&&(h.defaultValue!=null?fb(c,!!h.multiple,h.defaultValue,!0):fb(c,!!h.multiple,h.multiple?[]:"",!1))}c[Pf]=h}catch(rt){W(i,i.return,rt)}}break;case 6:if(ck(e,i),ek(i),s&4){if(i.stateNode===null)throw Error(p(162));c=i.stateNode,h=i.memoizedProps;try{c.nodeValue=h}catch(rt){W(i,i.return,rt)}}break;case 3:if(ck(e,i),ek(i),s&4&&o!==null&&o.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(rt){W(i,i.return,rt)}break;case 4:ck(e,i),ek(i);break;case 13:ck(e,i),ek(i),c=i.child,c.flags&8192&&(h=c.memoizedState!==null,c.stateNode.isHidden=h,!h||c.alternate!==null&&c.alternate.memoizedState!==null||(fk=B())),s&4&&ak(i);break;case 22:if(et=o!==null&&o.memoizedState!==null,i.mode&1?(U=(tt=U)||et,ck(e,i),U=tt):ck(e,i),ek(i),s&8192){if(tt=i.memoizedState!==null,(i.stateNode.isHidden=tt)&&!et&&i.mode&1)for(V=i,et=i.child;et!==null;){for(d=V=et;V!==null;){switch(a=V,g=a.child,a.tag){case 0:case 11:case 14:case 15:Pj(4,a,a.return);break;case 1:Lj(a,a.return);var j=a.stateNode;if(typeof j.componentWillUnmount=="function"){s=a,o=a.return;try{e=s,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(rt){W(s,o,rt)}}break;case 5:Lj(a,a.return);break;case 22:if(a.memoizedState!==null){gk(d);continue}}g!==null?(g.return=a,V=g):gk(d)}et=et.sibling}e:for(et=null,d=i;;){if(d.tag===5){if(et===null){et=d;try{c=d.stateNode,tt?(h=c.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):($=d.stateNode,nt=d.memoizedProps.style,_=nt!=null&&nt.hasOwnProperty("display")?nt.display:null,$.style.display=rb("display",_))}catch(rt){W(i,i.return,rt)}}}else if(d.tag===6){if(et===null)try{d.stateNode.nodeValue=tt?"":d.memoizedProps}catch(rt){W(i,i.return,rt)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===i)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break e;for(;d.sibling===null;){if(d.return===null||d.return===i)break e;et===d&&(et=null),d=d.return}et===d&&(et=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ck(e,i),ek(i),s&4&&ak(i);break;case 21:break;default:ck(e,i),ek(i)}}function ek(i){var e=i.flags;if(e&2){try{e:{for(var o=i.return;o!==null;){if(Tj(o)){var s=o;break e}o=o.return}throw Error(p(160))}switch(s.tag){case 5:var c=s.stateNode;s.flags&32&&(ob(c,""),s.flags&=-33);var h=Uj(i);Wj(i,h,c);break;case 3:case 4:var _=s.stateNode.containerInfo,$=Uj(i);Vj(i,$,_);break;default:throw Error(p(161))}}catch(nt){W(i,i.return,nt)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function hk(i,e,o){V=i,ik(i)}function ik(i,e,o){for(var s=(i.mode&1)!==0;V!==null;){var c=V,h=c.child;if(c.tag===22&&s){var _=c.memoizedState!==null||Jj;if(!_){var $=c.alternate,nt=$!==null&&$.memoizedState!==null||U;$=Jj;var tt=U;if(Jj=_,(U=nt)&&!tt)for(V=c;V!==null;)_=V,nt=_.child,_.tag===22&&_.memoizedState!==null?jk(c):nt!==null?(nt.return=_,V=nt):jk(c);for(;h!==null;)V=h,ik(h),h=h.sibling;V=c,Jj=$,U=tt}kk(i)}else c.subtreeFlags&8772&&h!==null?(h.return=c,V=h):kk(i)}}function kk(i){for(;V!==null;){var e=V;if(e.flags&8772){var o=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!U)if(o===null)s.componentDidMount();else{var c=e.elementType===e.type?o.memoizedProps:Ci(e.type,o.memoizedProps);s.componentDidUpdate(c,o.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var h=e.updateQueue;h!==null&&sh(e,h,s);break;case 3:var _=e.updateQueue;if(_!==null){if(o=null,e.child!==null)switch(e.child.tag){case 5:o=e.child.stateNode;break;case 1:o=e.child.stateNode}sh(e,_,o)}break;case 5:var $=e.stateNode;if(o===null&&e.flags&4){o=$;var nt=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":nt.autoFocus&&o.focus();break;case"img":nt.src&&(o.src=nt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var tt=e.alternate;if(tt!==null){var et=tt.memoizedState;if(et!==null){var d=et.dehydrated;d!==null&&bd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||e.flags&512&&Rj(e)}catch(a){W(e,e.return,a)}}if(e===i){V=null;break}if(o=e.sibling,o!==null){o.return=e.return,V=o;break}V=e.return}}function gk(i){for(;V!==null;){var e=V;if(e===i){V=null;break}var o=e.sibling;if(o!==null){o.return=e.return,V=o;break}V=e.return}}function jk(i){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var o=e.return;try{Qj(4,e)}catch(nt){W(e,o,nt)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var c=e.return;try{s.componentDidMount()}catch(nt){W(e,c,nt)}}var h=e.return;try{Rj(e)}catch(nt){W(e,h,nt)}break;case 5:var _=e.return;try{Rj(e)}catch(nt){W(e,_,nt)}}}catch(nt){W(e,e.return,nt)}if(e===i){V=null;break}var $=e.sibling;if($!==null){$.return=e.return,V=$;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(i){return i.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(i=C$1,i!==0||(i=window.event,i=i===void 0?16:jd(i.type)),i):1}function gi(i,e,o,s){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(i,o,s),(!(K&2)||i!==Q)&&(i===Q&&(!(K&2)&&(qk|=o),T===4&&Ck(i,Z)),Dk(i,s),o===1&&K===0&&!(e.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(i,e){var o=i.callbackNode;wc(i,e);var s=uc(i,i===Q?Z:0);if(s===0)o!==null&&bc(o),i.callbackNode=null,i.callbackPriority=0;else if(e=s&-s,i.callbackPriority!==e){if(o!=null&&bc(o),e===1)i.tag===0?ig(Ek.bind(null,i)):hg(Ek.bind(null,i)),Jf(function(){!(K&6)&&jg()}),o=null;else{switch(Dc(s)){case 1:o=fc;break;case 4:o=gc;break;case 16:o=hc;break;case 536870912:o=jc;break;default:o=hc}o=Fk(o,Gk.bind(null,i))}i.callbackPriority=e,i.callbackNode=o}}function Gk(i,e){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var o=i.callbackNode;if(Hk()&&i.callbackNode!==o)return null;var s=uc(i,i===Q?Z:0);if(s===0)return null;if(s&30||s&i.expiredLanes||e)e=Ik(i,s);else{e=s;var c=K;K|=2;var h=Jk();(Q!==i||Z!==e)&&(uk=null,Gj=B()+500,Kk(i,e));do try{Lk();break}catch($){Mk(i,$)}while(!0);$g(),mk.current=h,K=c,Y!==null?e=0:(Q=null,Z=0,e=T)}if(e!==0){if(e===2&&(c=xc(i),c!==0&&(s=c,e=Nk(i,c))),e===1)throw o=pk,Kk(i,0),Ck(i,s),Dk(i,B()),o;if(e===6)Ck(i,s);else{if(c=i.current.alternate,!(s&30)&&!Ok(c)&&(e=Ik(i,s),e===2&&(h=xc(i),h!==0&&(s=h,e=Nk(i,h))),e===1))throw o=pk,Kk(i,0),Ck(i,s),Dk(i,B()),o;switch(i.finishedWork=c,i.finishedLanes=s,e){case 0:case 1:throw Error(p(345));case 2:Pk(i,tk,uk);break;case 3:if(Ck(i,s),(s&130023424)===s&&(e=fk+500-B(),10<e)){if(uc(i,0)!==0)break;if(c=i.suspendedLanes,(c&s)!==s){R(),i.pingedLanes|=i.suspendedLanes&c;break}i.timeoutHandle=Ff(Pk.bind(null,i,tk,uk),e);break}Pk(i,tk,uk);break;case 4:if(Ck(i,s),(s&4194240)===s)break;for(e=i.eventTimes,c=-1;0<s;){var _=31-oc(s);h=1<<_,_=e[_],_>c&&(c=_),s&=~h}if(s=c,s=B()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*lk(s/1960))-s,10<s){i.timeoutHandle=Ff(Pk.bind(null,i,tk,uk),s);break}Pk(i,tk,uk);break;case 5:Pk(i,tk,uk);break;default:throw Error(p(329))}}}return Dk(i,B()),i.callbackNode===o?Gk.bind(null,i):null}function Nk(i,e){var o=sk;return i.current.memoizedState.isDehydrated&&(Kk(i,e).flags|=256),i=Ik(i,e),i!==2&&(e=tk,tk=o,e!==null&&Fj(e)),i}function Fj(i){tk===null?tk=i:tk.push.apply(tk,i)}function Ok(i){for(var e=i;;){if(e.flags&16384){var o=e.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var s=0;s<o.length;s++){var c=o[s],h=c.getSnapshot;c=c.value;try{if(!He(h(),c))return!1}catch{return!1}}}if(o=e.child,e.subtreeFlags&16384&&o!==null)o.return=e,e=o;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(i,e){for(e&=~rk,e&=~qk,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var o=31-oc(e),s=1<<o;i[o]=-1,e&=~s}}function Ek(i){if(K&6)throw Error(p(327));Hk();var e=uc(i,0);if(!(e&1))return Dk(i,B()),null;var o=Ik(i,e);if(i.tag!==0&&o===2){var s=xc(i);s!==0&&(e=s,o=Nk(i,s))}if(o===1)throw o=pk,Kk(i,0),Ck(i,e),Dk(i,B()),o;if(o===6)throw Error(p(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Pk(i,tk,uk),Dk(i,B()),null}function Qk(i,e){var o=K;K|=1;try{return i(e)}finally{K=o,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(i){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var o=ok.transition,s=C$1;try{if(ok.transition=null,C$1=1,i)return i()}finally{C$1=s,ok.transition=o,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(i,e){i.finishedWork=null,i.finishedLanes=0;var o=i.timeoutHandle;if(o!==-1&&(i.timeoutHandle=-1,Gf(o)),Y!==null)for(o=Y.return;o!==null;){var s=o;switch(wg(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(s);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(s.type._context);break;case 22:case 23:Hj()}o=o.return}if(Q=i,Y=i=Pg(i.current,null),Z=fj=e,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(o=fh[e],s=o.interleaved,s!==null){o.interleaved=null;var c=s.next,h=o.pending;if(h!==null){var _=h.next;h.next=c,s.next=_}o.pending=s}fh=null}return i}function Mk(i,e){do{var o=Y;try{if($g(),Fh.current=Rh,Ih){for(var s=M.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,o===null||o.return===null){T=1,pk=e,Y=null;break}e:{var h=i,_=o.return,$=o,nt=e;if(e=Z,$.flags|=32768,nt!==null&&typeof nt=="object"&&typeof nt.then=="function"){var tt=nt,et=$,d=et.tag;if(!(et.mode&1)&&(d===0||d===11||d===15)){var a=et.alternate;a?(et.updateQueue=a.updateQueue,et.memoizedState=a.memoizedState,et.lanes=a.lanes):(et.updateQueue=null,et.memoizedState=null)}var g=Ui(_);if(g!==null){g.flags&=-257,Vi(g,_,$,h,e),g.mode&1&&Si(h,tt,e),e=g,nt=tt;var j=e.updateQueue;if(j===null){var rt=new Set;rt.add(nt),e.updateQueue=rt}else j.add(nt);break e}else{if(!(e&1)){Si(h,tt,e),tj();break e}nt=Error(p(426))}}else if(I&&$.mode&1){var ot=Ui(_);if(ot!==null){!(ot.flags&65536)&&(ot.flags|=256),Vi(ot,_,$,h,e),Jg(Ji(nt,$));break e}}h=nt=Ji(nt,$),T!==4&&(T=2),sk===null?sk=[h]:sk.push(h),h=_;do{switch(h.tag){case 3:h.flags|=65536,e&=-e,h.lanes|=e;var it=Ni(h,nt,e);ph(h,it);break e;case 1:$=nt;var at=h.type,lt=h.stateNode;if(!(h.flags&128)&&(typeof at.getDerivedStateFromError=="function"||lt!==null&&typeof lt.componentDidCatch=="function"&&(Ri===null||!Ri.has(lt)))){h.flags|=65536,e&=-e,h.lanes|=e;var ct=Qi(h,$,e);ph(h,ct);break e}}h=h.return}while(h!==null)}Sk(o)}catch(dt){e=dt,Y===o&&o!==null&&(Y=o=o.return);continue}break}while(!0)}function Jk(){var i=mk.current;return mk.current=Rh,i===null?Rh:i}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(i,e){var o=K;K|=2;var s=Jk();(Q!==i||Z!==e)&&(uk=null,Kk(i,e));do try{Tk();break}catch(c){Mk(i,c)}while(!0);if($g(),K=o,mk.current=s,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(i){var e=Vk(i.alternate,i,fj);i.memoizedProps=i.pendingProps,e===null?Sk(i):Y=e,nk.current=null}function Sk(i){var e=i;do{var o=e.alternate;if(i=e.return,e.flags&32768){if(o=Ij(o,e),o!==null){o.flags&=32767,Y=o;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{T=6,Y=null;return}}else if(o=Ej(o,e,fj),o!==null){Y=o;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=i}while(e!==null);T===0&&(T=5)}function Pk(i,e,o){var s=C$1,c=ok.transition;try{ok.transition=null,C$1=1,Wk(i,e,o,s)}finally{ok.transition=c,C$1=s}return null}function Wk(i,e,o,s){do Hk();while(wk!==null);if(K&6)throw Error(p(327));o=i.finishedWork;var c=i.finishedLanes;if(o===null)return null;if(i.finishedWork=null,i.finishedLanes=0,o===i.current)throw Error(p(177));i.callbackNode=null,i.callbackPriority=0;var h=o.lanes|o.childLanes;if(Bc(i,h),i===Q&&(Y=Q=null,Z=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),h=(o.flags&15990)!==0,o.subtreeFlags&15990||h){h=ok.transition,ok.transition=null;var _=C$1;C$1=1;var $=K;K|=4,nk.current=null,Oj(i,o),dk(o,i),Oe(Df),dd=!!Cf,Df=Cf=null,i.current=o,hk(o),dc(),K=$,C$1=_,ok.transition=h}else i.current=o;if(vk&&(vk=!1,wk=i,xk=c),h=i.pendingLanes,h===0&&(Ri=null),mc(o.stateNode),Dk(i,B()),e!==null)for(s=i.onRecoverableError,o=0;o<e.length;o++)c=e[o],s(c.value,{componentStack:c.stack,digest:c.digest});if(Oi)throw Oi=!1,i=Pi,Pi=null,i;return xk&1&&i.tag!==0&&Hk(),h=i.pendingLanes,h&1?i===zk?yk++:(yk=0,zk=i):yk=0,jg(),null}function Hk(){if(wk!==null){var i=Dc(xk),e=ok.transition,o=C$1;try{if(ok.transition=null,C$1=16>i?16:i,wk===null)var s=!1;else{if(i=wk,wk=null,xk=0,K&6)throw Error(p(331));var c=K;for(K|=4,V=i.current;V!==null;){var h=V,_=h.child;if(V.flags&16){var $=h.deletions;if($!==null){for(var nt=0;nt<$.length;nt++){var tt=$[nt];for(V=tt;V!==null;){var et=V;switch(et.tag){case 0:case 11:case 15:Pj(8,et,h)}var d=et.child;if(d!==null)d.return=et,V=d;else for(;V!==null;){et=V;var a=et.sibling,g=et.return;if(Sj(et),et===tt){V=null;break}if(a!==null){a.return=g,V=a;break}V=g}}}var j=h.alternate;if(j!==null){var rt=j.child;if(rt!==null){j.child=null;do{var ot=rt.sibling;rt.sibling=null,rt=ot}while(rt!==null)}}V=h}}if(h.subtreeFlags&2064&&_!==null)_.return=h,V=_;else e:for(;V!==null;){if(h=V,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Pj(9,h,h.return)}var it=h.sibling;if(it!==null){it.return=h.return,V=it;break e}V=h.return}}var at=i.current;for(V=at;V!==null;){_=V;var lt=_.child;if(_.subtreeFlags&2064&&lt!==null)lt.return=_,V=lt;else e:for(_=at;V!==null;){if($=V,$.flags&2048)try{switch($.tag){case 0:case 11:case 15:Qj(9,$)}}catch(dt){W($,$.return,dt)}if($===_){V=null;break e}var ct=$.sibling;if(ct!==null){ct.return=$.return,V=ct;break e}V=$.return}}if(K=c,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,i)}catch{}s=!0}return s}finally{C$1=o,ok.transition=e}}return!1}function Xk(i,e,o){e=Ji(o,e),e=Ni(i,e,1),i=nh(i,e,1),e=R(),i!==null&&(Ac(i,1,e),Dk(i,e))}function W(i,e,o){if(i.tag===3)Xk(i,i,o);else for(;e!==null;){if(e.tag===3){Xk(e,i,o);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ri===null||!Ri.has(s))){i=Ji(o,i),i=Qi(e,i,1),e=nh(e,i,1),i=R(),e!==null&&(Ac(e,1,i),Dk(e,i));break}}e=e.return}}function Ti(i,e,o){var s=i.pingCache;s!==null&&s.delete(e),e=R(),i.pingedLanes|=i.suspendedLanes&o,Q===i&&(Z&o)===o&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(i,0):rk|=o),Dk(i,e)}function Yk(i,e){e===0&&(i.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var o=R();i=ih(i,e),i!==null&&(Ac(i,e,o),Dk(i,o))}function uj(i){var e=i.memoizedState,o=0;e!==null&&(o=e.retryLane),Yk(i,o)}function bk(i,e){var o=0;switch(i.tag){case 13:var s=i.stateNode,c=i.memoizedState;c!==null&&(o=c.retryLane);break;case 19:s=i.stateNode;break;default:throw Error(p(314))}s!==null&&s.delete(e),Yk(i,o)}var Vk;Vk=function(i,e,o){if(i!==null)if(i.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(i.lanes&o)&&!(e.flags&128))return dh=!1,yj(i,e,o);dh=!!(i.flags&131072)}else dh=!1,I&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;ij(i,e),i=e.pendingProps;var c=Yf(e,H.current);ch(e,o),c=Nh(null,e,s,i,c,o);var h=Sh();return e.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(s)?(h=!0,cg(e)):h=!1,e.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,kh(e),c.updater=Ei,e.stateNode=c,c._reactInternals=e,Ii(e,s,i,o),e=jj(null,e,s,!0,h,o)):(e.tag=0,I&&h&&vg(e),Xi(null,e,c,o),e=e.child),e;case 16:s=e.elementType;e:{switch(ij(i,e),i=e.pendingProps,c=s._init,s=c(s._payload),e.type=s,c=e.tag=Zk(s),i=Ci(s,i),c){case 0:e=cj(null,e,s,i,o);break e;case 1:e=hj(null,e,s,i,o);break e;case 11:e=Yi(null,e,s,i,o);break e;case 14:e=$i(null,e,s,Ci(s.type,i),o);break e}throw Error(p(306,s,""))}return e;case 0:return s=e.type,c=e.pendingProps,c=e.elementType===s?c:Ci(s,c),cj(i,e,s,c,o);case 1:return s=e.type,c=e.pendingProps,c=e.elementType===s?c:Ci(s,c),hj(i,e,s,c,o);case 3:e:{if(kj(e),i===null)throw Error(p(387));s=e.pendingProps,h=e.memoizedState,c=h.element,lh(i,e),qh(e,s,null,o);var _=e.memoizedState;if(s=_.element,h.isDehydrated)if(h={element:s,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},e.updateQueue.baseState=h,e.memoizedState=h,e.flags&256){c=Ji(Error(p(423)),e),e=lj(i,e,s,o,c);break e}else if(s!==c){c=Ji(Error(p(424)),e),e=lj(i,e,s,o,c);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I=!0,zg=null,o=Vg(e,null,s,o),e.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ig(),s===c){e=Zi(i,e,o);break e}Xi(i,e,s,o)}e=e.child}return e;case 5:return Ah(e),i===null&&Eg(e),s=e.type,c=e.pendingProps,h=i!==null?i.memoizedProps:null,_=c.children,Ef(s,c)?_=null:h!==null&&Ef(s,h)&&(e.flags|=32),gj(i,e),Xi(i,e,_,o),e.child;case 6:return i===null&&Eg(e),null;case 13:return oj(i,e,o);case 4:return yh(e,e.stateNode.containerInfo),s=e.pendingProps,i===null?e.child=Ug(e,null,s,o):Xi(i,e,s,o),e.child;case 11:return s=e.type,c=e.pendingProps,c=e.elementType===s?c:Ci(s,c),Yi(i,e,s,c,o);case 7:return Xi(i,e,e.pendingProps,o),e.child;case 8:return Xi(i,e,e.pendingProps.children,o),e.child;case 12:return Xi(i,e,e.pendingProps.children,o),e.child;case 10:e:{if(s=e.type._context,c=e.pendingProps,h=e.memoizedProps,_=c.value,G(Wg,s._currentValue),s._currentValue=_,h!==null)if(He(h.value,_)){if(h.children===c.children&&!Wf.current){e=Zi(i,e,o);break e}}else for(h=e.child,h!==null&&(h.return=e);h!==null;){var $=h.dependencies;if($!==null){_=h.child;for(var nt=$.firstContext;nt!==null;){if(nt.context===s){if(h.tag===1){nt=mh(-1,o&-o),nt.tag=2;var tt=h.updateQueue;if(tt!==null){tt=tt.shared;var et=tt.pending;et===null?nt.next=nt:(nt.next=et.next,et.next=nt),tt.pending=nt}}h.lanes|=o,nt=h.alternate,nt!==null&&(nt.lanes|=o),bh(h.return,o,e),$.lanes|=o;break}nt=nt.next}}else if(h.tag===10)_=h.type===e.type?null:h.child;else if(h.tag===18){if(_=h.return,_===null)throw Error(p(341));_.lanes|=o,$=_.alternate,$!==null&&($.lanes|=o),bh(_,o,e),_=h.sibling}else _=h.child;if(_!==null)_.return=h;else for(_=h;_!==null;){if(_===e){_=null;break}if(h=_.sibling,h!==null){h.return=_.return,_=h;break}_=_.return}h=_}Xi(i,e,c.children,o),e=e.child}return e;case 9:return c=e.type,s=e.pendingProps.children,ch(e,o),c=eh(c),s=s(c),e.flags|=1,Xi(i,e,s,o),e.child;case 14:return s=e.type,c=Ci(s,e.pendingProps),c=Ci(s.type,c),$i(i,e,s,c,o);case 15:return bj(i,e,e.type,e.pendingProps,o);case 17:return s=e.type,c=e.pendingProps,c=e.elementType===s?c:Ci(s,c),ij(i,e),e.tag=1,Zf(s)?(i=!0,cg(e)):i=!1,ch(e,o),Gi(e,s,c),Ii(e,s,c,o),jj(null,e,s,!0,i,o);case 19:return xj(i,e,o);case 22:return dj(i,e,o)}throw Error(p(156,e.tag))};function Fk(i,e){return ac(i,e)}function $k(i,e,o,s){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(i,e,o,s){return new $k(i,e,o,s)}function aj(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Zk(i){if(typeof i=="function")return aj(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Da)return 11;if(i===Ga)return 14}return 2}function Pg(i,e){var o=i.alternate;return o===null?(o=Bg(i.tag,e,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=e,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&14680064,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o}function Rg(i,e,o,s,c,h){var _=2;if(s=i,typeof i=="function")aj(i)&&(_=1);else if(typeof i=="string")_=5;else e:switch(i){case ya:return Tg(o.children,c,h,e);case za:_=8,c|=8;break;case Aa:return i=Bg(12,o,e,c|2),i.elementType=Aa,i.lanes=h,i;case Ea:return i=Bg(13,o,e,c),i.elementType=Ea,i.lanes=h,i;case Fa:return i=Bg(19,o,e,c),i.elementType=Fa,i.lanes=h,i;case Ia:return pj(o,c,h,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ba:_=10;break e;case Ca:_=9;break e;case Da:_=11;break e;case Ga:_=14;break e;case Ha:_=16,s=null;break e}throw Error(p(130,i==null?i:typeof i,""))}return e=Bg(_,o,e,c),e.elementType=i,e.type=s,e.lanes=h,e}function Tg(i,e,o,s){return i=Bg(7,i,s,e),i.lanes=o,i}function pj(i,e,o,s){return i=Bg(22,i,s,e),i.elementType=Ia,i.lanes=o,i.stateNode={isHidden:!1},i}function Qg(i,e,o){return i=Bg(6,i,null,e),i.lanes=o,i}function Sg(i,e,o){return e=Bg(4,i.children!==null?i.children:[],i.key,e),e.lanes=o,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function al(i,e,o,s,c){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=s,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function bl(i,e,o,s,c,h,_,$,nt){return i=new al(i,e,o,$,nt),e===1?(e=1,h===!0&&(e|=8)):e=0,h=Bg(3,null,null,e),i.current=h,h.stateNode=i,h.memoizedState={element:s,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(h),i}function cl(i,e,o){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:s==null?null:""+s,children:i,containerInfo:e,implementation:o}}function dl(i){if(!i)return Vf;i=i._reactInternals;e:{if(Vb(i)!==i||i.tag!==1)throw Error(p(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p(171))}if(i.tag===1){var o=i.type;if(Zf(o))return bg(i,o,e)}return e}function el(i,e,o,s,c,h,_,$,nt){return i=bl(o,s,!0,i,c,h,_,$,nt),i.context=dl(null),o=i.current,s=R(),c=yi(o),h=mh(s,c),h.callback=e??null,nh(o,h,c),i.current.lanes=c,Ac(i,c,s),Dk(i,s),i}function fl(i,e,o,s){var c=e.current,h=R(),_=yi(c);return o=dl(o),e.context===null?e.context=o:e.pendingContext=o,e=mh(h,_),e.payload={element:i},s=s===void 0?null:s,s!==null&&(e.callback=s),i=nh(c,e,_),i!==null&&(gi(i,c,_,h),oh(i,c,_)),_}function gl(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function hl(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<e?o:e}}function il(i,e){hl(i,e),(i=i.alternate)&&hl(i,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(i){console.error(i)};function ll(i){this._internalRoot=i}ml.prototype.render=ll.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(p(409));fl(i,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Rk(function(){fl(null,i,null,null)}),e[uf]=null}};function ml(i){this._internalRoot=i}ml.prototype.unstable_scheduleHydration=function(i){if(i){var e=Hc();i={blockedOn:null,target:i,priority:e};for(var o=0;o<Qc.length&&e!==0&&e<Qc[o].priority;o++);Qc.splice(o,0,i),o===0&&Vc(i)}};function nl(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function ol(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(i,e,o,s,c){if(c){if(typeof s=="function"){var h=s;s=function(){var tt=gl(_);h.call(tt)}}var _=el(e,s,i,0,null,!1,!1,"",pl);return i._reactRootContainer=_,i[uf]=_.current,sf(i.nodeType===8?i.parentNode:i),Rk(),_}for(;c=i.lastChild;)i.removeChild(c);if(typeof s=="function"){var $=s;s=function(){var tt=gl(nt);$.call(tt)}}var nt=bl(i,0,!1,null,null,!1,!1,"",pl);return i._reactRootContainer=nt,i[uf]=nt.current,sf(i.nodeType===8?i.parentNode:i),Rk(function(){fl(e,nt,o,s)}),nt}function rl(i,e,o,s,c){var h=o._reactRootContainer;if(h){var _=h;if(typeof c=="function"){var $=c;c=function(){var nt=gl(_);$.call(nt)}}fl(e,_,i,c)}else _=ql(o,e,i,c,s);return gl(_)}Ec=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var o=tc(e.pendingLanes);o!==0&&(Cc(e,o|1),Dk(e,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var s=ih(i,1);if(s!==null){var c=R();gi(s,i,1,c)}}),il(i,1)}};Fc=function(i){if(i.tag===13){var e=ih(i,134217728);if(e!==null){var o=R();gi(e,i,134217728,o)}il(i,134217728)}};Gc=function(i){if(i.tag===13){var e=yi(i),o=ih(i,e);if(o!==null){var s=R();gi(o,i,e,s)}il(i,e)}};Hc=function(){return C$1};Ic=function(i,e){var o=C$1;try{return C$1=i,e()}finally{C$1=o}};yb=function(i,e,o){switch(e){case"input":if(bb(i,o),e=o.name,o.type==="radio"&&e!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<o.length;e++){var s=o[e];if(s!==i&&s.form===i.form){var c=Db(s);if(!c)throw Error(p(90));Wa(s),bb(s,c)}}}break;case"textarea":ib(i,o);break;case"select":e=o.value,e!=null&&fb(i,!!o.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Zb(i),i===null?null:i.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(i,e){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p(200));return cl(i,e,null,o)};reactDom_production_min.createRoot=function(i,e){if(!nl(i))throw Error(p(299));var o=!1,s="",c=kl;return e!=null&&(e.unstable_strictMode===!0&&(o=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(c=e.onRecoverableError)),e=bl(i,1,!1,null,null,o,!1,s,c),i[uf]=e.current,sf(i.nodeType===8?i.parentNode:i),new ll(e)};reactDom_production_min.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(p(188)):(i=Object.keys(i).join(","),Error(p(268,i)));return i=Zb(e),i=i===null?null:i.stateNode,i};reactDom_production_min.flushSync=function(i){return Rk(i)};reactDom_production_min.hydrate=function(i,e,o){if(!ol(e))throw Error(p(200));return rl(null,i,e,!0,o)};reactDom_production_min.hydrateRoot=function(i,e,o){if(!nl(i))throw Error(p(405));var s=o!=null&&o.hydratedSources||null,c=!1,h="",_=kl;if(o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),e=el(e,null,i,1,o??null,c,!1,h,_),i[uf]=e.current,sf(i),s)for(i=0;i<s.length;i++)o=s[i],c=o._getVersion,c=c(o._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[o,c]:e.mutableSourceEagerHydrationData.push(o,c);return new ml(e)};reactDom_production_min.render=function(i,e,o){if(!ol(e))throw Error(p(200));return rl(null,i,e,!1,o)};reactDom_production_min.unmountComponentAtNode=function(i){if(!ol(i))throw Error(p(40));return i._reactRootContainer?(Rk(function(){rl(null,null,i,!1,function(){i._reactRootContainer=null,i[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(i,e,o,s){if(!ol(o))throw Error(p(200));if(i==null||i._reactInternals===void 0)throw Error(p(38));return rl(i,e,o,!1,s)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(i){console.error(i)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,createRoot,m=reactDomExports;createRoot=m.createRoot,m.hydrateRoot;var define_process_env_default$1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(i){const e=[];let o=0;for(let s=0;s<i.length;s++){let c=i.charCodeAt(s);c<128?e[o++]=c:c<2048?(e[o++]=c>>6|192,e[o++]=c&63|128):(c&64512)===55296&&s+1<i.length&&(i.charCodeAt(s+1)&64512)===56320?(c=65536+((c&1023)<<10)+(i.charCodeAt(++s)&1023),e[o++]=c>>18|240,e[o++]=c>>12&63|128,e[o++]=c>>6&63|128,e[o++]=c&63|128):(e[o++]=c>>12|224,e[o++]=c>>6&63|128,e[o++]=c&63|128)}return e},byteArrayToString=function(i){const e=[];let o=0,s=0;for(;o<i.length;){const c=i[o++];if(c<128)e[s++]=String.fromCharCode(c);else if(c>191&&c<224){const h=i[o++];e[s++]=String.fromCharCode((c&31)<<6|h&63)}else if(c>239&&c<365){const h=i[o++],_=i[o++],$=i[o++],nt=((c&7)<<18|(h&63)<<12|(_&63)<<6|$&63)-65536;e[s++]=String.fromCharCode(55296+(nt>>10)),e[s++]=String.fromCharCode(56320+(nt&1023))}else{const h=i[o++],_=i[o++];e[s++]=String.fromCharCode((c&15)<<12|(h&63)<<6|_&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const o=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let c=0;c<i.length;c+=3){const h=i[c],_=c+1<i.length,$=_?i[c+1]:0,nt=c+2<i.length,tt=nt?i[c+2]:0,et=h>>2,d=(h&3)<<4|$>>4;let a=($&15)<<2|tt>>6,g=tt&63;nt||(g=64,_||(a=64)),s.push(o[et],o[d],o[a],o[g])}return s.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(stringToByteArray$1(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):byteArrayToString(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const o=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let c=0;c<i.length;){const h=o[i.charAt(c++)],$=c<i.length?o[i.charAt(c)]:0;++c;const tt=c<i.length?o[i.charAt(c)]:64;++c;const d=c<i.length?o[i.charAt(c)]:64;if(++c,h==null||$==null||tt==null||d==null)throw new DecodeBase64StringError;const a=h<<2|$>>4;if(s.push(a),tt!==64){const g=$<<4&240|tt>>2;if(s.push(g),d!==64){const j=tt<<6&192|d;s.push(j)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(i){const e=stringToByteArray$1(i);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(i){return base64Encode(i).replace(/\./g,"")},base64Decode=function(i){try{return base64.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default$1>"u")return;const i=define_process_env_default$1.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&base64Decode(i[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},getDefaultEmulatorHost=i=>{var e,o;return(o=(e=getDefaults())===null||e===void 0?void 0:e.emulatorHosts)===null||o===void 0?void 0:o[i]},getDefaultEmulatorHostnameAndPort=i=>{const e=getDefaultEmulatorHost(i);if(!e)return;const o=e.lastIndexOf(":");if(o<=0||o+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(o+1),10);return e[0]==="["?[e.substring(1,o-1),s]:[e.substring(0,o),s]},getDefaultAppConfig=()=>{var i;return(i=getDefaults())===null||i===void 0?void 0:i.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,o)=>{this.resolve=e,this.reject=o})}wrapCallback(e){return(o,s)=>{o?this.reject(o):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(o):e(o,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const o={alg:"none",type:"JWT"},s=e||"demo-project",c=i.iat||0,h=i.sub||i.user_id;if(!h)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const _=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:c,exp:c+3600,auth_time:c,sub:h,user_id:h,firebase:{sign_in_provider:"custom",identities:{}}},i);return[base64urlEncodeWithoutPadding(JSON.stringify(o)),base64urlEncodeWithoutPadding(JSON.stringify(_)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isNode(){var i;const e=(i=getDefaults())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isSafari(){return!isNode()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((i,e)=>{try{let o=!0;const s="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(s);c.onsuccess=()=>{c.result.close(),o||self.indexedDB.deleteDatabase(s),i(!0)},c.onupgradeneeded=()=>{o=!1},c.onerror=()=>{var h;e(((h=c.error)===null||h===void 0?void 0:h.message)||"")}}catch(o){e(o)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,o,s){super(o),this.code=e,this.customData=s,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,o,s){this.service=e,this.serviceName=o,this.errors=s}create(e,...o){const s=o[0]||{},c=`${this.service}/${e}`,h=this.errors[e],_=h?replaceTemplate(h,s):"Error",$=`${this.serviceName}: ${_} (${c}).`;return new FirebaseError(c,$,s)}}function replaceTemplate(i,e){return i.replace(PATTERN,(o,s)=>{const c=e[s];return c!=null?String(c):`<${s}?>`})}const PATTERN=/\{\$([^}]+)}/g;function deepEqual(i,e){if(i===e)return!0;const o=Object.keys(i),s=Object.keys(e);for(const c of o){if(!s.includes(c))return!1;const h=i[c],_=e[c];if(isObject(h)&&isObject(_)){if(!deepEqual(h,_))return!1}else if(h!==_)return!1}for(const c of s)if(!o.includes(c))return!1;return!0}function isObject(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(i){return i&&i._delegate?i._delegate:i}class Component{constructor(e,o,s){this.name=e,this.instanceFactory=o,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(e,o){this.name=e,this.container=o,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const o=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(o)){const s=new Deferred;if(this.instancesDeferred.set(o,s),this.isInitialized(o)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:o});c&&s.resolve(c)}catch{}}return this.instancesDeferred.get(o).promise}getImmediate(e){var o;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),c=(o=e==null?void 0:e.optional)!==null&&o!==void 0?o:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(h){if(c)return null;throw h}else{if(c)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[o,s]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);try{const h=this.getOrInitializeService({instanceIdentifier:c});s.resolve(h)}catch{}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(o=>"INTERNAL"in o).map(o=>o.INTERNAL.delete()),...e.filter(o=>"_delete"in o).map(o=>o._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:o={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:s,options:o});for(const[h,_]of this.instancesDeferred.entries()){const $=this.normalizeInstanceIdentifier(h);s===$&&_.resolve(c)}return c}onInit(e,o){var s;const c=this.normalizeInstanceIdentifier(o),h=(s=this.onInitCallbacks.get(c))!==null&&s!==void 0?s:new Set;h.add(e),this.onInitCallbacks.set(c,h);const _=this.instances.get(c);return _&&e(_,c),()=>{h.delete(e)}}invokeOnInitCallbacks(e,o){const s=this.onInitCallbacks.get(o);if(s)for(const c of s)try{c(e,o)}catch{}}getOrInitializeService({instanceIdentifier:e,options:o={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:o}),this.instances.set(e,s),this.instancesOptions.set(e,o),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(i){return i===DEFAULT_ENTRY_NAME$1?void 0:i}function isComponentEager(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const o=this.getProvider(e.name);if(o.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);o.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const o=new Provider(e,this);return this.providers.set(e,o),o}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(i,e,...o)=>{if(e<i.logLevel)return;const s=new Date().toISOString(),c=ConsoleMethod[e];if(c)console[c](`[${s}]  ${i.name}:`,...o);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}const instanceOfAny=(i,e)=>e.some(o=>i instanceof o);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(i){const e=new Promise((o,s)=>{const c=()=>{i.removeEventListener("success",h),i.removeEventListener("error",_)},h=()=>{o(wrap(i.result)),c()},_=()=>{s(i.error),c()};i.addEventListener("success",h),i.addEventListener("error",_)});return e.then(o=>{o instanceof IDBCursor&&cursorRequestMap.set(o,i)}).catch(()=>{}),reverseTransformCache.set(e,i),e}function cacheDonePromiseForTransaction(i){if(transactionDoneMap.has(i))return;const e=new Promise((o,s)=>{const c=()=>{i.removeEventListener("complete",h),i.removeEventListener("error",_),i.removeEventListener("abort",_)},h=()=>{o(),c()},_=()=>{s(i.error||new DOMException("AbortError","AbortError")),c()};i.addEventListener("complete",h),i.addEventListener("error",_),i.addEventListener("abort",_)});transactionDoneMap.set(i,e)}let idbProxyTraps={get(i,e,o){if(i instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(i);if(e==="objectStoreNames")return i.objectStoreNames||transactionStoreNamesMap.get(i);if(e==="store")return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return wrap(i[e])},set(i,e,o){return i[e]=o,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function replaceTraps(i){idbProxyTraps=i(idbProxyTraps)}function wrapFunction(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...o){const s=i.call(unwrap(this),e,...o);return transactionStoreNamesMap.set(s,e.sort?e.sort():[e]),wrap(s)}:getCursorAdvanceMethods().includes(i)?function(...e){return i.apply(unwrap(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(i.apply(unwrap(this),e))}}function transformCachableValue(i){return typeof i=="function"?wrapFunction(i):(i instanceof IDBTransaction&&cacheDonePromiseForTransaction(i),instanceOfAny(i,getIdbProxyableTypes())?new Proxy(i,idbProxyTraps):i)}function wrap(i){if(i instanceof IDBRequest)return promisifyRequest(i);if(transformCache.has(i))return transformCache.get(i);const e=transformCachableValue(i);return e!==i&&(transformCache.set(i,e),reverseTransformCache.set(e,i)),e}const unwrap=i=>reverseTransformCache.get(i);function openDB(i,e,{blocked:o,upgrade:s,blocking:c,terminated:h}={}){const _=indexedDB.open(i,e),$=wrap(_);return s&&_.addEventListener("upgradeneeded",nt=>{s(wrap(_.result),nt.oldVersion,nt.newVersion,wrap(_.transaction),nt)}),o&&_.addEventListener("blocked",nt=>o(nt.oldVersion,nt.newVersion,nt)),$.then(nt=>{h&&nt.addEventListener("close",()=>h()),c&&nt.addEventListener("versionchange",tt=>c(tt.oldVersion,tt.newVersion,tt))}).catch(()=>{}),$}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const o=e.replace(/FromIndex$/,""),s=e!==o,c=writeMethods.includes(o);if(!(o in(s?IDBIndex:IDBObjectStore).prototype)||!(c||readMethods.includes(o)))return;const h=async function(_,...$){const nt=this.transaction(_,c?"readwrite":"readonly");let tt=nt.store;return s&&(tt=tt.index($.shift())),(await Promise.all([tt[o](...$),c&&nt.done]))[0]};return cachedMethods.set(e,h),h}replaceTraps(i=>({...i,get:(e,o,s)=>getMethod(e,o)||i.get(e,o,s),has:(e,o)=>!!getMethod(e,o)||i.has(e,o)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(o=>{if(isVersionServiceProvider(o)){const s=o.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(o=>o).join(" ")}}function isVersionServiceProvider(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$q="@firebase/app",version$1="0.10.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger("@firebase/app"),name$p="@firebase/app-compat",name$o="@firebase/analytics-compat",name$n="@firebase/analytics",name$m="@firebase/app-check-compat",name$l="@firebase/app-check",name$k="@firebase/auth",name$j="@firebase/auth-compat",name$i="@firebase/database",name$h="@firebase/data-connect",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5="@firebase/storage",name$4="@firebase/storage-compat",name$3="@firebase/firestore",name$2="@firebase/vertexai",name$1$1="@firebase/firestore-compat",name$r="firebase",version$2="11.0.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$q]:"fire-core",[name$p]:"fire-core-compat",[name$n]:"fire-analytics",[name$o]:"fire-analytics-compat",[name$l]:"fire-app-check",[name$m]:"fire-app-check-compat",[name$k]:"fire-auth",[name$j]:"fire-auth-compat",[name$i]:"fire-rtdb",[name$h]:"fire-data-connect",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5]:"fire-gcs",[name$4]:"fire-gcs-compat",[name$3]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2]:"fire-vertex","fire-js":"fire-js",[name$r]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(i,e){try{i.container.addComponent(e)}catch(o){logger.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,o)}}function _registerComponent(i){const e=i.name;if(_components.has(e))return logger.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,i);for(const o of _apps.values())_addComponent(o,i);for(const o of _serverApps.values())_addComponent(o,i);return!0}function _getProvider(i,e){const o=i.container.getProvider("heartbeat").getImmediate({optional:!0});return o&&o.triggerHeartbeat(),i.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,o,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},o),this._name=o.name,this._automaticDataCollectionEnabled=o.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$2;function initializeApp(i,e={}){let o=i;typeof e!="object"&&(e={name:e});const s=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},e),c=s.name;if(typeof c!="string"||!c)throw ERROR_FACTORY.create("bad-app-name",{appName:String(c)});if(o||(o=getDefaultAppConfig()),!o)throw ERROR_FACTORY.create("no-options");const h=_apps.get(c);if(h){if(deepEqual(o,h.options)&&deepEqual(s,h.config))return h;throw ERROR_FACTORY.create("duplicate-app",{appName:c})}const _=new ComponentContainer(c);for(const nt of _components.values())_.addComponent(nt);const $=new FirebaseAppImpl(o,s,_);return _apps.set(c,$),$}function getApp(i=DEFAULT_ENTRY_NAME){const e=_apps.get(i);if(!e&&i===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!e)throw ERROR_FACTORY.create("no-app",{appName:i});return e}function registerVersion(i,e,o){var s;let c=(s=PLATFORM_LOG_STRING[i])!==null&&s!==void 0?s:i;o&&(c+=`-${o}`);const h=c.match(/\s|\//),_=e.match(/\s|\//);if(h||_){const $=[`Unable to register library "${c}" with version "${e}":`];h&&$.push(`library name "${c}" contains illegal characters (whitespace or "/")`),h&&_&&$.push("and"),_&&$.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger.warn($.join(" "));return}_registerComponent(new Component(`${c}-version`,()=>({library:c,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebase-heartbeat-database",DB_VERSION=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME,DB_VERSION,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(STORE_NAME)}catch(o){console.warn(o)}}}}).catch(i=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:i.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(i){try{const o=(await getDbPromise()).transaction(STORE_NAME),s=await o.objectStore(STORE_NAME).get(computeKey(i));return await o.done,s}catch(e){if(e instanceof FirebaseError)logger.warn(e.message);else{const o=ERROR_FACTORY.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger.warn(o.message)}}}async function writeHeartbeatsToIndexedDB(i,e){try{const s=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await s.objectStore(STORE_NAME).put(e,computeKey(i)),await s.done}catch(o){if(o instanceof FirebaseError)logger.warn(o.message);else{const s=ERROR_FACTORY.create("idb-set",{originalErrorMessage:o==null?void 0:o.message});logger.warn(s.message)}}}function computeKey(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const o=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(o),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,o;try{const c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),h=getUTCDateString();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((o=this._heartbeatsCache)===null||o===void 0?void 0:o.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===h||this._heartbeatsCache.heartbeats.some(_=>_.date===h)?void 0:(this._heartbeatsCache.heartbeats.push({date:h,agent:c}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(_=>{const $=new Date(_.date).valueOf();return Date.now()-$<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache))}catch(s){logger.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const o=getUTCDateString(),{heartbeatsToSend:s,unsentEntries:c}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),h=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=o,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),h}catch(o){return logger.warn(o),""}}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(i,e=MAX_HEADER_BYTES){const o=[];let s=i.slice();for(const c of i){const h=o.find(_=>_.agent===c.agent);if(h){if(h.dates.push(c.date),countBytes(o)>e){h.dates.pop();break}}else if(o.push({agent:c.agent,dates:[c.date]}),countBytes(o)>e){o.pop();break}s=s.slice(1)}return{heartbeatsToSend:o,unsentEntries:s}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const o=await readHeartbeatsFromIndexedDB(this.app);return o!=null&&o.heartbeats?o:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var o;if(await this._canUseIndexedDBPromise){const c=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(o=e.lastSentHeartbeatDate)!==null&&o!==void 0?o:c.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var o;if(await this._canUseIndexedDBPromise){const c=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(o=e.lastSentHeartbeatDate)!==null&&o!==void 0?o:c.lastSentHeartbeatDate,heartbeats:[...c.heartbeats,...e.heartbeats]})}else return}}function countBytes(i){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:i})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(i){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$q,version$1,i),registerVersion(name$q,version$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var name$1="firebase",version="11.0.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name$1,version,"app");var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Integer,Md5;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(ht,ft){function ut(){}ut.prototype=ft.prototype,ht.D=ft.prototype,ht.prototype=new ut,ht.prototype.constructor=ht,ht.C=function(_t,bt,vt){for(var Tt=Array(arguments.length-2),Mt=2;Mt<arguments.length;Mt++)Tt[Mt-2]=arguments[Mt];return ft.prototype[bt].apply(_t,Tt)}}function o(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,o),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function c(ht,ft,ut){ut||(ut=0);var _t=Array(16);if(typeof ft=="string")for(var bt=0;16>bt;++bt)_t[bt]=ft.charCodeAt(ut++)|ft.charCodeAt(ut++)<<8|ft.charCodeAt(ut++)<<16|ft.charCodeAt(ut++)<<24;else for(bt=0;16>bt;++bt)_t[bt]=ft[ut++]|ft[ut++]<<8|ft[ut++]<<16|ft[ut++]<<24;ft=ht.g[0],ut=ht.g[1],bt=ht.g[2];var vt=ht.g[3],Tt=ft+(vt^ut&(bt^vt))+_t[0]+3614090360&4294967295;ft=ut+(Tt<<7&4294967295|Tt>>>25),Tt=vt+(bt^ft&(ut^bt))+_t[1]+3905402710&4294967295,vt=ft+(Tt<<12&4294967295|Tt>>>20),Tt=bt+(ut^vt&(ft^ut))+_t[2]+606105819&4294967295,bt=vt+(Tt<<17&4294967295|Tt>>>15),Tt=ut+(ft^bt&(vt^ft))+_t[3]+3250441966&4294967295,ut=bt+(Tt<<22&4294967295|Tt>>>10),Tt=ft+(vt^ut&(bt^vt))+_t[4]+4118548399&4294967295,ft=ut+(Tt<<7&4294967295|Tt>>>25),Tt=vt+(bt^ft&(ut^bt))+_t[5]+1200080426&4294967295,vt=ft+(Tt<<12&4294967295|Tt>>>20),Tt=bt+(ut^vt&(ft^ut))+_t[6]+2821735955&4294967295,bt=vt+(Tt<<17&4294967295|Tt>>>15),Tt=ut+(ft^bt&(vt^ft))+_t[7]+4249261313&4294967295,ut=bt+(Tt<<22&4294967295|Tt>>>10),Tt=ft+(vt^ut&(bt^vt))+_t[8]+1770035416&4294967295,ft=ut+(Tt<<7&4294967295|Tt>>>25),Tt=vt+(bt^ft&(ut^bt))+_t[9]+2336552879&4294967295,vt=ft+(Tt<<12&4294967295|Tt>>>20),Tt=bt+(ut^vt&(ft^ut))+_t[10]+4294925233&4294967295,bt=vt+(Tt<<17&4294967295|Tt>>>15),Tt=ut+(ft^bt&(vt^ft))+_t[11]+2304563134&4294967295,ut=bt+(Tt<<22&4294967295|Tt>>>10),Tt=ft+(vt^ut&(bt^vt))+_t[12]+1804603682&4294967295,ft=ut+(Tt<<7&4294967295|Tt>>>25),Tt=vt+(bt^ft&(ut^bt))+_t[13]+4254626195&4294967295,vt=ft+(Tt<<12&4294967295|Tt>>>20),Tt=bt+(ut^vt&(ft^ut))+_t[14]+2792965006&4294967295,bt=vt+(Tt<<17&4294967295|Tt>>>15),Tt=ut+(ft^bt&(vt^ft))+_t[15]+1236535329&4294967295,ut=bt+(Tt<<22&4294967295|Tt>>>10),Tt=ft+(bt^vt&(ut^bt))+_t[1]+4129170786&4294967295,ft=ut+(Tt<<5&4294967295|Tt>>>27),Tt=vt+(ut^bt&(ft^ut))+_t[6]+3225465664&4294967295,vt=ft+(Tt<<9&4294967295|Tt>>>23),Tt=bt+(ft^ut&(vt^ft))+_t[11]+643717713&4294967295,bt=vt+(Tt<<14&4294967295|Tt>>>18),Tt=ut+(vt^ft&(bt^vt))+_t[0]+3921069994&4294967295,ut=bt+(Tt<<20&4294967295|Tt>>>12),Tt=ft+(bt^vt&(ut^bt))+_t[5]+3593408605&4294967295,ft=ut+(Tt<<5&4294967295|Tt>>>27),Tt=vt+(ut^bt&(ft^ut))+_t[10]+38016083&4294967295,vt=ft+(Tt<<9&4294967295|Tt>>>23),Tt=bt+(ft^ut&(vt^ft))+_t[15]+3634488961&4294967295,bt=vt+(Tt<<14&4294967295|Tt>>>18),Tt=ut+(vt^ft&(bt^vt))+_t[4]+3889429448&4294967295,ut=bt+(Tt<<20&4294967295|Tt>>>12),Tt=ft+(bt^vt&(ut^bt))+_t[9]+568446438&4294967295,ft=ut+(Tt<<5&4294967295|Tt>>>27),Tt=vt+(ut^bt&(ft^ut))+_t[14]+3275163606&4294967295,vt=ft+(Tt<<9&4294967295|Tt>>>23),Tt=bt+(ft^ut&(vt^ft))+_t[3]+4107603335&4294967295,bt=vt+(Tt<<14&4294967295|Tt>>>18),Tt=ut+(vt^ft&(bt^vt))+_t[8]+1163531501&4294967295,ut=bt+(Tt<<20&4294967295|Tt>>>12),Tt=ft+(bt^vt&(ut^bt))+_t[13]+2850285829&4294967295,ft=ut+(Tt<<5&4294967295|Tt>>>27),Tt=vt+(ut^bt&(ft^ut))+_t[2]+4243563512&4294967295,vt=ft+(Tt<<9&4294967295|Tt>>>23),Tt=bt+(ft^ut&(vt^ft))+_t[7]+1735328473&4294967295,bt=vt+(Tt<<14&4294967295|Tt>>>18),Tt=ut+(vt^ft&(bt^vt))+_t[12]+2368359562&4294967295,ut=bt+(Tt<<20&4294967295|Tt>>>12),Tt=ft+(ut^bt^vt)+_t[5]+4294588738&4294967295,ft=ut+(Tt<<4&4294967295|Tt>>>28),Tt=vt+(ft^ut^bt)+_t[8]+2272392833&4294967295,vt=ft+(Tt<<11&4294967295|Tt>>>21),Tt=bt+(vt^ft^ut)+_t[11]+1839030562&4294967295,bt=vt+(Tt<<16&4294967295|Tt>>>16),Tt=ut+(bt^vt^ft)+_t[14]+4259657740&4294967295,ut=bt+(Tt<<23&4294967295|Tt>>>9),Tt=ft+(ut^bt^vt)+_t[1]+2763975236&4294967295,ft=ut+(Tt<<4&4294967295|Tt>>>28),Tt=vt+(ft^ut^bt)+_t[4]+1272893353&4294967295,vt=ft+(Tt<<11&4294967295|Tt>>>21),Tt=bt+(vt^ft^ut)+_t[7]+4139469664&4294967295,bt=vt+(Tt<<16&4294967295|Tt>>>16),Tt=ut+(bt^vt^ft)+_t[10]+3200236656&4294967295,ut=bt+(Tt<<23&4294967295|Tt>>>9),Tt=ft+(ut^bt^vt)+_t[13]+681279174&4294967295,ft=ut+(Tt<<4&4294967295|Tt>>>28),Tt=vt+(ft^ut^bt)+_t[0]+3936430074&4294967295,vt=ft+(Tt<<11&4294967295|Tt>>>21),Tt=bt+(vt^ft^ut)+_t[3]+3572445317&4294967295,bt=vt+(Tt<<16&4294967295|Tt>>>16),Tt=ut+(bt^vt^ft)+_t[6]+76029189&4294967295,ut=bt+(Tt<<23&4294967295|Tt>>>9),Tt=ft+(ut^bt^vt)+_t[9]+3654602809&4294967295,ft=ut+(Tt<<4&4294967295|Tt>>>28),Tt=vt+(ft^ut^bt)+_t[12]+3873151461&4294967295,vt=ft+(Tt<<11&4294967295|Tt>>>21),Tt=bt+(vt^ft^ut)+_t[15]+530742520&4294967295,bt=vt+(Tt<<16&4294967295|Tt>>>16),Tt=ut+(bt^vt^ft)+_t[2]+3299628645&4294967295,ut=bt+(Tt<<23&4294967295|Tt>>>9),Tt=ft+(bt^(ut|~vt))+_t[0]+4096336452&4294967295,ft=ut+(Tt<<6&4294967295|Tt>>>26),Tt=vt+(ut^(ft|~bt))+_t[7]+1126891415&4294967295,vt=ft+(Tt<<10&4294967295|Tt>>>22),Tt=bt+(ft^(vt|~ut))+_t[14]+2878612391&4294967295,bt=vt+(Tt<<15&4294967295|Tt>>>17),Tt=ut+(vt^(bt|~ft))+_t[5]+4237533241&4294967295,ut=bt+(Tt<<21&4294967295|Tt>>>11),Tt=ft+(bt^(ut|~vt))+_t[12]+1700485571&4294967295,ft=ut+(Tt<<6&4294967295|Tt>>>26),Tt=vt+(ut^(ft|~bt))+_t[3]+2399980690&4294967295,vt=ft+(Tt<<10&4294967295|Tt>>>22),Tt=bt+(ft^(vt|~ut))+_t[10]+4293915773&4294967295,bt=vt+(Tt<<15&4294967295|Tt>>>17),Tt=ut+(vt^(bt|~ft))+_t[1]+2240044497&4294967295,ut=bt+(Tt<<21&4294967295|Tt>>>11),Tt=ft+(bt^(ut|~vt))+_t[8]+1873313359&4294967295,ft=ut+(Tt<<6&4294967295|Tt>>>26),Tt=vt+(ut^(ft|~bt))+_t[15]+4264355552&4294967295,vt=ft+(Tt<<10&4294967295|Tt>>>22),Tt=bt+(ft^(vt|~ut))+_t[6]+2734768916&4294967295,bt=vt+(Tt<<15&4294967295|Tt>>>17),Tt=ut+(vt^(bt|~ft))+_t[13]+1309151649&4294967295,ut=bt+(Tt<<21&4294967295|Tt>>>11),Tt=ft+(bt^(ut|~vt))+_t[4]+4149444226&4294967295,ft=ut+(Tt<<6&4294967295|Tt>>>26),Tt=vt+(ut^(ft|~bt))+_t[11]+3174756917&4294967295,vt=ft+(Tt<<10&4294967295|Tt>>>22),Tt=bt+(ft^(vt|~ut))+_t[2]+718787259&4294967295,bt=vt+(Tt<<15&4294967295|Tt>>>17),Tt=ut+(vt^(bt|~ft))+_t[9]+3951481745&4294967295,ht.g[0]=ht.g[0]+ft&4294967295,ht.g[1]=ht.g[1]+(bt+(Tt<<21&4294967295|Tt>>>11))&4294967295,ht.g[2]=ht.g[2]+bt&4294967295,ht.g[3]=ht.g[3]+vt&4294967295}s.prototype.u=function(ht,ft){ft===void 0&&(ft=ht.length);for(var ut=ft-this.blockSize,_t=this.B,bt=this.h,vt=0;vt<ft;){if(bt==0)for(;vt<=ut;)c(this,ht,vt),vt+=this.blockSize;if(typeof ht=="string"){for(;vt<ft;)if(_t[bt++]=ht.charCodeAt(vt++),bt==this.blockSize){c(this,_t),bt=0;break}}else for(;vt<ft;)if(_t[bt++]=ht[vt++],bt==this.blockSize){c(this,_t),bt=0;break}}this.h=bt,this.o+=ft},s.prototype.v=function(){var ht=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);ht[0]=128;for(var ft=1;ft<ht.length-8;++ft)ht[ft]=0;var ut=8*this.o;for(ft=ht.length-8;ft<ht.length;++ft)ht[ft]=ut&255,ut/=256;for(this.u(ht),ht=Array(16),ft=ut=0;4>ft;++ft)for(var _t=0;32>_t;_t+=8)ht[ut++]=this.g[ft]>>>_t&255;return ht};function h(ht,ft){var ut=$;return Object.prototype.hasOwnProperty.call(ut,ht)?ut[ht]:ut[ht]=ft(ht)}function _(ht,ft){this.h=ft;for(var ut=[],_t=!0,bt=ht.length-1;0<=bt;bt--){var vt=ht[bt]|0;_t&&vt==ft||(ut[bt]=vt,_t=!1)}this.g=ut}var $={};function nt(ht){return-128<=ht&&128>ht?h(ht,function(ft){return new _([ft|0],0>ft?-1:0)}):new _([ht|0],0>ht?-1:0)}function tt(ht){if(isNaN(ht)||!isFinite(ht))return d;if(0>ht)return ot(tt(-ht));for(var ft=[],ut=1,_t=0;ht>=ut;_t++)ft[_t]=ht/ut|0,ut*=4294967296;return new _(ft,0)}function et(ht,ft){if(ht.length==0)throw Error("number format error: empty string");if(ft=ft||10,2>ft||36<ft)throw Error("radix out of range: "+ft);if(ht.charAt(0)=="-")return ot(et(ht.substring(1),ft));if(0<=ht.indexOf("-"))throw Error('number format error: interior "-" character');for(var ut=tt(Math.pow(ft,8)),_t=d,bt=0;bt<ht.length;bt+=8){var vt=Math.min(8,ht.length-bt),Tt=parseInt(ht.substring(bt,bt+vt),ft);8>vt?(vt=tt(Math.pow(ft,vt)),_t=_t.j(vt).add(tt(Tt))):(_t=_t.j(ut),_t=_t.add(tt(Tt)))}return _t}var d=nt(0),a=nt(1),g=nt(16777216);i=_.prototype,i.m=function(){if(rt(this))return-ot(this).m();for(var ht=0,ft=1,ut=0;ut<this.g.length;ut++){var _t=this.i(ut);ht+=(0<=_t?_t:4294967296+_t)*ft,ft*=4294967296}return ht},i.toString=function(ht){if(ht=ht||10,2>ht||36<ht)throw Error("radix out of range: "+ht);if(j(this))return"0";if(rt(this))return"-"+ot(this).toString(ht);for(var ft=tt(Math.pow(ht,6)),ut=this,_t="";;){var bt=ct(ut,ft).g;ut=it(ut,bt.j(ft));var vt=((0<ut.g.length?ut.g[0]:ut.h)>>>0).toString(ht);if(ut=bt,j(ut))return vt+_t;for(;6>vt.length;)vt="0"+vt;_t=vt+_t}},i.i=function(ht){return 0>ht?0:ht<this.g.length?this.g[ht]:this.h};function j(ht){if(ht.h!=0)return!1;for(var ft=0;ft<ht.g.length;ft++)if(ht.g[ft]!=0)return!1;return!0}function rt(ht){return ht.h==-1}i.l=function(ht){return ht=it(this,ht),rt(ht)?-1:j(ht)?0:1};function ot(ht){for(var ft=ht.g.length,ut=[],_t=0;_t<ft;_t++)ut[_t]=~ht.g[_t];return new _(ut,~ht.h).add(a)}i.abs=function(){return rt(this)?ot(this):this},i.add=function(ht){for(var ft=Math.max(this.g.length,ht.g.length),ut=[],_t=0,bt=0;bt<=ft;bt++){var vt=_t+(this.i(bt)&65535)+(ht.i(bt)&65535),Tt=(vt>>>16)+(this.i(bt)>>>16)+(ht.i(bt)>>>16);_t=Tt>>>16,vt&=65535,Tt&=65535,ut[bt]=Tt<<16|vt}return new _(ut,ut[ut.length-1]&-2147483648?-1:0)};function it(ht,ft){return ht.add(ot(ft))}i.j=function(ht){if(j(this)||j(ht))return d;if(rt(this))return rt(ht)?ot(this).j(ot(ht)):ot(ot(this).j(ht));if(rt(ht))return ot(this.j(ot(ht)));if(0>this.l(g)&&0>ht.l(g))return tt(this.m()*ht.m());for(var ft=this.g.length+ht.g.length,ut=[],_t=0;_t<2*ft;_t++)ut[_t]=0;for(_t=0;_t<this.g.length;_t++)for(var bt=0;bt<ht.g.length;bt++){var vt=this.i(_t)>>>16,Tt=this.i(_t)&65535,Mt=ht.i(bt)>>>16,xt=ht.i(bt)&65535;ut[2*_t+2*bt]+=Tt*xt,at(ut,2*_t+2*bt),ut[2*_t+2*bt+1]+=vt*xt,at(ut,2*_t+2*bt+1),ut[2*_t+2*bt+1]+=Tt*Mt,at(ut,2*_t+2*bt+1),ut[2*_t+2*bt+2]+=vt*Mt,at(ut,2*_t+2*bt+2)}for(_t=0;_t<ft;_t++)ut[_t]=ut[2*_t+1]<<16|ut[2*_t];for(_t=ft;_t<2*ft;_t++)ut[_t]=0;return new _(ut,0)};function at(ht,ft){for(;(ht[ft]&65535)!=ht[ft];)ht[ft+1]+=ht[ft]>>>16,ht[ft]&=65535,ft++}function lt(ht,ft){this.g=ht,this.h=ft}function ct(ht,ft){if(j(ft))throw Error("division by zero");if(j(ht))return new lt(d,d);if(rt(ht))return ft=ct(ot(ht),ft),new lt(ot(ft.g),ot(ft.h));if(rt(ft))return ft=ct(ht,ot(ft)),new lt(ot(ft.g),ft.h);if(30<ht.g.length){if(rt(ht)||rt(ft))throw Error("slowDivide_ only works with positive integers.");for(var ut=a,_t=ft;0>=_t.l(ht);)ut=dt(ut),_t=dt(_t);var bt=mt(ut,1),vt=mt(_t,1);for(_t=mt(_t,2),ut=mt(ut,2);!j(_t);){var Tt=vt.add(_t);0>=Tt.l(ht)&&(bt=bt.add(ut),vt=Tt),_t=mt(_t,1),ut=mt(ut,1)}return ft=it(ht,bt.j(ft)),new lt(bt,ft)}for(bt=d;0<=ht.l(ft);){for(ut=Math.max(1,Math.floor(ht.m()/ft.m())),_t=Math.ceil(Math.log(ut)/Math.LN2),_t=48>=_t?1:Math.pow(2,_t-48),vt=tt(ut),Tt=vt.j(ft);rt(Tt)||0<Tt.l(ht);)ut-=_t,vt=tt(ut),Tt=vt.j(ft);j(vt)&&(vt=a),bt=bt.add(vt),ht=it(ht,Tt)}return new lt(bt,ht)}i.A=function(ht){return ct(this,ht).h},i.and=function(ht){for(var ft=Math.max(this.g.length,ht.g.length),ut=[],_t=0;_t<ft;_t++)ut[_t]=this.i(_t)&ht.i(_t);return new _(ut,this.h&ht.h)},i.or=function(ht){for(var ft=Math.max(this.g.length,ht.g.length),ut=[],_t=0;_t<ft;_t++)ut[_t]=this.i(_t)|ht.i(_t);return new _(ut,this.h|ht.h)},i.xor=function(ht){for(var ft=Math.max(this.g.length,ht.g.length),ut=[],_t=0;_t<ft;_t++)ut[_t]=this.i(_t)^ht.i(_t);return new _(ut,this.h^ht.h)};function dt(ht){for(var ft=ht.g.length+1,ut=[],_t=0;_t<ft;_t++)ut[_t]=ht.i(_t)<<1|ht.i(_t-1)>>>31;return new _(ut,ht.h)}function mt(ht,ft){var ut=ft>>5;ft%=32;for(var _t=ht.g.length-ut,bt=[],vt=0;vt<_t;vt++)bt[vt]=0<ft?ht.i(vt+ut)>>>ft|ht.i(vt+ut+1)<<32-ft:ht.i(vt+ut);return new _(bt,ht.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,Md5=s,_.prototype.add=_.prototype.add,_.prototype.multiply=_.prototype.j,_.prototype.modulo=_.prototype.A,_.prototype.compare=_.prototype.l,_.prototype.toNumber=_.prototype.m,_.prototype.toString=_.prototype.toString,_.prototype.getBits=_.prototype.i,_.fromNumber=tt,_.fromString=et,Integer=_}).apply(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{});var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XhrIo,WebChannel,EventType,ErrorCode,Stat,Event,getStatEventTarget,createWebChannelTransport;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(st,pt,yt){return st==Array.prototype||st==Object.prototype||(st[pt]=yt.value),st};function o(st){st=[typeof globalThis=="object"&&globalThis,st,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var pt=0;pt<st.length;++pt){var yt=st[pt];if(yt&&yt.Math==Math)return yt}throw Error("Cannot find global object")}var s=o(this);function c(st,pt){if(pt)e:{var yt=s;st=st.split(".");for(var At=0;At<st.length-1;At++){var Ft=st[At];if(!(Ft in yt))break e;yt=yt[Ft]}st=st[st.length-1],At=yt[st],pt=pt(At),pt!=At&&pt!=null&&e(yt,st,{configurable:!0,writable:!0,value:pt})}}function h(st,pt){st instanceof String&&(st+="");var yt=0,At=!1,Ft={next:function(){if(!At&&yt<st.length){var Ut=yt++;return{value:pt(Ut,st[Ut]),done:!1}}return At=!0,{done:!0,value:void 0}}};return Ft[Symbol.iterator]=function(){return Ft},Ft}c("Array.prototype.values",function(st){return st||function(){return h(this,function(pt,yt){return yt})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var _=_||{},$=this||self;function nt(st){var pt=typeof st;return pt=pt!="object"?pt:st?Array.isArray(st)?"array":pt:"null",pt=="array"||pt=="object"&&typeof st.length=="number"}function tt(st){var pt=typeof st;return pt=="object"&&st!=null||pt=="function"}function et(st,pt,yt){return st.call.apply(st.bind,arguments)}function d(st,pt,yt){if(!st)throw Error();if(2<arguments.length){var At=Array.prototype.slice.call(arguments,2);return function(){var Ft=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ft,At),st.apply(pt,Ft)}}return function(){return st.apply(pt,arguments)}}function a(st,pt,yt){return a=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?et:d,a.apply(null,arguments)}function g(st,pt){var yt=Array.prototype.slice.call(arguments,1);return function(){var At=yt.slice();return At.push.apply(At,arguments),st.apply(this,At)}}function j(st,pt){function yt(){}yt.prototype=pt.prototype,st.aa=pt.prototype,st.prototype=new yt,st.prototype.constructor=st,st.Qb=function(At,Ft,Ut){for(var Yt=Array(arguments.length-2),Mn=2;Mn<arguments.length;Mn++)Yt[Mn-2]=arguments[Mn];return pt.prototype[Ft].apply(At,Yt)}}function rt(st){const pt=st.length;if(0<pt){const yt=Array(pt);for(let At=0;At<pt;At++)yt[At]=st[At];return yt}return[]}function ot(st,pt){for(let yt=1;yt<arguments.length;yt++){const At=arguments[yt];if(nt(At)){const Ft=st.length||0,Ut=At.length||0;st.length=Ft+Ut;for(let Yt=0;Yt<Ut;Yt++)st[Ft+Yt]=At[Yt]}else st.push(At)}}class it{constructor(pt,yt){this.i=pt,this.j=yt,this.h=0,this.g=null}get(){let pt;return 0<this.h?(this.h--,pt=this.g,this.g=pt.next,pt.next=null):pt=this.i(),pt}}function at(st){return/^[\s\xa0]*$/.test(st)}function lt(){var st=$.navigator;return st&&(st=st.userAgent)?st:""}function ct(st){return ct[" "](st),st}ct[" "]=function(){};var dt=lt().indexOf("Gecko")!=-1&&!(lt().toLowerCase().indexOf("webkit")!=-1&&lt().indexOf("Edge")==-1)&&!(lt().indexOf("Trident")!=-1||lt().indexOf("MSIE")!=-1)&&lt().indexOf("Edge")==-1;function mt(st,pt,yt){for(const At in st)pt.call(yt,st[At],At,st)}function ht(st,pt){for(const yt in st)pt.call(void 0,st[yt],yt,st)}function ft(st){const pt={};for(const yt in st)pt[yt]=st[yt];return pt}const ut="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _t(st,pt){let yt,At;for(let Ft=1;Ft<arguments.length;Ft++){At=arguments[Ft];for(yt in At)st[yt]=At[yt];for(let Ut=0;Ut<ut.length;Ut++)yt=ut[Ut],Object.prototype.hasOwnProperty.call(At,yt)&&(st[yt]=At[yt])}}function bt(st){var pt=1;st=st.split(":");const yt=[];for(;0<pt&&st.length;)yt.push(st.shift()),pt--;return st.length&&yt.push(st.join(":")),yt}function vt(st){$.setTimeout(()=>{throw st},0)}function Tt(){var st=Ct;let pt=null;return st.g&&(pt=st.g,st.g=st.g.next,st.g||(st.h=null),pt.next=null),pt}class Mt{constructor(){this.h=this.g=null}add(pt,yt){const At=xt.get();At.set(pt,yt),this.h?this.h.next=At:this.g=At,this.h=At}}var xt=new it(()=>new Pt,st=>st.reset());class Pt{constructor(){this.next=this.g=this.h=null}set(pt,yt){this.h=pt,this.g=yt,this.next=null}reset(){this.next=this.g=this.h=null}}let It,Dt=!1,Ct=new Mt,Gt=()=>{const st=$.Promise.resolve(void 0);It=()=>{st.then(Wt)}};var Wt=()=>{for(var st;st=Tt();){try{st.h.call(st.g)}catch(yt){vt(yt)}var pt=xt;pt.j(st),100>pt.h&&(pt.h++,st.next=pt.g,pt.g=st)}Dt=!1};function Qt(){this.s=this.s,this.C=this.C}Qt.prototype.s=!1,Qt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Qt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function nn(st,pt){this.type=st,this.g=this.target=pt,this.defaultPrevented=!1}nn.prototype.h=function(){this.defaultPrevented=!0};var un=function(){if(!$.addEventListener||!Object.defineProperty)return!1;var st=!1,pt=Object.defineProperty({},"passive",{get:function(){st=!0}});try{const yt=()=>{};$.addEventListener("test",yt,pt),$.removeEventListener("test",yt,pt)}catch{}return st}();function en(st,pt){if(nn.call(this,st?st.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,st){var yt=this.type=st.type,At=st.changedTouches&&st.changedTouches.length?st.changedTouches[0]:null;if(this.target=st.target||st.srcElement,this.g=pt,pt=st.relatedTarget){if(dt){e:{try{ct(pt.nodeName);var Ft=!0;break e}catch{}Ft=!1}Ft||(pt=null)}}else yt=="mouseover"?pt=st.fromElement:yt=="mouseout"&&(pt=st.toElement);this.relatedTarget=pt,At?(this.clientX=At.clientX!==void 0?At.clientX:At.pageX,this.clientY=At.clientY!==void 0?At.clientY:At.pageY,this.screenX=At.screenX||0,this.screenY=At.screenY||0):(this.clientX=st.clientX!==void 0?st.clientX:st.pageX,this.clientY=st.clientY!==void 0?st.clientY:st.pageY,this.screenX=st.screenX||0,this.screenY=st.screenY||0),this.button=st.button,this.key=st.key||"",this.ctrlKey=st.ctrlKey,this.altKey=st.altKey,this.shiftKey=st.shiftKey,this.metaKey=st.metaKey,this.pointerId=st.pointerId||0,this.pointerType=typeof st.pointerType=="string"?st.pointerType:cn[st.pointerType]||"",this.state=st.state,this.i=st,st.defaultPrevented&&en.aa.h.call(this)}}j(en,nn);var cn={2:"touch",3:"pen",4:"mouse"};en.prototype.h=function(){en.aa.h.call(this);var st=this.i;st.preventDefault?st.preventDefault():st.returnValue=!1};var an="closure_listenable_"+(1e6*Math.random()|0),kn=0;function jn(st,pt,yt,At,Ft){this.listener=st,this.proxy=null,this.src=pt,this.type=yt,this.capture=!!At,this.ha=Ft,this.key=++kn,this.da=this.fa=!1}function bn(st){st.da=!0,st.listener=null,st.proxy=null,st.src=null,st.ha=null}function xn(st){this.src=st,this.g={},this.h=0}xn.prototype.add=function(st,pt,yt,At,Ft){var Ut=st.toString();st=this.g[Ut],st||(st=this.g[Ut]=[],this.h++);var Yt=An(st,pt,At,Ft);return-1<Yt?(pt=st[Yt],yt||(pt.fa=!1)):(pt=new jn(pt,this.src,Ut,!!At,Ft),pt.fa=yt,st.push(pt)),pt};function On(st,pt){var yt=pt.type;if(yt in st.g){var At=st.g[yt],Ft=Array.prototype.indexOf.call(At,pt,void 0),Ut;(Ut=0<=Ft)&&Array.prototype.splice.call(At,Ft,1),Ut&&(bn(pt),st.g[yt].length==0&&(delete st.g[yt],st.h--))}}function An(st,pt,yt,At){for(var Ft=0;Ft<st.length;++Ft){var Ut=st[Ft];if(!Ut.da&&Ut.listener==pt&&Ut.capture==!!yt&&Ut.ha==At)return Ft}return-1}var vn="closure_lm_"+(1e6*Math.random()|0),Bn={};function zn(st,pt,yt,At,Ft){if(Array.isArray(pt)){for(var Ut=0;Ut<pt.length;Ut++)zn(st,pt[Ut],yt,At,Ft);return null}return yt=pn(yt),st&&st[an]?st.K(pt,yt,tt(At)?!!At.capture:!!At,Ft):qn(st,pt,yt,!1,At,Ft)}function qn(st,pt,yt,At,Ft,Ut){if(!pt)throw Error("Invalid event type");var Yt=tt(Ft)?!!Ft.capture:!!Ft,Mn=Un(st);if(Mn||(st[vn]=Mn=new xn(st)),yt=Mn.add(pt,yt,At,Yt,Ut),yt.proxy)return yt;if(At=rr(),yt.proxy=At,At.src=st,At.listener=yt,st.addEventListener)un||(Ft=Yt),Ft===void 0&&(Ft=!1),st.addEventListener(pt.toString(),At,Ft);else if(st.attachEvent)st.attachEvent(Kn(pt.toString()),At);else if(st.addListener&&st.removeListener)st.addListener(At);else throw Error("addEventListener and attachEvent are unavailable.");return yt}function rr(){function st(yt){return pt.call(st.src,st.listener,yt)}const pt=Rn;return st}function ir(st,pt,yt,At,Ft){if(Array.isArray(pt))for(var Ut=0;Ut<pt.length;Ut++)ir(st,pt[Ut],yt,At,Ft);else At=tt(At)?!!At.capture:!!At,yt=pn(yt),st&&st[an]?(st=st.i,pt=String(pt).toString(),pt in st.g&&(Ut=st.g[pt],yt=An(Ut,yt,At,Ft),-1<yt&&(bn(Ut[yt]),Array.prototype.splice.call(Ut,yt,1),Ut.length==0&&(delete st.g[pt],st.h--)))):st&&(st=Un(st))&&(pt=st.g[pt.toString()],st=-1,pt&&(st=An(pt,yt,At,Ft)),(yt=-1<st?pt[st]:null)&&Hn(yt))}function Hn(st){if(typeof st!="number"&&st&&!st.da){var pt=st.src;if(pt&&pt[an])On(pt.i,st);else{var yt=st.type,At=st.proxy;pt.removeEventListener?pt.removeEventListener(yt,At,st.capture):pt.detachEvent?pt.detachEvent(Kn(yt),At):pt.addListener&&pt.removeListener&&pt.removeListener(At),(yt=Un(pt))?(On(yt,st),yt.h==0&&(yt.src=null,pt[vn]=null)):bn(st)}}}function Kn(st){return st in Bn?Bn[st]:Bn[st]="on"+st}function Rn(st,pt){if(st.da)st=!0;else{pt=new en(pt,this);var yt=st.listener,At=st.ha||st.src;st.fa&&Hn(st),st=yt.call(At,pt)}return st}function Un(st){return st=st[vn],st instanceof xn?st:null}var Zn="__closure_events_fn_"+(1e9*Math.random()>>>0);function pn(st){return typeof st=="function"?st:(st[Zn]||(st[Zn]=function(pt){return st.handleEvent(pt)}),st[Zn])}function Nn(){Qt.call(this),this.i=new xn(this),this.M=this,this.F=null}j(Nn,Qt),Nn.prototype[an]=!0,Nn.prototype.removeEventListener=function(st,pt,yt,At){ir(this,st,pt,yt,At)};function Fn(st,pt){var yt,At=st.F;if(At)for(yt=[];At;At=At.F)yt.push(At);if(st=st.M,At=pt.type||pt,typeof pt=="string")pt=new nn(pt,st);else if(pt instanceof nn)pt.target=pt.target||st;else{var Ft=pt;pt=new nn(At,st),_t(pt,Ft)}if(Ft=!0,yt)for(var Ut=yt.length-1;0<=Ut;Ut--){var Yt=pt.g=yt[Ut];Ft=Ar(Yt,At,!0,pt)&&Ft}if(Yt=pt.g=st,Ft=Ar(Yt,At,!0,pt)&&Ft,Ft=Ar(Yt,At,!1,pt)&&Ft,yt)for(Ut=0;Ut<yt.length;Ut++)Yt=pt.g=yt[Ut],Ft=Ar(Yt,At,!1,pt)&&Ft}Nn.prototype.N=function(){if(Nn.aa.N.call(this),this.i){var st=this.i,pt;for(pt in st.g){for(var yt=st.g[pt],At=0;At<yt.length;At++)bn(yt[At]);delete st.g[pt],st.h--}}this.F=null},Nn.prototype.K=function(st,pt,yt,At){return this.i.add(String(st),pt,!1,yt,At)},Nn.prototype.L=function(st,pt,yt,At){return this.i.add(String(st),pt,!0,yt,At)};function Ar(st,pt,yt,At){if(pt=st.i.g[String(pt)],!pt)return!0;pt=pt.concat();for(var Ft=!0,Ut=0;Ut<pt.length;++Ut){var Yt=pt[Ut];if(Yt&&!Yt.da&&Yt.capture==yt){var Mn=Yt.listener,Wn=Yt.ha||Yt.src;Yt.fa&&On(st.i,Yt),Ft=Mn.call(Wn,At)!==!1&&Ft}}return Ft&&!At.defaultPrevented}function or(st,pt,yt){if(typeof st=="function")yt&&(st=a(st,yt));else if(st&&typeof st.handleEvent=="function")st=a(st.handleEvent,st);else throw Error("Invalid listener argument");return 2147483647<Number(pt)?-1:$.setTimeout(st,pt||0)}function Sr(st){st.g=or(()=>{st.g=null,st.i&&(st.i=!1,Sr(st))},st.l);const pt=st.h;st.h=null,st.m.apply(null,pt)}class Rr extends Qt{constructor(pt,yt){super(),this.m=pt,this.l=yt,this.h=null,this.i=!1,this.g=null}j(pt){this.h=arguments,this.g?this.i=!0:Sr(this)}N(){super.N(),this.g&&($.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dn(st){Qt.call(this),this.h=st,this.g={}}j(Dn,Qt);var Tr=[];function rn(st){mt(st.g,function(pt,yt){this.g.hasOwnProperty(yt)&&Hn(pt)},st),st.g={}}Dn.prototype.N=function(){Dn.aa.N.call(this),rn(this)},Dn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sr=$.JSON.stringify,Hr=$.JSON.parse,Kr=class{stringify(st){return $.JSON.stringify(st,void 0)}parse(st){return $.JSON.parse(st,void 0)}};function er(){}er.prototype.h=null;function Tn(st){return st.h||(st.h=st.i())}function br(){}var cr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function dr(){nn.call(this,"d")}j(dr,nn);function sn(){nn.call(this,"c")}j(sn,nn);var tn={},on=null;function vr(){return on=on||new Nn}tn.La="serverreachability";function wr(st){nn.call(this,tn.La,st)}j(wr,nn);function hr(st){const pt=vr();Fn(pt,new wr(pt))}tn.STAT_EVENT="statevent";function Mr(st,pt){nn.call(this,tn.STAT_EVENT,st),this.stat=pt}j(Mr,nn);function $n(st){const pt=vr();Fn(pt,new Mr(pt,st))}tn.Ma="timingevent";function Or(st,pt){nn.call(this,tn.Ma,st),this.size=pt}j(Or,nn);function fr(st,pt){if(typeof st!="function")throw Error("Fn must not be null and must be a function");return $.setTimeout(function(){st()},pt)}function pr(){this.g=!0}pr.prototype.xa=function(){this.g=!1};function Nr(st,pt,yt,At,Ft,Ut){st.info(function(){if(st.g)if(Ut)for(var Yt="",Mn=Ut.split("&"),Wn=0;Wn<Mn.length;Wn++){var Pn=Mn[Wn].split("=");if(1<Pn.length){var Xn=Pn[0];Pn=Pn[1];var Qn=Xn.split("_");Yt=2<=Qn.length&&Qn[1]=="type"?Yt+(Xn+"="+Pn+"&"):Yt+(Xn+"=redacted&")}}else Yt=null;else Yt=Ut;return"XMLHTTP REQ ("+At+") [attempt "+Ft+"]: "+pt+`
`+yt+`
`+Yt})}function Fr(st,pt,yt,At,Ft,Ut,Yt){st.info(function(){return"XMLHTTP RESP ("+At+") [ attempt "+Ft+"]: "+pt+`
`+yt+`
`+Ut+" "+Yt})}function ar(st,pt,yt,At){st.info(function(){return"XMLHTTP TEXT ("+pt+"): "+$r(st,yt)+(At?" "+At:"")})}function Lr(st,pt){st.info(function(){return"TIMEOUT: "+pt})}pr.prototype.info=function(){};function $r(st,pt){if(!st.g)return pt;if(!pt)return null;try{var yt=JSON.parse(pt);if(yt){for(st=0;st<yt.length;st++)if(Array.isArray(yt[st])){var At=yt[st];if(!(2>At.length)){var Ft=At[1];if(Array.isArray(Ft)&&!(1>Ft.length)){var Ut=Ft[0];if(Ut!="noop"&&Ut!="stop"&&Ut!="close")for(var Yt=1;Yt<Ft.length;Yt++)Ft[Yt]=""}}}}return sr(yt)}catch{return pt}}var Er={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Et={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Rt;function kt(){}j(kt,er),kt.prototype.g=function(){return new XMLHttpRequest},kt.prototype.i=function(){return{}},Rt=new kt;function Vt(st,pt,yt,At){this.j=st,this.i=pt,this.l=yt,this.R=At||1,this.U=new Dn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Lt}function Lt(){this.i=null,this.g="",this.h=!1}var zt={},Ht={};function Zt(st,pt,yt){st.L=1,st.v=Gr(lr(pt)),st.m=yt,st.P=!0,Jt(st,null)}function Jt(st,pt){st.F=Date.now(),Vn(st),st.A=lr(st.v);var yt=st.A,At=st.R;Array.isArray(At)||(At=[String(At)]),ao(yt.i,"t",At),st.C=0,yt=st.j.J,st.h=new Lt,st.g=$o(st.j,yt?pt:null,!st.m),0<st.O&&(st.M=new Rr(a(st.Y,st,st.g),st.O)),pt=st.U,yt=st.g,At=st.ca;var Ft="readystatechange";Array.isArray(Ft)||(Ft&&(Tr[0]=Ft.toString()),Ft=Tr);for(var Ut=0;Ut<Ft.length;Ut++){var Yt=zn(yt,Ft[Ut],At||pt.handleEvent,!1,pt.h||pt);if(!Yt)break;pt.g[Yt.key]=Yt}pt=st.H?ft(st.H):{},st.m?(st.u||(st.u="POST"),pt["Content-Type"]="application/x-www-form-urlencoded",st.g.ea(st.A,st.u,st.m,pt)):(st.u="GET",st.g.ea(st.A,st.u,null,pt)),hr(),Nr(st.i,st.u,st.A,st.l,st.R,st.m)}Vt.prototype.ca=function(st){st=st.target;const pt=this.M;pt&&En(st)==3?pt.j():this.Y(st)},Vt.prototype.Y=function(st){try{if(st==this.g)e:{const Qn=En(this.g);var pt=this.g.Ba();const Zr=this.g.Z();if(!(3>Qn)&&(Qn!=3||this.g&&(this.h.h||this.g.oa()||ur(this.g)))){this.J||Qn!=4||pt==7||(pt==8||0>=Zr?hr(3):hr(2)),$t(this);var yt=this.g.Z();this.X=yt;t:if(ln(this)){var At=ur(this.g);st="";var Ft=At.length,Ut=En(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wn(this),dn(this);var Yt="";break t}this.h.i=new $.TextDecoder}for(pt=0;pt<Ft;pt++)this.h.h=!0,st+=this.h.i.decode(At[pt],{stream:!(Ut&&pt==Ft-1)});At.length=0,this.h.g+=st,this.C=0,Yt=this.h.g}else Yt=this.g.oa();if(this.o=yt==200,Fr(this.i,this.u,this.A,this.l,this.R,Qn,yt),this.o){if(this.T&&!this.K){t:{if(this.g){var Mn,Wn=this.g;if((Mn=Wn.g?Wn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!at(Mn)){var Pn=Mn;break t}}Pn=null}if(yt=Pn)ar(this.i,this.l,yt,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Yn(this,yt);else{this.o=!1,this.s=3,$n(12),wn(this),dn(this);break e}}if(this.P){yt=!0;let yr;for(;!this.J&&this.C<Yt.length;)if(yr=Sn(this,Yt),yr==Ht){Qn==4&&(this.s=4,$n(14),yt=!1),ar(this.i,this.l,null,"[Incomplete Response]");break}else if(yr==zt){this.s=4,$n(15),ar(this.i,this.l,Yt,"[Invalid Chunk]"),yt=!1;break}else ar(this.i,this.l,yr,null),Yn(this,yr);if(ln(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qn!=4||Yt.length!=0||this.h.h||(this.s=1,$n(16),yt=!1),this.o=this.o&&yt,!yt)ar(this.i,this.l,Yt,"[Invalid Chunked Response]"),wn(this),dn(this);else if(0<Yt.length&&!this.W){this.W=!0;var Xn=this.j;Xn.g==this&&Xn.ba&&!Xn.M&&(Xn.j.info("Great, no buffering proxy detected. Bytes received: "+Yt.length),So(Xn),Xn.M=!0,$n(11))}}else ar(this.i,this.l,Yt,null),Yn(this,Yt);Qn==4&&wn(this),this.o&&!this.J&&(Qn==4?Vo(this.j,this):(this.o=!1,Vn(this)))}else Vr(this.g),yt==400&&0<Yt.indexOf("Unknown SID")?(this.s=3,$n(12)):(this.s=0,$n(13)),wn(this),dn(this)}}}catch{}finally{}};function ln(st){return st.g?st.u=="GET"&&st.L!=2&&st.j.Ca:!1}function Sn(st,pt){var yt=st.C,At=pt.indexOf(`
`,yt);return At==-1?Ht:(yt=Number(pt.substring(yt,At)),isNaN(yt)?zt:(At+=1,At+yt>pt.length?Ht:(pt=pt.slice(At,At+yt),st.C=At+yt,pt)))}Vt.prototype.cancel=function(){this.J=!0,wn(this)};function Vn(st){st.S=Date.now()+st.I,Ln(st,st.I)}function Ln(st,pt){if(st.B!=null)throw Error("WatchDog timer not null");st.B=fr(a(st.ba,st),pt)}function $t(st){st.B&&($.clearTimeout(st.B),st.B=null)}Vt.prototype.ba=function(){this.B=null;const st=Date.now();0<=st-this.S?(Lr(this.i,this.A),this.L!=2&&(hr(),$n(17)),wn(this),this.s=2,dn(this)):Ln(this,this.S-st)};function dn(st){st.j.G==0||st.J||Vo(st.j,st)}function wn(st){$t(st);var pt=st.M;pt&&typeof pt.ma=="function"&&pt.ma(),st.M=null,rn(st.U),st.g&&(pt=st.g,st.g=null,pt.abort(),pt.ma())}function Yn(st,pt){try{var yt=st.j;if(yt.G!=0&&(yt.g==st||Gn(yt.h,st))){if(!st.K&&Gn(yt.h,st)&&yt.G==3){try{var At=yt.Da.g.parse(pt)}catch{At=null}if(Array.isArray(At)&&At.length==3){var Ft=At;if(Ft[0]==0){e:if(!yt.u){if(yt.g)if(yt.g.F+3e3<st.F)bo(yt),yo(yt);else break e;Ao(yt),$n(18)}}else yt.za=Ft[1],0<yt.za-yt.T&&37500>Ft[2]&&yt.F&&yt.v==0&&!yt.C&&(yt.C=fr(a(yt.Za,yt),6e3));if(1>=_i(yt.h)&&yt.ca){try{yt.ca()}catch{}yt.ca=void 0}}else qr(yt,11)}else if((st.K||yt.g==st)&&bo(yt),!at(pt))for(Ft=yt.Da.g.parse(pt),pt=0;pt<Ft.length;pt++){let Pn=Ft[pt];if(yt.T=Pn[0],Pn=Pn[1],yt.G==2)if(Pn[0]=="c"){yt.K=Pn[1],yt.ia=Pn[2];const Xn=Pn[3];Xn!=null&&(yt.la=Xn,yt.j.info("VER="+yt.la));const Qn=Pn[4];Qn!=null&&(yt.Aa=Qn,yt.j.info("SVER="+yt.Aa));const Zr=Pn[5];Zr!=null&&typeof Zr=="number"&&0<Zr&&(At=1.5*Zr,yt.L=At,yt.j.info("backChannelRequestTimeoutMs_="+At)),At=yt;const yr=st.g;if(yr){const wo=yr.g?yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wo){var Ut=At.h;Ut.g||wo.indexOf("spdy")==-1&&wo.indexOf("quic")==-1&&wo.indexOf("h2")==-1||(Ut.j=Ut.l,Ut.g=new Set,Ut.h&&(kr(Ut,Ut.h),Ut.h=null))}if(At.D){const xo=yr.g?yr.g.getResponseHeader("X-HTTP-Session-Id"):null;xo&&(At.ya=xo,In(At.I,At.D,xo))}}yt.G=3,yt.l&&yt.l.ua(),yt.ba&&(yt.R=Date.now()-st.F,yt.j.info("Handshake RTT: "+yt.R+"ms")),At=yt;var Yt=st;if(At.qa=Lo(At,At.J?At.ia:null,At.W),Yt.K){eo(At.h,Yt);var Mn=Yt,Wn=At.L;Wn&&(Mn.I=Wn),Mn.B&&($t(Mn),Vn(Mn)),At.g=Yt}else Co(At);0<yt.i.length&&To(yt)}else Pn[0]!="stop"&&Pn[0]!="close"||qr(yt,7);else yt.G==3&&(Pn[0]=="stop"||Pn[0]=="close"?Pn[0]=="stop"?qr(yt,7):Po(yt):Pn[0]!="noop"&&yt.l&&yt.l.ta(Pn),yt.v=0)}}hr(4)}catch{}}var _r=class{constructor(st,pt){this.g=st,this.map=pt}};function Yr(st){this.l=st||10,$.PerformanceNavigationTiming?(st=$.performance.getEntriesByType("navigation"),st=0<st.length&&(st[0].nextHopProtocol=="hq"||st[0].nextHopProtocol=="h2")):st=!!($.chrome&&$.chrome.loadTimes&&$.chrome.loadTimes()&&$.chrome.loadTimes().wasFetchedViaSpdy),this.j=st?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xr(st){return st.h?!0:st.g?st.g.size>=st.j:!1}function _i(st){return st.h?1:st.g?st.g.size:0}function Gn(st,pt){return st.h?st.h==pt:st.g?st.g.has(pt):!1}function kr(st,pt){st.g?st.g.add(pt):st.h=pt}function eo(st,pt){st.h&&st.h==pt?st.h=null:st.g&&st.g.has(pt)&&st.g.delete(pt)}Yr.prototype.cancel=function(){if(this.i=to(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const st of this.g.values())st.cancel();this.g.clear()}};function to(st){if(st.h!=null)return st.i.concat(st.h.D);if(st.g!=null&&st.g.size!==0){let pt=st.i;for(const yt of st.g.values())pt=pt.concat(yt.D);return pt}return rt(st.i)}function co(st){if(st.V&&typeof st.V=="function")return st.V();if(typeof Map<"u"&&st instanceof Map||typeof Set<"u"&&st instanceof Set)return Array.from(st.values());if(typeof st=="string")return st.split("");if(nt(st)){for(var pt=[],yt=st.length,At=0;At<yt;At++)pt.push(st[At]);return pt}pt=[],yt=0;for(At in st)pt[yt++]=st[At];return pt}function Eo(st){if(st.na&&typeof st.na=="function")return st.na();if(!st.V||typeof st.V!="function"){if(typeof Map<"u"&&st instanceof Map)return Array.from(st.keys());if(!(typeof Set<"u"&&st instanceof Set)){if(nt(st)||typeof st=="string"){var pt=[];st=st.length;for(var yt=0;yt<st;yt++)pt.push(yt);return pt}pt=[],yt=0;for(const At in st)pt[yt++]=At;return pt}}}function ho(st,pt){if(st.forEach&&typeof st.forEach=="function")st.forEach(pt,void 0);else if(nt(st)||typeof st=="string")Array.prototype.forEach.call(st,pt,void 0);else for(var yt=Eo(st),At=co(st),Ft=At.length,Ut=0;Ut<Ft;Ut++)pt.call(void 0,At[Ut],yt&&yt[Ut],st)}var jr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function no(st,pt){if(st){st=st.split("&");for(var yt=0;yt<st.length;yt++){var At=st[yt].indexOf("="),Ft=null;if(0<=At){var Ut=st[yt].substring(0,At);Ft=st[yt].substring(At+1)}else Ut=st[yt];pt(Ut,Ft?decodeURIComponent(Ft.replace(/\+/g," ")):"")}}}function Pr(st){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,st instanceof Pr){this.h=st.h,Br(this,st.j),this.o=st.o,this.g=st.g,zr(this,st.s),this.l=st.l;var pt=st.i,yt=new Dr;yt.i=pt.i,pt.g&&(yt.g=new Map(pt.g),yt.h=pt.h),Ur(this,yt),this.m=st.m}else st&&(pt=String(st).match(jr))?(this.h=!1,Br(this,pt[1]||"",!0),this.o=xr(pt[2]||""),this.g=xr(pt[3]||"",!0),zr(this,pt[4]),this.l=xr(pt[5]||"",!0),Ur(this,pt[6]||"",!0),this.m=xr(pt[7]||"")):(this.h=!1,this.i=new Dr(null,this.h))}Pr.prototype.toString=function(){var st=[],pt=this.j;pt&&st.push(Cr(pt,ro,!0),":");var yt=this.g;return(yt||pt=="file")&&(st.push("//"),(pt=this.o)&&st.push(Cr(pt,ro,!0),"@"),st.push(encodeURIComponent(String(yt)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),yt=this.s,yt!=null&&st.push(":",String(yt))),(yt=this.l)&&(this.g&&yt.charAt(0)!="/"&&st.push("/"),st.push(Cr(yt,yt.charAt(0)=="/"?hn:fn,!0))),(yt=this.i.toString())&&st.push("?",yt),(yt=this.m)&&st.push("#",Cr(yt,Qr)),st.join("")};function lr(st){return new Pr(st)}function Br(st,pt,yt){st.j=yt?xr(pt,!0):pt,st.j&&(st.j=st.j.replace(/:$/,""))}function zr(st,pt){if(pt){if(pt=Number(pt),isNaN(pt)||0>pt)throw Error("Bad port number "+pt);st.s=pt}else st.s=null}function Ur(st,pt,yt){pt instanceof Dr?(st.i=pt,fo(st.i,st.h)):(yt||(pt=Cr(pt,io)),st.i=new Dr(pt,st.h))}function In(st,pt,yt){st.i.set(pt,yt)}function Gr(st){return In(st,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),st}function xr(st,pt){return st?pt?decodeURI(st.replace(/%25/g,"%2525")):decodeURIComponent(st):""}function Cr(st,pt,yt){return typeof st=="string"?(st=encodeURI(st).replace(pt,_n),yt&&(st=st.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),st):null}function _n(st){return st=st.charCodeAt(0),"%"+(st>>4&15).toString(16)+(st&15).toString(16)}var ro=/[#\/\?@]/g,fn=/[#\?:]/g,hn=/[#\?]/g,io=/[#\?@]/g,Qr=/#/g;function Dr(st,pt){this.h=this.g=null,this.i=st||null,this.j=!!pt}function mr(st){st.g||(st.g=new Map,st.h=0,st.i&&no(st.i,function(pt,yt){st.add(decodeURIComponent(pt.replace(/\+/g," ")),yt)}))}i=Dr.prototype,i.add=function(st,pt){mr(this),this.i=null,st=Ir(this,st);var yt=this.g.get(st);return yt||this.g.set(st,yt=[]),yt.push(pt),this.h+=1,this};function oo(st,pt){mr(st),pt=Ir(st,pt),st.g.has(pt)&&(st.i=null,st.h-=st.g.get(pt).length,st.g.delete(pt))}function so(st,pt){return mr(st),pt=Ir(st,pt),st.g.has(pt)}i.forEach=function(st,pt){mr(this),this.g.forEach(function(yt,At){yt.forEach(function(Ft){st.call(pt,Ft,At,this)},this)},this)},i.na=function(){mr(this);const st=Array.from(this.g.values()),pt=Array.from(this.g.keys()),yt=[];for(let At=0;At<pt.length;At++){const Ft=st[At];for(let Ut=0;Ut<Ft.length;Ut++)yt.push(pt[At])}return yt},i.V=function(st){mr(this);let pt=[];if(typeof st=="string")so(this,st)&&(pt=pt.concat(this.g.get(Ir(this,st))));else{st=Array.from(this.g.values());for(let yt=0;yt<st.length;yt++)pt=pt.concat(st[yt])}return pt},i.set=function(st,pt){return mr(this),this.i=null,st=Ir(this,st),so(this,st)&&(this.h-=this.g.get(st).length),this.g.set(st,[pt]),this.h+=1,this},i.get=function(st,pt){return st?(st=this.V(st),0<st.length?String(st[0]):pt):pt};function ao(st,pt,yt){oo(st,pt),0<yt.length&&(st.i=null,st.g.set(Ir(st,pt),rt(yt)),st.h+=yt.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const st=[],pt=Array.from(this.g.keys());for(var yt=0;yt<pt.length;yt++){var At=pt[yt];const Ut=encodeURIComponent(String(At)),Yt=this.V(At);for(At=0;At<Yt.length;At++){var Ft=Ut;Yt[At]!==""&&(Ft+="="+encodeURIComponent(String(Yt[At]))),st.push(Ft)}}return this.i=st.join("&")};function Ir(st,pt){return pt=String(pt),st.j&&(pt=pt.toLowerCase()),pt}function fo(st,pt){pt&&!st.j&&(mr(st),st.i=null,st.g.forEach(function(yt,At){var Ft=At.toLowerCase();At!=Ft&&(oo(this,At),ao(this,Ft,yt))},st)),st.j=pt}function po(st,pt){const yt=new pr;if($.Image){const At=new Image;At.onload=g(gr,yt,"TestLoadImage: loaded",!0,pt,At),At.onerror=g(gr,yt,"TestLoadImage: error",!1,pt,At),At.onabort=g(gr,yt,"TestLoadImage: abort",!1,pt,At),At.ontimeout=g(gr,yt,"TestLoadImage: timeout",!1,pt,At),$.setTimeout(function(){At.ontimeout&&At.ontimeout()},1e4),At.src=st}else pt(!1)}function _o(st,pt){const yt=new pr,At=new AbortController,Ft=setTimeout(()=>{At.abort(),gr(yt,"TestPingServer: timeout",!1,pt)},1e4);fetch(st,{signal:At.signal}).then(Ut=>{clearTimeout(Ft),Ut.ok?gr(yt,"TestPingServer: ok",!0,pt):gr(yt,"TestPingServer: server error",!1,pt)}).catch(()=>{clearTimeout(Ft),gr(yt,"TestPingServer: error",!1,pt)})}function gr(st,pt,yt,At,Ft){try{Ft&&(Ft.onload=null,Ft.onerror=null,Ft.onabort=null,Ft.ontimeout=null),At(yt)}catch{}}function mo(){this.g=new Kr}function go(st,pt,yt){const At=yt||"";try{ho(st,function(Ft,Ut){let Yt=Ft;tt(Ft)&&(Yt=sr(Ft)),pt.push(At+Ut+"="+encodeURIComponent(Yt))})}catch(Ft){throw pt.push(At+"type="+encodeURIComponent("_badmap")),Ft}}function gt(st){this.l=st.Ub||null,this.j=st.eb||!1}j(gt,er),gt.prototype.g=function(){return new wt(this.l,this.j)},gt.prototype.i=function(st){return function(){return st}}({});function wt(st,pt){Nn.call(this),this.D=st,this.o=pt,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}j(wt,Nn),i=wt.prototype,i.open=function(st,pt){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=st,this.A=pt,this.readyState=1,Nt(this)},i.send=function(st){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const pt={headers:this.u,method:this.B,credentials:this.m,cache:void 0};st&&(pt.body=st),(this.D||$).fetch(new Request(this.A,pt)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ot(this)),this.readyState=0},i.Sa=function(st){if(this.g&&(this.l=st,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=st.headers,this.readyState=2,Nt(this)),this.g&&(this.readyState=3,Nt(this),this.g)))if(this.responseType==="arraybuffer")st.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof $.ReadableStream<"u"&&"body"in st){if(this.j=st.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;St(this)}else st.text().then(this.Ra.bind(this),this.ga.bind(this))};function St(st){st.j.read().then(st.Pa.bind(st)).catch(st.ga.bind(st))}i.Pa=function(st){if(this.g){if(this.o&&st.value)this.response.push(st.value);else if(!this.o){var pt=st.value?st.value:new Uint8Array(0);(pt=this.v.decode(pt,{stream:!st.done}))&&(this.response=this.responseText+=pt)}st.done?Ot(this):Nt(this),this.readyState==3&&St(this)}},i.Ra=function(st){this.g&&(this.response=this.responseText=st,Ot(this))},i.Qa=function(st){this.g&&(this.response=st,Ot(this))},i.ga=function(){this.g&&Ot(this)};function Ot(st){st.readyState=4,st.l=null,st.j=null,st.v=null,Nt(st)}i.setRequestHeader=function(st,pt){this.u.append(st,pt)},i.getResponseHeader=function(st){return this.h&&this.h.get(st.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const st=[],pt=this.h.entries();for(var yt=pt.next();!yt.done;)yt=yt.value,st.push(yt[0]+": "+yt[1]),yt=pt.next();return st.join(`\r
`)};function Nt(st){st.onreadystatechange&&st.onreadystatechange.call(st)}Object.defineProperty(wt.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(st){this.m=st?"include":"same-origin"}});function jt(st){let pt="";return mt(st,function(yt,At){pt+=At,pt+=":",pt+=yt,pt+=`\r
`}),pt}function Kt(st,pt,yt){e:{for(At in yt){var At=!1;break e}At=!0}At||(yt=jt(yt),typeof st=="string"?yt!=null&&encodeURIComponent(String(yt)):In(st,pt,yt))}function Xt(st){Nn.call(this),this.headers=new Map,this.o=st||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}j(Xt,Nn);var mn=/^https?$/i,gn=["POST","PUT"];i=Xt.prototype,i.Ha=function(st){this.J=st},i.ea=function(st,pt,yt,At){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+st);pt=pt?pt.toUpperCase():"GET",this.D=st,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rt.g(),this.v=this.o?Tn(this.o):Tn(Rt),this.g.onreadystatechange=a(this.Ea,this);try{this.B=!0,this.g.open(pt,String(st),!0),this.B=!1}catch(Ut){Cn(this,Ut);return}if(st=yt||"",yt=new Map(this.headers),At)if(Object.getPrototypeOf(At)===Object.prototype)for(var Ft in At)yt.set(Ft,At[Ft]);else if(typeof At.keys=="function"&&typeof At.get=="function")for(const Ut of At.keys())yt.set(Ut,At.get(Ut));else throw Error("Unknown input type for opt_headers: "+String(At));At=Array.from(yt.keys()).find(Ut=>Ut.toLowerCase()=="content-type"),Ft=$.FormData&&st instanceof $.FormData,!(0<=Array.prototype.indexOf.call(gn,pt,void 0))||At||Ft||yt.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ut,Yt]of yt)this.g.setRequestHeader(Ut,Yt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{yn(this),this.u=!0,this.g.send(st),this.u=!1}catch(Ut){Cn(this,Ut)}};function Cn(st,pt){st.h=!1,st.g&&(st.j=!0,st.g.abort(),st.j=!1),st.l=pt,st.m=5,tr(st),Bt(st)}function tr(st){st.A||(st.A=!0,Fn(st,"complete"),Fn(st,"error"))}i.abort=function(st){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=st||7,Fn(this,"complete"),Fn(this,"abort"),Bt(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bt(this,!0)),Xt.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?Jn(this):this.bb())},i.bb=function(){Jn(this)};function Jn(st){if(st.h&&typeof _<"u"&&(!st.v[1]||En(st)!=4||st.Z()!=2)){if(st.u&&En(st)==4)or(st.Ea,0,st);else if(Fn(st,"readystatechange"),En(st)==4){st.h=!1;try{const Yt=st.Z();e:switch(Yt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var pt=!0;break e;default:pt=!1}var yt;if(!(yt=pt)){var At;if(At=Yt===0){var Ft=String(st.D).match(jr)[1]||null;!Ft&&$.self&&$.self.location&&(Ft=$.self.location.protocol.slice(0,-1)),At=!mn.test(Ft?Ft.toLowerCase():"")}yt=At}if(yt)Fn(st,"complete"),Fn(st,"success");else{st.m=6;try{var Ut=2<En(st)?st.g.statusText:""}catch{Ut=""}st.l=Ut+" ["+st.Z()+"]",tr(st)}}finally{Bt(st)}}}}function Bt(st,pt){if(st.g){yn(st);const yt=st.g,At=st.v[0]?()=>{}:null;st.g=null,st.v=null,pt||Fn(st,"ready");try{yt.onreadystatechange=At}catch{}}}function yn(st){st.I&&($.clearTimeout(st.I),st.I=null)}i.isActive=function(){return!!this.g};function En(st){return st.g?st.g.readyState:0}i.Z=function(){try{return 2<En(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(st){if(this.g){var pt=this.g.responseText;return st&&pt.indexOf(st)==0&&(pt=pt.substring(st.length)),Hr(pt)}};function ur(st){try{if(!st.g)return null;if("response"in st.g)return st.g.response;switch(st.H){case"":case"text":return st.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in st.g)return st.g.mozResponseArrayBuffer}return null}catch{return null}}function Vr(st){const pt={};st=(st.g&&2<=En(st)&&st.g.getAllResponseHeaders()||"").split(`\r
`);for(let At=0;At<st.length;At++){if(at(st[At]))continue;var yt=bt(st[At]);const Ft=yt[0];if(yt=yt[1],typeof yt!="string")continue;yt=yt.trim();const Ut=pt[Ft]||[];pt[Ft]=Ut,Ut.push(yt)}ht(pt,function(At){return At.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function lo(st,pt,yt){return yt&&yt.internalChannelParams&&yt.internalChannelParams[st]||pt}function Ro(st){this.Aa=0,this.i=[],this.j=new pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=lo("failFast",!1,st),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=lo("baseRetryDelayMs",5e3,st),this.cb=lo("retryDelaySeedMs",1e4,st),this.Wa=lo("forwardChannelMaxRetries",2,st),this.wa=lo("forwardChannelRequestTimeoutMs",2e4,st),this.pa=st&&st.xmlHttpFactory||void 0,this.Xa=st&&st.Tb||void 0,this.Ca=st&&st.useFetchStreams||!1,this.L=void 0,this.J=st&&st.supportsCrossDomainXhr||!1,this.K="",this.h=new Yr(st&&st.concurrentRequestLimit),this.Da=new mo,this.P=st&&st.fastHandshake||!1,this.O=st&&st.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=st&&st.Rb||!1,st&&st.xa&&this.j.xa(),st&&st.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&st&&st.detectBufferingProxy||!1,this.ja=void 0,st&&st.longPollingTimeout&&0<st.longPollingTimeout&&(this.ja=st.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=Ro.prototype,i.la=8,i.G=1,i.connect=function(st,pt,yt,At){$n(0),this.W=st,this.H=pt||{},yt&&At!==void 0&&(this.H.OSID=yt,this.H.OAID=At),this.F=this.X,this.I=Lo(this,null,this.W),To(this)};function Po(st){if(Mo(st),st.G==3){var pt=st.U++,yt=lr(st.I);if(In(yt,"SID",st.K),In(yt,"RID",pt),In(yt,"TYPE","terminate"),uo(st,yt),pt=new Vt(st,st.j,pt),pt.L=2,pt.v=Gr(lr(yt)),yt=!1,$.navigator&&$.navigator.sendBeacon)try{yt=$.navigator.sendBeacon(pt.v.toString(),"")}catch{}!yt&&$.Image&&(new Image().src=pt.v,yt=!0),yt||(pt.g=$o(pt.j,null),pt.g.ea(pt.v)),pt.F=Date.now(),Vn(pt)}Fo(st)}function yo(st){st.g&&(So(st),st.g.cancel(),st.g=null)}function Mo(st){yo(st),st.u&&($.clearTimeout(st.u),st.u=null),bo(st),st.h.cancel(),st.s&&(typeof st.s=="number"&&$.clearTimeout(st.s),st.s=null)}function To(st){if(!Xr(st.h)&&!st.s){st.s=!0;var pt=st.Ga;It||Gt(),Dt||(It(),Dt=!0),Ct.add(pt,st),st.B=0}}function qo(st,pt){return _i(st.h)>=st.h.j-(st.s?1:0)?!1:st.s?(st.i=pt.D.concat(st.i),!0):st.G==1||st.G==2||st.B>=(st.Va?0:st.Wa)?!1:(st.s=fr(a(st.Ga,st,pt),No(st,st.B)),st.B++,!0)}i.Ga=function(st){if(this.s)if(this.s=null,this.G==1){if(!st){this.U=Math.floor(1e5*Math.random()),st=this.U++;const Ft=new Vt(this,this.j,st);let Ut=this.o;if(this.S&&(Ut?(Ut=ft(Ut),_t(Ut,this.S)):Ut=this.S),this.m!==null||this.O||(Ft.H=Ut,Ut=null),this.P)e:{for(var pt=0,yt=0;yt<this.i.length;yt++){t:{var At=this.i[yt];if("__data__"in At.map&&(At=At.map.__data__,typeof At=="string")){At=At.length;break t}At=void 0}if(At===void 0)break;if(pt+=At,4096<pt){pt=yt;break e}if(pt===4096||yt===this.i.length-1){pt=yt+1;break e}}pt=1e3}else pt=1e3;pt=ko(this,Ft,pt),yt=lr(this.I),In(yt,"RID",st),In(yt,"CVER",22),this.D&&In(yt,"X-HTTP-Session-Id",this.D),uo(this,yt),Ut&&(this.O?pt="headers="+encodeURIComponent(String(jt(Ut)))+"&"+pt:this.m&&Kt(yt,this.m,Ut)),kr(this.h,Ft),this.Ua&&In(yt,"TYPE","init"),this.P?(In(yt,"$req",pt),In(yt,"SID","null"),Ft.T=!0,Zt(Ft,yt,null)):Zt(Ft,yt,pt),this.G=2}}else this.G==3&&(st?Oo(this,st):this.i.length==0||Xr(this.h)||Oo(this))};function Oo(st,pt){var yt;pt?yt=pt.l:yt=st.U++;const At=lr(st.I);In(At,"SID",st.K),In(At,"RID",yt),In(At,"AID",st.T),uo(st,At),st.m&&st.o&&Kt(At,st.m,st.o),yt=new Vt(st,st.j,yt,st.B+1),st.m===null&&(yt.H=st.o),pt&&(st.i=pt.D.concat(st.i)),pt=ko(st,yt,1e3),yt.I=Math.round(.5*st.wa)+Math.round(.5*st.wa*Math.random()),kr(st.h,yt),Zt(yt,At,pt)}function uo(st,pt){st.H&&mt(st.H,function(yt,At){In(pt,At,yt)}),st.l&&ho({},function(yt,At){In(pt,At,yt)})}function ko(st,pt,yt){yt=Math.min(st.i.length,yt);var At=st.l?a(st.l.Na,st.l,st):null;e:{var Ft=st.i;let Ut=-1;for(;;){const Yt=["count="+yt];Ut==-1?0<yt?(Ut=Ft[0].g,Yt.push("ofs="+Ut)):Ut=0:Yt.push("ofs="+Ut);let Mn=!0;for(let Wn=0;Wn<yt;Wn++){let Pn=Ft[Wn].g;const Xn=Ft[Wn].map;if(Pn-=Ut,0>Pn)Ut=Math.max(0,Ft[Wn].g-100),Mn=!1;else try{go(Xn,Yt,"req"+Pn+"_")}catch{At&&At(Xn)}}if(Mn){At=Yt.join("&");break e}}}return st=st.i.splice(0,yt),pt.D=st,At}function Co(st){if(!st.g&&!st.u){st.Y=1;var pt=st.Fa;It||Gt(),Dt||(It(),Dt=!0),Ct.add(pt,st),st.v=0}}function Ao(st){return st.g||st.u||3<=st.v?!1:(st.Y++,st.u=fr(a(st.Fa,st),No(st,st.v)),st.v++,!0)}i.Fa=function(){if(this.u=null,Do(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var st=2*this.R;this.j.info("BP detection timer enabled: "+st),this.A=fr(a(this.ab,this),st)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$n(10),yo(this),Do(this))};function So(st){st.A!=null&&($.clearTimeout(st.A),st.A=null)}function Do(st){st.g=new Vt(st,st.j,"rpc",st.Y),st.m===null&&(st.g.H=st.o),st.g.O=0;var pt=lr(st.qa);In(pt,"RID","rpc"),In(pt,"SID",st.K),In(pt,"AID",st.T),In(pt,"CI",st.F?"0":"1"),!st.F&&st.ja&&In(pt,"TO",st.ja),In(pt,"TYPE","xmlhttp"),uo(st,pt),st.m&&st.o&&Kt(pt,st.m,st.o),st.L&&(st.g.I=st.L);var yt=st.g;st=st.ia,yt.L=1,yt.v=Gr(lr(pt)),yt.m=null,yt.P=!0,Jt(yt,st)}i.Za=function(){this.C!=null&&(this.C=null,yo(this),Ao(this),$n(19))};function bo(st){st.C!=null&&($.clearTimeout(st.C),st.C=null)}function Vo(st,pt){var yt=null;if(st.g==pt){bo(st),So(st),st.g=null;var At=2}else if(Gn(st.h,pt))yt=pt.D,eo(st.h,pt),At=1;else return;if(st.G!=0){if(pt.o)if(At==1){yt=pt.m?pt.m.length:0,pt=Date.now()-pt.F;var Ft=st.B;At=vr(),Fn(At,new Or(At,yt)),To(st)}else Co(st);else if(Ft=pt.s,Ft==3||Ft==0&&0<pt.X||!(At==1&&qo(st,pt)||At==2&&Ao(st)))switch(yt&&0<yt.length&&(pt=st.h,pt.i=pt.i.concat(yt)),Ft){case 1:qr(st,5);break;case 4:qr(st,10);break;case 3:qr(st,6);break;default:qr(st,2)}}}function No(st,pt){let yt=st.Ta+Math.floor(Math.random()*st.cb);return st.isActive()||(yt*=2),yt*pt}function qr(st,pt){if(st.j.info("Error code "+pt),pt==2){var yt=a(st.fb,st),At=st.Xa;const Ft=!At;At=new Pr(At||"//www.google.com/images/cleardot.gif"),$.location&&$.location.protocol=="http"||Br(At,"https"),Gr(At),Ft?po(At.toString(),yt):_o(At.toString(),yt)}else $n(2);st.G=0,st.l&&st.l.sa(pt),Fo(st),Mo(st)}i.fb=function(st){st?(this.j.info("Successfully pinged google.com"),$n(2)):(this.j.info("Failed to ping google.com"),$n(1))};function Fo(st){if(st.G=0,st.ka=[],st.l){const pt=to(st.h);(pt.length!=0||st.i.length!=0)&&(ot(st.ka,pt),ot(st.ka,st.i),st.h.i.length=0,rt(st.i),st.i.length=0),st.l.ra()}}function Lo(st,pt,yt){var At=yt instanceof Pr?lr(yt):new Pr(yt);if(At.g!="")pt&&(At.g=pt+"."+At.g),zr(At,At.s);else{var Ft=$.location;At=Ft.protocol,pt=pt?pt+"."+Ft.hostname:Ft.hostname,Ft=+Ft.port;var Ut=new Pr(null);At&&Br(Ut,At),pt&&(Ut.g=pt),Ft&&zr(Ut,Ft),yt&&(Ut.l=yt),At=Ut}return yt=st.D,pt=st.ya,yt&&pt&&In(At,yt,pt),In(At,"VER",st.la),uo(st,At),At}function $o(st,pt,yt){if(pt&&!st.J)throw Error("Can't create secondary domain capable XhrIo object.");return pt=st.Ca&&!st.pa?new Xt(new gt({eb:yt})):new Xt(st.pa),pt.Ha(st.J),pt}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function jo(){}i=jo.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function vo(){}vo.prototype.g=function(st,pt){return new nr(st,pt)};function nr(st,pt){Nn.call(this),this.g=new Ro(pt),this.l=st,this.h=pt&&pt.messageUrlParams||null,st=pt&&pt.messageHeaders||null,pt&&pt.clientProtocolHeaderRequired&&(st?st["X-Client-Protocol"]="webchannel":st={"X-Client-Protocol":"webchannel"}),this.g.o=st,st=pt&&pt.initMessageHeaders||null,pt&&pt.messageContentType&&(st?st["X-WebChannel-Content-Type"]=pt.messageContentType:st={"X-WebChannel-Content-Type":pt.messageContentType}),pt&&pt.va&&(st?st["X-WebChannel-Client-Profile"]=pt.va:st={"X-WebChannel-Client-Profile":pt.va}),this.g.S=st,(st=pt&&pt.Sb)&&!at(st)&&(this.g.m=st),this.v=pt&&pt.supportsCrossDomainXhr||!1,this.u=pt&&pt.sendRawJson||!1,(pt=pt&&pt.httpSessionIdParam)&&!at(pt)&&(this.g.D=pt,st=this.h,st!==null&&pt in st&&(st=this.h,pt in st&&delete st[pt])),this.j=new Jr(this)}j(nr,Nn),nr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},nr.prototype.close=function(){Po(this.g)},nr.prototype.o=function(st){var pt=this.g;if(typeof st=="string"){var yt={};yt.__data__=st,st=yt}else this.u&&(yt={},yt.__data__=sr(st),st=yt);pt.i.push(new _r(pt.Ya++,st)),pt.G==3&&To(pt)},nr.prototype.N=function(){this.g.l=null,delete this.j,Po(this.g),delete this.g,nr.aa.N.call(this)};function Bo(st){dr.call(this),st.__headers__&&(this.headers=st.__headers__,this.statusCode=st.__status__,delete st.__headers__,delete st.__status__);var pt=st.__sm__;if(pt){e:{for(const yt in pt){st=yt;break e}st=void 0}(this.i=st)&&(st=this.i,pt=pt!==null&&st in pt?pt[st]:void 0),this.data=pt}else this.data=st}j(Bo,dr);function zo(){sn.call(this),this.status=1}j(zo,sn);function Jr(st){this.g=st}j(Jr,jo),Jr.prototype.ua=function(){Fn(this.g,"a")},Jr.prototype.ta=function(st){Fn(this.g,new Bo(st))},Jr.prototype.sa=function(st){Fn(this.g,new zo)},Jr.prototype.ra=function(){Fn(this.g,"b")},vo.prototype.createWebChannel=vo.prototype.g,nr.prototype.send=nr.prototype.o,nr.prototype.open=nr.prototype.m,nr.prototype.close=nr.prototype.close,createWebChannelTransport=function(){return new vo},getStatEventTarget=function(){return vr()},Event=tn,Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Er.NO_ERROR=0,Er.TIMEOUT=8,Er.HTTP_ERROR=6,ErrorCode=Er,Et.COMPLETE="complete",EventType=Et,br.EventType=cr,cr.OPEN="a",cr.CLOSE="b",cr.ERROR="c",cr.MESSAGE="d",Nn.prototype.listen=Nn.prototype.K,WebChannel=br,Xt.prototype.listenOnce=Xt.prototype.L,Xt.prototype.getLastError=Xt.prototype.Ka,Xt.prototype.getLastErrorCode=Xt.prototype.Ba,Xt.prototype.getStatus=Xt.prototype.Z,Xt.prototype.getResponseJson=Xt.prototype.Oa,Xt.prototype.getResponseText=Xt.prototype.oa,Xt.prototype.send=Xt.prototype.ea,Xt.prototype.setWithCredentials=Xt.prototype.Ha,XhrIo=Xt}).apply(typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{});const w="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let S="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b=new Logger("@firebase/firestore");function __PRIVATE_getLogLevel(){return b.logLevel}function __PRIVATE_logDebug(i,...e){if(b.logLevel<=LogLevel.DEBUG){const o=e.map(__PRIVATE_argToString);b.debug(`Firestore (${S}): ${i}`,...o)}}function __PRIVATE_logError(i,...e){if(b.logLevel<=LogLevel.ERROR){const o=e.map(__PRIVATE_argToString);b.error(`Firestore (${S}): ${i}`,...o)}}function __PRIVATE_logWarn(i,...e){if(b.logLevel<=LogLevel.WARN){const o=e.map(__PRIVATE_argToString);b.warn(`Firestore (${S}): ${i}`,...o)}}function __PRIVATE_argToString(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(o){return JSON.stringify(o)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(i="Unexpected state"){const e=`FIRESTORE (${S}) INTERNAL ASSERTION FAILED: `+i;throw __PRIVATE_logError(e),new Error(e)}function __PRIVATE_hardAssert(i,e){i||fail()}function __PRIVATE_debugCast(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FirestoreError extends FirebaseError{constructor(e,o){super(e,o),this.code=e,this.message=o,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,o)=>{this.resolve=e,this.reject=o})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_OAuthToken{constructor(e,o){this.user=o,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,o){e.enqueueRetryable(()=>o(User.UNAUTHENTICATED))}shutdown(){}}class __PRIVATE_EmulatorAuthCredentialsProvider{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,o){this.changeListener=o,e.enqueueRetryable(()=>o(this.token.user))}shutdown(){this.changeListener=null}}class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,o){__PRIVATE_hardAssert(this.o===void 0);let s=this.i;const c=nt=>this.i!==s?(s=this.i,o(nt)):Promise.resolve();let h=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),h.resolve(),h=new __PRIVATE_Deferred,e.enqueueRetryable(()=>c(this.currentUser))};const _=()=>{const nt=h;e.enqueueRetryable(async()=>{await nt.promise,await c(this.currentUser)})},$=nt=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=nt,this.o&&(this.auth.addAuthTokenListener(this.o),_())};this.t.onInit(nt=>$(nt)),setTimeout(()=>{if(!this.auth){const nt=this.t.getImmediate({optional:!0});nt?$(nt):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),h.resolve(),h=new __PRIVATE_Deferred)}},0),_()}getToken(){const e=this.i,o=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(o).then(s=>this.i!==e?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(__PRIVATE_hardAssert(typeof s.accessToken=="string"),new __PRIVATE_OAuthToken(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(e===null||typeof e=="string"),new User(e)}}class __PRIVATE_FirstPartyToken{constructor(e,o,s){this.l=e,this.h=o,this.P=s,this.type="FirstParty",this.user=User.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,o,s){this.l=e,this.h=o,this.P=s}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.l,this.h,this.P))}start(e,o){e.enqueueRetryable(()=>o(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,o){__PRIVATE_hardAssert(this.o===void 0);const s=h=>{h.error!=null&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${h.error.message}`);const _=h.token!==this.R;return this.R=h.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${_?"new":"existing"} token.`),_?o(h.token):Promise.resolve()};this.o=h=>{e.enqueueRetryable(()=>s(h))};const c=h=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=h,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(h=>c(h)),setTimeout(()=>{if(!this.appCheck){const h=this.A.getImmediate({optional:!0});h?c(h):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(o=>o?(__PRIVATE_hardAssert(typeof o.token=="string"),this.R=o.token,new AppCheckToken(o.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_randomBytes(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),o=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(o);else for(let s=0;s<i;s++)o[s]=Math.floor(256*Math.random());return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AutoId{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const c=__PRIVATE_randomBytes(40);for(let h=0;h<c.length;++h)s.length<20&&c[h]<o&&(s+=e.charAt(c[h]%e.length))}return s}}function __PRIVATE_primitiveComparator(i,e){return i<e?-1:i>e?1:0}function __PRIVATE_arrayEquals(i,e,o){return i.length===e.length&&i.every((s,c)=>o(s,e[c]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Timestamp{static now(){return Timestamp.fromMillis(Date.now())}static fromDate(e){return Timestamp.fromMillis(e.getTime())}static fromMillis(e){const o=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*o));return new Timestamp(o,s)}constructor(e,o){if(this.seconds=e,this.nanoseconds=o,o<0)throw new FirestoreError(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+o);if(o>=1e9)throw new FirestoreError(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+o);if(e<-62135596800)throw new FirestoreError(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new FirestoreError(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,e.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotVersion{static fromTimestamp(e){return new SnapshotVersion(e)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BasePath{constructor(e,o,s){o===void 0?o=0:o>e.length&&fail(),s===void 0?s=e.length-o:s>e.length-o&&fail(),this.segments=e,this.offset=o,this.len=s}get length(){return this.len}isEqual(e){return BasePath.comparator(this,e)===0}child(e){const o=this.segments.slice(this.offset,this.limit());return e instanceof BasePath?e.forEach(s=>{o.push(s)}):o.push(e),this.construct(o)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let o=0;o<this.length;o++)if(this.get(o)!==e.get(o))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let o=0;o<this.length;o++)if(this.get(o)!==e.get(o))return!1;return!0}forEach(e){for(let o=this.offset,s=this.limit();o<s;o++)e(this.segments[o])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,o){const s=Math.min(e.length,o.length);for(let c=0;c<s;c++){const h=e.get(c),_=o.get(c);if(h<_)return-1;if(h>_)return 1}return e.length<o.length?-1:e.length>o.length?1:0}}class ResourcePath extends BasePath{construct(e,o,s){return new ResourcePath(e,o,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const o=[];for(const s of e){if(s.indexOf("//")>=0)throw new FirestoreError(D.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);o.push(...s.split("/").filter(c=>c.length>0))}return new ResourcePath(o)}static emptyPath(){return new ResourcePath([])}}const v=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class FieldPath$1 extends BasePath{construct(e,o,s){return new FieldPath$1(e,o,s)}static isValidIdentifier(e){return v.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new FieldPath$1(["__name__"])}static fromServerFormat(e){const o=[];let s="",c=0;const h=()=>{if(s.length===0)throw new FirestoreError(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);o.push(s),s=""};let _=!1;for(;c<e.length;){const $=e[c];if($==="\\"){if(c+1===e.length)throw new FirestoreError(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const nt=e[c+1];if(nt!=="\\"&&nt!=="."&&nt!=="`")throw new FirestoreError(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=nt,c+=2}else $==="`"?(_=!_,c++):$!=="."||_?(s+=$,c++):(h(),c++)}if(h(),_)throw new FirestoreError(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new FieldPath$1(o)}static emptyPath(){return new FieldPath$1([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentKey{constructor(e){this.path=e}static fromPath(e){return new DocumentKey(ResourcePath.fromString(e))}static fromName(e){return new DocumentKey(ResourcePath.fromString(e).popFirst(5))}static empty(){return new DocumentKey(ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ResourcePath.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,o){return ResourcePath.comparator(e.path,o.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DocumentKey(new ResourcePath(e.slice()))}}function __PRIVATE_newIndexOffsetSuccessorFromReadTime(i,e){const o=i.toTimestamp().seconds,s=i.toTimestamp().nanoseconds+1,c=SnapshotVersion.fromTimestamp(s===1e9?new Timestamp(o+1,0):new Timestamp(o,s));return new IndexOffset(c,DocumentKey.empty(),e)}function __PRIVATE_newIndexOffsetFromDocument(i){return new IndexOffset(i.readTime,i.key,-1)}class IndexOffset{constructor(e,o,s){this.readTime=e,this.documentKey=o,this.largestBatchId=s}static min(){return new IndexOffset(SnapshotVersion.min(),DocumentKey.empty(),-1)}static max(){return new IndexOffset(SnapshotVersion.max(),DocumentKey.empty(),-1)}}function __PRIVATE_indexOffsetComparator(i,e){let o=i.readTime.compareTo(e.readTime);return o!==0?o:(o=DocumentKey.comparator(i.documentKey,e.documentKey),o!==0?o:__PRIVATE_primitiveComparator(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(i){if(i.code!==D.FAILED_PRECONDITION||i.message!==C)throw i;__PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PersistencePromise{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(o=>{this.isDone=!0,this.result=o,this.nextCallback&&this.nextCallback(o)},o=>{this.isDone=!0,this.error=o,this.catchCallback&&this.catchCallback(o)})}catch(e){return this.next(void 0,e)}next(e,o){return this.callbackAttached&&fail(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(o,this.error):this.wrapSuccess(e,this.result):new PersistencePromise((s,c)=>{this.nextCallback=h=>{this.wrapSuccess(e,h).next(s,c)},this.catchCallback=h=>{this.wrapFailure(o,h).next(s,c)}})}toPromise(){return new Promise((e,o)=>{this.next(e,o)})}wrapUserFunction(e){try{const o=e();return o instanceof PersistencePromise?o:PersistencePromise.resolve(o)}catch(o){return PersistencePromise.reject(o)}}wrapSuccess(e,o){return e?this.wrapUserFunction(()=>e(o)):PersistencePromise.resolve(o)}wrapFailure(e,o){return e?this.wrapUserFunction(()=>e(o)):PersistencePromise.reject(o)}static resolve(e){return new PersistencePromise((o,s)=>{o(e)})}static reject(e){return new PersistencePromise((o,s)=>{s(e)})}static waitFor(e){return new PersistencePromise((o,s)=>{let c=0,h=0,_=!1;e.forEach($=>{++c,$.next(()=>{++h,_&&h===c&&o()},nt=>s(nt))}),_=!0,h===c&&o()})}static or(e){let o=PersistencePromise.resolve(!1);for(const s of e)o=o.next(c=>c?PersistencePromise.resolve(c):s());return o}static forEach(e,o){const s=[];return e.forEach((c,h)=>{s.push(o.call(this,c,h))}),this.waitFor(s)}static mapArray(e,o){return new PersistencePromise((s,c)=>{const h=e.length,_=new Array(h);let $=0;for(let nt=0;nt<h;nt++){const tt=nt;o(e[tt]).next(et=>{_[tt]=et,++$,$===h&&s(_)},et=>c(et))}})}static doWhile(e,o){return new PersistencePromise((s,c)=>{const h=()=>{e()===!0?o().next(()=>{h()},c):s()};h()})}}function __PRIVATE_getAndroidVersion(i){const e=i.match(/Android ([\d.]+)/i),o=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(o)}function __PRIVATE_isIndexedDbTransactionError(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ListenSequence{constructor(e,o){this.previousValue=e,o&&(o.sequenceNumberHandler=s=>this.ie(s),this.se=s=>o.writeSequenceNumber(s))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}__PRIVATE_ListenSequence.oe=-1;function __PRIVATE_isNullOrUndefined(i){return i==null}function __PRIVATE_isNegativeZero(i){return i===0&&1/i==-1/0}function isSafeInteger(i){return typeof i=="number"&&Number.isInteger(i)&&!__PRIVATE_isNegativeZero(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_encodeResourcePath(i){let e="";for(let o=0;o<i.length;o++)e.length>0&&(e=__PRIVATE_encodeSeparator(e)),e=__PRIVATE_encodeSegment(i.get(o),e);return __PRIVATE_encodeSeparator(e)}function __PRIVATE_encodeSegment(i,e){let o=e;const s=i.length;for(let c=0;c<s;c++){const h=i.charAt(c);switch(h){case"\0":o+="";break;case"":o+="";break;default:o+=h}}return o}function __PRIVATE_encodeSeparator(i){return i+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(i){let e=0;for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&e++;return e}function forEach(i,e){for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&e(o,i[o])}function isEmpty$1(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMap{constructor(e,o){this.comparator=e,this.root=o||LLRBNode.EMPTY}insert(e,o){return new SortedMap(this.comparator,this.root.insert(e,o,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let o=this.root;for(;!o.isEmpty();){const s=this.comparator(e,o.key);if(s===0)return o.value;s<0?o=o.left:s>0&&(o=o.right)}return null}indexOf(e){let o=0,s=this.root;for(;!s.isEmpty();){const c=this.comparator(e,s.key);if(c===0)return o+s.left.size;c<0?s=s.left:(o+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((o,s)=>(e(o,s),!1))}toString(){const e=[];return this.inorderTraversal((o,s)=>(e.push(`${o}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!0)}}class SortedMapIterator{constructor(e,o,s,c){this.isReverse=c,this.nodeStack=[];let h=1;for(;!e.isEmpty();)if(h=o?s(e.key,o):1,o&&c&&(h*=-1),h<0)e=this.isReverse?e.left:e.right;else{if(h===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const o={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return o}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class LLRBNode{constructor(e,o,s,c,h){this.key=e,this.value=o,this.color=s??LLRBNode.RED,this.left=c??LLRBNode.EMPTY,this.right=h??LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,o,s,c,h){return new LLRBNode(e??this.key,o??this.value,s??this.color,c??this.left,h??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,o,s){let c=this;const h=s(e,c.key);return c=h<0?c.copy(null,null,null,c.left.insert(e,o,s),null):h===0?c.copy(null,o,null,null,null):c.copy(null,null,null,null,c.right.insert(e,o,s)),c.fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,o){let s,c=this;if(o(e,c.key)<0)c.left.isEmpty()||c.left.isRed()||c.left.left.isRed()||(c=c.moveRedLeft()),c=c.copy(null,null,null,c.left.remove(e,o),null);else{if(c.left.isRed()&&(c=c.rotateRight()),c.right.isEmpty()||c.right.isRed()||c.right.left.isRed()||(c=c.moveRedRight()),o(e,c.key)===0){if(c.right.isEmpty())return LLRBNode.EMPTY;s=c.right.min(),c=c.copy(s.key,s.value,null,null,c.right.removeMin())}c=c.copy(null,null,null,null,c.right.remove(e,o))}return c.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),o=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,o)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw fail();const e=this.left.check();if(e!==this.right.check())throw fail();return e+(this.isRed()?0:1)}}LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1;LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw fail()}get value(){throw fail()}get color(){throw fail()}get left(){throw fail()}get right(){throw fail()}copy(e,o,s,c,h){return this}insert(e,o,s){return new LLRBNode(e,o)}remove(e,o){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedSet{constructor(e){this.comparator=e,this.data=new SortedMap(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((o,s)=>(e(o),!1))}forEachInRange(e,o){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const c=s.getNext();if(this.comparator(c.key,e[1])>=0)return;o(c.key)}}forEachWhile(e,o){let s;for(s=o!==void 0?this.data.getIteratorFrom(o):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const o=this.data.getIteratorFrom(e);return o.hasNext()?o.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom(e){return new SortedSetIterator(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let o=this;return o.size<e.size&&(o=e,e=this),e.forEach(s=>{o=o.add(s)}),o}isEqual(e){if(!(e instanceof SortedSet)||this.size!==e.size)return!1;const o=this.data.getIterator(),s=e.data.getIterator();for(;o.hasNext();){const c=o.getNext().key,h=s.getNext().key;if(this.comparator(c,h)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(o=>{e.push(o)}),e}toString(){const e=[];return this.forEach(o=>e.push(o)),"SortedSet("+e.toString()+")"}copy(e){const o=new SortedSet(this.comparator);return o.data=e,o}}class SortedSetIterator{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldMask{constructor(e){this.fields=e,e.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith(e){let o=new SortedSet(FieldPath$1.comparator);for(const s of this.fields)o=o.add(s);for(const s of e)o=o.add(s);return new FieldMask(o.toArray())}covers(e){for(const o of this.fields)if(o.isPrefixOf(e))return!0;return!1}isEqual(e){return __PRIVATE_arrayEquals(this.fields,e.fields,(o,s)=>o.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ByteString{constructor(e){this.binaryString=e}static fromBase64String(e){const o=function(c){try{return atob(c)}catch(h){throw typeof DOMException<"u"&&h instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+h):h}}(e);return new ByteString(o)}static fromUint8Array(e){const o=function(c){let h="";for(let _=0;_<c.length;++_)h+=String.fromCharCode(c[_]);return h}(e);return new ByteString(o)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(o){return btoa(o)}(this.binaryString)}toUint8Array(){return function(o){const s=new Uint8Array(o.length);for(let c=0;c<o.length;c++)s[c]=o.charCodeAt(c);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return __PRIVATE_primitiveComparator(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ByteString.EMPTY_BYTE_STRING=new ByteString("");const ne=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(i){if(__PRIVATE_hardAssert(!!i),typeof i=="string"){let e=0;const o=ne.exec(i);if(__PRIVATE_hardAssert(!!o),o[1]){let c=o[1];c=(c+"000000000").substr(0,9),e=Number(c)}const s=new Date(i);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:__PRIVATE_normalizeNumber(i.seconds),nanos:__PRIVATE_normalizeNumber(i.nanos)}}function __PRIVATE_normalizeNumber(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function __PRIVATE_normalizeByteString(i){return typeof i=="string"?ByteString.fromBase64String(i):ByteString.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_isServerTimestamp(i){var e,o;return((o=(((e=i==null?void 0:i.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||o===void 0?void 0:o.stringValue)==="server_timestamp"}function __PRIVATE_getPreviousValue(i){const e=i.mapValue.fields.__previous_value__;return __PRIVATE_isServerTimestamp(e)?__PRIVATE_getPreviousValue(e):e}function __PRIVATE_getLocalWriteTime(i){const e=__PRIVATE_normalizeTimestamp(i.mapValue.fields.__local_write_time__.timestampValue);return new Timestamp(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DatabaseInfo{constructor(e,o,s,c,h,_,$,nt,tt){this.databaseId=e,this.appId=o,this.persistenceKey=s,this.host=c,this.ssl=h,this.forceLongPolling=_,this.autoDetectLongPolling=$,this.longPollingOptions=nt,this.useFetchStreams=tt}}class DatabaseId{constructor(e,o){this.projectId=e,this.database=o||"(default)"}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function __PRIVATE_typeOrder(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?__PRIVATE_isServerTimestamp(i)?4:__PRIVATE_isMaxValue(i)?9007199254740991:__PRIVATE_isVectorValue(i)?10:11:fail()}function __PRIVATE_valueEquals(i,e){if(i===e)return!0;const o=__PRIVATE_typeOrder(i);if(o!==__PRIVATE_typeOrder(e))return!1;switch(o){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(i).isEqual(__PRIVATE_getLocalWriteTime(e));case 3:return function(c,h){if(typeof c.timestampValue=="string"&&typeof h.timestampValue=="string"&&c.timestampValue.length===h.timestampValue.length)return c.timestampValue===h.timestampValue;const _=__PRIVATE_normalizeTimestamp(c.timestampValue),$=__PRIVATE_normalizeTimestamp(h.timestampValue);return _.seconds===$.seconds&&_.nanos===$.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(c,h){return __PRIVATE_normalizeByteString(c.bytesValue).isEqual(__PRIVATE_normalizeByteString(h.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(c,h){return __PRIVATE_normalizeNumber(c.geoPointValue.latitude)===__PRIVATE_normalizeNumber(h.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(c.geoPointValue.longitude)===__PRIVATE_normalizeNumber(h.geoPointValue.longitude)}(i,e);case 2:return function(c,h){if("integerValue"in c&&"integerValue"in h)return __PRIVATE_normalizeNumber(c.integerValue)===__PRIVATE_normalizeNumber(h.integerValue);if("doubleValue"in c&&"doubleValue"in h){const _=__PRIVATE_normalizeNumber(c.doubleValue),$=__PRIVATE_normalizeNumber(h.doubleValue);return _===$?__PRIVATE_isNegativeZero(_)===__PRIVATE_isNegativeZero($):isNaN(_)&&isNaN($)}return!1}(i,e);case 9:return __PRIVATE_arrayEquals(i.arrayValue.values||[],e.arrayValue.values||[],__PRIVATE_valueEquals);case 10:case 11:return function(c,h){const _=c.mapValue.fields||{},$=h.mapValue.fields||{};if(__PRIVATE_objectSize(_)!==__PRIVATE_objectSize($))return!1;for(const nt in _)if(_.hasOwnProperty(nt)&&($[nt]===void 0||!__PRIVATE_valueEquals(_[nt],$[nt])))return!1;return!0}(i,e);default:return fail()}}function __PRIVATE_arrayValueContains(i,e){return(i.values||[]).find(o=>__PRIVATE_valueEquals(o,e))!==void 0}function __PRIVATE_valueCompare(i,e){if(i===e)return 0;const o=__PRIVATE_typeOrder(i),s=__PRIVATE_typeOrder(e);if(o!==s)return __PRIVATE_primitiveComparator(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(i.booleanValue,e.booleanValue);case 2:return function(h,_){const $=__PRIVATE_normalizeNumber(h.integerValue||h.doubleValue),nt=__PRIVATE_normalizeNumber(_.integerValue||_.doubleValue);return $<nt?-1:$>nt?1:$===nt?0:isNaN($)?isNaN(nt)?0:-1:1}(i,e);case 3:return __PRIVATE_compareTimestamps(i.timestampValue,e.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(i),__PRIVATE_getLocalWriteTime(e));case 5:return __PRIVATE_primitiveComparator(i.stringValue,e.stringValue);case 6:return function(h,_){const $=__PRIVATE_normalizeByteString(h),nt=__PRIVATE_normalizeByteString(_);return $.compareTo(nt)}(i.bytesValue,e.bytesValue);case 7:return function(h,_){const $=h.split("/"),nt=_.split("/");for(let tt=0;tt<$.length&&tt<nt.length;tt++){const et=__PRIVATE_primitiveComparator($[tt],nt[tt]);if(et!==0)return et}return __PRIVATE_primitiveComparator($.length,nt.length)}(i.referenceValue,e.referenceValue);case 8:return function(h,_){const $=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(h.latitude),__PRIVATE_normalizeNumber(_.latitude));return $!==0?$:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(h.longitude),__PRIVATE_normalizeNumber(_.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return __PRIVATE_compareArrays(i.arrayValue,e.arrayValue);case 10:return function(h,_){var $,nt,tt,et;const d=h.fields||{},a=_.fields||{},g=($=d.value)===null||$===void 0?void 0:$.arrayValue,j=(nt=a.value)===null||nt===void 0?void 0:nt.arrayValue,rt=__PRIVATE_primitiveComparator(((tt=g==null?void 0:g.values)===null||tt===void 0?void 0:tt.length)||0,((et=j==null?void 0:j.values)===null||et===void 0?void 0:et.length)||0);return rt!==0?rt:__PRIVATE_compareArrays(g,j)}(i.mapValue,e.mapValue);case 11:return function(h,_){if(h===re.mapValue&&_===re.mapValue)return 0;if(h===re.mapValue)return 1;if(_===re.mapValue)return-1;const $=h.fields||{},nt=Object.keys($),tt=_.fields||{},et=Object.keys(tt);nt.sort(),et.sort();for(let d=0;d<nt.length&&d<et.length;++d){const a=__PRIVATE_primitiveComparator(nt[d],et[d]);if(a!==0)return a;const g=__PRIVATE_valueCompare($[nt[d]],tt[et[d]]);if(g!==0)return g}return __PRIVATE_primitiveComparator(nt.length,et.length)}(i.mapValue,e.mapValue);default:throw fail()}}function __PRIVATE_compareTimestamps(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return __PRIVATE_primitiveComparator(i,e);const o=__PRIVATE_normalizeTimestamp(i),s=__PRIVATE_normalizeTimestamp(e),c=__PRIVATE_primitiveComparator(o.seconds,s.seconds);return c!==0?c:__PRIVATE_primitiveComparator(o.nanos,s.nanos)}function __PRIVATE_compareArrays(i,e){const o=i.values||[],s=e.values||[];for(let c=0;c<o.length&&c<s.length;++c){const h=__PRIVATE_valueCompare(o[c],s[c]);if(h)return h}return __PRIVATE_primitiveComparator(o.length,s.length)}function canonicalId(i){return __PRIVATE_canonifyValue(i)}function __PRIVATE_canonifyValue(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(o){const s=__PRIVATE_normalizeTimestamp(o);return`time(${s.seconds},${s.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(o){return __PRIVATE_normalizeByteString(o).toBase64()}(i.bytesValue):"referenceValue"in i?function(o){return DocumentKey.fromName(o).toString()}(i.referenceValue):"geoPointValue"in i?function(o){return`geo(${o.latitude},${o.longitude})`}(i.geoPointValue):"arrayValue"in i?function(o){let s="[",c=!0;for(const h of o.values||[])c?c=!1:s+=",",s+=__PRIVATE_canonifyValue(h);return s+"]"}(i.arrayValue):"mapValue"in i?function(o){const s=Object.keys(o.fields||{}).sort();let c="{",h=!0;for(const _ of s)h?h=!1:c+=",",c+=`${_}:${__PRIVATE_canonifyValue(o.fields[_])}`;return c+"}"}(i.mapValue):fail()}function __PRIVATE_estimateByteSize(i){switch(__PRIVATE_typeOrder(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=__PRIVATE_getPreviousValue(i);return e?16+__PRIVATE_estimateByteSize(e):16;case 5:return 2*i.stringValue.length;case 6:return __PRIVATE_normalizeByteString(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((c,h)=>c+__PRIVATE_estimateByteSize(h),0)}(i.arrayValue);case 10:case 11:return function(s){let c=0;return forEach(s.fields,(h,_)=>{c+=h.length+__PRIVATE_estimateByteSize(_)}),c}(i.mapValue);default:throw fail()}}function isInteger$1(i){return!!i&&"integerValue"in i}function isArray(i){return!!i&&"arrayValue"in i}function __PRIVATE_isNullValue(i){return!!i&&"nullValue"in i}function __PRIVATE_isNanValue(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function __PRIVATE_isMapValue(i){return!!i&&"mapValue"in i}function __PRIVATE_isVectorValue(i){var e,o;return((o=(((e=i==null?void 0:i.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||o===void 0?void 0:o.stringValue)==="__vector__"}function __PRIVATE_deepClone(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return forEach(i.mapValue.fields,(o,s)=>e.mapValue.fields[o]=__PRIVATE_deepClone(s)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let o=0;o<(i.arrayValue.values||[]).length;++o)e.arrayValue.values[o]=__PRIVATE_deepClone(i.arrayValue.values[o]);return e}return Object.assign({},i)}function __PRIVATE_isMaxValue(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ObjectValue$1=class Io{constructor(e){this.value=e}static empty(){return new Io({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let o=this.value;for(let s=0;s<e.length-1;++s)if(o=(o.mapValue.fields||{})[e.get(s)],!__PRIVATE_isMapValue(o))return null;return o=(o.mapValue.fields||{})[e.lastSegment()],o||null}}set(e,o){this.getFieldsMap(e.popLast())[e.lastSegment()]=__PRIVATE_deepClone(o)}setAll(e){let o=FieldPath$1.emptyPath(),s={},c=[];e.forEach((_,$)=>{if(!o.isImmediateParentOf($)){const nt=this.getFieldsMap(o);this.applyChanges(nt,s,c),s={},c=[],o=$.popLast()}_?s[$.lastSegment()]=__PRIVATE_deepClone(_):c.push($.lastSegment())});const h=this.getFieldsMap(o);this.applyChanges(h,s,c)}delete(e){const o=this.field(e.popLast());__PRIVATE_isMapValue(o)&&o.mapValue.fields&&delete o.mapValue.fields[e.lastSegment()]}isEqual(e){return __PRIVATE_valueEquals(this.value,e.value)}getFieldsMap(e){let o=this.value;o.mapValue.fields||(o.mapValue={fields:{}});for(let s=0;s<e.length;++s){let c=o.mapValue.fields[e.get(s)];__PRIVATE_isMapValue(c)&&c.mapValue.fields||(c={mapValue:{fields:{}}},o.mapValue.fields[e.get(s)]=c),o=c}return o.mapValue.fields}applyChanges(e,o,s){forEach(o,(c,h)=>e[c]=h);for(const c of s)delete e[c]}clone(){return new Io(__PRIVATE_deepClone(this.value))}};function __PRIVATE_extractFieldMask(i){const e=[];return forEach(i.fields,(o,s)=>{const c=new FieldPath$1([o]);if(__PRIVATE_isMapValue(s)){const h=__PRIVATE_extractFieldMask(s.mapValue).fields;if(h.length===0)e.push(c);else for(const _ of h)e.push(c.child(_))}else e.push(c)}),new FieldMask(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutableDocument{constructor(e,o,s,c,h,_,$){this.key=e,this.documentType=o,this.version=s,this.readTime=c,this.createTime=h,this.data=_,this.documentState=$}static newInvalidDocument(e){return new MutableDocument(e,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue$1.empty(),0)}static newFoundDocument(e,o,s,c){return new MutableDocument(e,1,o,SnapshotVersion.min(),s,c,0)}static newNoDocument(e,o){return new MutableDocument(e,2,o,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue$1.empty(),0)}static newUnknownDocument(e,o){return new MutableDocument(e,3,o,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue$1.empty(),2)}convertToFoundDocument(e,o){return!this.createTime.isEqual(SnapshotVersion.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=o,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ObjectValue$1.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ObjectValue$1.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof MutableDocument&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bound{constructor(e,o){this.position=e,this.inclusive=o}}function __PRIVATE_boundCompareToDocument(i,e,o){let s=0;for(let c=0;c<i.position.length;c++){const h=e[c],_=i.position[c];if(h.field.isKeyField()?s=DocumentKey.comparator(DocumentKey.fromName(_.referenceValue),o.key):s=__PRIVATE_valueCompare(_,o.data.field(h.field)),h.dir==="desc"&&(s*=-1),s!==0)break}return s}function __PRIVATE_boundEquals(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let o=0;o<i.position.length;o++)if(!__PRIVATE_valueEquals(i.position[o],e.position[o]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OrderBy{constructor(e,o="asc"){this.field=e,this.dir=o}}function __PRIVATE_orderByEquals(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Filter{}class FieldFilter extends Filter{constructor(e,o,s){super(),this.field=e,this.op=o,this.value=s}static create(e,o,s){return e.isKeyField()?o==="in"||o==="not-in"?this.createKeyFieldInFilter(e,o,s):new __PRIVATE_KeyFieldFilter(e,o,s):o==="array-contains"?new __PRIVATE_ArrayContainsFilter(e,s):o==="in"?new __PRIVATE_InFilter(e,s):o==="not-in"?new __PRIVATE_NotInFilter(e,s):o==="array-contains-any"?new __PRIVATE_ArrayContainsAnyFilter(e,s):new FieldFilter(e,o,s)}static createKeyFieldInFilter(e,o,s){return o==="in"?new __PRIVATE_KeyFieldInFilter(e,s):new __PRIVATE_KeyFieldNotInFilter(e,s)}matches(e){const o=e.data.field(this.field);return this.op==="!="?o!==null&&this.matchesComparison(__PRIVATE_valueCompare(o,this.value)):o!==null&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(o)&&this.matchesComparison(__PRIVATE_valueCompare(o,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fail()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class CompositeFilter extends Filter{constructor(e,o){super(),this.filters=e,this.op=o,this.ae=null}static create(e,o){return new CompositeFilter(e,o)}matches(e){return __PRIVATE_compositeFilterIsConjunction(this)?this.filters.find(o=>!o.matches(e))===void 0:this.filters.find(o=>o.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,o)=>e.concat(o.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function __PRIVATE_compositeFilterIsConjunction(i){return i.op==="and"}function __PRIVATE_compositeFilterIsFlatConjunction(i){return __PRIVATE_compositeFilterIsFlat(i)&&__PRIVATE_compositeFilterIsConjunction(i)}function __PRIVATE_compositeFilterIsFlat(i){for(const e of i.filters)if(e instanceof CompositeFilter)return!1;return!0}function __PRIVATE_canonifyFilter(i){if(i instanceof FieldFilter)return i.field.canonicalString()+i.op.toString()+canonicalId(i.value);if(__PRIVATE_compositeFilterIsFlatConjunction(i))return i.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");{const e=i.filters.map(o=>__PRIVATE_canonifyFilter(o)).join(",");return`${i.op}(${e})`}}function __PRIVATE_filterEquals(i,e){return i instanceof FieldFilter?function(s,c){return c instanceof FieldFilter&&s.op===c.op&&s.field.isEqual(c.field)&&__PRIVATE_valueEquals(s.value,c.value)}(i,e):i instanceof CompositeFilter?function(s,c){return c instanceof CompositeFilter&&s.op===c.op&&s.filters.length===c.filters.length?s.filters.reduce((h,_,$)=>h&&__PRIVATE_filterEquals(_,c.filters[$]),!0):!1}(i,e):void fail()}function __PRIVATE_stringifyFilter(i){return i instanceof FieldFilter?function(o){return`${o.field.canonicalString()} ${o.op} ${canonicalId(o.value)}`}(i):i instanceof CompositeFilter?function(o){return o.op.toString()+" {"+o.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}"}(i):"Filter"}class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor(e,o,s){super(e,o,s),this.key=DocumentKey.fromName(s.referenceValue)}matches(e){const o=DocumentKey.comparator(e.key,this.key);return this.matchesComparison(o)}}class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor(e,o){super(e,"in",o),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",o)}matches(e){return this.keys.some(o=>o.isEqual(e.key))}}class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor(e,o){super(e,"not-in",o),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",o)}matches(e){return!this.keys.some(o=>o.isEqual(e.key))}}function __PRIVATE_extractDocumentKeysFromArrayValue(i,e){var o;return(((o=e.arrayValue)===null||o===void 0?void 0:o.values)||[]).map(s=>DocumentKey.fromName(s.referenceValue))}class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor(e,o){super(e,"array-contains",o)}matches(e){const o=e.data.field(this.field);return isArray(o)&&__PRIVATE_arrayValueContains(o.arrayValue,this.value)}}class __PRIVATE_InFilter extends FieldFilter{constructor(e,o){super(e,"in",o)}matches(e){const o=e.data.field(this.field);return o!==null&&__PRIVATE_arrayValueContains(this.value.arrayValue,o)}}class __PRIVATE_NotInFilter extends FieldFilter{constructor(e,o){super(e,"not-in",o)}matches(e){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const o=e.data.field(this.field);return o!==null&&!__PRIVATE_arrayValueContains(this.value.arrayValue,o)}}class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor(e,o){super(e,"array-contains-any",o)}matches(e){const o=e.data.field(this.field);return!(!isArray(o)||!o.arrayValue.values)&&o.arrayValue.values.some(s=>__PRIVATE_arrayValueContains(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetImpl{constructor(e,o=null,s=[],c=[],h=null,_=null,$=null){this.path=e,this.collectionGroup=o,this.orderBy=s,this.filters=c,this.limit=h,this.startAt=_,this.endAt=$,this.ue=null}}function __PRIVATE_newTarget(i,e=null,o=[],s=[],c=null,h=null,_=null){return new __PRIVATE_TargetImpl(i,e,o,s,c,h,_)}function __PRIVATE_canonifyTarget(i){const e=__PRIVATE_debugCast(i);if(e.ue===null){let o=e.path.canonicalString();e.collectionGroup!==null&&(o+="|cg:"+e.collectionGroup),o+="|f:",o+=e.filters.map(s=>__PRIVATE_canonifyFilter(s)).join(","),o+="|ob:",o+=e.orderBy.map(s=>function(h){return h.field.canonicalString()+h.dir}(s)).join(","),__PRIVATE_isNullOrUndefined(e.limit)||(o+="|l:",o+=e.limit),e.startAt&&(o+="|lb:",o+=e.startAt.inclusive?"b:":"a:",o+=e.startAt.position.map(s=>canonicalId(s)).join(",")),e.endAt&&(o+="|ub:",o+=e.endAt.inclusive?"a:":"b:",o+=e.endAt.position.map(s=>canonicalId(s)).join(",")),e.ue=o}return e.ue}function __PRIVATE_targetEquals(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let o=0;o<i.orderBy.length;o++)if(!__PRIVATE_orderByEquals(i.orderBy[o],e.orderBy[o]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let o=0;o<i.filters.length;o++)if(!__PRIVATE_filterEquals(i.filters[o],e.filters[o]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!__PRIVATE_boundEquals(i.startAt,e.startAt)&&__PRIVATE_boundEquals(i.endAt,e.endAt)}function __PRIVATE_targetIsDocumentTarget(i){return DocumentKey.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryImpl{constructor(e,o=null,s=[],c=[],h=null,_="F",$=null,nt=null){this.path=e,this.collectionGroup=o,this.explicitOrderBy=s,this.filters=c,this.limit=h,this.limitType=_,this.startAt=$,this.endAt=nt,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function __PRIVATE_newQuery(i,e,o,s,c,h,_,$){return new __PRIVATE_QueryImpl(i,e,o,s,c,h,_,$)}function __PRIVATE_newQueryForPath(i){return new __PRIVATE_QueryImpl(i)}function __PRIVATE_queryMatchesAllDocuments(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function __PRIVATE_isCollectionGroupQuery(i){return i.collectionGroup!==null}function __PRIVATE_queryNormalizedOrderBy(i){const e=__PRIVATE_debugCast(i);if(e.ce===null){e.ce=[];const o=new Set;for(const h of e.explicitOrderBy)e.ce.push(h),o.add(h.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(_){let $=new SortedSet(FieldPath$1.comparator);return _.filters.forEach(nt=>{nt.getFlattenedFilters().forEach(tt=>{tt.isInequality()&&($=$.add(tt.field))})}),$})(e).forEach(h=>{o.has(h.canonicalString())||h.isKeyField()||e.ce.push(new OrderBy(h,s))}),o.has(FieldPath$1.keyField().canonicalString())||e.ce.push(new OrderBy(FieldPath$1.keyField(),s))}return e.ce}function __PRIVATE_queryToTarget(i){const e=__PRIVATE_debugCast(i);return e.le||(e.le=__PRIVATE__queryToTarget(e,__PRIVATE_queryNormalizedOrderBy(i))),e.le}function __PRIVATE__queryToTarget(i,e){if(i.limitType==="F")return __PRIVATE_newTarget(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(c=>{const h=c.dir==="desc"?"asc":"desc";return new OrderBy(c.field,h)});const o=i.endAt?new Bound(i.endAt.position,i.endAt.inclusive):null,s=i.startAt?new Bound(i.startAt.position,i.startAt.inclusive):null;return __PRIVATE_newTarget(i.path,i.collectionGroup,e,i.filters,i.limit,o,s)}}function __PRIVATE_queryWithLimit(i,e,o){return new __PRIVATE_QueryImpl(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,o,i.startAt,i.endAt)}function __PRIVATE_queryEquals(i,e){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(i),__PRIVATE_queryToTarget(e))&&i.limitType===e.limitType}function __PRIVATE_canonifyQuery(i){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(i))}|lt:${i.limitType}`}function __PRIVATE_stringifyQuery(i){return`Query(target=${function(o){let s=o.path.canonicalString();return o.collectionGroup!==null&&(s+=" collectionGroup="+o.collectionGroup),o.filters.length>0&&(s+=`, filters: [${o.filters.map(c=>__PRIVATE_stringifyFilter(c)).join(", ")}]`),__PRIVATE_isNullOrUndefined(o.limit)||(s+=", limit: "+o.limit),o.orderBy.length>0&&(s+=`, orderBy: [${o.orderBy.map(c=>function(_){return`${_.field.canonicalString()} (${_.dir})`}(c)).join(", ")}]`),o.startAt&&(s+=", startAt: ",s+=o.startAt.inclusive?"b:":"a:",s+=o.startAt.position.map(c=>canonicalId(c)).join(",")),o.endAt&&(s+=", endAt: ",s+=o.endAt.inclusive?"a:":"b:",s+=o.endAt.position.map(c=>canonicalId(c)).join(",")),`Target(${s})`}(__PRIVATE_queryToTarget(i))}; limitType=${i.limitType})`}function __PRIVATE_queryMatches(i,e){return e.isFoundDocument()&&function(s,c){const h=c.key.path;return s.collectionGroup!==null?c.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(h):DocumentKey.isDocumentKey(s.path)?s.path.isEqual(h):s.path.isImmediateParentOf(h)}(i,e)&&function(s,c){for(const h of __PRIVATE_queryNormalizedOrderBy(s))if(!h.field.isKeyField()&&c.data.field(h.field)===null)return!1;return!0}(i,e)&&function(s,c){for(const h of s.filters)if(!h.matches(c))return!1;return!0}(i,e)&&function(s,c){return!(s.startAt&&!function(_,$,nt){const tt=__PRIVATE_boundCompareToDocument(_,$,nt);return _.inclusive?tt<=0:tt<0}(s.startAt,__PRIVATE_queryNormalizedOrderBy(s),c)||s.endAt&&!function(_,$,nt){const tt=__PRIVATE_boundCompareToDocument(_,$,nt);return _.inclusive?tt>=0:tt>0}(s.endAt,__PRIVATE_queryNormalizedOrderBy(s),c))}(i,e)}function __PRIVATE_queryCollectionGroup(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function __PRIVATE_newQueryComparator(i){return(e,o)=>{let s=!1;for(const c of __PRIVATE_queryNormalizedOrderBy(i)){const h=__PRIVATE_compareDocs(c,e,o);if(h!==0)return h;s=s||c.field.isKeyField()}return 0}}function __PRIVATE_compareDocs(i,e,o){const s=i.field.isKeyField()?DocumentKey.comparator(e.key,o.key):function(h,_,$){const nt=_.data.field(h),tt=$.data.field(h);return nt!==null&&tt!==null?__PRIVATE_valueCompare(nt,tt):fail()}(i.field,e,o);switch(i.dir){case"asc":return s;case"desc":return-1*s;default:return fail()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectMap{constructor(e,o){this.mapKeyFn=e,this.equalsFn=o,this.inner={},this.innerSize=0}get(e){const o=this.mapKeyFn(e),s=this.inner[o];if(s!==void 0){for(const[c,h]of s)if(this.equalsFn(c,e))return h}}has(e){return this.get(e)!==void 0}set(e,o){const s=this.mapKeyFn(e),c=this.inner[s];if(c===void 0)return this.inner[s]=[[e,o]],void this.innerSize++;for(let h=0;h<c.length;h++)if(this.equalsFn(c[h][0],e))return void(c[h]=[e,o]);c.push([e,o]),this.innerSize++}delete(e){const o=this.mapKeyFn(e),s=this.inner[o];if(s===void 0)return!1;for(let c=0;c<s.length;c++)if(this.equalsFn(s[c][0],e))return s.length===1?delete this.inner[o]:s.splice(c,1),this.innerSize--,!0;return!1}forEach(e){forEach(this.inner,(o,s)=>{for(const[c,h]of s)e(c,h)})}isEmpty(){return isEmpty$1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe=new SortedMap(DocumentKey.comparator);function __PRIVATE_mutableDocumentMap(){return oe}const _e=new SortedMap(DocumentKey.comparator);function documentMap(...i){let e=_e;for(const o of i)e=e.insert(o.key,o);return e}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(i){let e=_e;return i.forEach((o,s)=>e=e.insert(o,s.overlayedDocument)),e}function __PRIVATE_newOverlayMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newMutationMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(i=>i.toString(),(i,e)=>i.isEqual(e))}const ae=new SortedMap(DocumentKey.comparator),ue=new SortedSet(DocumentKey.comparator);function __PRIVATE_documentKeySet(...i){let e=ue;for(const o of i)e=e.add(o);return e}const ce=new SortedSet(__PRIVATE_primitiveComparator);function __PRIVATE_targetIdSet(){return ce}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero(e)?"-0":e}}function __PRIVATE_toInteger(i){return{integerValue:""+i}}function toNumber(i,e){return isSafeInteger(e)?__PRIVATE_toInteger(e):__PRIVATE_toDouble(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransformOperation{constructor(){this._=void 0}}function __PRIVATE_applyTransformOperationToLocalView(i,e,o){return i instanceof __PRIVATE_ServerTimestampTransform?function(c,h){const _={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:c.seconds,nanos:c.nanoseconds}}}};return h&&__PRIVATE_isServerTimestamp(h)&&(h=__PRIVATE_getPreviousValue(h)),h&&(_.fields.__previous_value__=h),{mapValue:_}}(o,e):i instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(i,e):i instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(i,e):function(c,h){const _=__PRIVATE_computeTransformOperationBaseValue(c,h),$=asNumber(_)+asNumber(c.Pe);return isInteger$1(_)&&isInteger$1(c.Pe)?__PRIVATE_toInteger($):__PRIVATE_toDouble(c.serializer,$)}(i,e)}function __PRIVATE_applyTransformOperationToRemoteDocument(i,e,o){return i instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(i,e):i instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(i,e):o}function __PRIVATE_computeTransformOperationBaseValue(i,e){return i instanceof __PRIVATE_NumericIncrementTransformOperation?function(s){return isInteger$1(s)||function(h){return!!h&&"doubleValue"in h}(s)}(e)?e:{integerValue:0}:null}class __PRIVATE_ServerTimestampTransform extends TransformOperation{}class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayUnionTransformOperation(i,e){const o=__PRIVATE_coercedFieldValuesArray(e);for(const s of i.elements)o.some(c=>__PRIVATE_valueEquals(c,s))||o.push(s);return{arrayValue:{values:o}}}class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayRemoveTransformOperation(i,e){let o=__PRIVATE_coercedFieldValuesArray(e);for(const s of i.elements)o=o.filter(c=>!__PRIVATE_valueEquals(c,s));return{arrayValue:{values:o}}}class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor(e,o){super(),this.serializer=e,this.Pe=o}}function asNumber(i){return __PRIVATE_normalizeNumber(i.integerValue||i.doubleValue)}function __PRIVATE_coercedFieldValuesArray(i){return isArray(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function __PRIVATE_fieldTransformEquals(i,e){return i.field.isEqual(e.field)&&function(s,c){return s instanceof __PRIVATE_ArrayUnionTransformOperation&&c instanceof __PRIVATE_ArrayUnionTransformOperation||s instanceof __PRIVATE_ArrayRemoveTransformOperation&&c instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(s.elements,c.elements,__PRIVATE_valueEquals):s instanceof __PRIVATE_NumericIncrementTransformOperation&&c instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(s.Pe,c.Pe):s instanceof __PRIVATE_ServerTimestampTransform&&c instanceof __PRIVATE_ServerTimestampTransform}(i.transform,e.transform)}class MutationResult{constructor(e,o){this.version=e,this.transformResults=o}}class Precondition{constructor(e,o){this.updateTime=e,this.exists=o}static none(){return new Precondition}static exists(e){return new Precondition(void 0,e)}static updateTime(e){return new Precondition(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function __PRIVATE_preconditionIsValidForDocument(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class Mutation{}function __PRIVATE_calculateOverlayMutation(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new __PRIVATE_DeleteMutation(i.key,Precondition.none()):new __PRIVATE_SetMutation(i.key,i.data,Precondition.none());{const o=i.data,s=ObjectValue$1.empty();let c=new SortedSet(FieldPath$1.comparator);for(let h of e.fields)if(!c.has(h)){let _=o.field(h);_===null&&h.length>1&&(h=h.popLast(),_=o.field(h)),_===null?s.delete(h):s.set(h,_),c=c.add(h)}return new __PRIVATE_PatchMutation(i.key,s,new FieldMask(c.toArray()),Precondition.none())}}function __PRIVATE_mutationApplyToRemoteDocument(i,e,o){i instanceof __PRIVATE_SetMutation?function(c,h,_){const $=c.value.clone(),nt=__PRIVATE_serverTransformResults(c.fieldTransforms,h,_.transformResults);$.setAll(nt),h.convertToFoundDocument(_.version,$).setHasCommittedMutations()}(i,e,o):i instanceof __PRIVATE_PatchMutation?function(c,h,_){if(!__PRIVATE_preconditionIsValidForDocument(c.precondition,h))return void h.convertToUnknownDocument(_.version);const $=__PRIVATE_serverTransformResults(c.fieldTransforms,h,_.transformResults),nt=h.data;nt.setAll(__PRIVATE_getPatch(c)),nt.setAll($),h.convertToFoundDocument(_.version,nt).setHasCommittedMutations()}(i,e,o):function(c,h,_){h.convertToNoDocument(_.version).setHasCommittedMutations()}(0,e,o)}function __PRIVATE_mutationApplyToLocalView(i,e,o,s){return i instanceof __PRIVATE_SetMutation?function(h,_,$,nt){if(!__PRIVATE_preconditionIsValidForDocument(h.precondition,_))return $;const tt=h.value.clone(),et=__PRIVATE_localTransformResults(h.fieldTransforms,nt,_);return tt.setAll(et),_.convertToFoundDocument(_.version,tt).setHasLocalMutations(),null}(i,e,o,s):i instanceof __PRIVATE_PatchMutation?function(h,_,$,nt){if(!__PRIVATE_preconditionIsValidForDocument(h.precondition,_))return $;const tt=__PRIVATE_localTransformResults(h.fieldTransforms,nt,_),et=_.data;return et.setAll(__PRIVATE_getPatch(h)),et.setAll(tt),_.convertToFoundDocument(_.version,et).setHasLocalMutations(),$===null?null:$.unionWith(h.fieldMask.fields).unionWith(h.fieldTransforms.map(d=>d.field))}(i,e,o,s):function(h,_,$){return __PRIVATE_preconditionIsValidForDocument(h.precondition,_)?(_.convertToNoDocument(_.version).setHasLocalMutations(),null):$}(i,e,o)}function __PRIVATE_mutationExtractBaseValue(i,e){let o=null;for(const s of i.fieldTransforms){const c=e.data.field(s.field),h=__PRIVATE_computeTransformOperationBaseValue(s.transform,c||null);h!=null&&(o===null&&(o=ObjectValue$1.empty()),o.set(s.field,h))}return o||null}function __PRIVATE_mutationEquals(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(s,c){return s===void 0&&c===void 0||!(!s||!c)&&__PRIVATE_arrayEquals(s,c,(h,_)=>__PRIVATE_fieldTransformEquals(h,_))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class __PRIVATE_SetMutation extends Mutation{constructor(e,o,s,c=[]){super(),this.key=e,this.value=o,this.precondition=s,this.fieldTransforms=c,this.type=0}getFieldMask(){return null}}class __PRIVATE_PatchMutation extends Mutation{constructor(e,o,s,c,h=[]){super(),this.key=e,this.data=o,this.fieldMask=s,this.precondition=c,this.fieldTransforms=h,this.type=1}getFieldMask(){return this.fieldMask}}function __PRIVATE_getPatch(i){const e=new Map;return i.fieldMask.fields.forEach(o=>{if(!o.isEmpty()){const s=i.data.field(o);e.set(o,s)}}),e}function __PRIVATE_serverTransformResults(i,e,o){const s=new Map;__PRIVATE_hardAssert(i.length===o.length);for(let c=0;c<o.length;c++){const h=i[c],_=h.transform,$=e.data.field(h.field);s.set(h.field,__PRIVATE_applyTransformOperationToRemoteDocument(_,$,o[c]))}return s}function __PRIVATE_localTransformResults(i,e,o){const s=new Map;for(const c of i){const h=c.transform,_=o.data.field(c.field);s.set(c.field,__PRIVATE_applyTransformOperationToLocalView(h,_,e))}return s}class __PRIVATE_DeleteMutation extends Mutation{constructor(e,o){super(),this.key=e,this.precondition=o,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class __PRIVATE_VerifyMutation extends Mutation{constructor(e,o){super(),this.key=e,this.precondition=o,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutationBatch{constructor(e,o,s,c){this.batchId=e,this.localWriteTime=o,this.baseMutations=s,this.mutations=c}applyToRemoteDocument(e,o){const s=o.mutationResults;for(let c=0;c<this.mutations.length;c++){const h=this.mutations[c];h.key.isEqual(e.key)&&__PRIVATE_mutationApplyToRemoteDocument(h,e,s[c])}}applyToLocalView(e,o){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(o=__PRIVATE_mutationApplyToLocalView(s,e,o,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(o=__PRIVATE_mutationApplyToLocalView(s,e,o,this.localWriteTime));return o}applyToLocalDocumentSet(e,o){const s=__PRIVATE_newMutationMap();return this.mutations.forEach(c=>{const h=e.get(c.key),_=h.overlayedDocument;let $=this.applyToLocalView(_,h.mutatedFields);$=o.has(c.key)?null:$;const nt=__PRIVATE_calculateOverlayMutation(_,$);nt!==null&&s.set(c.key,nt),_.isValidDocument()||_.convertToNoDocument(SnapshotVersion.min())}),s}keys(){return this.mutations.reduce((e,o)=>e.add(o.key),__PRIVATE_documentKeySet())}isEqual(e){return this.batchId===e.batchId&&__PRIVATE_arrayEquals(this.mutations,e.mutations,(o,s)=>__PRIVATE_mutationEquals(o,s))&&__PRIVATE_arrayEquals(this.baseMutations,e.baseMutations,(o,s)=>__PRIVATE_mutationEquals(o,s))}}class MutationBatchResult{constructor(e,o,s,c){this.batch=e,this.commitVersion=o,this.mutationResults=s,this.docVersions=c}static from(e,o,s){__PRIVATE_hardAssert(e.mutations.length===s.length);let c=function(){return ae}();const h=e.mutations;for(let _=0;_<h.length;_++)c=c.insert(h[_].key,s[_].version);return new MutationBatchResult(e,o,s,c)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overlay{constructor(e,o){this.largestBatchId=e,this.mutation=o}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistenceFilter{constructor(e,o){this.count=e,this.unchangedNames=o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le,he;function __PRIVATE_isPermanentError(i){switch(i){default:return fail();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function __PRIVATE_mapCodeFromRpcCode(i){if(i===void 0)return __PRIVATE_logError("GRPC error has no .code"),D.UNKNOWN;switch(i){case le.OK:return D.OK;case le.CANCELLED:return D.CANCELLED;case le.UNKNOWN:return D.UNKNOWN;case le.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case le.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case le.INTERNAL:return D.INTERNAL;case le.UNAVAILABLE:return D.UNAVAILABLE;case le.UNAUTHENTICATED:return D.UNAUTHENTICATED;case le.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case le.NOT_FOUND:return D.NOT_FOUND;case le.ALREADY_EXISTS:return D.ALREADY_EXISTS;case le.PERMISSION_DENIED:return D.PERMISSION_DENIED;case le.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case le.ABORTED:return D.ABORTED;case le.OUT_OF_RANGE:return D.OUT_OF_RANGE;case le.UNIMPLEMENTED:return D.UNIMPLEMENTED;case le.DATA_LOSS:return D.DATA_LOSS;default:return fail()}}(he=le||(le={}))[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newTextEncoder(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Te=new Integer([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(i){const e=__PRIVATE_newTextEncoder().encode(i),o=new Md5;return o.update(e),new Uint8Array(o.digest())}function __PRIVATE_get64BitUints(i){const e=new DataView(i.buffer),o=e.getUint32(0,!0),s=e.getUint32(4,!0),c=e.getUint32(8,!0),h=e.getUint32(12,!0);return[new Integer([o,s],0),new Integer([c,h],0)]}class BloomFilter{constructor(e,o,s){if(this.bitmap=e,this.padding=o,this.hashCount=s,o<0||o>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${o}`);if(s<0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${s}`);if(e.length===0&&o!==0)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${o}`);this.Te=8*e.length-o,this.Ie=Integer.fromNumber(this.Te)}Ee(e,o,s){let c=e.add(o.multiply(Integer.fromNumber(s)));return c.compare(Te)===1&&(c=new Integer([c.getBits(0),c.getBits(1)],0)),c.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const o=__PRIVATE_getMd5HashValue(e),[s,c]=__PRIVATE_get64BitUints(o);for(let h=0;h<this.hashCount;h++){const _=this.Ee(s,c,h);if(!this.de(_))return!1}return!0}static create(e,o,s){const c=e%8==0?0:8-e%8,h=new Uint8Array(Math.ceil(e/8)),_=new BloomFilter(h,c,o);return s.forEach($=>_.insert($)),_}insert(e){if(this.Te===0)return;const o=__PRIVATE_getMd5HashValue(e),[s,c]=__PRIVATE_get64BitUints(o);for(let h=0;h<this.hashCount;h++){const _=this.Ee(s,c,h);this.Ae(_)}}Ae(e){const o=Math.floor(e/8),s=e%8;this.bitmap[o]|=1<<s}}class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteEvent{constructor(e,o,s,c,h){this.snapshotVersion=e,this.targetChanges=o,this.targetMismatches=s,this.documentUpdates=c,this.resolvedLimboDocuments=h}static createSynthesizedRemoteEventForCurrentChange(e,o,s){const c=new Map;return c.set(e,TargetChange.createSynthesizedTargetChangeForCurrentChange(e,o,s)),new RemoteEvent(SnapshotVersion.min(),c,new SortedMap(__PRIVATE_primitiveComparator),__PRIVATE_mutableDocumentMap(),__PRIVATE_documentKeySet())}}class TargetChange{constructor(e,o,s,c,h){this.resumeToken=e,this.current=o,this.addedDocuments=s,this.modifiedDocuments=c,this.removedDocuments=h}static createSynthesizedTargetChangeForCurrentChange(e,o,s){return new TargetChange(s,o,__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentWatchChange{constructor(e,o,s,c){this.Re=e,this.removedTargetIds=o,this.key=s,this.Ve=c}}class __PRIVATE_ExistenceFilterChange{constructor(e,o){this.targetId=e,this.me=o}}class __PRIVATE_WatchTargetChange{constructor(e,o,s=ByteString.EMPTY_BYTE_STRING,c=null){this.state=e,this.targetIds=o,this.resumeToken=s,this.cause=c}}class __PRIVATE_TargetState{constructor(){this.fe=0,this.ge=__PRIVATE_snapshotChangesMap(),this.pe=ByteString.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=__PRIVATE_documentKeySet(),o=__PRIVATE_documentKeySet(),s=__PRIVATE_documentKeySet();return this.ge.forEach((c,h)=>{switch(h){case 0:e=e.add(c);break;case 2:o=o.add(c);break;case 1:s=s.add(c);break;default:fail()}}),new TargetChange(this.pe,this.ye,e,o,s)}Ce(){this.we=!1,this.ge=__PRIVATE_snapshotChangesMap()}Fe(e,o){this.we=!0,this.ge=this.ge.insert(e,o)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,__PRIVATE_hardAssert(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class __PRIVATE_WatchChangeAggregator{constructor(e){this.Le=e,this.Be=new Map,this.ke=__PRIVATE_mutableDocumentMap(),this.qe=__PRIVATE_documentTargetMap(),this.Qe=__PRIVATE_documentTargetMap(),this.Ke=new SortedMap(__PRIVATE_primitiveComparator)}$e(e){for(const o of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(o,e.Ve):this.We(o,e.key,e.Ve);for(const o of e.removedTargetIds)this.We(o,e.key,e.Ve)}Ge(e){this.forEachTarget(e,o=>{const s=this.ze(o);switch(e.state){case 0:this.je(o)&&s.De(e.resumeToken);break;case 1:s.Oe(),s.Se||s.Ce(),s.De(e.resumeToken);break;case 2:s.Oe(),s.Se||this.removeTarget(o);break;case 3:this.je(o)&&(s.Ne(),s.De(e.resumeToken));break;case 4:this.je(o)&&(this.He(o),s.De(e.resumeToken));break;default:fail()}})}forEachTarget(e,o){e.targetIds.length>0?e.targetIds.forEach(o):this.Be.forEach((s,c)=>{this.je(c)&&o(c)})}Je(e){const o=e.targetId,s=e.me.count,c=this.Ye(o);if(c){const h=c.target;if(__PRIVATE_targetIsDocumentTarget(h))if(s===0){const _=new DocumentKey(h.path);this.We(o,_,MutableDocument.newNoDocument(_,SnapshotVersion.min()))}else __PRIVATE_hardAssert(s===1);else{const _=this.Ze(o);if(_!==s){const $=this.Xe(e),nt=$?this.et($,e,_):1;if(nt!==0){this.He(o);const tt=nt===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(o,tt)}}}}}Xe(e){const o=e.me.unchangedNames;if(!o||!o.bits)return null;const{bits:{bitmap:s="",padding:c=0},hashCount:h=0}=o;let _,$;try{_=__PRIVATE_normalizeByteString(s).toUint8Array()}catch(nt){if(nt instanceof __PRIVATE_Base64DecodeError)return __PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+nt.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw nt}try{$=new BloomFilter(_,c,h)}catch(nt){return __PRIVATE_logWarn(nt instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",nt),null}return $.Te===0?null:$}et(e,o,s){return o.me.count===s-this.rt(e,o.targetId)?0:2}rt(e,o){const s=this.Le.getRemoteKeysForTarget(o);let c=0;return s.forEach(h=>{const _=this.Le.nt(),$=`projects/${_.projectId}/databases/${_.database}/documents/${h.path.canonicalString()}`;e.mightContain($)||(this.We(o,h,null),c++)}),c}it(e){const o=new Map;this.Be.forEach((h,_)=>{const $=this.Ye(_);if($){if(h.current&&__PRIVATE_targetIsDocumentTarget($.target)){const nt=new DocumentKey($.target.path);this.st(nt).has(_)||this.ot(_,nt)||this.We(_,nt,MutableDocument.newNoDocument(nt,e))}h.be&&(o.set(_,h.ve()),h.Ce())}});let s=__PRIVATE_documentKeySet();this.Qe.forEach((h,_)=>{let $=!0;_.forEachWhile(nt=>{const tt=this.Ye(nt);return!tt||tt.purpose==="TargetPurposeLimboResolution"||($=!1,!1)}),$&&(s=s.add(h))}),this.ke.forEach((h,_)=>_.setReadTime(e));const c=new RemoteEvent(e,o,this.Ke,this.ke,s);return this.ke=__PRIVATE_mutableDocumentMap(),this.qe=__PRIVATE_documentTargetMap(),this.Qe=__PRIVATE_documentTargetMap(),this.Ke=new SortedMap(__PRIVATE_primitiveComparator),c}Ue(e,o){if(!this.je(e))return;const s=this.ot(e,o.key)?2:0;this.ze(e).Fe(o.key,s),this.ke=this.ke.insert(o.key,o),this.qe=this.qe.insert(o.key,this.st(o.key).add(e)),this.Qe=this.Qe.insert(o.key,this._t(o.key).add(e))}We(e,o,s){if(!this.je(e))return;const c=this.ze(e);this.ot(e,o)?c.Fe(o,1):c.Me(o),this.Qe=this.Qe.insert(o,this._t(o).delete(e)),this.Qe=this.Qe.insert(o,this._t(o).add(e)),s&&(this.ke=this.ke.insert(o,s))}removeTarget(e){this.Be.delete(e)}Ze(e){const o=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+o.addedDocuments.size-o.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let o=this.Be.get(e);return o||(o=new __PRIVATE_TargetState,this.Be.set(e,o)),o}_t(e){let o=this.Qe.get(e);return o||(o=new SortedSet(__PRIVATE_primitiveComparator),this.Qe=this.Qe.insert(e,o)),o}st(e){let o=this.qe.get(e);return o||(o=new SortedSet(__PRIVATE_primitiveComparator),this.qe=this.qe.insert(e,o)),o}je(e){const o=this.Ye(e)!==null;return o||__PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",e),o}Ye(e){const o=this.Be.get(e);return o&&o.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new __PRIVATE_TargetState),this.Le.getRemoteKeysForTarget(e).forEach(o=>{this.We(e,o,null)})}ot(e,o){return this.Le.getRemoteKeysForTarget(e).has(o)}}function __PRIVATE_documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}const Ie={asc:"ASCENDING",desc:"DESCENDING"},Ee={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},de={and:"AND",or:"OR"};class JsonProtoSerializer{constructor(e,o){this.databaseId=e,this.useProto3Json=o}}function __PRIVATE_toInt32Proto(i,e){return i.useProto3Json||__PRIVATE_isNullOrUndefined(e)?e:{value:e}}function toTimestamp(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __PRIVATE_toBytes(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function __PRIVATE_toVersion(i,e){return toTimestamp(i,e.toTimestamp())}function __PRIVATE_fromVersion(i){return __PRIVATE_hardAssert(!!i),SnapshotVersion.fromTimestamp(function(o){const s=__PRIVATE_normalizeTimestamp(o);return new Timestamp(s.seconds,s.nanos)}(i))}function __PRIVATE_toResourceName(i,e){return __PRIVATE_toResourcePath(i,e).canonicalString()}function __PRIVATE_toResourcePath(i,e){const o=function(c){return new ResourcePath(["projects",c.projectId,"databases",c.database])}(i).child("documents");return e===void 0?o:o.child(e)}function __PRIVATE_fromResourceName(i){const e=ResourcePath.fromString(i);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName(e)),e}function __PRIVATE_toName(i,e){return __PRIVATE_toResourceName(i.databaseId,e.path)}function fromName(i,e){const o=__PRIVATE_fromResourceName(e);if(o.get(1)!==i.databaseId.projectId)throw new FirestoreError(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+o.get(1)+" vs "+i.databaseId.projectId);if(o.get(3)!==i.databaseId.database)throw new FirestoreError(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+o.get(3)+" vs "+i.databaseId.database);return new DocumentKey(__PRIVATE_extractLocalPathFromResourceName(o))}function __PRIVATE_toQueryPath(i,e){return __PRIVATE_toResourceName(i.databaseId,e)}function __PRIVATE_fromQueryPath(i){const e=__PRIVATE_fromResourceName(i);return e.length===4?ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName(e)}function __PRIVATE_getEncodedDatabaseId(i){return new ResourcePath(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(i){return __PRIVATE_hardAssert(i.length>4&&i.get(4)==="documents"),i.popFirst(5)}function __PRIVATE_toMutationDocument(i,e,o){return{name:__PRIVATE_toName(i,e),fields:o.value.mapValue.fields}}function __PRIVATE_fromWatchChange(i,e){let o;if("targetChange"in e){e.targetChange;const s=function(tt){return tt==="NO_CHANGE"?0:tt==="ADD"?1:tt==="REMOVE"?2:tt==="CURRENT"?3:tt==="RESET"?4:fail()}(e.targetChange.targetChangeType||"NO_CHANGE"),c=e.targetChange.targetIds||[],h=function(tt,et){return tt.useProto3Json?(__PRIVATE_hardAssert(et===void 0||typeof et=="string"),ByteString.fromBase64String(et||"")):(__PRIVATE_hardAssert(et===void 0||et instanceof Buffer||et instanceof Uint8Array),ByteString.fromUint8Array(et||new Uint8Array))}(i,e.targetChange.resumeToken),_=e.targetChange.cause,$=_&&function(tt){const et=tt.code===void 0?D.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(tt.code);return new FirestoreError(et,tt.message||"")}(_);o=new __PRIVATE_WatchTargetChange(s,c,h,$||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const c=fromName(i,s.document.name),h=__PRIVATE_fromVersion(s.document.updateTime),_=s.document.createTime?__PRIVATE_fromVersion(s.document.createTime):SnapshotVersion.min(),$=new ObjectValue$1({mapValue:{fields:s.document.fields}}),nt=MutableDocument.newFoundDocument(c,h,_,$),tt=s.targetIds||[],et=s.removedTargetIds||[];o=new __PRIVATE_DocumentWatchChange(tt,et,nt.key,nt)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const c=fromName(i,s.document),h=s.readTime?__PRIVATE_fromVersion(s.readTime):SnapshotVersion.min(),_=MutableDocument.newNoDocument(c,h),$=s.removedTargetIds||[];o=new __PRIVATE_DocumentWatchChange([],$,_.key,_)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const c=fromName(i,s.document),h=s.removedTargetIds||[];o=new __PRIVATE_DocumentWatchChange([],h,c,null)}else{if(!("filter"in e))return fail();{e.filter;const s=e.filter;s.targetId;const{count:c=0,unchangedNames:h}=s,_=new ExistenceFilter(c,h),$=s.targetId;o=new __PRIVATE_ExistenceFilterChange($,_)}}return o}function toMutation(i,e){let o;if(e instanceof __PRIVATE_SetMutation)o={update:__PRIVATE_toMutationDocument(i,e.key,e.value)};else if(e instanceof __PRIVATE_DeleteMutation)o={delete:__PRIVATE_toName(i,e.key)};else if(e instanceof __PRIVATE_PatchMutation)o={update:__PRIVATE_toMutationDocument(i,e.key,e.data),updateMask:__PRIVATE_toDocumentMask(e.fieldMask)};else{if(!(e instanceof __PRIVATE_VerifyMutation))return fail();o={verify:__PRIVATE_toName(i,e.key)}}return e.fieldTransforms.length>0&&(o.updateTransforms=e.fieldTransforms.map(s=>function(h,_){const $=_.transform;if($ instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:_.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if($ instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:_.field.canonicalString(),appendMissingElements:{values:$.elements}};if($ instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:_.field.canonicalString(),removeAllFromArray:{values:$.elements}};if($ instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:_.field.canonicalString(),increment:$.Pe};throw fail()}(0,s))),e.precondition.isNone||(o.currentDocument=function(c,h){return h.updateTime!==void 0?{updateTime:__PRIVATE_toVersion(c,h.updateTime)}:h.exists!==void 0?{exists:h.exists}:fail()}(i,e.precondition)),o}function __PRIVATE_fromWriteResults(i,e){return i&&i.length>0?(__PRIVATE_hardAssert(e!==void 0),i.map(o=>function(c,h){let _=c.updateTime?__PRIVATE_fromVersion(c.updateTime):__PRIVATE_fromVersion(h);return _.isEqual(SnapshotVersion.min())&&(_=__PRIVATE_fromVersion(h)),new MutationResult(_,c.transformResults||[])}(o,e))):[]}function __PRIVATE_toDocumentsTarget(i,e){return{documents:[__PRIVATE_toQueryPath(i,e.path)]}}function __PRIVATE_toQueryTarget(i,e){const o={structuredQuery:{}},s=e.path;let c;e.collectionGroup!==null?(c=s,o.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(c=s.popLast(),o.structuredQuery.from=[{collectionId:s.lastSegment()}]),o.parent=__PRIVATE_toQueryPath(i,c);const h=function(tt){if(tt.length!==0)return __PRIVATE_toFilter(CompositeFilter.create(tt,"and"))}(e.filters);h&&(o.structuredQuery.where=h);const _=function(tt){if(tt.length!==0)return tt.map(et=>function(a){return{field:__PRIVATE_toFieldPathReference(a.field),direction:__PRIVATE_toDirection(a.dir)}}(et))}(e.orderBy);_&&(o.structuredQuery.orderBy=_);const $=__PRIVATE_toInt32Proto(i,e.limit);return $!==null&&(o.structuredQuery.limit=$),e.startAt&&(o.structuredQuery.startAt=function(tt){return{before:tt.inclusive,values:tt.position}}(e.startAt)),e.endAt&&(o.structuredQuery.endAt=function(tt){return{before:!tt.inclusive,values:tt.position}}(e.endAt)),{ct:o,parent:c}}function __PRIVATE_convertQueryTargetToQuery(i){let e=__PRIVATE_fromQueryPath(i.parent);const o=i.structuredQuery,s=o.from?o.from.length:0;let c=null;if(s>0){__PRIVATE_hardAssert(s===1);const et=o.from[0];et.allDescendants?c=et.collectionId:e=e.child(et.collectionId)}let h=[];o.where&&(h=function(d){const a=__PRIVATE_fromFilter(d);return a instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlatConjunction(a)?a.getFilters():[a]}(o.where));let _=[];o.orderBy&&(_=function(d){return d.map(a=>function(j){return new OrderBy(__PRIVATE_fromFieldPathReference(j.field),function(ot){switch(ot){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(j.direction))}(a))}(o.orderBy));let $=null;o.limit&&($=function(d){let a;return a=typeof d=="object"?d.value:d,__PRIVATE_isNullOrUndefined(a)?null:a}(o.limit));let nt=null;o.startAt&&(nt=function(d){const a=!!d.before,g=d.values||[];return new Bound(g,a)}(o.startAt));let tt=null;return o.endAt&&(tt=function(d){const a=!d.before,g=d.values||[];return new Bound(g,a)}(o.endAt)),__PRIVATE_newQuery(e,c,_,h,$,"F",nt,tt)}function __PRIVATE_toListenRequestLabels(i,e){const o=function(c){switch(c){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fail()}}(e.purpose);return o==null?null:{"goog-listen-tags":o}}function __PRIVATE_fromFilter(i){return i.unaryFilter!==void 0?function(o){switch(o.unaryFilter.op){case"IS_NAN":const s=__PRIVATE_fromFieldPathReference(o.unaryFilter.field);return FieldFilter.create(s,"==",{doubleValue:NaN});case"IS_NULL":const c=__PRIVATE_fromFieldPathReference(o.unaryFilter.field);return FieldFilter.create(c,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const h=__PRIVATE_fromFieldPathReference(o.unaryFilter.field);return FieldFilter.create(h,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const _=__PRIVATE_fromFieldPathReference(o.unaryFilter.field);return FieldFilter.create(_,"!=",{nullValue:"NULL_VALUE"});default:return fail()}}(i):i.fieldFilter!==void 0?function(o){return FieldFilter.create(__PRIVATE_fromFieldPathReference(o.fieldFilter.field),function(c){switch(c){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return fail()}}(o.fieldFilter.op),o.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(o){return CompositeFilter.create(o.compositeFilter.filters.map(s=>__PRIVATE_fromFilter(s)),function(c){switch(c){case"AND":return"and";case"OR":return"or";default:return fail()}}(o.compositeFilter.op))}(i):fail()}function __PRIVATE_toDirection(i){return Ie[i]}function __PRIVATE_toOperatorName(i){return Ee[i]}function __PRIVATE_toCompositeOperatorName(i){return de[i]}function __PRIVATE_toFieldPathReference(i){return{fieldPath:i.canonicalString()}}function __PRIVATE_fromFieldPathReference(i){return FieldPath$1.fromServerFormat(i.fieldPath)}function __PRIVATE_toFilter(i){return i instanceof FieldFilter?function(o){if(o.op==="=="){if(__PRIVATE_isNanValue(o.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(o.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(o.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(o.field),op:"IS_NULL"}}}else if(o.op==="!="){if(__PRIVATE_isNanValue(o.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(o.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(o.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(o.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(o.field),op:__PRIVATE_toOperatorName(o.op),value:o.value}}}(i):i instanceof CompositeFilter?function(o){const s=o.getFilters().map(c=>__PRIVATE_toFilter(c));return s.length===1?s[0]:{compositeFilter:{op:__PRIVATE_toCompositeOperatorName(o.op),filters:s}}}(i):fail()}function __PRIVATE_toDocumentMask(i){const e=[];return i.fields.forEach(o=>e.push(o.canonicalString())),{fieldPaths:e}}function __PRIVATE_isValidResourceName(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TargetData{constructor(e,o,s,c,h=SnapshotVersion.min(),_=SnapshotVersion.min(),$=ByteString.EMPTY_BYTE_STRING,nt=null){this.target=e,this.targetId=o,this.purpose=s,this.sequenceNumber=c,this.snapshotVersion=h,this.lastLimboFreeSnapshotVersion=_,this.resumeToken=$,this.expectedCount=nt}withSequenceNumber(e){return new TargetData(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,o){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,o,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalSerializer{constructor(e){this.ht=e}}function __PRIVATE_fromBundledQuery(i){const e=__PRIVATE_convertQueryTargetToQuery({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?__PRIVATE_queryWithLimit(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryIndexManager{constructor(){this.ln=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex(e,o){return this.ln.add(o),PersistencePromise.resolve()}getCollectionParents(e,o){return PersistencePromise.resolve(this.ln.getEntries(o))}addFieldIndex(e,o){return PersistencePromise.resolve()}deleteFieldIndex(e,o){return PersistencePromise.resolve()}deleteAllFieldIndexes(e){return PersistencePromise.resolve()}createTargetIndexes(e,o){return PersistencePromise.resolve()}getDocumentsMatchingTarget(e,o){return PersistencePromise.resolve(null)}getIndexType(e,o){return PersistencePromise.resolve(0)}getFieldIndexes(e,o){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate(e){return PersistencePromise.resolve(null)}getMinOffset(e,o){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup(e,o){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup(e,o,s){return PersistencePromise.resolve()}updateIndexEntries(e,o){return PersistencePromise.resolve()}}class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add(e){const o=e.lastSegment(),s=e.popLast(),c=this.index[o]||new SortedSet(ResourcePath.comparator),h=!c.has(s);return this.index[o]=c.add(s),h}has(e){const o=e.lastSegment(),s=e.popLast(),c=this.index[o];return c&&c.has(s)}getEntries(e){return(this.index[e]||new SortedSet(ResourcePath.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class LruParams{static withCacheSize(e){return new LruParams(e,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,o,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=o,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */LruParams.DEFAULT_COLLECTION_PERCENTILE=10,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,LruParams.DEFAULT=new LruParams(41943040,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),LruParams.DISABLED=new LruParams(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetIdGenerator{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new __PRIVATE_TargetIdGenerator(0)}static Qn(){return new __PRIVATE_TargetIdGenerator(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_bufferEntryComparator([i,e],[o,s]){const c=__PRIVATE_primitiveComparator(i,o);return c===0?__PRIVATE_primitiveComparator(e,s):c}class __PRIVATE_RollingSequenceNumberBuffer{constructor(e){this.Gn=e,this.buffer=new SortedSet(__PRIVATE_bufferEntryComparator),this.zn=0}jn(){return++this.zn}Hn(e){const o=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(o);else{const s=this.buffer.last();__PRIVATE_bufferEntryComparator(o,s)<0&&(this.buffer=this.buffer.delete(s).add(o))}}get maxValue(){return this.buffer.last()[0]}}class __PRIVATE_LruScheduler{constructor(e,o,s){this.garbageCollector=e,this.asyncQueue=o,this.localStore=s,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){__PRIVATE_logDebug("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(o){__PRIVATE_isIndexedDbTransactionError(o)?__PRIVATE_logDebug("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",o):await __PRIVATE_ignoreIfPrimaryLeaseLoss(o)}await this.Yn(3e5)})}}class __PRIVATE_LruGarbageCollectorImpl{constructor(e,o){this.Zn=e,this.params=o}calculateTargetCount(e,o){return this.Zn.Xn(e).next(s=>Math.floor(o/100*s))}nthSequenceNumber(e,o){if(o===0)return PersistencePromise.resolve(__PRIVATE_ListenSequence.oe);const s=new __PRIVATE_RollingSequenceNumberBuffer(o);return this.Zn.forEachTarget(e,c=>s.Hn(c.sequenceNumber)).next(()=>this.Zn.er(e,c=>s.Hn(c))).next(()=>s.maxValue)}removeTargets(e,o,s){return this.Zn.removeTargets(e,o,s)}removeOrphanedDocuments(e,o){return this.Zn.removeOrphanedDocuments(e,o)}collect(e,o){return this.params.cacheSizeCollectionThreshold===-1?(__PRIVATE_logDebug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(Re)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(__PRIVATE_logDebug("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Re):this.tr(e,o))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,o){let s,c,h,_,$,nt,tt;const et=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(__PRIVATE_logDebug("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),c=this.params.maximumSequenceNumbersToCollect):c=d,_=Date.now(),this.nthSequenceNumber(e,c))).next(d=>(s=d,$=Date.now(),this.removeTargets(e,s,o))).next(d=>(h=d,nt=Date.now(),this.removeOrphanedDocuments(e,s))).next(d=>(tt=Date.now(),__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${_-et}ms
	Determined least recently used ${c} in `+($-_)+`ms
	Removed ${h} targets in `+(nt-$)+`ms
	Removed ${d} documents in `+(tt-nt)+`ms
Total Duration: ${tt-et}ms`),PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:c,targetsRemoved:h,documentsRemoved:d})))}}function __PRIVATE_newLruGarbageCollector(i,e){return new __PRIVATE_LruGarbageCollectorImpl(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap(e=>e.toString(),(e,o)=>e.isEqual(o)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,o){this.assertNotApplied(),this.changes.set(e,MutableDocument.newInvalidDocument(e).setReadTime(o))}getEntry(e,o){this.assertNotApplied();const s=this.changes.get(o);return s!==void 0?PersistencePromise.resolve(s):this.getFromCache(e,o)}getEntries(e,o){return this.getAllFromCache(e,o)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OverlayedDocument{constructor(e,o){this.overlayedDocument=e,this.mutatedFields=o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LocalDocumentsView{constructor(e,o,s,c){this.remoteDocumentCache=e,this.mutationQueue=o,this.documentOverlayCache=s,this.indexManager=c}getDocument(e,o){let s=null;return this.documentOverlayCache.getOverlay(e,o).next(c=>(s=c,this.remoteDocumentCache.getEntry(e,o))).next(c=>(s!==null&&__PRIVATE_mutationApplyToLocalView(s.mutation,c,FieldMask.empty(),Timestamp.now()),c))}getDocuments(e,o){return this.remoteDocumentCache.getEntries(e,o).next(s=>this.getLocalViewOfDocuments(e,s,__PRIVATE_documentKeySet()).next(()=>s))}getLocalViewOfDocuments(e,o,s=__PRIVATE_documentKeySet()){const c=__PRIVATE_newOverlayMap();return this.populateOverlays(e,c,o).next(()=>this.computeViews(e,o,c,s).next(h=>{let _=documentMap();return h.forEach(($,nt)=>{_=_.insert($,nt.overlayedDocument)}),_}))}getOverlayedDocuments(e,o){const s=__PRIVATE_newOverlayMap();return this.populateOverlays(e,s,o).next(()=>this.computeViews(e,o,s,__PRIVATE_documentKeySet()))}populateOverlays(e,o,s){const c=[];return s.forEach(h=>{o.has(h)||c.push(h)}),this.documentOverlayCache.getOverlays(e,c).next(h=>{h.forEach((_,$)=>{o.set(_,$)})})}computeViews(e,o,s,c){let h=__PRIVATE_mutableDocumentMap();const _=__PRIVATE_newDocumentKeyMap(),$=function(){return __PRIVATE_newDocumentKeyMap()}();return o.forEach((nt,tt)=>{const et=s.get(tt.key);c.has(tt.key)&&(et===void 0||et.mutation instanceof __PRIVATE_PatchMutation)?h=h.insert(tt.key,tt):et!==void 0?(_.set(tt.key,et.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(et.mutation,tt,et.mutation.getFieldMask(),Timestamp.now())):_.set(tt.key,FieldMask.empty())}),this.recalculateAndSaveOverlays(e,h).next(nt=>(nt.forEach((tt,et)=>_.set(tt,et)),o.forEach((tt,et)=>{var d;return $.set(tt,new OverlayedDocument(et,(d=_.get(tt))!==null&&d!==void 0?d:null))}),$))}recalculateAndSaveOverlays(e,o){const s=__PRIVATE_newDocumentKeyMap();let c=new SortedMap((_,$)=>_-$),h=__PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,o).next(_=>{for(const $ of _)$.keys().forEach(nt=>{const tt=o.get(nt);if(tt===null)return;let et=s.get(nt)||FieldMask.empty();et=$.applyToLocalView(tt,et),s.set(nt,et);const d=(c.get($.batchId)||__PRIVATE_documentKeySet()).add(nt);c=c.insert($.batchId,d)})}).next(()=>{const _=[],$=c.getReverseIterator();for(;$.hasNext();){const nt=$.getNext(),tt=nt.key,et=nt.value,d=__PRIVATE_newMutationMap();et.forEach(a=>{if(!h.has(a)){const g=__PRIVATE_calculateOverlayMutation(o.get(a),s.get(a));g!==null&&d.set(a,g),h=h.add(a)}}),_.push(this.documentOverlayCache.saveOverlays(e,tt,d))}return PersistencePromise.waitFor(_)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,o){return this.remoteDocumentCache.getEntries(e,o).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,o,s,c){return function(_){return DocumentKey.isDocumentKey(_.path)&&_.collectionGroup===null&&_.filters.length===0}(o)?this.getDocumentsMatchingDocumentQuery(e,o.path):__PRIVATE_isCollectionGroupQuery(o)?this.getDocumentsMatchingCollectionGroupQuery(e,o,s,c):this.getDocumentsMatchingCollectionQuery(e,o,s,c)}getNextDocuments(e,o,s,c){return this.remoteDocumentCache.getAllFromCollectionGroup(e,o,s,c).next(h=>{const _=c-h.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,o,s.largestBatchId,c-h.size):PersistencePromise.resolve(__PRIVATE_newOverlayMap());let $=-1,nt=h;return _.next(tt=>PersistencePromise.forEach(tt,(et,d)=>($<d.largestBatchId&&($=d.largestBatchId),h.get(et)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry(e,et).next(a=>{nt=nt.insert(et,a)}))).next(()=>this.populateOverlays(e,tt,h)).next(()=>this.computeViews(e,nt,tt,__PRIVATE_documentKeySet())).next(et=>({batchId:$,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(et)})))})}getDocumentsMatchingDocumentQuery(e,o){return this.getDocument(e,new DocumentKey(o)).next(s=>{let c=documentMap();return s.isFoundDocument()&&(c=c.insert(s.key,s)),c})}getDocumentsMatchingCollectionGroupQuery(e,o,s,c){const h=o.collectionGroup;let _=documentMap();return this.indexManager.getCollectionParents(e,h).next($=>PersistencePromise.forEach($,nt=>{const tt=function(d,a){return new __PRIVATE_QueryImpl(a,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(o,nt.child(h));return this.getDocumentsMatchingCollectionQuery(e,tt,s,c).next(et=>{et.forEach((d,a)=>{_=_.insert(d,a)})})}).next(()=>_))}getDocumentsMatchingCollectionQuery(e,o,s,c){let h;return this.documentOverlayCache.getOverlaysForCollection(e,o.path,s.largestBatchId).next(_=>(h=_,this.remoteDocumentCache.getDocumentsMatchingQuery(e,o,s,h,c))).next(_=>{h.forEach((nt,tt)=>{const et=tt.getKey();_.get(et)===null&&(_=_.insert(et,MutableDocument.newInvalidDocument(et)))});let $=documentMap();return _.forEach((nt,tt)=>{const et=h.get(nt);et!==void 0&&__PRIVATE_mutationApplyToLocalView(et.mutation,tt,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(o,tt)&&($=$.insert(nt,tt))}),$})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryBundleCache{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,o){return PersistencePromise.resolve(this.Tr.get(o))}saveBundleMetadata(e,o){return this.Tr.set(o.id,function(c){return{id:c.id,version:c.version,createTime:__PRIVATE_fromVersion(c.createTime)}}(o)),PersistencePromise.resolve()}getNamedQuery(e,o){return PersistencePromise.resolve(this.Ir.get(o))}saveNamedQuery(e,o){return this.Ir.set(o.name,function(c){return{name:c.name,query:__PRIVATE_fromBundledQuery(c.bundledQuery),readTime:__PRIVATE_fromVersion(c.readTime)}}(o)),PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(DocumentKey.comparator),this.Er=new Map}getOverlay(e,o){return PersistencePromise.resolve(this.overlays.get(o))}getOverlays(e,o){const s=__PRIVATE_newOverlayMap();return PersistencePromise.forEach(o,c=>this.getOverlay(e,c).next(h=>{h!==null&&s.set(c,h)})).next(()=>s)}saveOverlays(e,o,s){return s.forEach((c,h)=>{this.Tt(e,o,h)}),PersistencePromise.resolve()}removeOverlaysForBatchId(e,o,s){const c=this.Er.get(s);return c!==void 0&&(c.forEach(h=>this.overlays=this.overlays.remove(h)),this.Er.delete(s)),PersistencePromise.resolve()}getOverlaysForCollection(e,o,s){const c=__PRIVATE_newOverlayMap(),h=o.length+1,_=new DocumentKey(o.child("")),$=this.overlays.getIteratorFrom(_);for(;$.hasNext();){const nt=$.getNext().value,tt=nt.getKey();if(!o.isPrefixOf(tt.path))break;tt.path.length===h&&nt.largestBatchId>s&&c.set(nt.getKey(),nt)}return PersistencePromise.resolve(c)}getOverlaysForCollectionGroup(e,o,s,c){let h=new SortedMap((tt,et)=>tt-et);const _=this.overlays.getIterator();for(;_.hasNext();){const tt=_.getNext().value;if(tt.getKey().getCollectionGroup()===o&&tt.largestBatchId>s){let et=h.get(tt.largestBatchId);et===null&&(et=__PRIVATE_newOverlayMap(),h=h.insert(tt.largestBatchId,et)),et.set(tt.getKey(),tt)}}const $=__PRIVATE_newOverlayMap(),nt=h.getIterator();for(;nt.hasNext()&&(nt.getNext().value.forEach((tt,et)=>$.set(tt,et)),!($.size()>=c)););return PersistencePromise.resolve($)}Tt(e,o,s){const c=this.overlays.get(s.key);if(c!==null){const _=this.Er.get(c.largestBatchId).delete(s.key);this.Er.set(c.largestBatchId,_)}this.overlays=this.overlays.insert(s.key,new Overlay(o,s));let h=this.Er.get(o);h===void 0&&(h=__PRIVATE_documentKeySet(),this.Er.set(o,h)),this.Er.set(o,h.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryGlobalsCache{constructor(){this.sessionToken=ByteString.EMPTY_BYTE_STRING}getSessionToken(e){return PersistencePromise.resolve(this.sessionToken)}setSessionToken(e,o){return this.sessionToken=o,PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ReferenceSet{constructor(){this.dr=new SortedSet(__PRIVATE_DocReference.Ar),this.Rr=new SortedSet(__PRIVATE_DocReference.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,o){const s=new __PRIVATE_DocReference(e,o);this.dr=this.dr.add(s),this.Rr=this.Rr.add(s)}mr(e,o){e.forEach(s=>this.addReference(s,o))}removeReference(e,o){this.gr(new __PRIVATE_DocReference(e,o))}pr(e,o){e.forEach(s=>this.removeReference(s,o))}yr(e){const o=new DocumentKey(new ResourcePath([])),s=new __PRIVATE_DocReference(o,e),c=new __PRIVATE_DocReference(o,e+1),h=[];return this.Rr.forEachInRange([s,c],_=>{this.gr(_),h.push(_.key)}),h}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const o=new DocumentKey(new ResourcePath([])),s=new __PRIVATE_DocReference(o,e),c=new __PRIVATE_DocReference(o,e+1);let h=__PRIVATE_documentKeySet();return this.Rr.forEachInRange([s,c],_=>{h=h.add(_.key)}),h}containsKey(e){const o=new __PRIVATE_DocReference(e,0),s=this.dr.firstAfterOrEqual(o);return s!==null&&e.isEqual(s.key)}}class __PRIVATE_DocReference{constructor(e,o){this.key=e,this.br=o}static Ar(e,o){return DocumentKey.comparator(e.key,o.key)||__PRIVATE_primitiveComparator(e.br,o.br)}static Vr(e,o){return __PRIVATE_primitiveComparator(e.br,o.br)||DocumentKey.comparator(e.key,o.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryMutationQueue{constructor(e,o){this.indexManager=e,this.referenceDelegate=o,this.mutationQueue=[],this.Dr=1,this.vr=new SortedSet(__PRIVATE_DocReference.Ar)}checkEmpty(e){return PersistencePromise.resolve(this.mutationQueue.length===0)}addMutationBatch(e,o,s,c){const h=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const _=new MutationBatch(h,o,s,c);this.mutationQueue.push(_);for(const $ of c)this.vr=this.vr.add(new __PRIVATE_DocReference($.key,h)),this.indexManager.addToCollectionParentIndex(e,$.key.path.popLast());return PersistencePromise.resolve(_)}lookupMutationBatch(e,o){return PersistencePromise.resolve(this.Cr(o))}getNextMutationBatchAfterBatchId(e,o){const s=o+1,c=this.Fr(s),h=c<0?0:c;return PersistencePromise.resolve(this.mutationQueue.length>h?this.mutationQueue[h]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,o){const s=new __PRIVATE_DocReference(o,0),c=new __PRIVATE_DocReference(o,Number.POSITIVE_INFINITY),h=[];return this.vr.forEachInRange([s,c],_=>{const $=this.Cr(_.br);h.push($)}),PersistencePromise.resolve(h)}getAllMutationBatchesAffectingDocumentKeys(e,o){let s=new SortedSet(__PRIVATE_primitiveComparator);return o.forEach(c=>{const h=new __PRIVATE_DocReference(c,0),_=new __PRIVATE_DocReference(c,Number.POSITIVE_INFINITY);this.vr.forEachInRange([h,_],$=>{s=s.add($.br)})}),PersistencePromise.resolve(this.Mr(s))}getAllMutationBatchesAffectingQuery(e,o){const s=o.path,c=s.length+1;let h=s;DocumentKey.isDocumentKey(h)||(h=h.child(""));const _=new __PRIVATE_DocReference(new DocumentKey(h),0);let $=new SortedSet(__PRIVATE_primitiveComparator);return this.vr.forEachWhile(nt=>{const tt=nt.key.path;return!!s.isPrefixOf(tt)&&(tt.length===c&&($=$.add(nt.br)),!0)},_),PersistencePromise.resolve(this.Mr($))}Mr(e){const o=[];return e.forEach(s=>{const c=this.Cr(s);c!==null&&o.push(c)}),o}removeMutationBatch(e,o){__PRIVATE_hardAssert(this.Or(o.batchId,"removed")===0),this.mutationQueue.shift();let s=this.vr;return PersistencePromise.forEach(o.mutations,c=>{const h=new __PRIVATE_DocReference(c.key,o.batchId);return s=s.delete(h),this.referenceDelegate.markPotentiallyOrphaned(e,c.key)}).next(()=>{this.vr=s})}Ln(e){}containsKey(e,o){const s=new __PRIVATE_DocReference(o,0),c=this.vr.firstAfterOrEqual(s);return PersistencePromise.resolve(o.isEqual(c&&c.key))}performConsistencyCheck(e){return this.mutationQueue.length,PersistencePromise.resolve()}Or(e,o){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const o=this.Fr(e);return o<0||o>=this.mutationQueue.length?null:this.mutationQueue[o]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor(e){this.Nr=e,this.docs=function(){return new SortedMap(DocumentKey.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,o){const s=o.key,c=this.docs.get(s),h=c?c.size:0,_=this.Nr(o);return this.docs=this.docs.insert(s,{document:o.mutableCopy(),size:_}),this.size+=_-h,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const o=this.docs.get(e);o&&(this.docs=this.docs.remove(e),this.size-=o.size)}getEntry(e,o){const s=this.docs.get(o);return PersistencePromise.resolve(s?s.document.mutableCopy():MutableDocument.newInvalidDocument(o))}getEntries(e,o){let s=__PRIVATE_mutableDocumentMap();return o.forEach(c=>{const h=this.docs.get(c);s=s.insert(c,h?h.document.mutableCopy():MutableDocument.newInvalidDocument(c))}),PersistencePromise.resolve(s)}getDocumentsMatchingQuery(e,o,s,c){let h=__PRIVATE_mutableDocumentMap();const _=o.path,$=new DocumentKey(_.child("")),nt=this.docs.getIteratorFrom($);for(;nt.hasNext();){const{key:tt,value:{document:et}}=nt.getNext();if(!_.isPrefixOf(tt.path))break;tt.path.length>_.length+1||__PRIVATE_indexOffsetComparator(__PRIVATE_newIndexOffsetFromDocument(et),s)<=0||(c.has(et.key)||__PRIVATE_queryMatches(o,et))&&(h=h.insert(et.key,et.mutableCopy()))}return PersistencePromise.resolve(h)}getAllFromCollectionGroup(e,o,s,c){fail()}Lr(e,o){return PersistencePromise.forEach(this.docs,s=>o(s))}newChangeBuffer(e){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize(e){return PersistencePromise.resolve(this.size)}}class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor(e){super(),this.hr=e}applyChanges(e){const o=[];return this.changes.forEach((s,c)=>{c.isValidDocument()?o.push(this.hr.addEntry(e,c)):this.hr.removeEntry(s)}),PersistencePromise.waitFor(o)}getFromCache(e,o){return this.hr.getEntry(e,o)}getAllFromCache(e,o){return this.hr.getEntries(e,o)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryTargetCache{constructor(e){this.persistence=e,this.Br=new ObjectMap(o=>__PRIVATE_canonifyTarget(o),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this.kr=0,this.qr=new __PRIVATE_ReferenceSet,this.targetCount=0,this.Qr=__PRIVATE_TargetIdGenerator.qn()}forEachTarget(e,o){return this.Br.forEach((s,c)=>o(c)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return PersistencePromise.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata(e,o,s){return s&&(this.lastRemoteSnapshotVersion=s),o>this.kr&&(this.kr=o),PersistencePromise.resolve()}Un(e){this.Br.set(e.target,e);const o=e.targetId;o>this.highestTargetId&&(this.Qr=new __PRIVATE_TargetIdGenerator(o),this.highestTargetId=o),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,o){return this.Un(o),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData(e,o){return this.Un(o),PersistencePromise.resolve()}removeTargetData(e,o){return this.Br.delete(o.target),this.qr.yr(o.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets(e,o,s){let c=0;const h=[];return this.Br.forEach((_,$)=>{$.sequenceNumber<=o&&s.get($.targetId)===null&&(this.Br.delete(_),h.push(this.removeMatchingKeysForTargetId(e,$.targetId)),c++)}),PersistencePromise.waitFor(h).next(()=>c)}getTargetCount(e){return PersistencePromise.resolve(this.targetCount)}getTargetData(e,o){const s=this.Br.get(o)||null;return PersistencePromise.resolve(s)}addMatchingKeys(e,o,s){return this.qr.mr(o,s),PersistencePromise.resolve()}removeMatchingKeys(e,o,s){this.qr.pr(o,s);const c=this.persistence.referenceDelegate,h=[];return c&&o.forEach(_=>{h.push(c.markPotentiallyOrphaned(e,_))}),PersistencePromise.waitFor(h)}removeMatchingKeysForTargetId(e,o){return this.qr.yr(o),PersistencePromise.resolve()}getMatchingKeysForTargetId(e,o){const s=this.qr.Sr(o);return PersistencePromise.resolve(s)}containsKey(e,o){return PersistencePromise.resolve(this.qr.containsKey(o))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryPersistence{constructor(e,o){this.Kr={},this.overlays={},this.$r=new __PRIVATE_ListenSequence(0),this.Ur=!1,this.Ur=!0,this.Wr=new __PRIVATE_MemoryGlobalsCache,this.referenceDelegate=e(this),this.Gr=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=function(c){return new __PRIVATE_MemoryRemoteDocumentCacheImpl(c)}(s=>this.referenceDelegate.zr(s)),this.serializer=new __PRIVATE_LocalSerializer(o),this.jr=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let o=this.overlays[e.toKey()];return o||(o=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[e.toKey()]=o),o}getMutationQueue(e,o){let s=this.Kr[e.toKey()];return s||(s=new __PRIVATE_MemoryMutationQueue(o,this.referenceDelegate),this.Kr[e.toKey()]=s),s}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,o,s){__PRIVATE_logDebug("MemoryPersistence","Starting transaction:",e);const c=new __PRIVATE_MemoryTransaction(this.$r.next());return this.referenceDelegate.Hr(),s(c).next(h=>this.referenceDelegate.Jr(c).next(()=>h)).toPromise().then(h=>(c.raiseOnCommittedEvent(),h))}Yr(e,o){return PersistencePromise.or(Object.values(this.Kr).map(s=>()=>s.containsKey(e,o)))}}class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor(e){super(),this.currentSequenceNumber=e}}class __PRIVATE_MemoryEagerDelegate{constructor(e){this.persistence=e,this.Zr=new __PRIVATE_ReferenceSet,this.Xr=null}static ei(e){return new __PRIVATE_MemoryEagerDelegate(e)}get ti(){if(this.Xr)return this.Xr;throw fail()}addReference(e,o,s){return this.Zr.addReference(s,o),this.ti.delete(s.toString()),PersistencePromise.resolve()}removeReference(e,o,s){return this.Zr.removeReference(s,o),this.ti.add(s.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned(e,o){return this.ti.add(o.toString()),PersistencePromise.resolve()}removeTarget(e,o){this.Zr.yr(o.targetId).forEach(c=>this.ti.add(c.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,o.targetId).next(c=>{c.forEach(h=>this.ti.add(h.toString()))}).next(()=>s.removeTargetData(e,o))}Hr(){this.Xr=new Set}Jr(e){const o=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.ti,s=>{const c=DocumentKey.fromPath(s);return this.ni(e,c).next(h=>{h||o.removeEntry(c,SnapshotVersion.min())})}).next(()=>(this.Xr=null,o.apply(e)))}updateLimboDocument(e,o){return this.ni(e,o).next(s=>{s?this.ti.delete(o.toString()):this.ti.add(o.toString())})}zr(e){return 0}ni(e,o){return PersistencePromise.or([()=>PersistencePromise.resolve(this.Zr.containsKey(o)),()=>this.persistence.getTargetCache().containsKey(e,o),()=>this.persistence.Yr(e,o)])}}class __PRIVATE_MemoryLruDelegate{constructor(e,o){this.persistence=e,this.ri=new ObjectMap(s=>__PRIVATE_encodeResourcePath(s.path),(s,c)=>s.isEqual(c)),this.garbageCollector=__PRIVATE_newLruGarbageCollector(this,o)}static ei(e,o){return new __PRIVATE_MemoryLruDelegate(e,o)}Hr(){}Jr(e){return PersistencePromise.resolve()}forEachTarget(e,o){return this.persistence.getTargetCache().forEachTarget(e,o)}Xn(e){const o=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>o.next(c=>s+c))}nr(e){let o=0;return this.er(e,s=>{o++}).next(()=>o)}er(e,o){return PersistencePromise.forEach(this.ri,(s,c)=>this.ir(e,s,c).next(h=>h?PersistencePromise.resolve():o(c)))}removeTargets(e,o,s){return this.persistence.getTargetCache().removeTargets(e,o,s)}removeOrphanedDocuments(e,o){let s=0;const c=this.persistence.getRemoteDocumentCache(),h=c.newChangeBuffer();return c.Lr(e,_=>this.ir(e,_,o).next($=>{$||(s++,h.removeEntry(_,SnapshotVersion.min()))})).next(()=>h.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,o){return this.ri.set(o,e.currentSequenceNumber),PersistencePromise.resolve()}removeTarget(e,o){const s=o.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,o,s){return this.ri.set(s,e.currentSequenceNumber),PersistencePromise.resolve()}removeReference(e,o,s){return this.ri.set(s,e.currentSequenceNumber),PersistencePromise.resolve()}updateLimboDocument(e,o){return this.ri.set(o,e.currentSequenceNumber),PersistencePromise.resolve()}zr(e){let o=e.key.toString().length;return e.isFoundDocument()&&(o+=__PRIVATE_estimateByteSize(e.data.value)),o}ir(e,o,s){return PersistencePromise.or([()=>this.persistence.Yr(e,o),()=>this.persistence.getTargetCache().containsKey(e,o),()=>{const c=this.ri.get(o);return PersistencePromise.resolve(c!==void 0&&c>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalViewChanges{constructor(e,o,s,c){this.targetId=e,this.fromCache=o,this.Wi=s,this.Gi=c}static zi(e,o){let s=__PRIVATE_documentKeySet(),c=__PRIVATE_documentKeySet();for(const h of o.docChanges)switch(h.type){case 0:s=s.add(h.doc.key);break;case 1:c=c.add(h.doc.key)}return new __PRIVATE_LocalViewChanges(e,o.fromCache,s,c)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryEngine{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return isSafari()?8:__PRIVATE_getAndroidVersion(getUA())>0?6:4}()}initialize(e,o){this.Zi=e,this.indexManager=o,this.ji=!0}getDocumentsMatchingQuery(e,o,s,c){const h={result:null};return this.Xi(e,o).next(_=>{h.result=_}).next(()=>{if(!h.result)return this.es(e,o,c,s).next(_=>{h.result=_})}).next(()=>{if(h.result)return;const _=new QueryContext;return this.ts(e,o,_).next($=>{if(h.result=$,this.Hi)return this.ns(e,o,_,$.size)})}).next(()=>h.result)}ns(e,o,s,c){return s.documentReadCount<this.Ji?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(o),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(o),"scans",s.documentReadCount,"local documents and returns",c,"documents as results."),s.documentReadCount>this.Yi*c?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(o),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,__PRIVATE_queryToTarget(o))):PersistencePromise.resolve())}Xi(e,o){if(__PRIVATE_queryMatchesAllDocuments(o))return PersistencePromise.resolve(null);let s=__PRIVATE_queryToTarget(o);return this.indexManager.getIndexType(e,s).next(c=>c===0?null:(o.limit!==null&&c===1&&(o=__PRIVATE_queryWithLimit(o,null,"F"),s=__PRIVATE_queryToTarget(o)),this.indexManager.getDocumentsMatchingTarget(e,s).next(h=>{const _=__PRIVATE_documentKeySet(...h);return this.Zi.getDocuments(e,_).next($=>this.indexManager.getMinOffset(e,s).next(nt=>{const tt=this.rs(o,$);return this.ss(o,tt,_,nt.readTime)?this.Xi(e,__PRIVATE_queryWithLimit(o,null,"F")):this.os(e,tt,o,nt)}))})))}es(e,o,s,c){return __PRIVATE_queryMatchesAllDocuments(o)||c.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.Zi.getDocuments(e,s).next(h=>{const _=this.rs(o,h);return this.ss(o,_,s,c)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",c.toString(),__PRIVATE_stringifyQuery(o)),this.os(e,_,o,__PRIVATE_newIndexOffsetSuccessorFromReadTime(c,-1)).next($=>$))})}rs(e,o){let s=new SortedSet(__PRIVATE_newQueryComparator(e));return o.forEach((c,h)=>{__PRIVATE_queryMatches(e,h)&&(s=s.add(h))}),s}ss(e,o,s,c){if(e.limit===null)return!1;if(s.size!==o.size)return!0;const h=e.limitType==="F"?o.last():o.first();return!!h&&(h.hasPendingWrites||h.version.compareTo(c)>0)}ts(e,o,s){return __PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(o)),this.Zi.getDocumentsMatchingQuery(e,o,IndexOffset.min(),s)}os(e,o,s,c){return this.Zi.getDocumentsMatchingQuery(e,s,c).next(h=>(o.forEach(_=>{h=h.insert(_.key,_)}),h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalStoreImpl{constructor(e,o,s,c){this.persistence=e,this._s=o,this.serializer=c,this.us=new SortedMap(__PRIVATE_primitiveComparator),this.cs=new ObjectMap(h=>__PRIVATE_canonifyTarget(h),__PRIVATE_targetEquals),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(s)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LocalDocumentsView(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",o=>e.collect(o,this.us))}}function __PRIVATE_newLocalStore(i,e,o,s){return new __PRIVATE_LocalStoreImpl(i,e,o,s)}async function __PRIVATE_localStoreHandleUserChange(i,e){const o=__PRIVATE_debugCast(i);return await o.persistence.runTransaction("Handle user change","readonly",s=>{let c;return o.mutationQueue.getAllMutationBatches(s).next(h=>(c=h,o.Ps(e),o.mutationQueue.getAllMutationBatches(s))).next(h=>{const _=[],$=[];let nt=__PRIVATE_documentKeySet();for(const tt of c){_.push(tt.batchId);for(const et of tt.mutations)nt=nt.add(et.key)}for(const tt of h){$.push(tt.batchId);for(const et of tt.mutations)nt=nt.add(et.key)}return o.localDocuments.getDocuments(s,nt).next(tt=>({Ts:tt,removedBatchIds:_,addedBatchIds:$}))})})}function __PRIVATE_localStoreAcknowledgeBatch(i,e){const o=__PRIVATE_debugCast(i);return o.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const c=e.batch.keys(),h=o.hs.newChangeBuffer({trackRemovals:!0});return function($,nt,tt,et){const d=tt.batch,a=d.keys();let g=PersistencePromise.resolve();return a.forEach(j=>{g=g.next(()=>et.getEntry(nt,j)).next(rt=>{const ot=tt.docVersions.get(j);__PRIVATE_hardAssert(ot!==null),rt.version.compareTo(ot)<0&&(d.applyToRemoteDocument(rt,tt),rt.isValidDocument()&&(rt.setReadTime(tt.commitVersion),et.addEntry(rt)))})}),g.next(()=>$.mutationQueue.removeMutationBatch(nt,d))}(o,s,e,h).next(()=>h.apply(s)).next(()=>o.mutationQueue.performConsistencyCheck(s)).next(()=>o.documentOverlayCache.removeOverlaysForBatchId(s,c,e.batch.batchId)).next(()=>o.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function($){let nt=__PRIVATE_documentKeySet();for(let tt=0;tt<$.mutationResults.length;++tt)$.mutationResults[tt].transformResults.length>0&&(nt=nt.add($.batch.mutations[tt].key));return nt}(e))).next(()=>o.localDocuments.getDocuments(s,c))})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(i){const e=__PRIVATE_debugCast(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",o=>e.Gr.getLastRemoteSnapshotVersion(o))}function __PRIVATE_localStoreApplyRemoteEventToLocalCache(i,e){const o=__PRIVATE_debugCast(i),s=e.snapshotVersion;let c=o.us;return o.persistence.runTransaction("Apply remote event","readwrite-primary",h=>{const _=o.hs.newChangeBuffer({trackRemovals:!0});c=o.us;const $=[];e.targetChanges.forEach((et,d)=>{const a=c.get(d);if(!a)return;$.push(o.Gr.removeMatchingKeys(h,et.removedDocuments,d).next(()=>o.Gr.addMatchingKeys(h,et.addedDocuments,d)));let g=a.withSequenceNumber(h.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):et.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(et.resumeToken,s)),c=c.insert(d,g),function(rt,ot,it){return rt.resumeToken.approximateByteSize()===0||ot.snapshotVersion.toMicroseconds()-rt.snapshotVersion.toMicroseconds()>=3e8?!0:it.addedDocuments.size+it.modifiedDocuments.size+it.removedDocuments.size>0}(a,g,et)&&$.push(o.Gr.updateTargetData(h,g))});let nt=__PRIVATE_mutableDocumentMap(),tt=__PRIVATE_documentKeySet();if(e.documentUpdates.forEach(et=>{e.resolvedLimboDocuments.has(et)&&$.push(o.persistence.referenceDelegate.updateLimboDocument(h,et))}),$.push(__PRIVATE_populateDocumentChangeBuffer(h,_,e.documentUpdates).next(et=>{nt=et.Is,tt=et.Es})),!s.isEqual(SnapshotVersion.min())){const et=o.Gr.getLastRemoteSnapshotVersion(h).next(d=>o.Gr.setTargetsMetadata(h,h.currentSequenceNumber,s));$.push(et)}return PersistencePromise.waitFor($).next(()=>_.apply(h)).next(()=>o.localDocuments.getLocalViewOfDocuments(h,nt,tt)).next(()=>nt)}).then(h=>(o.us=c,h))}function __PRIVATE_populateDocumentChangeBuffer(i,e,o){let s=__PRIVATE_documentKeySet(),c=__PRIVATE_documentKeySet();return o.forEach(h=>s=s.add(h)),e.getEntries(i,s).next(h=>{let _=__PRIVATE_mutableDocumentMap();return o.forEach(($,nt)=>{const tt=h.get($);nt.isFoundDocument()!==tt.isFoundDocument()&&(c=c.add($)),nt.isNoDocument()&&nt.version.isEqual(SnapshotVersion.min())?(e.removeEntry($,nt.readTime),_=_.insert($,nt)):!tt.isValidDocument()||nt.version.compareTo(tt.version)>0||nt.version.compareTo(tt.version)===0&&tt.hasPendingWrites?(e.addEntry(nt),_=_.insert($,nt)):__PRIVATE_logDebug("LocalStore","Ignoring outdated watch update for ",$,". Current version:",tt.version," Watch version:",nt.version)}),{Is:_,Es:c}})}function __PRIVATE_localStoreGetNextMutationBatch(i,e){const o=__PRIVATE_debugCast(i);return o.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),o.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function __PRIVATE_localStoreAllocateTarget(i,e){const o=__PRIVATE_debugCast(i);return o.persistence.runTransaction("Allocate target","readwrite",s=>{let c;return o.Gr.getTargetData(s,e).next(h=>h?(c=h,PersistencePromise.resolve(c)):o.Gr.allocateTargetId(s).next(_=>(c=new TargetData(e,_,"TargetPurposeListen",s.currentSequenceNumber),o.Gr.addTargetData(s,c).next(()=>c))))}).then(s=>{const c=o.us.get(s.targetId);return(c===null||s.snapshotVersion.compareTo(c.snapshotVersion)>0)&&(o.us=o.us.insert(s.targetId,s),o.cs.set(e,s.targetId)),s})}async function __PRIVATE_localStoreReleaseTarget(i,e,o){const s=__PRIVATE_debugCast(i),c=s.us.get(e),h=o?"readwrite":"readwrite-primary";try{o||await s.persistence.runTransaction("Release target",h,_=>s.persistence.referenceDelegate.removeTarget(_,c))}catch(_){if(!__PRIVATE_isIndexedDbTransactionError(_))throw _;__PRIVATE_logDebug("LocalStore",`Failed to update sequence numbers for target ${e}: ${_}`)}s.us=s.us.remove(e),s.cs.delete(c.target)}function __PRIVATE_localStoreExecuteQuery(i,e,o){const s=__PRIVATE_debugCast(i);let c=SnapshotVersion.min(),h=__PRIVATE_documentKeySet();return s.persistence.runTransaction("Execute query","readwrite",_=>function(nt,tt,et){const d=__PRIVATE_debugCast(nt),a=d.cs.get(et);return a!==void 0?PersistencePromise.resolve(d.us.get(a)):d.Gr.getTargetData(tt,et)}(s,_,__PRIVATE_queryToTarget(e)).next($=>{if($)return c=$.lastLimboFreeSnapshotVersion,s.Gr.getMatchingKeysForTargetId(_,$.targetId).next(nt=>{h=nt})}).next(()=>s._s.getDocumentsMatchingQuery(_,e,o?c:SnapshotVersion.min(),o?h:__PRIVATE_documentKeySet())).next($=>(__PRIVATE_setMaxReadTime(s,__PRIVATE_queryCollectionGroup(e),$),{documents:$,ds:h})))}function __PRIVATE_setMaxReadTime(i,e,o){let s=i.ls.get(e)||SnapshotVersion.min();o.forEach((c,h)=>{h.readTime.compareTo(s)>0&&(s=h.readTime)}),i.ls.set(e,s)}class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=__PRIVATE_targetIdSet()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class __PRIVATE_MemorySharedClientState{constructor(){this._o=new __PRIVATE_LocalClientState,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,o,s){}addLocalQueryTarget(e,o=!0){return o&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,o,s){this.ao[e]=o}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange(e,o,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_NoopConnectivityMonitor{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){__PRIVATE_logDebug("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){__PRIVATE_logDebug("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let me=null;function __PRIVATE_generateUniqueDebugId(){return me===null?me=function(){return 268435456+Math.round(2147483648*Math.random())}():me++,"0x"+me.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_StreamBridge{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ge="WebChannelConnection";class __PRIVATE_WebChannelConnection extends class{get Co(){return!1}constructor(o){this.databaseInfo=o,this.databaseId=o.databaseId;const s=o.ssl?"https":"http",c=encodeURIComponent(this.databaseId.projectId),h=encodeURIComponent(this.databaseId.database);this.Fo=s+"://"+o.host,this.Mo=`projects/${c}/databases/${h}`,this.xo=this.databaseId.database==="(default)"?`project_id=${c}`:`project_id=${c}&database_id=${h}`}Oo(o,s,c,h,_){const $=__PRIVATE_generateUniqueDebugId(),nt=this.No(o,s.toUriEncodedString());__PRIVATE_logDebug("RestConnection",`Sending RPC '${o}' ${$}:`,nt,c);const tt={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(tt,h,_),this.Bo(o,nt,tt,c).then(et=>(__PRIVATE_logDebug("RestConnection",`Received RPC '${o}' ${$}: `,et),et),et=>{throw __PRIVATE_logWarn("RestConnection",`RPC '${o}' ${$} failed with error: `,et,"url: ",nt,"request:",c),et})}ko(o,s,c,h,_,$){return this.Oo(o,s,c,h,_)}Lo(o,s,c){o["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+S}(),o["Content-Type"]="text/plain",this.databaseInfo.appId&&(o["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((h,_)=>o[_]=h),c&&c.headers.forEach((h,_)=>o[_]=h)}No(o,s){const c=fe[o];return`${this.Fo}/v1/${s}:${c}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,o,s,c){const h=__PRIVATE_generateUniqueDebugId();return new Promise((_,$)=>{const nt=new XhrIo;nt.setWithCredentials(!0),nt.listenOnce(EventType.COMPLETE,()=>{try{switch(nt.getLastErrorCode()){case ErrorCode.NO_ERROR:const et=nt.getResponseJson();__PRIVATE_logDebug(ge,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(et)),_(et);break;case ErrorCode.TIMEOUT:__PRIVATE_logDebug(ge,`RPC '${e}' ${h} timed out`),$(new FirestoreError(D.DEADLINE_EXCEEDED,"Request time out"));break;case ErrorCode.HTTP_ERROR:const d=nt.getStatus();if(__PRIVATE_logDebug(ge,`RPC '${e}' ${h} failed with status:`,d,"response text:",nt.getResponseText()),d>0){let a=nt.getResponseJson();Array.isArray(a)&&(a=a[0]);const g=a==null?void 0:a.error;if(g&&g.status&&g.message){const j=function(ot){const it=ot.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(it)>=0?it:D.UNKNOWN}(g.status);$(new FirestoreError(j,g.message))}else $(new FirestoreError(D.UNKNOWN,"Server responded with status "+nt.getStatus()))}else $(new FirestoreError(D.UNAVAILABLE,"Connection failed."));break;default:fail()}}finally{__PRIVATE_logDebug(ge,`RPC '${e}' ${h} completed.`)}});const tt=JSON.stringify(c);__PRIVATE_logDebug(ge,`RPC '${e}' ${h} sending request:`,c),nt.send(o,"POST",tt,s,15)})}qo(e,o,s){const c=__PRIVATE_generateUniqueDebugId(),h=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],_=createWebChannelTransport(),$=getStatEventTarget(),nt={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},tt=this.longPollingOptions.timeoutSeconds;tt!==void 0&&(nt.longPollingTimeout=Math.round(1e3*tt)),this.useFetchStreams&&(nt.useFetchStreams=!0),this.Lo(nt.initMessageHeaders,o,s),nt.encodeInitMessageHeaders=!0;const et=h.join("");__PRIVATE_logDebug(ge,`Creating RPC '${e}' stream ${c}: ${et}`,nt);const d=_.createWebChannel(et,nt);let a=!1,g=!1;const j=new __PRIVATE_StreamBridge({Eo:ot=>{g?__PRIVATE_logDebug(ge,`Not sending because RPC '${e}' stream ${c} is closed:`,ot):(a||(__PRIVATE_logDebug(ge,`Opening RPC '${e}' stream ${c} transport.`),d.open(),a=!0),__PRIVATE_logDebug(ge,`RPC '${e}' stream ${c} sending:`,ot),d.send(ot))},Ao:()=>d.close()}),rt=(ot,it,at)=>{ot.listen(it,lt=>{try{at(lt)}catch(ct){setTimeout(()=>{throw ct},0)}})};return rt(d,WebChannel.EventType.OPEN,()=>{g||(__PRIVATE_logDebug(ge,`RPC '${e}' stream ${c} transport opened.`),j.So())}),rt(d,WebChannel.EventType.CLOSE,()=>{g||(g=!0,__PRIVATE_logDebug(ge,`RPC '${e}' stream ${c} transport closed`),j.Do())}),rt(d,WebChannel.EventType.ERROR,ot=>{g||(g=!0,__PRIVATE_logWarn(ge,`RPC '${e}' stream ${c} transport errored:`,ot),j.Do(new FirestoreError(D.UNAVAILABLE,"The operation could not be completed")))}),rt(d,WebChannel.EventType.MESSAGE,ot=>{var it;if(!g){const at=ot.data[0];__PRIVATE_hardAssert(!!at);const lt=at,ct=(lt==null?void 0:lt.error)||((it=lt[0])===null||it===void 0?void 0:it.error);if(ct){__PRIVATE_logDebug(ge,`RPC '${e}' stream ${c} received error:`,ct);const dt=ct.status;let mt=function(ut){const _t=le[ut];if(_t!==void 0)return __PRIVATE_mapCodeFromRpcCode(_t)}(dt),ht=ct.message;mt===void 0&&(mt=D.INTERNAL,ht="Unknown error status: "+dt+" with message "+ct.message),g=!0,j.Do(new FirestoreError(mt,ht)),d.close()}else __PRIVATE_logDebug(ge,`RPC '${e}' stream ${c} received:`,at),j.vo(at)}}),rt($,Event.STAT_EVENT,ot=>{ot.stat===Stat.PROXY?__PRIVATE_logDebug(ge,`RPC '${e}' stream ${c} detected buffering proxy`):ot.stat===Stat.NOPROXY&&__PRIVATE_logDebug(ge,`RPC '${e}' stream ${c} detected no buffering proxy`)}),setTimeout(()=>{j.bo()},0),j}}function getDocument(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newSerializer(i){return new JsonProtoSerializer(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ExponentialBackoff{constructor(e,o,s=1e3,c=1.5,h=6e4){this.li=e,this.timerId=o,this.Qo=s,this.Ko=c,this.$o=h,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const o=Math.floor(this.Uo+this.Ho()),s=Math.max(0,Date.now()-this.Go),c=Math.max(0,o-s);c>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${c} ms (base delay: ${this.Uo} ms, delay with jitter: ${o} ms, last attempt: ${s} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,c,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_PersistentStream{constructor(e,o,s,c,h,_,$,nt){this.li=e,this.Yo=s,this.Zo=c,this.connection=h,this.authCredentialsProvider=_,this.appCheckCredentialsProvider=$,this.listener=nt,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new __PRIVATE_ExponentialBackoff(e,o)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,o){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():o&&o.code===D.RESOURCE_EXHAUSTED?(__PRIVATE_logError(o.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):o&&o.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(o)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),o=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,c])=>{this.Xo===o&&this.I_(s,c)},s=>{e(()=>{const c=new FirestoreError(D.UNKNOWN,"Fetching auth token failed: "+s.message);return this.E_(c)})})}I_(e,o){const s=this.T_(this.Xo);this.stream=this.d_(e,o),this.stream.Ro(()=>{s(()=>this.listener.Ro())}),this.stream.mo(()=>{s(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(c=>{s(()=>this.E_(c))}),this.stream.onMessage(c=>{s(()=>++this.n_==1?this.A_(c):this.onNext(c))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return __PRIVATE_logDebug("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return o=>{this.li.enqueueAndForget(()=>this.Xo===e?o():(__PRIVATE_logDebug("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor(e,o,s,c,h,_){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",o,s,c,_),this.serializer=h}d_(e,o){return this.connection.qo("Listen",e,o)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const o=__PRIVATE_fromWatchChange(this.serializer,e),s=function(h){if(!("targetChange"in h))return SnapshotVersion.min();const _=h.targetChange;return _.targetIds&&_.targetIds.length?SnapshotVersion.min():_.readTime?__PRIVATE_fromVersion(_.readTime):SnapshotVersion.min()}(e);return this.listener.R_(o,s)}V_(e){const o={};o.database=__PRIVATE_getEncodedDatabaseId(this.serializer),o.addTarget=function(h,_){let $;const nt=_.target;if($=__PRIVATE_targetIsDocumentTarget(nt)?{documents:__PRIVATE_toDocumentsTarget(h,nt)}:{query:__PRIVATE_toQueryTarget(h,nt).ct},$.targetId=_.targetId,_.resumeToken.approximateByteSize()>0){$.resumeToken=__PRIVATE_toBytes(h,_.resumeToken);const tt=__PRIVATE_toInt32Proto(h,_.expectedCount);tt!==null&&($.expectedCount=tt)}else if(_.snapshotVersion.compareTo(SnapshotVersion.min())>0){$.readTime=toTimestamp(h,_.snapshotVersion.toTimestamp());const tt=__PRIVATE_toInt32Proto(h,_.expectedCount);tt!==null&&($.expectedCount=tt)}return $}(this.serializer,e);const s=__PRIVATE_toListenRequestLabels(this.serializer,e);s&&(o.labels=s),this.c_(o)}m_(e){const o={};o.database=__PRIVATE_getEncodedDatabaseId(this.serializer),o.removeTarget=e,this.c_(o)}}class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor(e,o,s,c,h,_){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",o,s,c,_),this.serializer=h}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,o){return this.connection.qo("Write",e,o)}A_(e){return __PRIVATE_hardAssert(!!e.streamToken),this.lastStreamToken=e.streamToken,__PRIVATE_hardAssert(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){__PRIVATE_hardAssert(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const o=__PRIVATE_fromWriteResults(e.writeResults,e.commitTime),s=__PRIVATE_fromVersion(e.commitTime);return this.listener.y_(s,o)}w_(){const e={};e.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.c_(e)}g_(e){const o={streamToken:this.lastStreamToken,writes:e.map(s=>toMutation(this.serializer,s))};this.c_(o)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DatastoreImpl extends class{}{constructor(e,o,s,c){super(),this.authCredentials=e,this.appCheckCredentials=o,this.connection=s,this.serializer=c,this.S_=!1}b_(){if(this.S_)throw new FirestoreError(D.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,o,s,c){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([h,_])=>this.connection.Oo(e,__PRIVATE_toResourcePath(o,s),c,h,_)).catch(h=>{throw h.name==="FirebaseError"?(h.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new FirestoreError(D.UNKNOWN,h.toString())})}ko(e,o,s,c,h){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([_,$])=>this.connection.ko(e,__PRIVATE_toResourcePath(o,s),c,_,$,h)).catch(_=>{throw _.name==="FirebaseError"?(_.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),_):new FirestoreError(D.UNKNOWN,_.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class __PRIVATE_OnlineStateTracker{constructor(e,o){this.asyncQueue=e,this.onlineStateHandler=o,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const o=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(__PRIVATE_logError(o),this.C_=!1):__PRIVATE_logDebug("OnlineStateTracker",o)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_RemoteStoreImpl{constructor(e,o,s,c,h){this.localStore=e,this.datastore=o,this.asyncQueue=s,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=h,this.Q_.uo(_=>{s.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(__PRIVATE_logDebug("RemoteStore","Restarting streams for network reachability change."),await async function(nt){const tt=__PRIVATE_debugCast(nt);tt.k_.add(4),await __PRIVATE_disableNetworkInternal(tt),tt.K_.set("Unknown"),tt.k_.delete(4),await __PRIVATE_enableNetworkInternal(tt)}(this))})}),this.K_=new __PRIVATE_OnlineStateTracker(s,c)}}async function __PRIVATE_enableNetworkInternal(i){if(__PRIVATE_canUseNetwork(i))for(const e of i.q_)await e(!0)}async function __PRIVATE_disableNetworkInternal(i){for(const e of i.q_)await e(!1)}function __PRIVATE_remoteStoreListen(i,e){const o=__PRIVATE_debugCast(i);o.B_.has(e.targetId)||(o.B_.set(e.targetId,e),__PRIVATE_shouldStartWatchStream(o)?__PRIVATE_startWatchStream(o):__PRIVATE_ensureWatchStream(o).s_()&&__PRIVATE_sendWatchRequest(o,e))}function __PRIVATE_remoteStoreUnlisten(i,e){const o=__PRIVATE_debugCast(i),s=__PRIVATE_ensureWatchStream(o);o.B_.delete(e),s.s_()&&__PRIVATE_sendUnwatchRequest(o,e),o.B_.size===0&&(s.s_()?s.a_():__PRIVATE_canUseNetwork(o)&&o.K_.set("Unknown"))}function __PRIVATE_sendWatchRequest(i,e){if(i.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(SnapshotVersion.min())>0){const o=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(o)}__PRIVATE_ensureWatchStream(i).V_(e)}function __PRIVATE_sendUnwatchRequest(i,e){i.U_.xe(e),__PRIVATE_ensureWatchStream(i).m_(e)}function __PRIVATE_startWatchStream(i){i.U_=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>i.B_.get(e)||null,nt:()=>i.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(i).start(),i.K_.F_()}function __PRIVATE_shouldStartWatchStream(i){return __PRIVATE_canUseNetwork(i)&&!__PRIVATE_ensureWatchStream(i).i_()&&i.B_.size>0}function __PRIVATE_canUseNetwork(i){return __PRIVATE_debugCast(i).k_.size===0}function __PRIVATE_cleanUpWatchStreamState(i){i.U_=void 0}async function __PRIVATE_onWatchStreamConnected(i){i.K_.set("Online")}async function __PRIVATE_onWatchStreamOpen(i){i.B_.forEach((e,o)=>{__PRIVATE_sendWatchRequest(i,e)})}async function __PRIVATE_onWatchStreamClose(i,e){__PRIVATE_cleanUpWatchStreamState(i),__PRIVATE_shouldStartWatchStream(i)?(i.K_.O_(e),__PRIVATE_startWatchStream(i)):i.K_.set("Unknown")}async function __PRIVATE_onWatchStreamChange(i,e,o){if(i.K_.set("Online"),e instanceof __PRIVATE_WatchTargetChange&&e.state===2&&e.cause)try{await async function(c,h){const _=h.cause;for(const $ of h.targetIds)c.B_.has($)&&(await c.remoteSyncer.rejectListen($,_),c.B_.delete($),c.U_.removeTarget($))}(i,e)}catch(s){__PRIVATE_logDebug("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await __PRIVATE_disableNetworkUntilRecovery(i,s)}else if(e instanceof __PRIVATE_DocumentWatchChange?i.U_.$e(e):e instanceof __PRIVATE_ExistenceFilterChange?i.U_.Je(e):i.U_.Ge(e),!o.isEqual(SnapshotVersion.min()))try{const s=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(i.localStore);o.compareTo(s)>=0&&await function(h,_){const $=h.U_.it(_);return $.targetChanges.forEach((nt,tt)=>{if(nt.resumeToken.approximateByteSize()>0){const et=h.B_.get(tt);et&&h.B_.set(tt,et.withResumeToken(nt.resumeToken,_))}}),$.targetMismatches.forEach((nt,tt)=>{const et=h.B_.get(nt);if(!et)return;h.B_.set(nt,et.withResumeToken(ByteString.EMPTY_BYTE_STRING,et.snapshotVersion)),__PRIVATE_sendUnwatchRequest(h,nt);const d=new TargetData(et.target,nt,tt,et.sequenceNumber);__PRIVATE_sendWatchRequest(h,d)}),h.remoteSyncer.applyRemoteEvent($)}(i,o)}catch(s){__PRIVATE_logDebug("RemoteStore","Failed to raise snapshot:",s),await __PRIVATE_disableNetworkUntilRecovery(i,s)}}async function __PRIVATE_disableNetworkUntilRecovery(i,e,o){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;i.k_.add(1),await __PRIVATE_disableNetworkInternal(i),i.K_.set("Offline"),o||(o=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{__PRIVATE_logDebug("RemoteStore","Retrying IndexedDB access"),await o(),i.k_.delete(1),await __PRIVATE_enableNetworkInternal(i)})}function __PRIVATE_executeWithRecovery(i,e){return e().catch(o=>__PRIVATE_disableNetworkUntilRecovery(i,o,e))}async function __PRIVATE_fillWritePipeline(i){const e=__PRIVATE_debugCast(i),o=__PRIVATE_ensureWriteStream(e);let s=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;__PRIVATE_canAddToWritePipeline(e);)try{const c=await __PRIVATE_localStoreGetNextMutationBatch(e.localStore,s);if(c===null){e.L_.length===0&&o.a_();break}s=c.batchId,__PRIVATE_addToWritePipeline(e,c)}catch(c){await __PRIVATE_disableNetworkUntilRecovery(e,c)}__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}function __PRIVATE_canAddToWritePipeline(i){return __PRIVATE_canUseNetwork(i)&&i.L_.length<10}function __PRIVATE_addToWritePipeline(i,e){i.L_.push(e);const o=__PRIVATE_ensureWriteStream(i);o.s_()&&o.f_&&o.g_(e.mutations)}function __PRIVATE_shouldStartWriteStream(i){return __PRIVATE_canUseNetwork(i)&&!__PRIVATE_ensureWriteStream(i).i_()&&i.L_.length>0}function __PRIVATE_startWriteStream(i){__PRIVATE_ensureWriteStream(i).start()}async function __PRIVATE_onWriteStreamOpen(i){__PRIVATE_ensureWriteStream(i).w_()}async function __PRIVATE_onWriteHandshakeComplete(i){const e=__PRIVATE_ensureWriteStream(i);for(const o of i.L_)e.g_(o.mutations)}async function __PRIVATE_onMutationResult(i,e,o){const s=i.L_.shift(),c=MutationBatchResult.from(s,e,o);await __PRIVATE_executeWithRecovery(i,()=>i.remoteSyncer.applySuccessfulWrite(c)),await __PRIVATE_fillWritePipeline(i)}async function __PRIVATE_onWriteStreamClose(i,e){e&&__PRIVATE_ensureWriteStream(i).f_&&await async function(s,c){if(function(_){return __PRIVATE_isPermanentError(_)&&_!==D.ABORTED}(c.code)){const h=s.L_.shift();__PRIVATE_ensureWriteStream(s).__(),await __PRIVATE_executeWithRecovery(s,()=>s.remoteSyncer.rejectFailedWrite(h.batchId,c)),await __PRIVATE_fillWritePipeline(s)}}(i,e),__PRIVATE_shouldStartWriteStream(i)&&__PRIVATE_startWriteStream(i)}async function __PRIVATE_remoteStoreHandleCredentialChange(i,e){const o=__PRIVATE_debugCast(i);o.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug("RemoteStore","RemoteStore received new credentials");const s=__PRIVATE_canUseNetwork(o);o.k_.add(3),await __PRIVATE_disableNetworkInternal(o),s&&o.K_.set("Unknown"),await o.remoteSyncer.handleCredentialChange(e),o.k_.delete(3),await __PRIVATE_enableNetworkInternal(o)}async function __PRIVATE_remoteStoreApplyPrimaryState(i,e){const o=__PRIVATE_debugCast(i);e?(o.k_.delete(2),await __PRIVATE_enableNetworkInternal(o)):e||(o.k_.add(2),await __PRIVATE_disableNetworkInternal(o),o.K_.set("Unknown"))}function __PRIVATE_ensureWatchStream(i){return i.W_||(i.W_=function(o,s,c){const h=__PRIVATE_debugCast(o);return h.b_(),new __PRIVATE_PersistentListenStream(s,h.connection,h.authCredentials,h.appCheckCredentials,h.serializer,c)}(i.datastore,i.asyncQueue,{Ro:__PRIVATE_onWatchStreamConnected.bind(null,i),mo:__PRIVATE_onWatchStreamOpen.bind(null,i),po:__PRIVATE_onWatchStreamClose.bind(null,i),R_:__PRIVATE_onWatchStreamChange.bind(null,i)}),i.q_.push(async e=>{e?(i.W_.__(),__PRIVATE_shouldStartWatchStream(i)?__PRIVATE_startWatchStream(i):i.K_.set("Unknown")):(await i.W_.stop(),__PRIVATE_cleanUpWatchStreamState(i))})),i.W_}function __PRIVATE_ensureWriteStream(i){return i.G_||(i.G_=function(o,s,c){const h=__PRIVATE_debugCast(o);return h.b_(),new __PRIVATE_PersistentWriteStream(s,h.connection,h.authCredentials,h.appCheckCredentials,h.serializer,c)}(i.datastore,i.asyncQueue,{Ro:()=>Promise.resolve(),mo:__PRIVATE_onWriteStreamOpen.bind(null,i),po:__PRIVATE_onWriteStreamClose.bind(null,i),p_:__PRIVATE_onWriteHandshakeComplete.bind(null,i),y_:__PRIVATE_onMutationResult.bind(null,i)}),i.q_.push(async e=>{e?(i.G_.__(),await __PRIVATE_fillWritePipeline(i)):(await i.G_.stop(),i.L_.length>0&&(__PRIVATE_logDebug("RemoteStore",`Stopping write stream with ${i.L_.length} pending writes`),i.L_=[]))})),i.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DelayedOperation{constructor(e,o,s,c,h){this.asyncQueue=e,this.timerId=o,this.targetTimeMs=s,this.op=c,this.removalCallback=h,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(_=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,o,s,c,h){const _=Date.now()+s,$=new DelayedOperation(e,o,_,c,h);return $.start(s),$}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function __PRIVATE_wrapInUserErrorIfRecoverable(i,e){if(__PRIVATE_logError("AsyncQueue",`${e}: ${i}`),__PRIVATE_isIndexedDbTransactionError(i))return new FirestoreError(D.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSet{static emptySet(e){return new DocumentSet(e.comparator)}constructor(e){this.comparator=e?(o,s)=>e(o,s)||DocumentKey.comparator(o.key,s.key):(o,s)=>DocumentKey.comparator(o.key,s.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const o=this.keyedMap.get(e);return o?this.sortedSet.indexOf(o):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((o,s)=>(e(o),!1))}add(e){const o=this.delete(e.key);return o.copy(o.keyedMap.insert(e.key,e),o.sortedSet.insert(e,null))}delete(e){const o=this.get(e);return o?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(o)):this}isEqual(e){if(!(e instanceof DocumentSet)||this.size!==e.size)return!1;const o=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;o.hasNext();){const c=o.getNext().key,h=s.getNext().key;if(!c.isEqual(h))return!1}return!0}toString(){const e=[];return this.forEach(o=>{e.push(o.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,o){const s=new DocumentSet;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=o,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentChangeSet{constructor(){this.z_=new SortedMap(DocumentKey.comparator)}track(e){const o=e.doc.key,s=this.z_.get(o);s?e.type!==0&&s.type===3?this.z_=this.z_.insert(o,e):e.type===3&&s.type!==1?this.z_=this.z_.insert(o,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.z_=this.z_.insert(o,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.z_=this.z_.insert(o,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.z_=this.z_.remove(o):e.type===1&&s.type===2?this.z_=this.z_.insert(o,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.z_=this.z_.insert(o,{type:2,doc:e.doc}):fail():this.z_=this.z_.insert(o,e)}j_(){const e=[];return this.z_.inorderTraversal((o,s)=>{e.push(s)}),e}}class ViewSnapshot{constructor(e,o,s,c,h,_,$,nt,tt){this.query=e,this.docs=o,this.oldDocs=s,this.docChanges=c,this.mutatedKeys=h,this.fromCache=_,this.syncStateChanged=$,this.excludesMetadataChanges=nt,this.hasCachedResults=tt}static fromInitialDocuments(e,o,s,c,h){const _=[];return o.forEach($=>{_.push({type:0,doc:$})}),new ViewSnapshot(e,o,DocumentSet.emptySet(o),_,s,c,!0,!1,h)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&__PRIVATE_queryEquals(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const o=this.docChanges,s=e.docChanges;if(o.length!==s.length)return!1;for(let c=0;c<o.length;c++)if(o[c].type!==s[c].type||!o[c].doc.isEqual(s[c].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryListenersInfo{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class __PRIVATE_EventManagerImpl{constructor(){this.queries=__PRIVATE_newQueriesObjectMap(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(o,s){const c=__PRIVATE_debugCast(o),h=c.queries;c.queries=__PRIVATE_newQueriesObjectMap(),h.forEach((_,$)=>{for(const nt of $.J_)nt.onError(s)})})(this,new FirestoreError(D.ABORTED,"Firestore shutting down"))}}function __PRIVATE_newQueriesObjectMap(){return new ObjectMap(i=>__PRIVATE_canonifyQuery(i),__PRIVATE_queryEquals)}async function __PRIVATE_eventManagerListen(i,e){const o=__PRIVATE_debugCast(i);let s=3;const c=e.query;let h=o.queries.get(c);h?!h.Y_()&&e.Z_()&&(s=2):(h=new __PRIVATE_QueryListenersInfo,s=e.Z_()?0:1);try{switch(s){case 0:h.H_=await o.onListen(c,!0);break;case 1:h.H_=await o.onListen(c,!1);break;case 2:await o.onFirstRemoteStoreListen(c)}}catch(_){const $=__PRIVATE_wrapInUserErrorIfRecoverable(_,`Initialization of query '${__PRIVATE_stringifyQuery(e.query)}' failed`);return void e.onError($)}o.queries.set(c,h),h.J_.push(e),e.ea(o.onlineState),h.H_&&e.ta(h.H_)&&__PRIVATE_raiseSnapshotsInSyncEvent(o)}async function __PRIVATE_eventManagerUnlisten(i,e){const o=__PRIVATE_debugCast(i),s=e.query;let c=3;const h=o.queries.get(s);if(h){const _=h.J_.indexOf(e);_>=0&&(h.J_.splice(_,1),h.J_.length===0?c=e.Z_()?0:1:!h.Y_()&&e.Z_()&&(c=2))}switch(c){case 0:return o.queries.delete(s),o.onUnlisten(s,!0);case 1:return o.queries.delete(s),o.onUnlisten(s,!1);case 2:return o.onLastRemoteStoreUnlisten(s);default:return}}function __PRIVATE_eventManagerOnWatchChange(i,e){const o=__PRIVATE_debugCast(i);let s=!1;for(const c of e){const h=c.query,_=o.queries.get(h);if(_){for(const $ of _.J_)$.ta(c)&&(s=!0);_.H_=c}}s&&__PRIVATE_raiseSnapshotsInSyncEvent(o)}function __PRIVATE_eventManagerOnWatchError(i,e,o){const s=__PRIVATE_debugCast(i),c=s.queries.get(e);if(c)for(const h of c.J_)h.onError(o);s.queries.delete(e)}function __PRIVATE_raiseSnapshotsInSyncEvent(i){i.X_.forEach(e=>{e.next()})}var pe,ye;(ye=pe||(pe={})).na="default",ye.Cache="cache";class __PRIVATE_QueryListener{constructor(e,o,s){this.query=e,this.ra=o,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=s||{}}ta(e){if(!this.options.includeMetadataChanges){const s=[];for(const c of e.docChanges)c.type!==3&&s.push(c);e=new ViewSnapshot(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let o=!1;return this.ia?this.oa(e)&&(this.ra.next(e),o=!0):this._a(e,this.onlineState)&&(this.aa(e),o=!0),this.sa=e,o}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let o=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),o=!0),o}_a(e,o){if(!e.fromCache||!this.Z_())return!0;const s=o!=="Offline";return(!this.options.ua||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||o==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const o=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!o)&&this.options.includeMetadataChanges===!0}aa(e){e=ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==pe.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AddedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_RemovedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_View{constructor(e,o){this.query=e,this.da=o,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=__PRIVATE_documentKeySet(),this.mutatedKeys=__PRIVATE_documentKeySet(),this.Va=__PRIVATE_newQueryComparator(e),this.ma=new DocumentSet(this.Va)}get fa(){return this.da}ga(e,o){const s=o?o.pa:new __PRIVATE_DocumentChangeSet,c=o?o.ma:this.ma;let h=o?o.mutatedKeys:this.mutatedKeys,_=c,$=!1;const nt=this.query.limitType==="F"&&c.size===this.query.limit?c.last():null,tt=this.query.limitType==="L"&&c.size===this.query.limit?c.first():null;if(e.inorderTraversal((et,d)=>{const a=c.get(et),g=__PRIVATE_queryMatches(this.query,d)?d:null,j=!!a&&this.mutatedKeys.has(a.key),rt=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let ot=!1;a&&g?a.data.isEqual(g.data)?j!==rt&&(s.track({type:3,doc:g}),ot=!0):this.ya(a,g)||(s.track({type:2,doc:g}),ot=!0,(nt&&this.Va(g,nt)>0||tt&&this.Va(g,tt)<0)&&($=!0)):!a&&g?(s.track({type:0,doc:g}),ot=!0):a&&!g&&(s.track({type:1,doc:a}),ot=!0,(nt||tt)&&($=!0)),ot&&(g?(_=_.add(g),h=rt?h.add(et):h.delete(et)):(_=_.delete(et),h=h.delete(et)))}),this.query.limit!==null)for(;_.size>this.query.limit;){const et=this.query.limitType==="F"?_.last():_.first();_=_.delete(et.key),h=h.delete(et.key),s.track({type:1,doc:et})}return{ma:_,pa:s,ss:$,mutatedKeys:h}}ya(e,o){return e.hasLocalMutations&&o.hasCommittedMutations&&!o.hasLocalMutations}applyChanges(e,o,s,c){const h=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const _=e.pa.j_();_.sort((et,d)=>function(g,j){const rt=ot=>{switch(ot){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fail()}};return rt(g)-rt(j)}(et.type,d.type)||this.Va(et.doc,d.doc)),this.wa(s),c=c!=null&&c;const $=o&&!c?this.Sa():[],nt=this.Ra.size===0&&this.current&&!c?1:0,tt=nt!==this.Aa;return this.Aa=nt,_.length!==0||tt?{snapshot:new ViewSnapshot(this.query,e.ma,h,_,e.mutatedKeys,nt===0,tt,!1,!!s&&s.resumeToken.approximateByteSize()>0),ba:$}:{ba:$}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(o=>this.da=this.da.add(o)),e.modifiedDocuments.forEach(o=>{}),e.removedDocuments.forEach(o=>this.da=this.da.delete(o)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=__PRIVATE_documentKeySet(),this.ma.forEach(s=>{this.Da(s.key)&&(this.Ra=this.Ra.add(s.key))});const o=[];return e.forEach(s=>{this.Ra.has(s)||o.push(new __PRIVATE_RemovedLimboDocument(s))}),this.Ra.forEach(s=>{e.has(s)||o.push(new __PRIVATE_AddedLimboDocument(s))}),o}va(e){this.da=e.ds,this.Ra=__PRIVATE_documentKeySet();const o=this.ga(e.documents);return this.applyChanges(o,!0)}Ca(){return ViewSnapshot.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class __PRIVATE_QueryView{constructor(e,o,s){this.query=e,this.targetId=o,this.view=s}}class LimboResolution{constructor(e){this.key=e,this.Fa=!1}}class __PRIVATE_SyncEngineImpl{constructor(e,o,s,c,h,_){this.localStore=e,this.remoteStore=o,this.eventManager=s,this.sharedClientState=c,this.currentUser=h,this.maxConcurrentLimboResolutions=_,this.Ma={},this.xa=new ObjectMap($=>__PRIVATE_canonifyQuery($),__PRIVATE_queryEquals),this.Oa=new Map,this.Na=new Set,this.La=new SortedMap(DocumentKey.comparator),this.Ba=new Map,this.ka=new __PRIVATE_ReferenceSet,this.qa={},this.Qa=new Map,this.Ka=__PRIVATE_TargetIdGenerator.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function __PRIVATE_syncEngineListen(i,e,o=!0){const s=__PRIVATE_ensureWatchCallbacks(i);let c;const h=s.xa.get(e);return h?(s.sharedClientState.addLocalQueryTarget(h.targetId),c=h.view.Ca()):c=await __PRIVATE_allocateTargetAndMaybeListen(s,e,o,!0),c}async function __PRIVATE_triggerRemoteStoreListen(i,e){const o=__PRIVATE_ensureWatchCallbacks(i);await __PRIVATE_allocateTargetAndMaybeListen(o,e,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(i,e,o,s){const c=await __PRIVATE_localStoreAllocateTarget(i.localStore,__PRIVATE_queryToTarget(e)),h=c.targetId,_=i.sharedClientState.addLocalQueryTarget(h,o);let $;return s&&($=await __PRIVATE_initializeViewAndComputeSnapshot(i,e,h,_==="current",c.resumeToken)),i.isPrimaryClient&&o&&__PRIVATE_remoteStoreListen(i.remoteStore,c),$}async function __PRIVATE_initializeViewAndComputeSnapshot(i,e,o,s,c){i.Ua=(d,a,g)=>async function(rt,ot,it,at){let lt=ot.view.ga(it);lt.ss&&(lt=await __PRIVATE_localStoreExecuteQuery(rt.localStore,ot.query,!1).then(({documents:ht})=>ot.view.ga(ht,lt)));const ct=at&&at.targetChanges.get(ot.targetId),dt=at&&at.targetMismatches.get(ot.targetId)!=null,mt=ot.view.applyChanges(lt,rt.isPrimaryClient,ct,dt);return __PRIVATE_updateTrackedLimbos(rt,ot.targetId,mt.ba),mt.snapshot}(i,d,a,g);const h=await __PRIVATE_localStoreExecuteQuery(i.localStore,e,!0),_=new __PRIVATE_View(e,h.ds),$=_.ga(h.documents),nt=TargetChange.createSynthesizedTargetChangeForCurrentChange(o,s&&i.onlineState!=="Offline",c),tt=_.applyChanges($,i.isPrimaryClient,nt);__PRIVATE_updateTrackedLimbos(i,o,tt.ba);const et=new __PRIVATE_QueryView(e,o,_);return i.xa.set(e,et),i.Oa.has(o)?i.Oa.get(o).push(e):i.Oa.set(o,[e]),tt.snapshot}async function __PRIVATE_syncEngineUnlisten(i,e,o){const s=__PRIVATE_debugCast(i),c=s.xa.get(e),h=s.Oa.get(c.targetId);if(h.length>1)return s.Oa.set(c.targetId,h.filter(_=>!__PRIVATE_queryEquals(_,e))),void s.xa.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(c.targetId),s.sharedClientState.isActiveQueryTarget(c.targetId)||await __PRIVATE_localStoreReleaseTarget(s.localStore,c.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(c.targetId),o&&__PRIVATE_remoteStoreUnlisten(s.remoteStore,c.targetId),__PRIVATE_removeAndCleanupTarget(s,c.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(s,c.targetId),await __PRIVATE_localStoreReleaseTarget(s.localStore,c.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(i,e){const o=__PRIVATE_debugCast(i),s=o.xa.get(e),c=o.Oa.get(s.targetId);o.isPrimaryClient&&c.length===1&&(o.sharedClientState.removeLocalQueryTarget(s.targetId),__PRIVATE_remoteStoreUnlisten(o.remoteStore,s.targetId))}async function __PRIVATE_syncEngineWrite(i,e,o){const s=__PRIVATE_syncEngineEnsureWriteCallbacks(i);try{const c=await function(_,$){const nt=__PRIVATE_debugCast(_),tt=Timestamp.now(),et=$.reduce((g,j)=>g.add(j.key),__PRIVATE_documentKeySet());let d,a;return nt.persistence.runTransaction("Locally write mutations","readwrite",g=>{let j=__PRIVATE_mutableDocumentMap(),rt=__PRIVATE_documentKeySet();return nt.hs.getEntries(g,et).next(ot=>{j=ot,j.forEach((it,at)=>{at.isValidDocument()||(rt=rt.add(it))})}).next(()=>nt.localDocuments.getOverlayedDocuments(g,j)).next(ot=>{d=ot;const it=[];for(const at of $){const lt=__PRIVATE_mutationExtractBaseValue(at,d.get(at.key).overlayedDocument);lt!=null&&it.push(new __PRIVATE_PatchMutation(at.key,lt,__PRIVATE_extractFieldMask(lt.value.mapValue),Precondition.exists(!0)))}return nt.mutationQueue.addMutationBatch(g,tt,it,$)}).next(ot=>{a=ot;const it=ot.applyToLocalDocumentSet(d,rt);return nt.documentOverlayCache.saveOverlays(g,ot.batchId,it)})}).then(()=>({batchId:a.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(d)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(c.batchId),function(_,$,nt){let tt=_.qa[_.currentUser.toKey()];tt||(tt=new SortedMap(__PRIVATE_primitiveComparator)),tt=tt.insert($,nt),_.qa[_.currentUser.toKey()]=tt}(s,c.batchId,o),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(s,c.changes),await __PRIVATE_fillWritePipeline(s.remoteStore)}catch(c){const h=__PRIVATE_wrapInUserErrorIfRecoverable(c,"Failed to persist write");o.reject(h)}}async function __PRIVATE_syncEngineApplyRemoteEvent(i,e){const o=__PRIVATE_debugCast(i);try{const s=await __PRIVATE_localStoreApplyRemoteEventToLocalCache(o.localStore,e);e.targetChanges.forEach((c,h)=>{const _=o.Ba.get(h);_&&(__PRIVATE_hardAssert(c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size<=1),c.addedDocuments.size>0?_.Fa=!0:c.modifiedDocuments.size>0?__PRIVATE_hardAssert(_.Fa):c.removedDocuments.size>0&&(__PRIVATE_hardAssert(_.Fa),_.Fa=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(o,s,e)}catch(s){await __PRIVATE_ignoreIfPrimaryLeaseLoss(s)}}function __PRIVATE_syncEngineApplyOnlineStateChange(i,e,o){const s=__PRIVATE_debugCast(i);if(s.isPrimaryClient&&o===0||!s.isPrimaryClient&&o===1){const c=[];s.xa.forEach((h,_)=>{const $=_.view.ea(e);$.snapshot&&c.push($.snapshot)}),function(_,$){const nt=__PRIVATE_debugCast(_);nt.onlineState=$;let tt=!1;nt.queries.forEach((et,d)=>{for(const a of d.J_)a.ea($)&&(tt=!0)}),tt&&__PRIVATE_raiseSnapshotsInSyncEvent(nt)}(s.eventManager,e),c.length&&s.Ma.R_(c),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function __PRIVATE_syncEngineRejectListen(i,e,o){const s=__PRIVATE_debugCast(i);s.sharedClientState.updateQueryState(e,"rejected",o);const c=s.Ba.get(e),h=c&&c.key;if(h){let _=new SortedMap(DocumentKey.comparator);_=_.insert(h,MutableDocument.newNoDocument(h,SnapshotVersion.min()));const $=__PRIVATE_documentKeySet().add(h),nt=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),_,$);await __PRIVATE_syncEngineApplyRemoteEvent(s,nt),s.La=s.La.remove(h),s.Ba.delete(e),__PRIVATE_pumpEnqueuedLimboResolutions(s)}else await __PRIVATE_localStoreReleaseTarget(s.localStore,e,!1).then(()=>__PRIVATE_removeAndCleanupTarget(s,e,o)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(i,e){const o=__PRIVATE_debugCast(i),s=e.batch.batchId;try{const c=await __PRIVATE_localStoreAcknowledgeBatch(o.localStore,e);__PRIVATE_processUserCallback(o,s,null),__PRIVATE_triggerPendingWritesCallbacks(o,s),o.sharedClientState.updateMutationState(s,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(o,c)}catch(c){await __PRIVATE_ignoreIfPrimaryLeaseLoss(c)}}async function __PRIVATE_syncEngineRejectFailedWrite(i,e,o){const s=__PRIVATE_debugCast(i);try{const c=await function(_,$){const nt=__PRIVATE_debugCast(_);return nt.persistence.runTransaction("Reject batch","readwrite-primary",tt=>{let et;return nt.mutationQueue.lookupMutationBatch(tt,$).next(d=>(__PRIVATE_hardAssert(d!==null),et=d.keys(),nt.mutationQueue.removeMutationBatch(tt,d))).next(()=>nt.mutationQueue.performConsistencyCheck(tt)).next(()=>nt.documentOverlayCache.removeOverlaysForBatchId(tt,et,$)).next(()=>nt.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(tt,et)).next(()=>nt.localDocuments.getDocuments(tt,et))})}(s.localStore,e);__PRIVATE_processUserCallback(s,e,o),__PRIVATE_triggerPendingWritesCallbacks(s,e),s.sharedClientState.updateMutationState(e,"rejected",o),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(s,c)}catch(c){await __PRIVATE_ignoreIfPrimaryLeaseLoss(c)}}function __PRIVATE_triggerPendingWritesCallbacks(i,e){(i.Qa.get(e)||[]).forEach(o=>{o.resolve()}),i.Qa.delete(e)}function __PRIVATE_processUserCallback(i,e,o){const s=__PRIVATE_debugCast(i);let c=s.qa[s.currentUser.toKey()];if(c){const h=c.get(e);h&&(o?h.reject(o):h.resolve(),c=c.remove(e)),s.qa[s.currentUser.toKey()]=c}}function __PRIVATE_removeAndCleanupTarget(i,e,o=null){i.sharedClientState.removeLocalQueryTarget(e);for(const s of i.Oa.get(e))i.xa.delete(s),o&&i.Ma.Wa(s,o);i.Oa.delete(e),i.isPrimaryClient&&i.ka.yr(e).forEach(s=>{i.ka.containsKey(s)||__PRIVATE_removeLimboTarget(i,s)})}function __PRIVATE_removeLimboTarget(i,e){i.Na.delete(e.path.canonicalString());const o=i.La.get(e);o!==null&&(__PRIVATE_remoteStoreUnlisten(i.remoteStore,o),i.La=i.La.remove(e),i.Ba.delete(o),__PRIVATE_pumpEnqueuedLimboResolutions(i))}function __PRIVATE_updateTrackedLimbos(i,e,o){for(const s of o)s instanceof __PRIVATE_AddedLimboDocument?(i.ka.addReference(s.key,e),__PRIVATE_trackLimboChange(i,s)):s instanceof __PRIVATE_RemovedLimboDocument?(__PRIVATE_logDebug("SyncEngine","Document no longer in limbo: "+s.key),i.ka.removeReference(s.key,e),i.ka.containsKey(s.key)||__PRIVATE_removeLimboTarget(i,s.key)):fail()}function __PRIVATE_trackLimboChange(i,e){const o=e.key,s=o.path.canonicalString();i.La.get(o)||i.Na.has(s)||(__PRIVATE_logDebug("SyncEngine","New document in limbo: "+o),i.Na.add(s),__PRIVATE_pumpEnqueuedLimboResolutions(i))}function __PRIVATE_pumpEnqueuedLimboResolutions(i){for(;i.Na.size>0&&i.La.size<i.maxConcurrentLimboResolutions;){const e=i.Na.values().next().value;i.Na.delete(e);const o=new DocumentKey(ResourcePath.fromString(e)),s=i.Ka.next();i.Ba.set(s,new LimboResolution(o)),i.La=i.La.insert(o,s),__PRIVATE_remoteStoreListen(i.remoteStore,new TargetData(__PRIVATE_queryToTarget(__PRIVATE_newQueryForPath(o.path)),s,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.oe))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(i,e,o){const s=__PRIVATE_debugCast(i),c=[],h=[],_=[];s.xa.isEmpty()||(s.xa.forEach(($,nt)=>{_.push(s.Ua(nt,e,o).then(tt=>{var et;if((tt||o)&&s.isPrimaryClient){const d=tt?!tt.fromCache:(et=o==null?void 0:o.targetChanges.get(nt.targetId))===null||et===void 0?void 0:et.current;s.sharedClientState.updateQueryState(nt.targetId,d?"current":"not-current")}if(tt){c.push(tt);const d=__PRIVATE_LocalViewChanges.zi(nt.targetId,tt);h.push(d)}}))}),await Promise.all(_),s.Ma.R_(c),await async function(nt,tt){const et=__PRIVATE_debugCast(nt);try{await et.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>PersistencePromise.forEach(tt,a=>PersistencePromise.forEach(a.Wi,g=>et.persistence.referenceDelegate.addReference(d,a.targetId,g)).next(()=>PersistencePromise.forEach(a.Gi,g=>et.persistence.referenceDelegate.removeReference(d,a.targetId,g)))))}catch(d){if(!__PRIVATE_isIndexedDbTransactionError(d))throw d;__PRIVATE_logDebug("LocalStore","Failed to update sequence numbers: "+d)}for(const d of tt){const a=d.targetId;if(!d.fromCache){const g=et.us.get(a),j=g.snapshotVersion,rt=g.withLastLimboFreeSnapshotVersion(j);et.us=et.us.insert(a,rt)}}}(s.localStore,h))}async function __PRIVATE_syncEngineHandleCredentialChange(i,e){const o=__PRIVATE_debugCast(i);if(!o.currentUser.isEqual(e)){__PRIVATE_logDebug("SyncEngine","User change. New user:",e.toKey());const s=await __PRIVATE_localStoreHandleUserChange(o.localStore,e);o.currentUser=e,function(h,_){h.Qa.forEach($=>{$.forEach(nt=>{nt.reject(new FirestoreError(D.CANCELLED,_))})}),h.Qa.clear()}(o,"'waitForPendingWrites' promise is rejected due to a user change."),o.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(o,s.Ts)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(i,e){const o=__PRIVATE_debugCast(i),s=o.Ba.get(e);if(s&&s.Fa)return __PRIVATE_documentKeySet().add(s.key);{let c=__PRIVATE_documentKeySet();const h=o.Oa.get(e);if(!h)return c;for(const _ of h){const $=o.xa.get(_);c=c.unionWith($.view.fa)}return c}}function __PRIVATE_ensureWatchCallbacks(i){const e=__PRIVATE_debugCast(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,e),e.Ma.R_=__PRIVATE_eventManagerOnWatchChange.bind(null,e.eventManager),e.Ma.Wa=__PRIVATE_eventManagerOnWatchError.bind(null,e.eventManager),e}function __PRIVATE_syncEngineEnsureWriteCallbacks(i){const e=__PRIVATE_debugCast(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,e),e}class __PRIVATE_MemoryOfflineComponentProvider{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=__PRIVATE_newSerializer(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,o){return null}Ya(e,o){return null}Ha(e){return __PRIVATE_newLocalStore(this.persistence,new __PRIVATE_QueryEngine,e.initialUser,this.serializer)}ja(e){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.ei,this.serializer)}za(e){return new __PRIVATE_MemorySharedClientState}async terminate(){var e,o;(e=this.gcScheduler)===null||e===void 0||e.stop(),(o=this.indexBackfillerScheduler)===null||o===void 0||o.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}__PRIVATE_MemoryOfflineComponentProvider.provider={build:()=>new __PRIVATE_MemoryOfflineComponentProvider};class __PRIVATE_LruGcMemoryOfflineComponentProvider extends __PRIVATE_MemoryOfflineComponentProvider{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,o){__PRIVATE_hardAssert(this.persistence.referenceDelegate instanceof __PRIVATE_MemoryLruDelegate);const s=this.persistence.referenceDelegate.garbageCollector;return new __PRIVATE_LruScheduler(s,e.asyncQueue,o)}ja(e){const o=this.cacheSizeBytes!==void 0?LruParams.withCacheSize(this.cacheSizeBytes):LruParams.DEFAULT;return new __PRIVATE_MemoryPersistence(s=>__PRIVATE_MemoryLruDelegate.ei(s,o),this.serializer)}}class OnlineComponentProvider{async initialize(e,o){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(o),this.remoteStore=this.createRemoteStore(o),this.eventManager=this.createEventManager(o),this.syncEngine=this.createSyncEngine(o,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new __PRIVATE_EventManagerImpl}()}createDatastore(e){const o=__PRIVATE_newSerializer(e.databaseInfo.databaseId),s=function(h){return new __PRIVATE_WebChannelConnection(h)}(e.databaseInfo);return function(h,_,$,nt){return new __PRIVATE_DatastoreImpl(h,_,$,nt)}(e.authCredentials,e.appCheckCredentials,s,o)}createRemoteStore(e){return function(s,c,h,_,$){return new __PRIVATE_RemoteStoreImpl(s,c,h,_,$)}(this.localStore,this.datastore,e.asyncQueue,o=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,o,0),function(){return __PRIVATE_BrowserConnectivityMonitor.p()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor}())}createSyncEngine(e,o){return function(c,h,_,$,nt,tt,et){const d=new __PRIVATE_SyncEngineImpl(c,h,_,$,nt,tt);return et&&(d.$a=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,o)}async terminate(){var e,o;await async function(c){const h=__PRIVATE_debugCast(c);__PRIVATE_logDebug("RemoteStore","RemoteStore shutting down."),h.k_.add(5),await __PRIVATE_disableNetworkInternal(h),h.Q_.shutdown(),h.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(o=this.eventManager)===null||o===void 0||o.terminate()}}OnlineComponentProvider.provider={build:()=>new OnlineComponentProvider};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncObserver{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):__PRIVATE_logError("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,o){setTimeout(()=>{this.muted||e(o)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirestoreClient{constructor(e,o,s,c,h){this.authCredentials=e,this.appCheckCredentials=o,this.asyncQueue=s,this.databaseInfo=c,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=h,this.authCredentials.start(s,async _=>{__PRIVATE_logDebug("FirestoreClient","Received user=",_.uid),await this.authCredentialListener(_),this.user=_}),this.appCheckCredentials.start(s,_=>(__PRIVATE_logDebug("FirestoreClient","Received new app check token=",_),this.appCheckCredentialListener(_,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(o){const s=__PRIVATE_wrapInUserErrorIfRecoverable(o,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function __PRIVATE_setOfflineComponentProvider(i,e){i.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug("FirestoreClient","Initializing OfflineComponentProvider");const o=i.configuration;await e.initialize(o);let s=o.initialUser;i.setCredentialChangeListener(async c=>{s.isEqual(c)||(await __PRIVATE_localStoreHandleUserChange(e.localStore,c),s=c)}),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e}async function __PRIVATE_setOnlineComponentProvider(i,e){i.asyncQueue.verifyOperationInProgress();const o=await __PRIVATE_ensureOfflineComponents(i);__PRIVATE_logDebug("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(o,i.configuration),i.setCredentialChangeListener(s=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,s)),i.setAppCheckTokenChangeListener((s,c)=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,c)),i._onlineComponents=e}async function __PRIVATE_ensureOfflineComponents(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){__PRIVATE_logDebug("FirestoreClient","Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(i,i._uninitializedComponentsProvider._offline)}catch(e){const o=e;if(!function(c){return c.name==="FirebaseError"?c.code===D.FAILED_PRECONDITION||c.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&c instanceof DOMException)||c.code===22||c.code===20||c.code===11}(o))throw o;__PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+o),await __PRIVATE_setOfflineComponentProvider(i,new __PRIVATE_MemoryOfflineComponentProvider)}}else __PRIVATE_logDebug("FirestoreClient","Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(i,new __PRIVATE_LruGcMemoryOfflineComponentProvider(void 0));return i._offlineComponents}async function __PRIVATE_ensureOnlineComponents(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(__PRIVATE_logDebug("FirestoreClient","Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(i,i._uninitializedComponentsProvider._online)):(__PRIVATE_logDebug("FirestoreClient","Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(i,new OnlineComponentProvider))),i._onlineComponents}function __PRIVATE_getSyncEngine(i){return __PRIVATE_ensureOnlineComponents(i).then(e=>e.syncEngine)}async function __PRIVATE_getEventManager(i){const e=await __PRIVATE_ensureOnlineComponents(i),o=e.eventManager;return o.onListen=__PRIVATE_syncEngineListen.bind(null,e.syncEngine),o.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,e.syncEngine),o.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,e.syncEngine),o.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,e.syncEngine),o}function __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(i,e,o={}){const s=new __PRIVATE_Deferred;return i.asyncQueue.enqueueAndForget(async()=>function(h,_,$,nt,tt){const et=new __PRIVATE_AsyncObserver({next:a=>{et.eu(),_.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(h,d));const g=a.docs.has($);!g&&a.fromCache?tt.reject(new FirestoreError(D.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&a.fromCache&&nt&&nt.source==="server"?tt.reject(new FirestoreError(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):tt.resolve(a)},error:a=>tt.reject(a)}),d=new __PRIVATE_QueryListener(__PRIVATE_newQueryForPath($.path),et,{includeMetadataChanges:!0,ua:!0});return __PRIVATE_eventManagerListen(h,d)}(await __PRIVATE_getEventManager(i),i.asyncQueue,e,o,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const we=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(i,e,o){if(!o)throw new FirestoreError(D.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function __PRIVATE_validateIsNotUsedTogether(i,e,o,s){if(e===!0&&s===!0)throw new FirestoreError(D.INVALID_ARGUMENT,`${i} and ${o} cannot be used together.`)}function __PRIVATE_validateDocumentPath(i){if(!DocumentKey.isDocumentKey(i))throw new FirestoreError(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function __PRIVATE_validateCollectionPath(i){if(DocumentKey.isDocumentKey(i))throw new FirestoreError(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function __PRIVATE_valueDescription(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":fail()}function __PRIVATE_cast(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new FirestoreError(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const o=__PRIVATE_valueDescription(i);throw new FirestoreError(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${o}`)}}return i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirestoreSettingsImpl{constructor(e){var o,s;if(e.host===void 0){if(e.ssl!==void 0)throw new FirestoreError(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(o=e.ssl)===null||o===void 0||o;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new FirestoreError(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(h){if(h.timeoutSeconds!==void 0){if(isNaN(h.timeoutSeconds))throw new FirestoreError(D.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (must not be NaN)`);if(h.timeoutSeconds<5)throw new FirestoreError(D.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (minimum allowed value is 5)`);if(h.timeoutSeconds>30)throw new FirestoreError(D.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,c){return s.timeoutSeconds===c.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Firestore$1{constructor(e,o,s,c){this._authCredentials=e,this._appCheckCredentials=o,this._databaseId=s,this._app=c,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new FirestoreError(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new FirestoreError(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(s.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new FirestoreError(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(o){const s=we.get(o);s&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),we.delete(o),s.terminate())}(this),Promise.resolve()}}function connectFirestoreEmulator(i,e,o,s={}){var c;const h=(i=__PRIVATE_cast(i,Firestore$1))._getSettings(),_=`${e}:${o}`;if(h.host!=="firestore.googleapis.com"&&h.host!==_&&__PRIVATE_logWarn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),i._setSettings(Object.assign(Object.assign({},h),{host:_,ssl:!1})),s.mockUserToken){let $,nt;if(typeof s.mockUserToken=="string")$=s.mockUserToken,nt=User.MOCK_USER;else{$=createMockUserToken(s.mockUserToken,(c=i._app)===null||c===void 0?void 0:c.options.projectId);const tt=s.mockUserToken.sub||s.mockUserToken.user_id;if(!tt)throw new FirestoreError(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");nt=new User(tt)}i._authCredentials=new __PRIVATE_EmulatorAuthCredentialsProvider(new __PRIVATE_OAuthToken($,nt))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Query{constructor(e,o,s){this.converter=o,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Query(this.firestore,e,this._query)}}class DocumentReference{constructor(e,o,s){this.converter=o,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new DocumentReference(this.firestore,e,this._key)}}class CollectionReference extends Query{constructor(e,o,s){super(e,o,__PRIVATE_newQueryForPath(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new DocumentReference(this.firestore,null,new DocumentKey(e))}withConverter(e){return new CollectionReference(this.firestore,e,this._path)}}function collection(i,e,...o){if(i=getModularInstance(i),__PRIVATE_validateNonEmptyArgument("collection","path",e),i instanceof Firestore$1){const s=ResourcePath.fromString(e,...o);return __PRIVATE_validateCollectionPath(s),new CollectionReference(i,null,s)}{if(!(i instanceof DocumentReference||i instanceof CollectionReference))throw new FirestoreError(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(ResourcePath.fromString(e,...o));return __PRIVATE_validateCollectionPath(s),new CollectionReference(i.firestore,null,s)}}function doc(i,e,...o){if(i=getModularInstance(i),arguments.length===1&&(e=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",e),i instanceof Firestore$1){const s=ResourcePath.fromString(e,...o);return __PRIVATE_validateDocumentPath(s),new DocumentReference(i,null,new DocumentKey(s))}{if(!(i instanceof DocumentReference||i instanceof CollectionReference))throw new FirestoreError(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(ResourcePath.fromString(e,...o));return __PRIVATE_validateDocumentPath(s),new DocumentReference(i.firestore,i instanceof CollectionReference?i.converter:null,new DocumentKey(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this.fu=()=>{const s=getDocument();s&&__PRIVATE_logDebug("AsyncQueue","Visibility state changed to "+s.visibilityState),this.r_.Jo()},this.gu=e;const o=getDocument();o&&typeof o.addEventListener=="function"&&o.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const o=getDocument();o&&typeof o.removeEventListener=="function"&&o.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const o=new __PRIVATE_Deferred;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(o.resolve,o.reject),o.promise)).then(()=>o.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const o=this.gu.then(()=>(this.Ru=!0,e().catch(s=>{this.Au=s,this.Ru=!1;const c=function(_){let $=_.message||"";return _.stack&&($=_.stack.includes(_.message)?_.stack:_.message+`
`+_.stack),$}(s);throw __PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",c),s}).then(s=>(this.Ru=!1,s))));return this.gu=o,o}enqueueAfterDelay(e,o,s){this.pu(),this.mu.indexOf(e)>-1&&(o=0);const c=DelayedOperation.createAndSchedule(this,e,o,s,h=>this.Su(h));return this.du.push(c),c}pu(){this.Au&&fail()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const o of this.du)if(o.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((o,s)=>o.targetTimeMs-s.targetTimeMs);for(const o of this.du)if(o.skipDelay(),e!=="all"&&o.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const o=this.du.indexOf(e);this.du.splice(o,1)}}function __PRIVATE_isPartialObserver(i){return function(o,s){if(typeof o!="object"||o===null)return!1;const c=o;for(const h of s)if(h in c&&typeof c[h]=="function")return!0;return!1}(i,["next","error","complete"])}class Firestore extends Firestore$1{constructor(e,o,s,c){super(e,o,s,c),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=(c==null?void 0:c.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,await e}}}function getFirestore(i,e){const o=typeof i=="object"?i:getApp(),s=typeof i=="string"?i:"(default)",c=_getProvider(o,"firestore").getImmediate({identifier:s});if(!c._initialized){const h=getDefaultEmulatorHostnameAndPort("firestore");h&&connectFirestoreEmulator(c,...h)}return c}function ensureFirestoreConfigured(i){if(i._terminated)throw new FirestoreError(D.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||__PRIVATE_configureFirestore(i),i._firestoreClient}function __PRIVATE_configureFirestore(i){var e,o,s;const c=i._freezeSettings(),h=function($,nt,tt,et){return new DatabaseInfo($,nt,tt,et.host,et.ssl,et.experimentalForceLongPolling,et.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(et.experimentalLongPollingOptions),et.useFetchStreams)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,c);i._componentsProvider||!((o=c.localCache)===null||o===void 0)&&o._offlineComponentProvider&&(!((s=c.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(i._componentsProvider={_offline:c.localCache._offlineComponentProvider,_online:c.localCache._onlineComponentProvider}),i._firestoreClient=new FirestoreClient(i._authCredentials,i._appCheckCredentials,i._queue,h,i._componentsProvider&&function($){const nt=$==null?void 0:$._online.build();return{_offline:$==null?void 0:$._offline.build(nt),_online:nt}}(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bytes{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bytes(ByteString.fromBase64String(e))}catch(o){throw new FirestoreError(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+o)}}static fromUint8Array(e){return new Bytes(ByteString.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldPath{constructor(...e){for(let o=0;o<e.length;++o)if(e[o].length===0)throw new FirestoreError(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldValue{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GeoPoint{constructor(e,o){if(!isFinite(e)||e<-90||e>90)throw new FirestoreError(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(o)||o<-180||o>180)throw new FirestoreError(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+o);this._lat=e,this._long=o}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return __PRIVATE_primitiveComparator(this._lat,e._lat)||__PRIVATE_primitiveComparator(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VectorValue{constructor(e){this._values=(e||[]).map(o=>o)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,c){if(s.length!==c.length)return!1;for(let h=0;h<s.length;++h)if(s[h]!==c[h])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const be=/^__.*__$/;class ParsedSetData{constructor(e,o,s){this.data=e,this.fieldMask=o,this.fieldTransforms=s}toMutation(e,o){return this.fieldMask!==null?new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,o,this.fieldTransforms):new __PRIVATE_SetMutation(e,this.data,o,this.fieldTransforms)}}class ParsedUpdateData{constructor(e,o,s){this.data=e,this.fieldMask=o,this.fieldTransforms=s}toMutation(e,o){return new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,o,this.fieldTransforms)}}function __PRIVATE_isWrite(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fail()}}class __PRIVATE_ParseContextImpl{constructor(e,o,s,c,h,_){this.settings=e,this.databaseId=o,this.serializer=s,this.ignoreUndefinedProperties=c,h===void 0&&this.Fu(),this.fieldTransforms=h||[],this.fieldMask=_||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new __PRIVATE_ParseContextImpl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var o;const s=(o=this.path)===null||o===void 0?void 0:o.child(e),c=this.xu({path:s,Nu:!1});return c.Lu(e),c}Bu(e){var o;const s=(o=this.path)===null||o===void 0?void 0:o.child(e),c=this.xu({path:s,Nu:!1});return c.Fu(),c}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return __PRIVATE_createError(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(o=>e.isPrefixOf(o))!==void 0||this.fieldTransforms.find(o=>e.isPrefixOf(o.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(__PRIVATE_isWrite(this.Mu)&&be.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class __PRIVATE_UserDataReader{constructor(e,o,s){this.databaseId=e,this.ignoreUndefinedProperties=o,this.serializer=s||__PRIVATE_newSerializer(e)}$u(e,o,s,c=!1){return new __PRIVATE_ParseContextImpl({Mu:e,methodName:o,Ku:s,path:FieldPath$1.emptyPath(),Nu:!1,Qu:c},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function __PRIVATE_newUserDataReader(i){const e=i._freezeSettings(),o=__PRIVATE_newSerializer(i._databaseId);return new __PRIVATE_UserDataReader(i._databaseId,!!e.ignoreUndefinedProperties,o)}function __PRIVATE_parseSetData(i,e,o,s,c,h={}){const _=i.$u(h.merge||h.mergeFields?2:0,e,o,c);__PRIVATE_validatePlainObject("Data must be an object, but it was:",_,s);const $=__PRIVATE_parseObject(s,_);let nt,tt;if(h.merge)nt=new FieldMask(_.fieldMask),tt=_.fieldTransforms;else if(h.mergeFields){const et=[];for(const d of h.mergeFields){const a=__PRIVATE_fieldPathFromArgument$1(e,d,o);if(!_.contains(a))throw new FirestoreError(D.INVALID_ARGUMENT,`Field '${a}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(et,a)||et.push(a)}nt=new FieldMask(et),tt=_.fieldTransforms.filter(d=>nt.covers(d.field))}else nt=null,tt=_.fieldTransforms;return new ParsedSetData(new ObjectValue$1($),nt,tt)}class __PRIVATE_DeleteFieldValueImpl extends FieldValue{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof __PRIVATE_DeleteFieldValueImpl}}function __PRIVATE_parseUpdateData(i,e,o,s){const c=i.$u(1,e,o);__PRIVATE_validatePlainObject("Data must be an object, but it was:",c,s);const h=[],_=ObjectValue$1.empty();forEach(s,(nt,tt)=>{const et=__PRIVATE_fieldPathFromDotSeparatedString(e,nt,o);tt=getModularInstance(tt);const d=c.Bu(et);if(tt instanceof __PRIVATE_DeleteFieldValueImpl)h.push(et);else{const a=__PRIVATE_parseData(tt,d);a!=null&&(h.push(et),_.set(et,a))}});const $=new FieldMask(h);return new ParsedUpdateData(_,$,c.fieldTransforms)}function __PRIVATE_parseUpdateVarargs(i,e,o,s,c,h){if(i.$u(1,e,o),__PRIVATE_fieldPathFromArgument$1(e,s,o),h.length%2!=0)throw new FirestoreError(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`)}function __PRIVATE_parseData(i,e){if(__PRIVATE_looksLikeJsonObject(i=getModularInstance(i)))return __PRIVATE_validatePlainObject("Unsupported field value:",e,i),__PRIVATE_parseObject(i,e);if(i instanceof FieldValue)return function(s,c){if(!__PRIVATE_isWrite(c.Mu))throw c.qu(`${s._methodName}() can only be used with update() and set()`);if(!c.path)throw c.qu(`${s._methodName}() is not currently supported inside arrays`);const h=s._toFieldTransform(c);h&&c.fieldTransforms.push(h)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(s,c){const h=[];let _=0;for(const $ of s){let nt=__PRIVATE_parseData($,c.ku(_));nt==null&&(nt={nullValue:"NULL_VALUE"}),h.push(nt),_++}return{arrayValue:{values:h}}}(i,e)}return function(s,c){if((s=getModularInstance(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return toNumber(c.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const h=Timestamp.fromDate(s);return{timestampValue:toTimestamp(c.serializer,h)}}if(s instanceof Timestamp){const h=new Timestamp(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:toTimestamp(c.serializer,h)}}if(s instanceof GeoPoint)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Bytes)return{bytesValue:__PRIVATE_toBytes(c.serializer,s._byteString)};if(s instanceof DocumentReference){const h=c.databaseId,_=s.firestore._databaseId;if(!_.isEqual(h))throw c.qu(`Document reference is for database ${_.projectId}/${_.database} but should be for database ${h.projectId}/${h.database}`);return{referenceValue:__PRIVATE_toResourceName(s.firestore._databaseId||c.databaseId,s._key.path)}}if(s instanceof VectorValue)return function(_,$){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:_.toArray().map(nt=>{if(typeof nt!="number")throw $.qu("VectorValues must only contain numeric values.");return __PRIVATE_toDouble($.serializer,nt)})}}}}}}(s,c);throw c.qu(`Unsupported field value: ${__PRIVATE_valueDescription(s)}`)}(i,e)}function __PRIVATE_parseObject(i,e){const o={};return isEmpty$1(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):forEach(i,(s,c)=>{const h=__PRIVATE_parseData(c,e.Ou(s));h!=null&&(o[s]=h)}),{mapValue:{fields:o}}}function __PRIVATE_looksLikeJsonObject(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Timestamp||i instanceof GeoPoint||i instanceof Bytes||i instanceof DocumentReference||i instanceof FieldValue||i instanceof VectorValue)}function __PRIVATE_validatePlainObject(i,e,o){if(!__PRIVATE_looksLikeJsonObject(o)||!function(c){return typeof c=="object"&&c!==null&&(Object.getPrototypeOf(c)===Object.prototype||Object.getPrototypeOf(c)===null)}(o)){const s=__PRIVATE_valueDescription(o);throw s==="an object"?e.qu(i+" a custom object"):e.qu(i+" "+s)}}function __PRIVATE_fieldPathFromArgument$1(i,e,o){if((e=getModularInstance(e))instanceof FieldPath)return e._internalPath;if(typeof e=="string")return __PRIVATE_fieldPathFromDotSeparatedString(i,e);throw __PRIVATE_createError("Field path arguments must be of type string or ",i,!1,void 0,o)}const De=new RegExp("[~\\*/\\[\\]]");function __PRIVATE_fieldPathFromDotSeparatedString(i,e,o){if(e.search(De)>=0)throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,o);try{return new FieldPath(...e.split("."))._internalPath}catch{throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,o)}}function __PRIVATE_createError(i,e,o,s,c){const h=s&&!s.isEmpty(),_=c!==void 0;let $=`Function ${e}() called with invalid data`;o&&($+=" (via `toFirestore()`)"),$+=". ";let nt="";return(h||_)&&(nt+=" (found",h&&(nt+=` in field ${s}`),_&&(nt+=` in document ${c}`),nt+=")"),new FirestoreError(D.INVALID_ARGUMENT,$+i+nt)}function __PRIVATE_fieldMaskContains(i,e){return i.some(o=>o.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSnapshot$1{constructor(e,o,s,c,h){this._firestore=e,this._userDataWriter=o,this._key=s,this._document=c,this._converter=h}get id(){return this._key.path.lastSegment()}get ref(){return new DocumentReference(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const o=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(o!==null)return this._userDataWriter.convertValue(o)}}}class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}}function __PRIVATE_fieldPathFromArgument(i,e){return typeof e=="string"?__PRIVATE_fieldPathFromDotSeparatedString(i,e):e instanceof FieldPath?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateHasExplicitOrderByForLimitToLast(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new FirestoreError(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AbstractUserDataWriter{convertValue(e,o="none"){switch(__PRIVATE_typeOrder(e)){case 0:return null;case 1:return e.booleanValue;case 2:return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,o);case 5:return e.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,o);case 11:return this.convertObject(e.mapValue,o);case 10:return this.convertVectorValue(e.mapValue);default:throw fail()}}convertObject(e,o){return this.convertObjectMap(e.fields,o)}convertObjectMap(e,o="none"){const s={};return forEach(e,(c,h)=>{s[c]=this.convertValue(h,o)}),s}convertVectorValue(e){var o,s,c;const h=(c=(s=(o=e.fields)===null||o===void 0?void 0:o.value.arrayValue)===null||s===void 0?void 0:s.values)===null||c===void 0?void 0:c.map(_=>__PRIVATE_normalizeNumber(_.doubleValue));return new VectorValue(h)}convertGeoPoint(e){return new GeoPoint(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(e.longitude))}convertArray(e,o){return(e.values||[]).map(s=>this.convertValue(s,o))}convertServerTimestamp(e,o){switch(o){case"previous":const s=__PRIVATE_getPreviousValue(e);return s==null?null:this.convertValue(s,o);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime(e));default:return null}}convertTimestamp(e){const o=__PRIVATE_normalizeTimestamp(e);return new Timestamp(o.seconds,o.nanos)}convertDocumentKey(e,o){const s=ResourcePath.fromString(e);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(s));const c=new DatabaseId(s.get(1),s.get(3)),h=new DocumentKey(s.popFirst(5));return c.isEqual(o)||__PRIVATE_logError(`Document ${h} contains a document reference within a different database (${c.projectId}/${c.database}) which is not supported. It will be treated as a reference in the current database (${o.projectId}/${o.database}) instead.`),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_applyFirestoreDataConverter(i,e,o){let s;return s=i?i.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotMetadata{constructor(e,o){this.hasPendingWrites=e,this.fromCache=o}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class DocumentSnapshot extends DocumentSnapshot$1{constructor(e,o,s,c,h,_){super(e,o,s,c,_),this._firestore=e,this._firestoreImpl=e,this.metadata=h}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const o=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(o,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,o={}){if(this._document){const s=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,o.serverTimestamps)}}}class QueryDocumentSnapshot extends DocumentSnapshot{data(e={}){return super.data(e)}}class QuerySnapshot{constructor(e,o,s,c){this._firestore=e,this._userDataWriter=o,this._snapshot=c,this.metadata=new SnapshotMetadata(c.hasPendingWrites,c.fromCache),this.query=s}get docs(){const e=[];return this.forEach(o=>e.push(o)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,o){this._snapshot.docs.forEach(s=>{e.call(o,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,s.key,s,new SnapshotMetadata(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const o=!!e.includeMetadataChanges;if(o&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===o||(this._cachedChanges=function(c,h){if(c._snapshot.oldDocs.isEmpty()){let _=0;return c._snapshot.docChanges.map($=>{const nt=new QueryDocumentSnapshot(c._firestore,c._userDataWriter,$.doc.key,$.doc,new SnapshotMetadata(c._snapshot.mutatedKeys.has($.doc.key),c._snapshot.fromCache),c.query.converter);return $.doc,{type:"added",doc:nt,oldIndex:-1,newIndex:_++}})}{let _=c._snapshot.oldDocs;return c._snapshot.docChanges.filter($=>h||$.type!==3).map($=>{const nt=new QueryDocumentSnapshot(c._firestore,c._userDataWriter,$.doc.key,$.doc,new SnapshotMetadata(c._snapshot.mutatedKeys.has($.doc.key),c._snapshot.fromCache),c.query.converter);let tt=-1,et=-1;return $.type!==0&&(tt=_.indexOf($.doc.key),_=_.delete($.doc.key)),$.type!==1&&(_=_.add($.doc),et=_.indexOf($.doc.key)),{type:__PRIVATE_resultChangeType($.type),doc:nt,oldIndex:tt,newIndex:et}})}}(this,o),this._cachedChangesIncludeMetadataChanges=o),this._cachedChanges}}function __PRIVATE_resultChangeType(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fail()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getDoc(i){i=__PRIVATE_cast(i,DocumentReference);const e=__PRIVATE_cast(i.firestore,Firestore);return __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(ensureFirestoreConfigured(e),i._key).then(o=>__PRIVATE_convertToDocSnapshot(e,i,o))}class __PRIVATE_ExpUserDataWriter extends AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bytes(e)}convertReference(e){const o=this.convertDocumentKey(e,this.firestore._databaseId);return new DocumentReference(this.firestore,null,o)}}function setDoc(i,e,o){i=__PRIVATE_cast(i,DocumentReference);const s=__PRIVATE_cast(i.firestore,Firestore),c=__PRIVATE_applyFirestoreDataConverter(i.converter,e);return executeWrite(s,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(s),"setDoc",i._key,c,i.converter!==null,o).toMutation(i._key,Precondition.none())])}function updateDoc(i,e,o,...s){i=__PRIVATE_cast(i,DocumentReference);const c=__PRIVATE_cast(i.firestore,Firestore),h=__PRIVATE_newUserDataReader(c);let _;return _=typeof(e=getModularInstance(e))=="string"||e instanceof FieldPath?__PRIVATE_parseUpdateVarargs(h,"updateDoc",i._key,e,o,s):__PRIVATE_parseUpdateData(h,"updateDoc",i._key,e),executeWrite(c,[_.toMutation(i._key,Precondition.exists(!0))])}function addDoc(i,e){const o=__PRIVATE_cast(i.firestore,Firestore),s=doc(i),c=__PRIVATE_applyFirestoreDataConverter(i.converter,e);return executeWrite(o,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(i.firestore),"addDoc",s._key,c,i.converter!==null,{}).toMutation(s._key,Precondition.exists(!1))]).then(()=>s)}function onSnapshot(i,...e){var o,s,c;i=getModularInstance(i);let h={includeMetadataChanges:!1,source:"default"},_=0;typeof e[_]!="object"||__PRIVATE_isPartialObserver(e[_])||(h=e[_],_++);const $={includeMetadataChanges:h.includeMetadataChanges,source:h.source};if(__PRIVATE_isPartialObserver(e[_])){const d=e[_];e[_]=(o=d.next)===null||o===void 0?void 0:o.bind(d),e[_+1]=(s=d.error)===null||s===void 0?void 0:s.bind(d),e[_+2]=(c=d.complete)===null||c===void 0?void 0:c.bind(d)}let nt,tt,et;if(i instanceof DocumentReference)tt=__PRIVATE_cast(i.firestore,Firestore),et=__PRIVATE_newQueryForPath(i._key.path),nt={next:d=>{e[_]&&e[_](__PRIVATE_convertToDocSnapshot(tt,i,d))},error:e[_+1],complete:e[_+2]};else{const d=__PRIVATE_cast(i,Query);tt=__PRIVATE_cast(d.firestore,Firestore),et=d._query;const a=new __PRIVATE_ExpUserDataWriter(tt);nt={next:g=>{e[_]&&e[_](new QuerySnapshot(tt,a,d,g))},error:e[_+1],complete:e[_+2]},__PRIVATE_validateHasExplicitOrderByForLimitToLast(i._query)}return function(a,g,j,rt){const ot=new __PRIVATE_AsyncObserver(rt),it=new __PRIVATE_QueryListener(g,ot,j);return a.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerListen(await __PRIVATE_getEventManager(a),it)),()=>{ot.eu(),a.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerUnlisten(await __PRIVATE_getEventManager(a),it))}}(ensureFirestoreConfigured(tt),et,$,nt)}function executeWrite(i,e){return function(s,c){const h=new __PRIVATE_Deferred;return s.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_getSyncEngine(s),c,h)),h.promise}(ensureFirestoreConfigured(i),e)}function __PRIVATE_convertToDocSnapshot(i,e,o){const s=o.docs.get(e._key),c=new __PRIVATE_ExpUserDataWriter(i);return new DocumentSnapshot(i,c,e._key,s,new SnapshotMetadata(o.hasPendingWrites,o.fromCache),e.converter)}(function(e,o=!0){(function(c){S=c})(SDK_VERSION),_registerComponent(new Component("firestore",(s,{instanceIdentifier:c,options:h})=>{const _=s.getProvider("app").getImmediate(),$=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(s.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(s.getProvider("app-check-internal")),function(tt,et){if(!Object.prototype.hasOwnProperty.apply(tt.options,["projectId"]))throw new FirestoreError(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(tt.options.projectId,et)}(_,c),_);return h=Object.assign({useFetchStreams:o},h),$._setSettings(h),$},"PUBLIC").setMultipleInstances(!0)),registerVersion(w,"4.7.5",e),registerVersion(w,"4.7.5","esm2017")})();function dispatchCallback(i,e){i&&i(e)}function reverseDictionary(i){return Object.fromEntries(Object.entries(i).map(([e,o])=>[o,e]))}function escapeRegExp(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const Callable=class{constructor(){let i=function(...e){return i._call(...e)};return Object.setPrototypeOf(i,new.target.prototype)}_call(...i){throw Error("Must implement _call method in subclass")}};function isTypedArray(i){var e,o,s;return((s=(o=(e=i==null?void 0:i.prototype)==null?void 0:e.__proto__)==null?void 0:o.constructor)==null?void 0:s.name)==="TypedArray"}function isIntegralNumber(i){return Number.isInteger(i)||typeof i=="bigint"}function exists(i){return i!=null}function calculateDimensions(i){const e=[];let o=i;for(;Array.isArray(o);)e.push(o.length),o=o[0];return e}function pop(i,e,o=void 0){const s=i[e];if(s!==void 0)return delete i[e],s;if(o===void 0)throw Error(`Key ${e} does not exist in object.`);return o}function mergeArrays(...i){return Array.prototype.concat.apply([],i)}function product(...i){return i.reduce((e,o)=>e.flatMap(s=>o.map(c=>[s,c])))}function calculateReflectOffset(i,e){return Math.abs((i+e)%(2*e)-e)}const sharp={},ONNX_NODE=Object.freeze(Object.defineProperty({__proto__:null,default:sharp},Symbol.toStringTag,{value:"Module"}));var ortWeb_min$1={exports:{}};const backends={},backendsSortedByPriority=[],registerBackend=(i,e,o)=>{if(e&&typeof e.init=="function"&&typeof e.createSessionHandler=="function"){const s=backends[i];if(s===void 0)backends[i]={backend:e,priority:o};else{if(s.priority>o)return;if(s.priority===o&&s.backend!==e)throw new Error(`cannot register backend "${i}" using priority ${o}`)}if(o>=0){const c=backendsSortedByPriority.indexOf(i);c!==-1&&backendsSortedByPriority.splice(c,1);for(let h=0;h<backendsSortedByPriority.length;h++)if(backends[backendsSortedByPriority[h]].priority<=o){backendsSortedByPriority.splice(h,0,i);return}backendsSortedByPriority.push(i)}return}throw new TypeError("not a valid backend")},resolveBackend=async i=>{const e=i.length===0?backendsSortedByPriority:i,o=[];for(const s of e){const c=backends[s];if(c){if(c.initialized)return c.backend;if(c.aborted)continue;const h=!!c.initPromise;try{return h||(c.initPromise=c.backend.init()),await c.initPromise,c.initialized=!0,c.backend}catch(_){h||o.push({name:s,err:_}),c.aborted=!0}finally{delete c.initPromise}}}throw new Error(`no available backend found. ERR: ${o.map(s=>`[${s.name}] ${s.err}`).join(", ")}`)};class EnvImpl{constructor(){this.wasm={},this.webgl={},this.logLevelInternal="warning"}set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);this.logLevelInternal=e}}get logLevel(){return this.logLevelInternal}}const env$2=new EnvImpl,isBigInt64ArrayAvailable=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",isBigUint64ArrayAvailable=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function",NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);isBigInt64ArrayAvailable&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("int64",BigInt64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigInt64Array,"int64"));isBigUint64ArrayAvailable&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("uint64",BigUint64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigUint64Array,"uint64"));const calculateSize=i=>{let e=1;for(let o=0;o<i.length;o++){const s=i[o];if(typeof s!="number"||!Number.isSafeInteger(s))throw new TypeError(`dims[${o}] must be an integer, got: ${s}`);if(s<0)throw new RangeError(`dims[${o}] must be a non-negative integer, got: ${s}`);e*=s}return e};let Tensor$2=class Wr{constructor(e,o,s){let c,h,_;if(typeof e=="string")if(c=e,_=s,e==="string"){if(!Array.isArray(o))throw new TypeError("A string tensor's data must be a string array.");h=o}else{const nt=NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(e);if(nt===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(o))h=nt.from(o);else if(o instanceof nt)h=o;else throw new TypeError(`A ${c} tensor's data must be type of ${nt}`)}else if(_=o,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const nt=typeof e[0];if(nt==="string")c="string",h=e;else if(nt==="boolean")c="bool",h=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${nt}.`)}else{const nt=NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.get(e.constructor);if(nt===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);c=nt,h=e}if(_===void 0)_=[h.length];else if(!Array.isArray(_))throw new TypeError("A tensor's dims must be a number array");const $=calculateSize(_);if($!==h.length)throw new Error(`Tensor's size(${$}) does not match data length(${h.length}).`);this.dims=_,this.type=c,this.data=h,this.size=$}static bufferToTensor(e,o){if(e===void 0)throw new Error("Image buffer must be defined");if(o.height===void 0||o.width===void 0)throw new Error("Image height and width must be defined");const{height:s,width:c}=o,h=o.norm;let _,$;h===void 0||h.mean===void 0?_=255:_=h.mean,h===void 0||h.bias===void 0?$=0:$=h.bias;const nt=o.bitmapFormat!==void 0?o.bitmapFormat:"RGBA",tt=o.tensorFormat!==void 0&&o.tensorFormat!==void 0?o.tensorFormat:"RGB",et=s*c,d=tt==="RGBA"?new Float32Array(et*4):new Float32Array(et*3);let a=4,g=0,j=1,rt=2,ot=3,it=0,at=et,lt=et*2,ct=-1;nt==="RGB"&&(a=3,g=0,j=1,rt=2,ot=-1),tt==="RGBA"?ct=et*3:tt==="RBG"?(it=0,lt=et,at=et*2):tt==="BGR"&&(lt=0,at=et,it=et*2);for(let mt=0;mt<et;mt++,g+=a,rt+=a,j+=a,ot+=a)d[it++]=(e[g]+$)/_,d[at++]=(e[j]+$)/_,d[lt++]=(e[rt]+$)/_,ct!==-1&&ot!==-1&&(d[ct++]=(e[ot]+$)/_);return tt==="RGBA"?new Wr("float32",d,[1,4,s,c]):new Wr("float32",d,[1,3,s,c])}static async fromImage(e,o){const s=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,c=typeof ImageData<"u"&&e instanceof ImageData,h=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,_=typeof String<"u"&&(e instanceof String||typeof e=="string");let $,nt={};if(s){const tt=document.createElement("canvas"),et=tt.getContext("2d");if(et!=null){let d=e.naturalHeight,a=e.naturalWidth;if(o!==void 0&&o.resizedHeight!==void 0&&o.resizedWidth!==void 0&&(d=o.resizedHeight,a=o.resizedWidth),o!==void 0){if(nt=o,o.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");if(nt.tensorFormat="RGBA",o.height!==void 0&&o.height!==d)throw new Error("Image input config height doesn't match HTMLImageElement height");if(nt.height=d,o.width!==void 0&&o.width!==a)throw new Error("Image input config width doesn't match HTMLImageElement width");nt.width=a}else nt.tensorFormat="RGBA",nt.height=d,nt.width=a;tt.width=a,tt.height=d,et.drawImage(e,0,0,a,d),$=et.getImageData(0,0,a,d).data}else throw new Error("Can not access image data")}else if(c){const tt="RGBA";let et,d;if(o!==void 0&&o.resizedWidth!==void 0&&o.resizedHeight!==void 0?(et=o.resizedHeight,d=o.resizedWidth):(et=e.height,d=e.width),o!==void 0){if(nt=o,o.bitmapFormat!==void 0&&o.bitmapFormat!==tt)throw new Error("Image input config format must be RGBA for ImageData");nt.bitmapFormat="RGBA"}else nt.bitmapFormat="RGBA";if(nt.height=et,nt.width=d,o!==void 0){const a=document.createElement("canvas");a.width=d,a.height=et;const g=a.getContext("2d");if(g!=null)g.putImageData(e,0,0),$=g.getImageData(0,0,d,et).data;else throw new Error("Can not access image data")}else $=e.data}else if(h){if(o===void 0)throw new Error("Please provide image config with format for Imagebitmap");if(o.bitmapFormat!==void 0)throw new Error("Image input config format must be defined for ImageBitmap");const tt=document.createElement("canvas").getContext("2d");if(tt!=null){const et=e.height,d=e.width;if(tt.drawImage(e,0,0,d,et),$=tt.getImageData(0,0,d,et).data,o!==void 0){if(o.height!==void 0&&o.height!==et)throw new Error("Image input config height doesn't match ImageBitmap height");if(nt.height=et,o.width!==void 0&&o.width!==d)throw new Error("Image input config width doesn't match ImageBitmap width");nt.width=d}else nt.height=et,nt.width=d;return Wr.bufferToTensor($,nt)}else throw new Error("Can not access image data")}else{if(_)return new Promise((tt,et)=>{const d=document.createElement("canvas"),a=d.getContext("2d");if(!e||!a)return et();const g=new Image;g.crossOrigin="Anonymous",g.src=e,g.onload=()=>{d.width=g.width,d.height=g.height,a.drawImage(g,0,0,d.width,d.height);const j=a.getImageData(0,0,d.width,d.height);if(o!==void 0){if(o.height!==void 0&&o.height!==d.height)throw new Error("Image input config height doesn't match ImageBitmap height");if(nt.height=d.height,o.width!==void 0&&o.width!==d.width)throw new Error("Image input config width doesn't match ImageBitmap width");nt.width=d.width}else nt.height=d.height,nt.width=d.width;tt(Wr.bufferToTensor(j.data,nt))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if($!==void 0)return Wr.bufferToTensor($,nt);throw new Error("Input data provided is not supported - aborted tensor creation")}toImageData(e){var o,s;const c=document.createElement("canvas").getContext("2d");let h;if(c!=null){const _=this.dims[3],$=this.dims[2],nt=this.dims[1],tt=e!==void 0&&e.format!==void 0?e.format:"RGB",et=e!==void 0&&((o=e.norm)===null||o===void 0?void 0:o.mean)!==void 0?e.norm.mean:255,d=e!==void 0&&((s=e.norm)===null||s===void 0?void 0:s.bias)!==void 0?e.norm.bias:0,a=$*_;if(e!==void 0){if(e.height!==void 0&&e.height!==$)throw new Error("Image output config height doesn't match tensor height");if(e.width!==void 0&&e.width!==_)throw new Error("Image output config width doesn't match tensor width");if(e.format!==void 0&&nt===4&&e.format!=="RGBA"||nt===3&&e.format!=="RGB"&&e.format!=="BGR")throw new Error("Tensor format doesn't match input tensor dims")}const g=4;let j=0,rt=1,ot=2,it=3,at=0,lt=a,ct=a*2,dt=-1;tt==="RGBA"?(at=0,lt=a,ct=a*2,dt=a*3):tt==="RGB"?(at=0,lt=a,ct=a*2):tt==="RBG"&&(at=0,ct=a,lt=a*2),h=c.createImageData(_,$);for(let mt=0;mt<$*_;j+=g,rt+=g,ot+=g,it+=g,mt++)h.data[j]=(this.data[at++]-d)*et,h.data[rt]=(this.data[lt++]-d)*et,h.data[ot]=(this.data[ct++]-d)*et,h.data[it]=dt===-1?255:(this.data[dt++]-d)*et}else throw new Error("Can not access image data");return h}reshape(e){return new Wr(this.type,this.data,e)}};const Tensor$1=Tensor$2;let InferenceSession$2=class Go{constructor(e){this.handler=e}async run(e,o,s){const c={};let h={};if(typeof e!="object"||e===null||e instanceof Tensor$1||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let _=!0;if(typeof o=="object"){if(o===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(o instanceof Tensor$1)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(o)){if(o.length===0)throw new TypeError("'fetches' cannot be an empty array.");_=!1;for(const tt of o){if(typeof tt!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(tt)===-1)throw new RangeError(`'fetches' contains invalid output name: ${tt}.`);c[tt]=null}if(typeof s=="object"&&s!==null)h=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else{let tt=!1;const et=Object.getOwnPropertyNames(o);for(const d of this.outputNames)if(et.indexOf(d)!==-1){const a=o[d];(a===null||a instanceof Tensor$1)&&(tt=!0,_=!1,c[d]=a)}if(tt){if(typeof s=="object"&&s!==null)h=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else h=o}}else if(typeof o<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const tt of this.inputNames)if(typeof e[tt]>"u")throw new Error(`input '${tt}' is missing in 'feeds'.`);if(_)for(const tt of this.outputNames)c[tt]=null;const $=await this.handler.run(e,c,h),nt={};for(const tt in $)Object.hasOwnProperty.call($,tt)&&(nt[tt]=new Tensor$1($[tt].type,$[tt].data,$[tt].dims));return nt}static async create(e,o,s,c){let h,_={};if(typeof e=="string"){if(h=e,typeof o=="object"&&o!==null)_=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(h=e,typeof o=="object"&&o!==null)_=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){const d=e;let a=0,g=e.byteLength;if(typeof o=="object"&&o!==null)_=o;else if(typeof o=="number"){if(a=o,!Number.isSafeInteger(a))throw new RangeError("'byteOffset' must be an integer.");if(a<0||a>=d.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${d.byteLength}).`);if(g=e.byteLength-a,typeof s=="number"){if(g=s,!Number.isSafeInteger(g))throw new RangeError("'byteLength' must be an integer.");if(g<=0||a+g>d.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${d.byteLength-a}].`);if(typeof c=="object"&&c!==null)_=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else if(typeof s<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof o<"u")throw new TypeError("'options' must be an object.");h=new Uint8Array(d,a,g)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const nt=(_.executionProviders||[]).map(d=>typeof d=="string"?d:d.name),et=await(await resolveBackend(nt)).createSessionHandler(h,_);return new Go(et)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const InferenceSession$1=InferenceSession$2,lib=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession:InferenceSession$1,Tensor:Tensor$1,env:env$2,registerBackend},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(lib);/*!
* ONNX Runtime Web v1.14.0
* Copyright (c) Microsoft Corporation. All rights reserved.
* Licensed under the MIT License.
*/(function(module,exports){(function(i,e){module.exports=e(require$$0)})(self,__WEBPACK_EXTERNAL_MODULE__1670__=>(()=>{var __webpack_modules__={3474:(i,e,o)=>{var s,c=(s=(s=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(h){function _(){return Ct.buffer!=Wt&&An(Ct.buffer),Qt}function $(){return Ct.buffer!=Wt&&An(Ct.buffer),nn}function nt(){return Ct.buffer!=Wt&&An(Ct.buffer),un}function tt(){return Ct.buffer!=Wt&&An(Ct.buffer),en}function et(){return Ct.buffer!=Wt&&An(Ct.buffer),cn}var d,a,g;h=h||{},d||(d=h!==void 0?h:{}),d.ready=new Promise(function(gt,wt){a=gt,g=wt});var j,rt,ot,it,at,lt,ct=Object.assign({},d),dt="./this.program",mt=(gt,wt)=>{throw wt},ht=typeof window=="object",ft=typeof importScripts=="function",ut=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",_t=d.ENVIRONMENT_IS_PTHREAD||!1,bt="";function vt(gt){return d.locateFile?d.locateFile(gt,bt):bt+gt}if(ut){let gt;bt=ft?o(908).dirname(bt)+"/":"//",lt=()=>{at||(it=o(1384),at=o(908))},j=function(wt,St){return lt(),wt=at.normalize(wt),it.readFileSync(wt,St?void 0:"utf8")},ot=wt=>((wt=j(wt,!0)).buffer||(wt=new Uint8Array(wt)),wt),rt=(wt,St,Ot)=>{lt(),wt=at.normalize(wt),it.readFile(wt,function(Nt,jt){Nt?Ot(Nt):St(jt.buffer)})},1<process.argv.length&&(dt=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(wt){if(!(wt instanceof or))throw wt}),process.on("unhandledRejection",function(wt){throw wt}),mt=(wt,St)=>{if(Hn())throw process.exitCode=wt,St;St instanceof or||It("exiting due to exception: "+St),process.exit(wt)},d.inspect=function(){return"[Emscripten Module object]"};try{gt=o(9925)}catch(wt){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),wt}o.g.Worker=gt.Worker}else(ht||ft)&&(ft?bt=self.location.href:typeof document<"u"&&document.currentScript&&(bt=document.currentScript.src),s&&(bt=s),bt=bt.indexOf("blob:")!==0?bt.substr(0,bt.replace(/[?#].*/,"").lastIndexOf("/")+1):"",ut||(j=gt=>{var wt=new XMLHttpRequest;return wt.open("GET",gt,!1),wt.send(null),wt.responseText},ft&&(ot=gt=>{var wt=new XMLHttpRequest;return wt.open("GET",gt,!1),wt.responseType="arraybuffer",wt.send(null),new Uint8Array(wt.response)}),rt=(gt,wt,St)=>{var Ot=new XMLHttpRequest;Ot.open("GET",gt,!0),Ot.responseType="arraybuffer",Ot.onload=()=>{Ot.status==200||Ot.status==0&&Ot.response?wt(Ot.response):St()},Ot.onerror=St,Ot.send(null)}));ut&&typeof performance>"u"&&(o.g.performance=o(6953).performance);var Tt=console.log.bind(console),Mt=console.warn.bind(console);ut&&(lt(),Tt=gt=>it.writeSync(1,gt+`
`),Mt=gt=>it.writeSync(2,gt+`
`));var xt,Pt=d.print||Tt,It=d.printErr||Mt;Object.assign(d,ct),ct=null,d.thisProgram&&(dt=d.thisProgram),d.quit&&(mt=d.quit),d.wasmBinary&&(xt=d.wasmBinary);var Dt=d.noExitRuntime||!1;typeof WebAssembly!="object"&&pn("no native wasm support detected");var Ct,Gt,Wt,Qt,nn,un,en,cn,an=!1,kn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function jn(gt,wt,St){var Ot=(wt>>>=0)+St;for(St=wt;gt[St]&&!(St>=Ot);)++St;if(16<St-wt&&gt.buffer&&kn)return kn.decode(gt.buffer instanceof SharedArrayBuffer?gt.slice(wt,St):gt.subarray(wt,St));for(Ot="";wt<St;){var Nt=gt[wt++];if(128&Nt){var jt=63&gt[wt++];if((224&Nt)==192)Ot+=String.fromCharCode((31&Nt)<<6|jt);else{var Kt=63&gt[wt++];65536>(Nt=(240&Nt)==224?(15&Nt)<<12|jt<<6|Kt:(7&Nt)<<18|jt<<12|Kt<<6|63&gt[wt++])?Ot+=String.fromCharCode(Nt):(Nt-=65536,Ot+=String.fromCharCode(55296|Nt>>10,56320|1023&Nt))}}else Ot+=String.fromCharCode(Nt)}return Ot}function bn(gt,wt){return(gt>>>=0)?jn($(),gt,wt):""}function xn(gt,wt,St,Ot){if(!(0<Ot))return 0;var Nt=St>>>=0;Ot=St+Ot-1;for(var jt=0;jt<gt.length;++jt){var Kt=gt.charCodeAt(jt);if(55296<=Kt&&57343>=Kt&&(Kt=65536+((1023&Kt)<<10)|1023&gt.charCodeAt(++jt)),127>=Kt){if(St>=Ot)break;wt[St++>>>0]=Kt}else{if(2047>=Kt){if(St+1>=Ot)break;wt[St++>>>0]=192|Kt>>6}else{if(65535>=Kt){if(St+2>=Ot)break;wt[St++>>>0]=224|Kt>>12}else{if(St+3>=Ot)break;wt[St++>>>0]=240|Kt>>18,wt[St++>>>0]=128|Kt>>12&63}wt[St++>>>0]=128|Kt>>6&63}wt[St++>>>0]=128|63&Kt}}return wt[St>>>0]=0,St-Nt}function On(gt){for(var wt=0,St=0;St<gt.length;++St){var Ot=gt.charCodeAt(St);127>=Ot?wt++:2047>=Ot?wt+=2:55296<=Ot&&57343>=Ot?(wt+=4,++St):wt+=3}return wt}function An(gt){Wt=gt,d.HEAP8=Qt=new Int8Array(gt),d.HEAP16=new Int16Array(gt),d.HEAP32=un=new Int32Array(gt),d.HEAPU8=nn=new Uint8Array(gt),d.HEAPU16=new Uint16Array(gt),d.HEAPU32=en=new Uint32Array(gt),d.HEAPF32=new Float32Array(gt),d.HEAPF64=cn=new Float64Array(gt)}_t&&(Wt=d.buffer);var vn=d.INITIAL_MEMORY||16777216;if(_t)Ct=d.wasmMemory,Wt=d.buffer;else if(d.wasmMemory)Ct=d.wasmMemory;else if(!((Ct=new WebAssembly.Memory({initial:vn/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw It("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),ut&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");Ct&&(Wt=Ct.buffer),vn=Wt.byteLength,An(Wt);var Bn,zn=[],qn=[],rr=[],ir=[];function Hn(){return Dt||!1}function Kn(){var gt=d.preRun.shift();zn.unshift(gt)}var Rn,Un=0,Zn=null;function pn(gt){throw _t?postMessage({cmd:"onAbort",arg:gt}):d.onAbort&&d.onAbort(gt),It(gt="Aborted("+gt+")"),an=!0,gt=new WebAssembly.RuntimeError(gt+". Build with -sASSERTIONS for more info."),g(gt),gt}function Nn(){return Rn.startsWith("data:application/octet-stream;base64,")}function Fn(){var gt=Rn;try{if(gt==Rn&&xt)return new Uint8Array(xt);if(ot)return ot(gt);throw"both async and sync fetching of the wasm failed"}catch(wt){pn(wt)}}Rn="ort-wasm-threaded.wasm",Nn()||(Rn=vt(Rn));var Ar={};function or(gt){this.name="ExitStatus",this.message="Program terminated with exit("+gt+")",this.status=gt}function Sr(gt){(gt=rn.Vb[gt])||pn(),rn.mc(gt)}function Rr(gt){var wt=rn.Cc();if(!wt)return 6;rn.ac.push(wt),rn.Vb[gt.Ub]=wt,wt.Ub=gt.Ub;var St={cmd:"run",start_routine:gt.Ic,arg:gt.zc,pthread_ptr:gt.Ub};return wt.$b=()=>{St.time=performance.now(),wt.postMessage(St,gt.Nc)},wt.loaded&&(wt.$b(),delete wt.$b),0}function Dn(gt){if(_t)return Jt(1,1,gt);Hn()||(rn.oc(),d.onExit&&d.onExit(gt),an=!0),mt(gt,new or(gt))}function Tr(gt,wt){if(!wt&&_t)throw Kr(gt),"unwind";Hn()||_t||(Br(),sr(rr),lr(0),Yr[1].length&&Xr(1,10),Yr[2].length&&Xr(2,10),rn.oc()),Dn(gt)}var rn={Yb:[],ac:[],qc:[],Vb:{},fc:function(){_t&&rn.Ec()},Pc:function(){},Ec:function(){rn.receiveObjectTransfer=rn.Gc,rn.threadInitTLS=rn.pc,rn.setExitStatus=rn.nc,Dt=!1},nc:function(){},oc:function(){for(var gt of Object.values(rn.Vb))rn.mc(gt);for(gt of rn.Yb)gt.terminate();rn.Yb=[]},mc:function(gt){var wt=gt.Ub;delete rn.Vb[wt],rn.Yb.push(gt),rn.ac.splice(rn.ac.indexOf(gt),1),gt.Ub=0,xr(wt)},Gc:function(){},pc:function(){rn.qc.forEach(gt=>gt())},Fc:function(gt,wt){gt.onmessage=St=>{var Ot=(St=St.data).cmd;if(gt.Ub&&(rn.Bc=gt.Ub),St.targetThread&&St.targetThread!=jr()){var Nt=rn.Vb[St.Qc];Nt?Nt.postMessage(St,St.transferList):It('Internal error! Worker sent a message "'+Ot+'" to target pthread '+St.targetThread+", but that thread no longer exists!")}else Ot==="processProxyingQueue"?kt(St.queue):Ot==="spawnThread"?Rr(St):Ot==="cleanupThread"?Sr(St.thread):Ot==="killThread"?(St=St.thread,Ot=rn.Vb[St],delete rn.Vb[St],Ot.terminate(),xr(St),rn.ac.splice(rn.ac.indexOf(Ot),1),Ot.Ub=0):Ot==="cancelThread"?rn.Vb[St.thread].postMessage({cmd:"cancel"}):Ot==="loaded"?(gt.loaded=!0,wt&&wt(gt),gt.$b&&(gt.$b(),delete gt.$b)):Ot==="print"?Pt("Thread "+St.threadId+": "+St.text):Ot==="printErr"?It("Thread "+St.threadId+": "+St.text):Ot==="alert"?alert("Thread "+St.threadId+": "+St.text):St.target==="setimmediate"?gt.postMessage(St):Ot==="onAbort"?d.onAbort&&d.onAbort(St.arg):Ot&&It("worker sent an unknown command "+Ot);rn.Bc=void 0},gt.onerror=St=>{throw It("worker sent an error! "+St.filename+":"+St.lineno+": "+St.message),St},ut&&(gt.on("message",function(St){gt.onmessage({data:St})}),gt.on("error",function(St){gt.onerror(St)}),gt.on("detachedExit",function(){})),gt.postMessage({cmd:"load",urlOrBlob:d.mainScriptUrlOrBlob||s,wasmMemory:Ct,wasmModule:Gt})},yc:function(){var gt=vt("ort-wasm-threaded.worker.js");rn.Yb.push(new Worker(gt))},Cc:function(){return rn.Yb.length==0&&(rn.yc(),rn.Fc(rn.Yb[0])),rn.Yb.pop()}};function sr(gt){for(;0<gt.length;)gt.shift()(d)}function Hr(gt){var wt=fn();return gt=gt(),hn(wt),gt}function Kr(gt){if(_t)return Jt(2,0,gt);try{Tr(gt)}catch(wt){wt instanceof or||wt=="unwind"||mt(1,wt)}}d.PThread=rn,d.establishStackSpace=function(){var gt=jr(),wt=nt()[gt+44>>2>>>0];gt=nt()[gt+48>>2>>>0],ro(wt,wt-gt),hn(wt)};var er=[];function Tn(gt){var wt=er[gt];return wt||(gt>=er.length&&(er.length=gt+1),er[gt]=wt=Bn.get(gt)),wt}d.invokeEntryPoint=function(gt,wt){gt=Tn(gt)(wt),Hn()?rn.nc(gt):Cr(gt)};var br,cr,dr=[],sn=0,tn=0;function on(gt){this.Zb=gt,this.Sb=gt-24,this.xc=function(wt){tt()[this.Sb+4>>2>>>0]=wt},this.bc=function(){return tt()[this.Sb+4>>2>>>0]},this.wc=function(wt){tt()[this.Sb+8>>2>>>0]=wt},this.Dc=function(){return tt()[this.Sb+8>>2>>>0]},this.rc=function(){nt()[this.Sb>>2>>>0]=0},this.hc=function(wt){wt=wt?1:0,_()[this.Sb+12>>0>>>0]=wt},this.uc=function(){return _()[this.Sb+12>>0>>>0]!=0},this.ic=function(wt){wt=wt?1:0,_()[this.Sb+13>>0>>>0]=wt},this.kc=function(){return _()[this.Sb+13>>0>>>0]!=0},this.fc=function(wt,St){this.cc(0),this.xc(wt),this.wc(St),this.rc(),this.hc(!1),this.ic(!1)},this.sc=function(){Atomics.add(nt(),this.Sb>>2,1)},this.Hc=function(){return Atomics.sub(nt(),this.Sb>>2,1)===1},this.cc=function(wt){tt()[this.Sb+16>>2>>>0]=wt},this.tc=function(){return tt()[this.Sb+16>>2>>>0]},this.vc=function(){if(Dr(this.bc()))return tt()[this.Zb>>2>>>0];var wt=this.tc();return wt!==0?wt:this.Zb}}function vr(gt){return Pr(new on(gt).Sb)}function wr(gt,wt,St,Ot){return _t?Jt(3,1,gt,wt,St,Ot):hr(gt,wt,St,Ot)}function hr(gt,wt,St,Ot){if(typeof SharedArrayBuffer>"u")return It("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var Nt=[];return _t&&Nt.length===0?wr(gt,wt,St,Ot):(gt={Ic:St,Ub:gt,zc:Ot,Nc:Nt},_t?(gt.Oc="spawnThread",postMessage(gt,Nt),0):Rr(gt))}function Mr(gt,wt,St){return _t?Jt(4,1,gt,wt,St):0}function $n(gt,wt){if(_t)return Jt(5,1,gt,wt)}function Or(gt,wt){if(_t)return Jt(6,1,gt,wt)}function fr(gt,wt,St){if(_t)return Jt(7,1,gt,wt,St)}function pr(gt,wt,St){return _t?Jt(8,1,gt,wt,St):0}function Nr(gt,wt){if(_t)return Jt(9,1,gt,wt)}function Fr(gt,wt,St){if(_t)return Jt(10,1,gt,wt,St)}function ar(gt,wt,St,Ot){if(_t)return Jt(11,1,gt,wt,St,Ot)}function Lr(gt,wt,St,Ot){if(_t)return Jt(12,1,gt,wt,St,Ot)}function $r(gt,wt,St,Ot){if(_t)return Jt(13,1,gt,wt,St,Ot)}function Er(gt){if(_t)return Jt(14,1,gt)}function Et(gt,wt){if(_t)return Jt(15,1,gt,wt)}function Rt(gt,wt,St){if(_t)return Jt(16,1,gt,wt,St)}function kt(gt){Atomics.store(nt(),gt>>2,1),jr()&&Gr(gt),Atomics.compareExchange(nt(),gt>>2,1,0)}function Vt(gt){return tt()[gt>>>2]+4294967296*nt()[gt+4>>>2]}function Lt(gt,wt,St,Ot,Nt,jt){return _t?Jt(17,1,gt,wt,St,Ot,Nt,jt):-52}function zt(gt,wt,St,Ot,Nt,jt){if(_t)return Jt(18,1,gt,wt,St,Ot,Nt,jt)}function Ht(gt){var wt=On(gt)+1,St=no(wt);return St&&xn(gt,_(),St,wt),St}function Zt(gt,wt,St){function Ot(gn){return(gn=gn.toTimeString().match(/\(([A-Za-z ]+)\)$/))?gn[1]:"GMT"}if(_t)return Jt(19,1,gt,wt,St);var Nt=new Date().getFullYear(),jt=new Date(Nt,0,1),Kt=new Date(Nt,6,1);Nt=jt.getTimezoneOffset();var Xt=Kt.getTimezoneOffset(),mn=Math.max(Nt,Xt);nt()[gt>>2>>>0]=60*mn,nt()[wt>>2>>>0]=+(Nt!=Xt),gt=Ot(jt),wt=Ot(Kt),gt=Ht(gt),wt=Ht(wt),Xt<Nt?(tt()[St>>2>>>0]=gt,tt()[St+4>>2>>>0]=wt):(tt()[St>>2>>>0]=wt,tt()[St+4>>2>>>0]=gt)}function Jt(gt,wt){var St=arguments.length-2,Ot=arguments;return Hr(()=>{for(var Nt=io(8*St),jt=Nt>>3,Kt=0;Kt<St;Kt++){var Xt=Ot[2+Kt];et()[jt+Kt>>>0]=Xt}return In(gt,St,Nt,wt)})}d.executeNotifiedProxyingQueue=kt,cr=ut?()=>{var gt=process.hrtime();return 1e3*gt[0]+gt[1]/1e6}:_t?()=>performance.now()-d.__performance_now_clock_drift:()=>performance.now();var ln,Sn=[],Vn={};function Ln(){if(!ln){var gt,wt={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:dt||"./this.program"};for(gt in Vn)Vn[gt]===void 0?delete wt[gt]:wt[gt]=Vn[gt];var St=[];for(gt in wt)St.push(gt+"="+wt[gt]);ln=St}return ln}function $t(gt,wt){if(_t)return Jt(20,1,gt,wt);var St=0;return Ln().forEach(function(Ot,Nt){var jt=wt+St;for(Nt=tt()[gt+4*Nt>>2>>>0]=jt,jt=0;jt<Ot.length;++jt)_()[Nt++>>0>>>0]=Ot.charCodeAt(jt);_()[Nt>>0>>>0]=0,St+=Ot.length+1}),0}function dn(gt,wt){if(_t)return Jt(21,1,gt,wt);var St=Ln();tt()[gt>>2>>>0]=St.length;var Ot=0;return St.forEach(function(Nt){Ot+=Nt.length+1}),tt()[wt>>2>>>0]=Ot,0}function wn(gt){return _t?Jt(22,1,gt):52}function Yn(gt,wt,St,Ot){return _t?Jt(23,1,gt,wt,St,Ot):52}function _r(gt,wt,St,Ot,Nt){return _t?Jt(24,1,gt,wt,St,Ot,Nt):70}var Yr=[null,[],[]];function Xr(gt,wt){var St=Yr[gt];wt===0||wt===10?((gt===1?Pt:It)(jn(St,0)),St.length=0):St.push(wt)}function _i(gt,wt,St,Ot){if(_t)return Jt(25,1,gt,wt,St,Ot);for(var Nt=0,jt=0;jt<St;jt++){var Kt=tt()[wt>>2>>>0],Xt=tt()[wt+4>>2>>>0];wt+=8;for(var mn=0;mn<Xt;mn++)Xr(gt,$()[Kt+mn>>>0]);Nt+=Xt}return tt()[Ot>>2>>>0]=Nt,0}var Gn=0;function kr(gt){return gt%4==0&&(gt%100!=0||gt%400==0)}var eo=[31,29,31,30,31,30,31,31,30,31,30,31],to=[31,28,31,30,31,30,31,31,30,31,30,31];function co(gt,wt,St,Ot){function Nt(Bt,yn,En){for(Bt=typeof Bt=="number"?Bt.toString():Bt||"";Bt.length<yn;)Bt=En[0]+Bt;return Bt}function jt(Bt,yn){return Nt(Bt,yn,"0")}function Kt(Bt,yn){function En(Vr){return 0>Vr?-1:0<Vr?1:0}var ur;return(ur=En(Bt.getFullYear()-yn.getFullYear()))===0&&(ur=En(Bt.getMonth()-yn.getMonth()))===0&&(ur=En(Bt.getDate()-yn.getDate())),ur}function Xt(Bt){switch(Bt.getDay()){case 0:return new Date(Bt.getFullYear()-1,11,29);case 1:return Bt;case 2:return new Date(Bt.getFullYear(),0,3);case 3:return new Date(Bt.getFullYear(),0,2);case 4:return new Date(Bt.getFullYear(),0,1);case 5:return new Date(Bt.getFullYear()-1,11,31);case 6:return new Date(Bt.getFullYear()-1,11,30)}}function mn(Bt){var yn=Bt.Wb;for(Bt=new Date(new Date(Bt.Xb+1900,0,1).getTime());0<yn;){var En=Bt.getMonth(),ur=(kr(Bt.getFullYear())?eo:to)[En];if(!(yn>ur-Bt.getDate())){Bt.setDate(Bt.getDate()+yn);break}yn-=ur-Bt.getDate()+1,Bt.setDate(1),11>En?Bt.setMonth(En+1):(Bt.setMonth(0),Bt.setFullYear(Bt.getFullYear()+1))}return En=new Date(Bt.getFullYear()+1,0,4),yn=Xt(new Date(Bt.getFullYear(),0,4)),En=Xt(En),0>=Kt(yn,Bt)?0>=Kt(En,Bt)?Bt.getFullYear()+1:Bt.getFullYear():Bt.getFullYear()-1}var gn=nt()[Ot+40>>2>>>0];for(var Cn in Ot={Lc:nt()[Ot>>2>>>0],Kc:nt()[Ot+4>>2>>>0],dc:nt()[Ot+8>>2>>>0],jc:nt()[Ot+12>>2>>>0],ec:nt()[Ot+16>>2>>>0],Xb:nt()[Ot+20>>2>>>0],Tb:nt()[Ot+24>>2>>>0],Wb:nt()[Ot+28>>2>>>0],Rc:nt()[Ot+32>>2>>>0],Jc:nt()[Ot+36>>2>>>0],Mc:gn?bn(gn):""},St=bn(St),gn={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})St=St.replace(new RegExp(Cn,"g"),gn[Cn]);var tr="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Jn="January February March April May June July August September October November December".split(" ");for(Cn in gn={"%a":function(Bt){return tr[Bt.Tb].substring(0,3)},"%A":function(Bt){return tr[Bt.Tb]},"%b":function(Bt){return Jn[Bt.ec].substring(0,3)},"%B":function(Bt){return Jn[Bt.ec]},"%C":function(Bt){return jt((Bt.Xb+1900)/100|0,2)},"%d":function(Bt){return jt(Bt.jc,2)},"%e":function(Bt){return Nt(Bt.jc,2," ")},"%g":function(Bt){return mn(Bt).toString().substring(2)},"%G":function(Bt){return mn(Bt)},"%H":function(Bt){return jt(Bt.dc,2)},"%I":function(Bt){return(Bt=Bt.dc)==0?Bt=12:12<Bt&&(Bt-=12),jt(Bt,2)},"%j":function(Bt){for(var yn=0,En=0;En<=Bt.ec-1;yn+=(kr(Bt.Xb+1900)?eo:to)[En++]);return jt(Bt.jc+yn,3)},"%m":function(Bt){return jt(Bt.ec+1,2)},"%M":function(Bt){return jt(Bt.Kc,2)},"%n":function(){return`
`},"%p":function(Bt){return 0<=Bt.dc&&12>Bt.dc?"AM":"PM"},"%S":function(Bt){return jt(Bt.Lc,2)},"%t":function(){return"	"},"%u":function(Bt){return Bt.Tb||7},"%U":function(Bt){return jt(Math.floor((Bt.Wb+7-Bt.Tb)/7),2)},"%V":function(Bt){var yn=Math.floor((Bt.Wb+7-(Bt.Tb+6)%7)/7);if(2>=(Bt.Tb+371-Bt.Wb-2)%7&&yn++,yn)yn==53&&((En=(Bt.Tb+371-Bt.Wb)%7)==4||En==3&&kr(Bt.Xb)||(yn=1));else{yn=52;var En=(Bt.Tb+7-Bt.Wb-1)%7;(En==4||En==5&&kr(Bt.Xb%400-1))&&yn++}return jt(yn,2)},"%w":function(Bt){return Bt.Tb},"%W":function(Bt){return jt(Math.floor((Bt.Wb+7-(Bt.Tb+6)%7)/7),2)},"%y":function(Bt){return(Bt.Xb+1900).toString().substring(2)},"%Y":function(Bt){return Bt.Xb+1900},"%z":function(Bt){var yn=0<=(Bt=Bt.Jc);return Bt=Math.abs(Bt)/60,(yn?"+":"-")+("0000"+(Bt/60*100+Bt%60)).slice(-4)},"%Z":function(Bt){return Bt.Mc},"%%":function(){return"%"}},St=St.replace(/%%/g,"\0\0"),gn)St.includes(Cn)&&(St=St.replace(new RegExp(Cn,"g"),gn[Cn](Ot)));return Cn=function(Bt){var yn=Array(On(Bt)+1);return xn(Bt,yn,0,yn.length),yn}(St=St.replace(/\0\0/g,"%")),Cn.length>wt?0:(function(Bt,yn){_().set(Bt,yn>>>0)}(Cn,gt),Cn.length-1)}rn.fc();var Eo=[null,Dn,Kr,wr,Mr,$n,Or,fr,pr,Nr,Fr,ar,Lr,$r,Er,Et,Rt,Lt,zt,Zt,$t,dn,wn,Yn,_r,_i],ho={b:function(gt){return no(gt+24)+24},n:function(gt){return(gt=new on(gt)).uc()||(gt.hc(!0),sn--),gt.ic(!1),dr.push(gt),gt.sc(),gt.vc()},ma:function(gt){throw It("Unexpected exception thrown, this is not properly supported - aborting"),an=!0,gt},x:function(){_n(0);var gt=dr.pop();if(gt.Hc()&&!gt.kc()){var wt=gt.Dc();wt&&Tn(wt)(gt.Zb),vr(gt.Zb)}tn=0},e:function(){var gt=tn;if(!gt)return Gn=0;var wt=new on(gt);wt.cc(gt);var St=wt.bc();if(!St)return Gn=0,gt;for(var Ot=Array.prototype.slice.call(arguments),Nt=0;Nt<Ot.length;Nt++){var jt=Ot[Nt];if(jt===0||jt===St)break;if(Qr(jt,St,wt.Sb+16))return Gn=jt,gt}return Gn=St,gt},l:function(){var gt=tn;if(!gt)return Gn=0;var wt=new on(gt);wt.cc(gt);var St=wt.bc();if(!St)return Gn=0,gt;for(var Ot=Array.prototype.slice.call(arguments),Nt=0;Nt<Ot.length;Nt++){var jt=Ot[Nt];if(jt===0||jt===St)break;if(Qr(jt,St,wt.Sb+16))return Gn=jt,gt}return Gn=St,gt},h:function(){var gt=tn;if(!gt)return Gn=0;var wt=new on(gt);wt.cc(gt);var St=wt.bc();if(!St)return Gn=0,gt;for(var Ot=Array.prototype.slice.call(arguments),Nt=0;Nt<Ot.length;Nt++){var jt=Ot[Nt];if(jt===0||jt===St)break;if(Qr(jt,St,wt.Sb+16))return Gn=jt,gt}return Gn=St,gt},t:vr,M:function(){var gt=dr.pop();gt||pn("no exception to throw");var wt=gt.Zb;throw gt.kc()||(dr.push(gt),gt.ic(!0),gt.hc(!1),sn++),tn=wt,wt},c:function(gt,wt,St){throw new on(gt).fc(wt,St),tn=gt,sn++,gt},pa:function(){return sn},Fa:function(gt){zr(gt,!ft,1,!ht),rn.pc()},T:function(gt){_t?postMessage({cmd:"cleanupThread",thread:gt}):Sr(gt)},xa:hr,j:function(gt){throw tn||(tn=gt),gt},H:Mr,Ma:$n,ua:Or,wa:fr,oa:pr,Ka:Nr,Ca:Fr,Ja:ar,V:Lr,va:$r,sa:Er,La:Et,ta:Rt,Ta:function(){},X:function(){pn("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ua:function(){pn("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},W:function(){return Date.now()},ya:function(){return 2097152},Oa:function(){return!0},za:function(gt,wt,St,Ot){if(gt==wt)setTimeout(()=>kt(Ot));else if(_t)postMessage({targetThread:gt,cmd:"processProxyingQueue",queue:Ot});else{if(!(gt=rn.Vb[gt]))return;gt.postMessage({cmd:"processProxyingQueue",queue:Ot})}return 1},Ea:function(){return-1},Pa:function(gt,wt){gt=new Date(1e3*Vt(gt)),nt()[wt>>2>>>0]=gt.getUTCSeconds(),nt()[wt+4>>2>>>0]=gt.getUTCMinutes(),nt()[wt+8>>2>>>0]=gt.getUTCHours(),nt()[wt+12>>2>>>0]=gt.getUTCDate(),nt()[wt+16>>2>>>0]=gt.getUTCMonth(),nt()[wt+20>>2>>>0]=gt.getUTCFullYear()-1900,nt()[wt+24>>2>>>0]=gt.getUTCDay(),gt=(gt.getTime()-Date.UTC(gt.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,nt()[wt+28>>2>>>0]=gt},Qa:function(gt,wt){gt=new Date(1e3*Vt(gt)),nt()[wt>>2>>>0]=gt.getSeconds(),nt()[wt+4>>2>>>0]=gt.getMinutes(),nt()[wt+8>>2>>>0]=gt.getHours(),nt()[wt+12>>2>>>0]=gt.getDate(),nt()[wt+16>>2>>>0]=gt.getMonth(),nt()[wt+20>>2>>>0]=gt.getFullYear()-1900,nt()[wt+24>>2>>>0]=gt.getDay();var St=new Date(gt.getFullYear(),0,1),Ot=(gt.getTime()-St.getTime())/864e5|0;nt()[wt+28>>2>>>0]=Ot,nt()[wt+36>>2>>>0]=-60*gt.getTimezoneOffset(),Ot=new Date(gt.getFullYear(),6,1).getTimezoneOffset(),gt=0|(Ot!=(St=St.getTimezoneOffset())&&gt.getTimezoneOffset()==Math.min(St,Ot)),nt()[wt+32>>2>>>0]=gt},Ra:function(gt){var wt=new Date(nt()[gt+20>>2>>>0]+1900,nt()[gt+16>>2>>>0],nt()[gt+12>>2>>>0],nt()[gt+8>>2>>>0],nt()[gt+4>>2>>>0],nt()[gt>>2>>>0],0),St=nt()[gt+32>>2>>>0],Ot=wt.getTimezoneOffset(),Nt=new Date(wt.getFullYear(),0,1),jt=new Date(wt.getFullYear(),6,1).getTimezoneOffset(),Kt=Nt.getTimezoneOffset(),Xt=Math.min(Kt,jt);return 0>St?nt()[gt+32>>2>>>0]=+(jt!=Kt&&Xt==Ot):0<St!=(Xt==Ot)&&(jt=Math.max(Kt,jt),wt.setTime(wt.getTime()+6e4*((0<St?Xt:jt)-Ot))),nt()[gt+24>>2>>>0]=wt.getDay(),St=(wt.getTime()-Nt.getTime())/864e5|0,nt()[gt+28>>2>>>0]=St,nt()[gt>>2>>>0]=wt.getSeconds(),nt()[gt+4>>2>>>0]=wt.getMinutes(),nt()[gt+8>>2>>>0]=wt.getHours(),nt()[gt+12>>2>>>0]=wt.getDate(),nt()[gt+16>>2>>>0]=wt.getMonth(),wt.getTime()/1e3|0},Aa:Lt,Ba:zt,Sa:function gt(wt,St,Ot){gt.Ac||(gt.Ac=!0,Zt(wt,St,Ot))},y:function(){pn("")},U:function(){if(!ut&&!ft){var gt="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";br||(br={}),br[gt]||(br[gt]=1,ut&&(gt="warning: "+gt),It(gt))}},ra:function(){return 4294901760},B:cr,Ia:function(gt,wt,St){$().copyWithin(gt>>>0,wt>>>0,wt+St>>>0)},F:function(){return ut?o(3993).cpus().length:navigator.hardwareConcurrency},Da:function(gt,wt,St){Sn.length=wt,St>>=3;for(var Ot=0;Ot<wt;Ot++)Sn[Ot]=et()[St+Ot>>>0];return(0>gt?Ar[-gt-1]:Eo[gt]).apply(null,Sn)},qa:function(gt){var wt=$().length;if((gt>>>=0)<=wt||4294901760<gt)return!1;for(var St=1;4>=St;St*=2){var Ot=wt*(1+.2/St);Ot=Math.min(Ot,gt+100663296);var Nt=Math;Ot=Math.max(gt,Ot),Nt=Nt.min.call(Nt,4294901760,Ot+(65536-Ot%65536)%65536);e:{try{Ct.grow(Nt-Wt.byteLength+65535>>>16),An(Ct.buffer);var jt=1;break e}catch{}jt=void 0}if(jt)return!0}return!1},Na:function(){throw"unwind"},Ga:$t,Ha:dn,J:Tr,I:wn,S:Yn,ga:_r,R:_i,d:function(){return Gn},na:function gt(wt,St){gt.lc||(gt.lc=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var Nt=new Uint8Array(1);return()=>(crypto.getRandomValues(Nt),Nt[0])}if(ut)try{var jt=o(Object(function(){var Kt=new Error("Cannot find module 'crypto'");throw Kt.code="MODULE_NOT_FOUND",Kt}()));return()=>jt.randomBytes(1)[0]}catch{}return()=>pn("randomDevice")}());for(var Ot=0;Ot<St;Ot++)_()[wt+Ot>>0>>>0]=gt.lc();return 0},ia:function(gt,wt,St){var Ot=fn();try{return Tn(gt)(wt,St)}catch(Nt){if(hn(Ot),Nt!==Nt+0)throw Nt;_n(1,0)}},ja:function(gt,wt,St){var Ot=fn();try{return Tn(gt)(wt,St)}catch(Nt){if(hn(Ot),Nt!==Nt+0)throw Nt;_n(1,0)}},K:function(gt){var wt=fn();try{return Tn(gt)()}catch(St){if(hn(wt),St!==St+0)throw St;_n(1,0)}},f:function(gt,wt){var St=fn();try{return Tn(gt)(wt)}catch(Ot){if(hn(St),Ot!==Ot+0)throw Ot;_n(1,0)}},P:function(gt,wt,St){var Ot=fn();try{return Tn(gt)(wt,St)}catch(Nt){if(hn(Ot),Nt!==Nt+0)throw Nt;_n(1,0)}},Q:function(gt,wt,St){var Ot=fn();try{return Tn(gt)(wt,St)}catch(Nt){if(hn(Ot),Nt!==Nt+0)throw Nt;_n(1,0)}},k:function(gt,wt,St){var Ot=fn();try{return Tn(gt)(wt,St)}catch(Nt){if(hn(Ot),Nt!==Nt+0)throw Nt;_n(1,0)}},p:function(gt,wt,St,Ot){var Nt=fn();try{return Tn(gt)(wt,St,Ot)}catch(jt){if(hn(Nt),jt!==jt+0)throw jt;_n(1,0)}},q:function(gt,wt,St,Ot,Nt){var jt=fn();try{return Tn(gt)(wt,St,Ot,Nt)}catch(Kt){if(hn(jt),Kt!==Kt+0)throw Kt;_n(1,0)}},N:function(gt,wt,St,Ot,Nt,jt){var Kt=fn();try{return Tn(gt)(wt,St,Ot,Nt,jt)}catch(Xt){if(hn(Kt),Xt!==Xt+0)throw Xt;_n(1,0)}},s:function(gt,wt,St,Ot,Nt,jt){var Kt=fn();try{return Tn(gt)(wt,St,Ot,Nt,jt)}catch(Xt){if(hn(Kt),Xt!==Xt+0)throw Xt;_n(1,0)}},w:function(gt,wt,St,Ot,Nt,jt,Kt){var Xt=fn();try{return Tn(gt)(wt,St,Ot,Nt,jt,Kt)}catch(mn){if(hn(Xt),mn!==mn+0)throw mn;_n(1,0)}},L:function(gt,wt,St,Ot,Nt,jt,Kt,Xt){var mn=fn();try{return Tn(gt)(wt,St,Ot,Nt,jt,Kt,Xt)}catch(gn){if(hn(mn),gn!==gn+0)throw gn;_n(1,0)}},E:function(gt,wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn,tr){var Jn=fn();try{return Tn(gt)(wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn,tr)}catch(Bt){if(hn(Jn),Bt!==Bt+0)throw Bt;_n(1,0)}},aa:function(gt,wt,St,Ot,Nt,jt,Kt,Xt){var mn=fn();try{return gr(gt,wt,St,Ot,Nt,jt,Kt,Xt)}catch(gn){if(hn(mn),gn!==gn+0)throw gn;_n(1,0)}},_:function(gt,wt,St,Ot,Nt,jt,Kt){var Xt=fn();try{return oo(gt,wt,St,Ot,Nt,jt,Kt)}catch(mn){if(hn(Xt),mn!==mn+0)throw mn;_n(1,0)}},Z:function(gt,wt,St,Ot,Nt){var jt=fn();try{return mo(gt,wt,St,Ot,Nt)}catch(Kt){if(hn(jt),Kt!==Kt+0)throw Kt;_n(1,0)}},ca:function(gt,wt,St,Ot){var Nt=fn();try{return po(gt,wt,St,Ot)}catch(jt){if(hn(Nt),jt!==jt+0)throw jt;_n(1,0)}},$:function(gt){var wt=fn();try{return mr(gt)}catch(St){if(hn(wt),St!==St+0)throw St;_n(1,0)}},ba:function(gt,wt){var St=fn();try{return _o(gt,wt)}catch(Ot){if(hn(St),Ot!==Ot+0)throw Ot;_n(1,0)}},Y:function(gt,wt,St){var Ot=fn();try{return so(gt,wt,St)}catch(Nt){if(hn(Ot),Nt!==Nt+0)throw Nt;_n(1,0)}},g:function(gt){var wt=fn();try{Tn(gt)()}catch(St){if(hn(wt),St!==St+0)throw St;_n(1,0)}},r:function(gt,wt){var St=fn();try{Tn(gt)(wt)}catch(Ot){if(hn(St),Ot!==Ot+0)throw Ot;_n(1,0)}},i:function(gt,wt,St){var Ot=fn();try{Tn(gt)(wt,St)}catch(Nt){if(hn(Ot),Nt!==Nt+0)throw Nt;_n(1,0)}},ha:function(gt,wt,St,Ot){var Nt=fn();try{Tn(gt)(wt,St,Ot)}catch(jt){if(hn(Nt),jt!==jt+0)throw jt;_n(1,0)}},m:function(gt,wt,St,Ot){var Nt=fn();try{Tn(gt)(wt,St,Ot)}catch(jt){if(hn(Nt),jt!==jt+0)throw jt;_n(1,0)}},v:function(gt,wt,St,Ot,Nt){var jt=fn();try{Tn(gt)(wt,St,Ot,Nt)}catch(Kt){if(hn(jt),Kt!==Kt+0)throw Kt;_n(1,0)}},u:function(gt,wt,St,Ot,Nt,jt){var Kt=fn();try{Tn(gt)(wt,St,Ot,Nt,jt)}catch(Xt){if(hn(Kt),Xt!==Xt+0)throw Xt;_n(1,0)}},O:function(gt,wt,St,Ot,Nt,jt,Kt){var Xt=fn();try{Tn(gt)(wt,St,Ot,Nt,jt,Kt)}catch(mn){if(hn(Xt),mn!==mn+0)throw mn;_n(1,0)}},A:function(gt,wt,St,Ot,Nt,jt,Kt,Xt){var mn=fn();try{Tn(gt)(wt,St,Ot,Nt,jt,Kt,Xt)}catch(gn){if(hn(mn),gn!==gn+0)throw gn;_n(1,0)}},ka:function(gt,wt,St,Ot,Nt,jt,Kt,Xt,mn){var gn=fn();try{Tn(gt)(wt,St,Ot,Nt,jt,Kt,Xt,mn)}catch(Cn){if(hn(gn),Cn!==Cn+0)throw Cn;_n(1,0)}},C:function(gt,wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn){var tr=fn();try{Tn(gt)(wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn)}catch(Jn){if(hn(tr),Jn!==Jn+0)throw Jn;_n(1,0)}},D:function(gt,wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn,tr,Jn,Bt,yn,En){var ur=fn();try{Tn(gt)(wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn,tr,Jn,Bt,yn,En)}catch(Vr){if(hn(ur),Vr!==Vr+0)throw Vr;_n(1,0)}},fa:function(gt,wt,St,Ot,Nt,jt,Kt,Xt){var mn=fn();try{ao(gt,wt,St,Ot,Nt,jt,Kt,Xt)}catch(gn){if(hn(mn),gn!==gn+0)throw gn;_n(1,0)}},da:function(gt,wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn,tr){var Jn=fn();try{fo(gt,wt,St,Ot,Nt,jt,Kt,Xt,mn,gn,Cn,tr)}catch(Bt){if(hn(Jn),Bt!==Bt+0)throw Bt;_n(1,0)}},ea:function(gt,wt,St,Ot,Nt,jt){var Kt=fn();try{Ir(gt,wt,St,Ot,Nt,jt)}catch(Xt){if(hn(Kt),Xt!==Xt+0)throw Xt;_n(1,0)}},o:function(gt){return gt},a:Ct||d.wasmMemory,G:function(gt){Gn=gt},la:co,z:function(gt,wt,St,Ot){return co(gt,wt,St,Ot)}};(function(){function gt(Nt,jt){d.asm=Nt.exports,rn.qc.push(d.asm.sb),Bn=d.asm.ub,qn.unshift(d.asm.Va),Gt=jt,_t||(Un--,d.monitorRunDependencies&&d.monitorRunDependencies(Un),Un==0&&Zn&&(Nt=Zn,Zn=null,Nt()))}function wt(Nt){gt(Nt.instance,Nt.module)}function St(Nt){return function(){if(!xt&&(ht||ft)){if(typeof fetch=="function"&&!Rn.startsWith("file://"))return fetch(Rn,{credentials:"same-origin"}).then(function(jt){if(!jt.ok)throw"failed to load wasm binary file at '"+Rn+"'";return jt.arrayBuffer()}).catch(function(){return Fn()});if(rt)return new Promise(function(jt,Kt){rt(Rn,function(Xt){jt(new Uint8Array(Xt))},Kt)})}return Promise.resolve().then(function(){return Fn()})}().then(function(jt){return WebAssembly.instantiate(jt,Ot)}).then(function(jt){return jt}).then(Nt,function(jt){It("failed to asynchronously prepare wasm: "+jt),pn(jt)})}var Ot={a:ho};if(_t||(Un++,d.monitorRunDependencies&&d.monitorRunDependencies(Un)),d.instantiateWasm)try{return d.instantiateWasm(Ot,gt)}catch(Nt){return It("Module.instantiateWasm callback failed with error: "+Nt),!1}(xt||typeof WebAssembly.instantiateStreaming!="function"||Nn()||Rn.startsWith("file://")||ut||typeof fetch!="function"?St(wt):fetch(Rn,{credentials:"same-origin"}).then(function(Nt){return WebAssembly.instantiateStreaming(Nt,Ot).then(wt,function(jt){return It("wasm streaming compile failed: "+jt),It("falling back to ArrayBuffer instantiation"),St(wt)})})).catch(g)})(),d.___wasm_call_ctors=function(){return(d.___wasm_call_ctors=d.asm.Va).apply(null,arguments)},d._OrtInit=function(){return(d._OrtInit=d.asm.Wa).apply(null,arguments)},d._OrtCreateSessionOptions=function(){return(d._OrtCreateSessionOptions=d.asm.Xa).apply(null,arguments)},d._OrtAppendExecutionProvider=function(){return(d._OrtAppendExecutionProvider=d.asm.Ya).apply(null,arguments)},d._OrtAddSessionConfigEntry=function(){return(d._OrtAddSessionConfigEntry=d.asm.Za).apply(null,arguments)},d._OrtReleaseSessionOptions=function(){return(d._OrtReleaseSessionOptions=d.asm._a).apply(null,arguments)},d._OrtCreateSession=function(){return(d._OrtCreateSession=d.asm.$a).apply(null,arguments)},d._OrtReleaseSession=function(){return(d._OrtReleaseSession=d.asm.ab).apply(null,arguments)},d._OrtGetInputCount=function(){return(d._OrtGetInputCount=d.asm.bb).apply(null,arguments)},d._OrtGetOutputCount=function(){return(d._OrtGetOutputCount=d.asm.cb).apply(null,arguments)},d._OrtGetInputName=function(){return(d._OrtGetInputName=d.asm.db).apply(null,arguments)},d._OrtGetOutputName=function(){return(d._OrtGetOutputName=d.asm.eb).apply(null,arguments)},d._OrtFree=function(){return(d._OrtFree=d.asm.fb).apply(null,arguments)},d._OrtCreateTensor=function(){return(d._OrtCreateTensor=d.asm.gb).apply(null,arguments)},d._OrtGetTensorData=function(){return(d._OrtGetTensorData=d.asm.hb).apply(null,arguments)},d._OrtReleaseTensor=function(){return(d._OrtReleaseTensor=d.asm.ib).apply(null,arguments)},d._OrtCreateRunOptions=function(){return(d._OrtCreateRunOptions=d.asm.jb).apply(null,arguments)},d._OrtAddRunConfigEntry=function(){return(d._OrtAddRunConfigEntry=d.asm.kb).apply(null,arguments)},d._OrtReleaseRunOptions=function(){return(d._OrtReleaseRunOptions=d.asm.lb).apply(null,arguments)},d._OrtRun=function(){return(d._OrtRun=d.asm.mb).apply(null,arguments)},d._OrtEndProfiling=function(){return(d._OrtEndProfiling=d.asm.nb).apply(null,arguments)};var jr=d._pthread_self=function(){return(jr=d._pthread_self=d.asm.ob).apply(null,arguments)},no=d._malloc=function(){return(no=d._malloc=d.asm.pb).apply(null,arguments)},Pr=d._free=function(){return(Pr=d._free=d.asm.qb).apply(null,arguments)},lr=d._fflush=function(){return(lr=d._fflush=d.asm.rb).apply(null,arguments)};d.__emscripten_tls_init=function(){return(d.__emscripten_tls_init=d.asm.sb).apply(null,arguments)};var Br=d.___funcs_on_exit=function(){return(Br=d.___funcs_on_exit=d.asm.tb).apply(null,arguments)},zr=d.__emscripten_thread_init=function(){return(zr=d.__emscripten_thread_init=d.asm.vb).apply(null,arguments)};d.__emscripten_thread_crashed=function(){return(d.__emscripten_thread_crashed=d.asm.wb).apply(null,arguments)};var Ur,In=d._emscripten_run_in_main_runtime_thread_js=function(){return(In=d._emscripten_run_in_main_runtime_thread_js=d.asm.xb).apply(null,arguments)},Gr=d.__emscripten_proxy_execute_task_queue=function(){return(Gr=d.__emscripten_proxy_execute_task_queue=d.asm.yb).apply(null,arguments)},xr=d.__emscripten_thread_free_data=function(){return(xr=d.__emscripten_thread_free_data=d.asm.zb).apply(null,arguments)},Cr=d.__emscripten_thread_exit=function(){return(Cr=d.__emscripten_thread_exit=d.asm.Ab).apply(null,arguments)},_n=d._setThrew=function(){return(_n=d._setThrew=d.asm.Bb).apply(null,arguments)},ro=d._emscripten_stack_set_limits=function(){return(ro=d._emscripten_stack_set_limits=d.asm.Cb).apply(null,arguments)},fn=d.stackSave=function(){return(fn=d.stackSave=d.asm.Db).apply(null,arguments)},hn=d.stackRestore=function(){return(hn=d.stackRestore=d.asm.Eb).apply(null,arguments)},io=d.stackAlloc=function(){return(io=d.stackAlloc=d.asm.Fb).apply(null,arguments)},Qr=d.___cxa_can_catch=function(){return(Qr=d.___cxa_can_catch=d.asm.Gb).apply(null,arguments)},Dr=d.___cxa_is_pointer_type=function(){return(Dr=d.___cxa_is_pointer_type=d.asm.Hb).apply(null,arguments)},mr=d.dynCall_j=function(){return(mr=d.dynCall_j=d.asm.Ib).apply(null,arguments)},oo=d.dynCall_iiiiij=function(){return(oo=d.dynCall_iiiiij=d.asm.Jb).apply(null,arguments)},so=d.dynCall_jii=function(){return(so=d.dynCall_jii=d.asm.Kb).apply(null,arguments)},ao=d.dynCall_viiiiij=function(){return(ao=d.dynCall_viiiiij=d.asm.Lb).apply(null,arguments)},Ir=d.dynCall_vjji=function(){return(Ir=d.dynCall_vjji=d.asm.Mb).apply(null,arguments)},fo=d.dynCall_viiijjjii=function(){return(fo=d.dynCall_viiijjjii=d.asm.Nb).apply(null,arguments)},po=d.dynCall_iij=function(){return(po=d.dynCall_iij=d.asm.Ob).apply(null,arguments)},_o=d.dynCall_ji=function(){return(_o=d.dynCall_ji=d.asm.Pb).apply(null,arguments)},gr=d.dynCall_iiiiiij=function(){return(gr=d.dynCall_iiiiiij=d.asm.Qb).apply(null,arguments)},mo=d.dynCall_iiij=function(){return(mo=d.dynCall_iiij=d.asm.Rb).apply(null,arguments)};function go(){function gt(){if(!Ur&&(Ur=!0,d.calledRun=!0,!an)&&(_t||sr(qn),a(d),d.onRuntimeInitialized&&d.onRuntimeInitialized(),!_t)){if(d.postRun)for(typeof d.postRun=="function"&&(d.postRun=[d.postRun]);d.postRun.length;){var wt=d.postRun.shift();ir.unshift(wt)}sr(ir)}}if(!(0<Un))if(_t)a(d),_t||sr(qn),postMessage({cmd:"loaded"});else{if(d.preRun)for(typeof d.preRun=="function"&&(d.preRun=[d.preRun]);d.preRun.length;)Kn();sr(zn),0<Un||(d.setStatus?(d.setStatus("Running..."),setTimeout(function(){setTimeout(function(){d.setStatus("")},1),gt()},1)):gt())}}if(d.UTF8ToString=bn,d.stringToUTF8=function(gt,wt,St){return xn(gt,$(),wt,St)},d.lengthBytesUTF8=On,d.keepRuntimeAlive=Hn,d.wasmMemory=Ct,d.stackSave=fn,d.stackRestore=hn,d.stackAlloc=io,d.ExitStatus=or,d.PThread=rn,Zn=function gt(){Ur||go(),Ur||(Zn=gt)},d.preInit)for(typeof d.preInit=="function"&&(d.preInit=[d.preInit]);0<d.preInit.length;)d.preInit.pop()();return go(),h.ready});i.exports=c},932:(i,e,o)=>{var s,c=(s=(s=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(h){var _,$,nt;h=h||{},_||(_=h!==void 0?h:{}),_.ready=new Promise(function(Et,Rt){$=Et,nt=Rt});var tt,et,d,a,g,j,rt=Object.assign({},_),ot="./this.program",it=(Et,Rt)=>{throw Rt},at=typeof window=="object",lt=typeof importScripts=="function",ct=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",dt="";ct?(dt=lt?o(908).dirname(dt)+"/":"//",j=()=>{g||(a=o(1384),g=o(908))},tt=function(Et,Rt){return j(),Et=g.normalize(Et),a.readFileSync(Et,Rt?void 0:"utf8")},d=Et=>((Et=tt(Et,!0)).buffer||(Et=new Uint8Array(Et)),Et),et=(Et,Rt,kt)=>{j(),Et=g.normalize(Et),a.readFile(Et,function(Vt,Lt){Vt?kt(Vt):Rt(Lt.buffer)})},1<process.argv.length&&(ot=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(Et){if(!(Et instanceof qn))throw Et}),process.on("unhandledRejection",function(Et){throw Et}),it=(Et,Rt)=>{if(ut||0<kn)throw process.exitCode=Et,Rt;Rt instanceof qn||ft("exiting due to exception: "+Rt),process.exit(Et)},_.inspect=function(){return"[Emscripten Module object]"}):(at||lt)&&(lt?dt=self.location.href:typeof document<"u"&&document.currentScript&&(dt=document.currentScript.src),s&&(dt=s),dt=dt.indexOf("blob:")!==0?dt.substr(0,dt.replace(/[?#].*/,"").lastIndexOf("/")+1):"",tt=Et=>{var Rt=new XMLHttpRequest;return Rt.open("GET",Et,!1),Rt.send(null),Rt.responseText},lt&&(d=Et=>{var Rt=new XMLHttpRequest;return Rt.open("GET",Et,!1),Rt.responseType="arraybuffer",Rt.send(null),new Uint8Array(Rt.response)}),et=(Et,Rt,kt)=>{var Vt=new XMLHttpRequest;Vt.open("GET",Et,!0),Vt.responseType="arraybuffer",Vt.onload=()=>{Vt.status==200||Vt.status==0&&Vt.response?Rt(Vt.response):kt()},Vt.onerror=kt,Vt.send(null)});var mt,ht=_.print||console.log.bind(console),ft=_.printErr||console.warn.bind(console);Object.assign(_,rt),rt=null,_.thisProgram&&(ot=_.thisProgram),_.quit&&(it=_.quit),_.wasmBinary&&(mt=_.wasmBinary);var ut=_.noExitRuntime||!1;typeof WebAssembly!="object"&&An("no native wasm support detected");var _t,bt,vt,Tt,Mt,xt,Pt=!1,It=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Dt(Et,Rt,kt){var Vt=(Rt>>>=0)+kt;for(kt=Rt;Et[kt]&&!(kt>=Vt);)++kt;if(16<kt-Rt&&Et.buffer&&It)return It.decode(Et.subarray(Rt,kt));for(Vt="";Rt<kt;){var Lt=Et[Rt++];if(128&Lt){var zt=63&Et[Rt++];if((224&Lt)==192)Vt+=String.fromCharCode((31&Lt)<<6|zt);else{var Ht=63&Et[Rt++];65536>(Lt=(240&Lt)==224?(15&Lt)<<12|zt<<6|Ht:(7&Lt)<<18|zt<<12|Ht<<6|63&Et[Rt++])?Vt+=String.fromCharCode(Lt):(Lt-=65536,Vt+=String.fromCharCode(55296|Lt>>10,56320|1023&Lt))}}else Vt+=String.fromCharCode(Lt)}return Vt}function Ct(Et,Rt){return(Et>>>=0)?Dt(Tt,Et,Rt):""}function Gt(Et,Rt,kt,Vt){if(!(0<Vt))return 0;var Lt=kt>>>=0;Vt=kt+Vt-1;for(var zt=0;zt<Et.length;++zt){var Ht=Et.charCodeAt(zt);if(55296<=Ht&&57343>=Ht&&(Ht=65536+((1023&Ht)<<10)|1023&Et.charCodeAt(++zt)),127>=Ht){if(kt>=Vt)break;Rt[kt++>>>0]=Ht}else{if(2047>=Ht){if(kt+1>=Vt)break;Rt[kt++>>>0]=192|Ht>>6}else{if(65535>=Ht){if(kt+2>=Vt)break;Rt[kt++>>>0]=224|Ht>>12}else{if(kt+3>=Vt)break;Rt[kt++>>>0]=240|Ht>>18,Rt[kt++>>>0]=128|Ht>>12&63}Rt[kt++>>>0]=128|Ht>>6&63}Rt[kt++>>>0]=128|63&Ht}}return Rt[kt>>>0]=0,kt-Lt}function Wt(Et){for(var Rt=0,kt=0;kt<Et.length;++kt){var Vt=Et.charCodeAt(kt);127>=Vt?Rt++:2047>=Vt?Rt+=2:55296<=Vt&&57343>=Vt?(Rt+=4,++kt):Rt+=3}return Rt}function Qt(){var Et=_t.buffer;bt=Et,_.HEAP8=vt=new Int8Array(Et),_.HEAP16=new Int16Array(Et),_.HEAP32=Mt=new Int32Array(Et),_.HEAPU8=Tt=new Uint8Array(Et),_.HEAPU16=new Uint16Array(Et),_.HEAPU32=xt=new Uint32Array(Et),_.HEAPF32=new Float32Array(Et),_.HEAPF64=new Float64Array(Et)}var nn,un=[],en=[],cn=[],an=[],kn=0;function jn(){var Et=_.preRun.shift();un.unshift(Et)}var bn,xn=0,On=null;function An(Et){throw _.onAbort&&_.onAbort(Et),ft(Et="Aborted("+Et+")"),Pt=!0,Et=new WebAssembly.RuntimeError(Et+". Build with -sASSERTIONS for more info."),nt(Et),Et}function vn(){return bn.startsWith("data:application/octet-stream;base64,")}if(bn="ort-wasm.wasm",!vn()){var Bn=bn;bn=_.locateFile?_.locateFile(Bn,dt):dt+Bn}function zn(){var Et=bn;try{if(Et==bn&&mt)return new Uint8Array(mt);if(d)return d(Et);throw"both async and sync fetching of the wasm failed"}catch(Rt){An(Rt)}}function qn(Et){this.name="ExitStatus",this.message="Program terminated with exit("+Et+")",this.status=Et}function rr(Et){for(;0<Et.length;)Et.shift()(_)}var ir=[],Hn=0,Kn=0;function Rn(Et){this.Db=Et,this.zb=Et-24,this.Ub=function(Rt){xt[this.zb+4>>2>>>0]=Rt},this.Eb=function(){return xt[this.zb+4>>2>>>0]},this.Sb=function(Rt){xt[this.zb+8>>2>>>0]=Rt},this.Wb=function(){return xt[this.zb+8>>2>>>0]},this.Tb=function(){Mt[this.zb>>2>>>0]=0},this.Ib=function(Rt){vt[this.zb+12>>0>>>0]=Rt?1:0},this.Pb=function(){return vt[this.zb+12>>0>>>0]!=0},this.Jb=function(Rt){vt[this.zb+13>>0>>>0]=Rt?1:0},this.Lb=function(){return vt[this.zb+13>>0>>>0]!=0},this.Rb=function(Rt,kt){this.Fb(0),this.Ub(Rt),this.Sb(kt),this.Tb(),this.Ib(!1),this.Jb(!1)},this.Nb=function(){Mt[this.zb>>2>>>0]+=1},this.Xb=function(){var Rt=Mt[this.zb>>2>>>0];return Mt[this.zb>>2>>>0]=Rt-1,Rt===1},this.Fb=function(Rt){xt[this.zb+16>>2>>>0]=Rt},this.Ob=function(){return xt[this.zb+16>>2>>>0]},this.Qb=function(){if(hr(this.Eb()))return xt[this.Db>>2>>>0];var Rt=this.Ob();return Rt!==0?Rt:this.Db}}function Un(Et){return br(new Rn(Et).zb)}var Zn=[];function pn(Et){var Rt=Zn[Et];return Rt||(Et>=Zn.length&&(Zn.length=Et+1),Zn[Et]=Rt=nn.get(Et)),Rt}function Nn(Et){var Rt=Wt(Et)+1,kt=Tn(Rt);return kt&&Gt(Et,vt,kt,Rt),kt}var Fn={};function Ar(){if(!or){var Et,Rt={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:ot||"./this.program"};for(Et in Fn)Fn[Et]===void 0?delete Rt[Et]:Rt[Et]=Fn[Et];var kt=[];for(Et in Rt)kt.push(Et+"="+Rt[Et]);or=kt}return or}var or,Sr=[null,[],[]];function Rr(Et,Rt){var kt=Sr[Et];Rt===0||Rt===10?((Et===1?ht:ft)(Dt(kt,0)),kt.length=0):kt.push(Rt)}var Dn=0;function Tr(Et){return Et%4==0&&(Et%100!=0||Et%400==0)}var rn=[31,29,31,30,31,30,31,31,30,31,30,31],sr=[31,28,31,30,31,30,31,31,30,31,30,31];function Hr(Et,Rt,kt,Vt){function Lt($t,dn,wn){for($t=typeof $t=="number"?$t.toString():$t||"";$t.length<dn;)$t=wn[0]+$t;return $t}function zt($t,dn){return Lt($t,dn,"0")}function Ht($t,dn){function wn(_r){return 0>_r?-1:0<_r?1:0}var Yn;return(Yn=wn($t.getFullYear()-dn.getFullYear()))===0&&(Yn=wn($t.getMonth()-dn.getMonth()))===0&&(Yn=wn($t.getDate()-dn.getDate())),Yn}function Zt($t){switch($t.getDay()){case 0:return new Date($t.getFullYear()-1,11,29);case 1:return $t;case 2:return new Date($t.getFullYear(),0,3);case 3:return new Date($t.getFullYear(),0,2);case 4:return new Date($t.getFullYear(),0,1);case 5:return new Date($t.getFullYear()-1,11,31);case 6:return new Date($t.getFullYear()-1,11,30)}}function Jt($t){var dn=$t.Bb;for($t=new Date(new Date($t.Cb+1900,0,1).getTime());0<dn;){var wn=$t.getMonth(),Yn=(Tr($t.getFullYear())?rn:sr)[wn];if(!(dn>Yn-$t.getDate())){$t.setDate($t.getDate()+dn);break}dn-=Yn-$t.getDate()+1,$t.setDate(1),11>wn?$t.setMonth(wn+1):($t.setMonth(0),$t.setFullYear($t.getFullYear()+1))}return wn=new Date($t.getFullYear()+1,0,4),dn=Zt(new Date($t.getFullYear(),0,4)),wn=Zt(wn),0>=Ht(dn,$t)?0>=Ht(wn,$t)?$t.getFullYear()+1:$t.getFullYear():$t.getFullYear()-1}var ln=Mt[Vt+40>>2>>>0];for(var Sn in Vt={$b:Mt[Vt>>2>>>0],Zb:Mt[Vt+4>>2>>>0],Gb:Mt[Vt+8>>2>>>0],Kb:Mt[Vt+12>>2>>>0],Hb:Mt[Vt+16>>2>>>0],Cb:Mt[Vt+20>>2>>>0],Ab:Mt[Vt+24>>2>>>0],Bb:Mt[Vt+28>>2>>>0],bc:Mt[Vt+32>>2>>>0],Yb:Mt[Vt+36>>2>>>0],ac:ln?Ct(ln):""},kt=Ct(kt),ln={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})kt=kt.replace(new RegExp(Sn,"g"),ln[Sn]);var Vn="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ln="January February March April May June July August September October November December".split(" ");for(Sn in ln={"%a":function($t){return Vn[$t.Ab].substring(0,3)},"%A":function($t){return Vn[$t.Ab]},"%b":function($t){return Ln[$t.Hb].substring(0,3)},"%B":function($t){return Ln[$t.Hb]},"%C":function($t){return zt(($t.Cb+1900)/100|0,2)},"%d":function($t){return zt($t.Kb,2)},"%e":function($t){return Lt($t.Kb,2," ")},"%g":function($t){return Jt($t).toString().substring(2)},"%G":function($t){return Jt($t)},"%H":function($t){return zt($t.Gb,2)},"%I":function($t){return($t=$t.Gb)==0?$t=12:12<$t&&($t-=12),zt($t,2)},"%j":function($t){for(var dn=0,wn=0;wn<=$t.Hb-1;dn+=(Tr($t.Cb+1900)?rn:sr)[wn++]);return zt($t.Kb+dn,3)},"%m":function($t){return zt($t.Hb+1,2)},"%M":function($t){return zt($t.Zb,2)},"%n":function(){return`
`},"%p":function($t){return 0<=$t.Gb&&12>$t.Gb?"AM":"PM"},"%S":function($t){return zt($t.$b,2)},"%t":function(){return"	"},"%u":function($t){return $t.Ab||7},"%U":function($t){return zt(Math.floor(($t.Bb+7-$t.Ab)/7),2)},"%V":function($t){var dn=Math.floor(($t.Bb+7-($t.Ab+6)%7)/7);if(2>=($t.Ab+371-$t.Bb-2)%7&&dn++,dn)dn==53&&((wn=($t.Ab+371-$t.Bb)%7)==4||wn==3&&Tr($t.Cb)||(dn=1));else{dn=52;var wn=($t.Ab+7-$t.Bb-1)%7;(wn==4||wn==5&&Tr($t.Cb%400-1))&&dn++}return zt(dn,2)},"%w":function($t){return $t.Ab},"%W":function($t){return zt(Math.floor(($t.Bb+7-($t.Ab+6)%7)/7),2)},"%y":function($t){return($t.Cb+1900).toString().substring(2)},"%Y":function($t){return $t.Cb+1900},"%z":function($t){var dn=0<=($t=$t.Yb);return $t=Math.abs($t)/60,(dn?"+":"-")+("0000"+($t/60*100+$t%60)).slice(-4)},"%Z":function($t){return $t.ac},"%%":function(){return"%"}},kt=kt.replace(/%%/g,"\0\0"),ln)kt.includes(Sn)&&(kt=kt.replace(new RegExp(Sn,"g"),ln[Sn](Vt)));return Sn=function($t){var dn=Array(Wt($t)+1);return Gt($t,dn,0,dn.length),dn}(kt=kt.replace(/\0\0/g,"%")),Sn.length>Rt?0:(vt.set(Sn,Et>>>0),Sn.length-1)}var Kr={a:function(Et){return Tn(Et+24)+24},m:function(Et){return(Et=new Rn(Et)).Pb()||(Et.Ib(!0),Hn--),Et.Jb(!1),ir.push(Et),Et.Nb(),Et.Qb()},ia:function(Et){throw ft("Unexpected exception thrown, this is not properly supported - aborting"),Pt=!0,Et},w:function(){sn(0);var Et=ir.pop();if(Et.Xb()&&!Et.Lb()){var Rt=Et.Wb();Rt&&pn(Rt)(Et.Db),Un(Et.Db)}Kn=0},d:function(){var Et=Kn;if(!Et)return Dn=0;var Rt=new Rn(Et);Rt.Fb(Et);var kt=Rt.Eb();if(!kt)return Dn=0,Et;for(var Vt=Array.prototype.slice.call(arguments),Lt=0;Lt<Vt.length;Lt++){var zt=Vt[Lt];if(zt===0||zt===kt)break;if(wr(zt,kt,Rt.zb+16))return Dn=zt,Et}return Dn=kt,Et},k:function(){var Et=Kn;if(!Et)return Dn=0;var Rt=new Rn(Et);Rt.Fb(Et);var kt=Rt.Eb();if(!kt)return Dn=0,Et;for(var Vt=Array.prototype.slice.call(arguments),Lt=0;Lt<Vt.length;Lt++){var zt=Vt[Lt];if(zt===0||zt===kt)break;if(wr(zt,kt,Rt.zb+16))return Dn=zt,Et}return Dn=kt,Et},g:function(){var Et=Kn;if(!Et)return Dn=0;var Rt=new Rn(Et);Rt.Fb(Et);var kt=Rt.Eb();if(!kt)return Dn=0,Et;for(var Vt=Array.prototype.slice.call(arguments),Lt=0;Lt<Vt.length;Lt++){var zt=Vt[Lt];if(zt===0||zt===kt)break;if(wr(zt,kt,Rt.zb+16))return Dn=zt,Et}return Dn=kt,Et},s:Un,L:function(){var Et=ir.pop();Et||An("no exception to throw");var Rt=Et.Db;throw Et.Lb()||(ir.push(Et),Et.Jb(!0),Et.Ib(!1),Hn++),Kn=Rt,Rt},b:function(Et,Rt,kt){throw new Rn(Et).Rb(Rt,kt),Kn=Et,Hn++,Et},la:function(){return Hn},i:function(Et){throw Kn||(Kn=Et),Et},H:function(){return 0},Ba:function(){},pa:function(){},ra:function(){},ka:function(){return 0},za:function(){},ua:function(){},ya:function(){},R:function(){},qa:function(){},na:function(){},Aa:function(){},oa:function(){},Ha:function(){},Ja:function(){An("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ia:function(){An("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},S:function(){return Date.now()},Ca:function(){return!0},Da:function(Et,Rt){Et=new Date(1e3*(xt[Et>>>2]+4294967296*Mt[Et+4>>>2])),Mt[Rt>>2>>>0]=Et.getUTCSeconds(),Mt[Rt+4>>2>>>0]=Et.getUTCMinutes(),Mt[Rt+8>>2>>>0]=Et.getUTCHours(),Mt[Rt+12>>2>>>0]=Et.getUTCDate(),Mt[Rt+16>>2>>>0]=Et.getUTCMonth(),Mt[Rt+20>>2>>>0]=Et.getUTCFullYear()-1900,Mt[Rt+24>>2>>>0]=Et.getUTCDay(),Mt[Rt+28>>2>>>0]=(Et.getTime()-Date.UTC(Et.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},Ea:function(Et,Rt){Et=new Date(1e3*(xt[Et>>>2]+4294967296*Mt[Et+4>>>2])),Mt[Rt>>2>>>0]=Et.getSeconds(),Mt[Rt+4>>2>>>0]=Et.getMinutes(),Mt[Rt+8>>2>>>0]=Et.getHours(),Mt[Rt+12>>2>>>0]=Et.getDate(),Mt[Rt+16>>2>>>0]=Et.getMonth(),Mt[Rt+20>>2>>>0]=Et.getFullYear()-1900,Mt[Rt+24>>2>>>0]=Et.getDay();var kt=new Date(Et.getFullYear(),0,1);Mt[Rt+28>>2>>>0]=(Et.getTime()-kt.getTime())/864e5|0,Mt[Rt+36>>2>>>0]=-60*Et.getTimezoneOffset();var Vt=new Date(Et.getFullYear(),6,1).getTimezoneOffset();kt=kt.getTimezoneOffset(),Mt[Rt+32>>2>>>0]=0|(Vt!=kt&&Et.getTimezoneOffset()==Math.min(kt,Vt))},Fa:function(Et){var Rt=new Date(Mt[Et+20>>2>>>0]+1900,Mt[Et+16>>2>>>0],Mt[Et+12>>2>>>0],Mt[Et+8>>2>>>0],Mt[Et+4>>2>>>0],Mt[Et>>2>>>0],0),kt=Mt[Et+32>>2>>>0],Vt=Rt.getTimezoneOffset(),Lt=new Date(Rt.getFullYear(),0,1),zt=new Date(Rt.getFullYear(),6,1).getTimezoneOffset(),Ht=Lt.getTimezoneOffset(),Zt=Math.min(Ht,zt);return 0>kt?Mt[Et+32>>2>>>0]=+(zt!=Ht&&Zt==Vt):0<kt!=(Zt==Vt)&&(zt=Math.max(Ht,zt),Rt.setTime(Rt.getTime()+6e4*((0<kt?Zt:zt)-Vt))),Mt[Et+24>>2>>>0]=Rt.getDay(),Mt[Et+28>>2>>>0]=(Rt.getTime()-Lt.getTime())/864e5|0,Mt[Et>>2>>>0]=Rt.getSeconds(),Mt[Et+4>>2>>>0]=Rt.getMinutes(),Mt[Et+8>>2>>>0]=Rt.getHours(),Mt[Et+12>>2>>>0]=Rt.getDate(),Mt[Et+16>>2>>>0]=Rt.getMonth(),Rt.getTime()/1e3|0},sa:function(){return-52},ta:function(){},Ga:function Et(Rt,kt,Vt){Et.Vb||(Et.Vb=!0,function(Lt,zt,Ht){function Zt(Ln){return(Ln=Ln.toTimeString().match(/\(([A-Za-z ]+)\)$/))?Ln[1]:"GMT"}var Jt=new Date().getFullYear(),ln=new Date(Jt,0,1),Sn=new Date(Jt,6,1);Jt=ln.getTimezoneOffset();var Vn=Sn.getTimezoneOffset();Mt[Lt>>2>>>0]=60*Math.max(Jt,Vn),Mt[zt>>2>>>0]=+(Jt!=Vn),Lt=Zt(ln),zt=Zt(Sn),Lt=Nn(Lt),zt=Nn(zt),Vn<Jt?(xt[Ht>>2>>>0]=Lt,xt[Ht+4>>2>>>0]=zt):(xt[Ht>>2>>>0]=zt,xt[Ht+4>>2>>>0]=Lt)}(Rt,kt,Vt))},B:function(){An("")},ma:function(){return 4294901760},I:ct?()=>{var Et=process.hrtime();return 1e3*Et[0]+Et[1]/1e6}:()=>performance.now(),xa:function(Et,Rt,kt){Tt.copyWithin(Et>>>0,Rt>>>0,Rt+kt>>>0)},G:function(Et){var Rt=Tt.length;if(4294901760<(Et>>>=0))return!1;for(var kt=1;4>=kt;kt*=2){var Vt=Rt*(1+.2/kt);Vt=Math.min(Vt,Et+100663296);var Lt=Math;Vt=Math.max(Et,Vt),Lt=Lt.min.call(Lt,4294901760,Vt+(65536-Vt%65536)%65536);e:{try{_t.grow(Lt-bt.byteLength+65535>>>16),Qt();var zt=1;break e}catch{}zt=void 0}if(zt)return!0}return!1},va:function(Et,Rt){var kt=0;return Ar().forEach(function(Vt,Lt){var zt=Rt+kt;for(Lt=xt[Et+4*Lt>>2>>>0]=zt,zt=0;zt<Vt.length;++zt)vt[Lt++>>0>>>0]=Vt.charCodeAt(zt);vt[Lt>>0>>>0]=0,kt+=Vt.length+1}),0},wa:function(Et,Rt){var kt=Ar();xt[Et>>2>>>0]=kt.length;var Vt=0;return kt.forEach(function(Lt){Vt+=Lt.length+1}),xt[Rt>>2>>>0]=Vt,0},ba:function(Et){ut||0<kn||(dr(),rr(cn),cr(0),Sr[1].length&&Rr(1,10),Sr[2].length&&Rr(2,10)),ut||0<kn||(_.onExit&&_.onExit(Et),Pt=!0),it(Et,new qn(Et))},E:function(){return 52},Q:function(){return 52},ca:function(){return 70},P:function(Et,Rt,kt,Vt){for(var Lt=0,zt=0;zt<kt;zt++){var Ht=xt[Rt>>2>>>0],Zt=xt[Rt+4>>2>>>0];Rt+=8;for(var Jt=0;Jt<Zt;Jt++)Rr(Et,Tt[Ht+Jt>>>0]);Lt+=Zt}return xt[Vt>>2>>>0]=Lt,0},c:function(){return Dn},ja:function Et(Rt,kt){Et.Mb||(Et.Mb=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var Lt=new Uint8Array(1);return()=>(crypto.getRandomValues(Lt),Lt[0])}if(ct)try{var zt=o(Object(function(){var Ht=new Error("Cannot find module 'crypto'");throw Ht.code="MODULE_NOT_FOUND",Ht}()));return()=>zt.randomBytes(1)[0]}catch{}return()=>An("randomDevice")}());for(var Vt=0;Vt<kt;Vt++)vt[Rt+Vt>>0>>>0]=Et.Mb();return 0},ea:function(Et,Rt,kt){var Vt=tn();try{return pn(Et)(Rt,kt)}catch(Lt){if(on(Vt),Lt!==Lt+0)throw Lt;sn(1,0)}},fa:function(Et,Rt,kt){var Vt=tn();try{return pn(Et)(Rt,kt)}catch(Lt){if(on(Vt),Lt!==Lt+0)throw Lt;sn(1,0)}},J:function(Et){var Rt=tn();try{return pn(Et)()}catch(kt){if(on(Rt),kt!==kt+0)throw kt;sn(1,0)}},e:function(Et,Rt){var kt=tn();try{return pn(Et)(Rt)}catch(Vt){if(on(kt),Vt!==Vt+0)throw Vt;sn(1,0)}},N:function(Et,Rt,kt){var Vt=tn();try{return pn(Et)(Rt,kt)}catch(Lt){if(on(Vt),Lt!==Lt+0)throw Lt;sn(1,0)}},O:function(Et,Rt,kt){var Vt=tn();try{return pn(Et)(Rt,kt)}catch(Lt){if(on(Vt),Lt!==Lt+0)throw Lt;sn(1,0)}},j:function(Et,Rt,kt){var Vt=tn();try{return pn(Et)(Rt,kt)}catch(Lt){if(on(Vt),Lt!==Lt+0)throw Lt;sn(1,0)}},o:function(Et,Rt,kt,Vt){var Lt=tn();try{return pn(Et)(Rt,kt,Vt)}catch(zt){if(on(Lt),zt!==zt+0)throw zt;sn(1,0)}},p:function(Et,Rt,kt,Vt,Lt){var zt=tn();try{return pn(Et)(Rt,kt,Vt,Lt)}catch(Ht){if(on(zt),Ht!==Ht+0)throw Ht;sn(1,0)}},M:function(Et,Rt,kt,Vt,Lt,zt){var Ht=tn();try{return pn(Et)(Rt,kt,Vt,Lt,zt)}catch(Zt){if(on(Ht),Zt!==Zt+0)throw Zt;sn(1,0)}},r:function(Et,Rt,kt,Vt,Lt,zt){var Ht=tn();try{return pn(Et)(Rt,kt,Vt,Lt,zt)}catch(Zt){if(on(Ht),Zt!==Zt+0)throw Zt;sn(1,0)}},v:function(Et,Rt,kt,Vt,Lt,zt,Ht){var Zt=tn();try{return pn(Et)(Rt,kt,Vt,Lt,zt,Ht)}catch(Jt){if(on(Zt),Jt!==Jt+0)throw Jt;sn(1,0)}},K:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt){var Jt=tn();try{return pn(Et)(Rt,kt,Vt,Lt,zt,Ht,Zt)}catch(ln){if(on(Jt),ln!==ln+0)throw ln;sn(1,0)}},D:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn,Vn){var Ln=tn();try{return pn(Et)(Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn,Vn)}catch($t){if(on(Ln),$t!==$t+0)throw $t;sn(1,0)}},X:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt){var Jt=tn();try{return Lr(Et,Rt,kt,Vt,Lt,zt,Ht,Zt)}catch(ln){if(on(Jt),ln!==ln+0)throw ln;sn(1,0)}},V:function(Et,Rt,kt,Vt,Lt,zt,Ht){var Zt=tn();try{return $n(Et,Rt,kt,Vt,Lt,zt,Ht)}catch(Jt){if(on(Zt),Jt!==Jt+0)throw Jt;sn(1,0)}},U:function(Et,Rt,kt,Vt,Lt){var zt=tn();try{return $r(Et,Rt,kt,Vt,Lt)}catch(Ht){if(on(zt),Ht!==Ht+0)throw Ht;sn(1,0)}},Z:function(Et,Rt,kt,Vt){var Lt=tn();try{return Fr(Et,Rt,kt,Vt)}catch(zt){if(on(Lt),zt!==zt+0)throw zt;sn(1,0)}},W:function(Et){var Rt=tn();try{return Mr(Et)}catch(kt){if(on(Rt),kt!==kt+0)throw kt;sn(1,0)}},Y:function(Et,Rt){var kt=tn();try{return ar(Et,Rt)}catch(Vt){if(on(kt),Vt!==Vt+0)throw Vt;sn(1,0)}},T:function(Et,Rt,kt){var Vt=tn();try{return Or(Et,Rt,kt)}catch(Lt){if(on(Vt),Lt!==Lt+0)throw Lt;sn(1,0)}},f:function(Et){var Rt=tn();try{pn(Et)()}catch(kt){if(on(Rt),kt!==kt+0)throw kt;sn(1,0)}},q:function(Et,Rt){var kt=tn();try{pn(Et)(Rt)}catch(Vt){if(on(kt),Vt!==Vt+0)throw Vt;sn(1,0)}},h:function(Et,Rt,kt){var Vt=tn();try{pn(Et)(Rt,kt)}catch(Lt){if(on(Vt),Lt!==Lt+0)throw Lt;sn(1,0)}},da:function(Et,Rt,kt,Vt){var Lt=tn();try{pn(Et)(Rt,kt,Vt)}catch(zt){if(on(Lt),zt!==zt+0)throw zt;sn(1,0)}},l:function(Et,Rt,kt,Vt){var Lt=tn();try{pn(Et)(Rt,kt,Vt)}catch(zt){if(on(Lt),zt!==zt+0)throw zt;sn(1,0)}},t:function(Et,Rt,kt,Vt,Lt){var zt=tn();try{pn(Et)(Rt,kt,Vt,Lt)}catch(Ht){if(on(zt),Ht!==Ht+0)throw Ht;sn(1,0)}},u:function(Et,Rt,kt,Vt,Lt,zt){var Ht=tn();try{pn(Et)(Rt,kt,Vt,Lt,zt)}catch(Zt){if(on(Ht),Zt!==Zt+0)throw Zt;sn(1,0)}},x:function(Et,Rt,kt,Vt,Lt,zt,Ht){var Zt=tn();try{pn(Et)(Rt,kt,Vt,Lt,zt,Ht)}catch(Jt){if(on(Zt),Jt!==Jt+0)throw Jt;sn(1,0)}},z:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt){var Jt=tn();try{pn(Et)(Rt,kt,Vt,Lt,zt,Ht,Zt)}catch(ln){if(on(Jt),ln!==ln+0)throw ln;sn(1,0)}},ga:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt,Jt){var ln=tn();try{pn(Et)(Rt,kt,Vt,Lt,zt,Ht,Zt,Jt)}catch(Sn){if(on(ln),Sn!==Sn+0)throw Sn;sn(1,0)}},A:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn){var Vn=tn();try{pn(Et)(Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn)}catch(Ln){if(on(Vn),Ln!==Ln+0)throw Ln;sn(1,0)}},C:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn,Vn,Ln,$t,dn,wn){var Yn=tn();try{pn(Et)(Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn,Vn,Ln,$t,dn,wn)}catch(_r){if(on(Yn),_r!==_r+0)throw _r;sn(1,0)}},aa:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt){var Jt=tn();try{fr(Et,Rt,kt,Vt,Lt,zt,Ht,Zt)}catch(ln){if(on(Jt),ln!==ln+0)throw ln;sn(1,0)}},_:function(Et,Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn,Vn){var Ln=tn();try{Nr(Et,Rt,kt,Vt,Lt,zt,Ht,Zt,Jt,ln,Sn,Vn)}catch($t){if(on(Ln),$t!==$t+0)throw $t;sn(1,0)}},$:function(Et,Rt,kt,Vt,Lt,zt){var Ht=tn();try{pr(Et,Rt,kt,Vt,Lt,zt)}catch(Zt){if(on(Ht),Zt!==Zt+0)throw Zt;sn(1,0)}},n:function(Et){return Et},F:function(Et){Dn=Et},ha:Hr,y:function(Et,Rt,kt,Vt){return Hr(Et,Rt,kt,Vt)}};(function(){function Et(Lt){_.asm=Lt.exports,_t=_.asm.Ka,Qt(),nn=_.asm.ib,en.unshift(_.asm.La),xn--,_.monitorRunDependencies&&_.monitorRunDependencies(xn),xn==0&&On&&(Lt=On,On=null,Lt())}function Rt(Lt){Et(Lt.instance)}function kt(Lt){return function(){if(!mt&&(at||lt)){if(typeof fetch=="function"&&!bn.startsWith("file://"))return fetch(bn,{credentials:"same-origin"}).then(function(zt){if(!zt.ok)throw"failed to load wasm binary file at '"+bn+"'";return zt.arrayBuffer()}).catch(function(){return zn()});if(et)return new Promise(function(zt,Ht){et(bn,function(Zt){zt(new Uint8Array(Zt))},Ht)})}return Promise.resolve().then(function(){return zn()})}().then(function(zt){return WebAssembly.instantiate(zt,Vt)}).then(function(zt){return zt}).then(Lt,function(zt){ft("failed to asynchronously prepare wasm: "+zt),An(zt)})}var Vt={a:Kr};if(xn++,_.monitorRunDependencies&&_.monitorRunDependencies(xn),_.instantiateWasm)try{return _.instantiateWasm(Vt,Et)}catch(Lt){return ft("Module.instantiateWasm callback failed with error: "+Lt),!1}(mt||typeof WebAssembly.instantiateStreaming!="function"||vn()||bn.startsWith("file://")||ct||typeof fetch!="function"?kt(Rt):fetch(bn,{credentials:"same-origin"}).then(function(Lt){return WebAssembly.instantiateStreaming(Lt,Vt).then(Rt,function(zt){return ft("wasm streaming compile failed: "+zt),ft("falling back to ArrayBuffer instantiation"),kt(Rt)})})).catch(nt)})(),_.___wasm_call_ctors=function(){return(_.___wasm_call_ctors=_.asm.La).apply(null,arguments)},_._OrtInit=function(){return(_._OrtInit=_.asm.Ma).apply(null,arguments)},_._OrtCreateSessionOptions=function(){return(_._OrtCreateSessionOptions=_.asm.Na).apply(null,arguments)},_._OrtAppendExecutionProvider=function(){return(_._OrtAppendExecutionProvider=_.asm.Oa).apply(null,arguments)},_._OrtAddSessionConfigEntry=function(){return(_._OrtAddSessionConfigEntry=_.asm.Pa).apply(null,arguments)},_._OrtReleaseSessionOptions=function(){return(_._OrtReleaseSessionOptions=_.asm.Qa).apply(null,arguments)},_._OrtCreateSession=function(){return(_._OrtCreateSession=_.asm.Ra).apply(null,arguments)},_._OrtReleaseSession=function(){return(_._OrtReleaseSession=_.asm.Sa).apply(null,arguments)},_._OrtGetInputCount=function(){return(_._OrtGetInputCount=_.asm.Ta).apply(null,arguments)},_._OrtGetOutputCount=function(){return(_._OrtGetOutputCount=_.asm.Ua).apply(null,arguments)},_._OrtGetInputName=function(){return(_._OrtGetInputName=_.asm.Va).apply(null,arguments)},_._OrtGetOutputName=function(){return(_._OrtGetOutputName=_.asm.Wa).apply(null,arguments)},_._OrtFree=function(){return(_._OrtFree=_.asm.Xa).apply(null,arguments)},_._OrtCreateTensor=function(){return(_._OrtCreateTensor=_.asm.Ya).apply(null,arguments)},_._OrtGetTensorData=function(){return(_._OrtGetTensorData=_.asm.Za).apply(null,arguments)},_._OrtReleaseTensor=function(){return(_._OrtReleaseTensor=_.asm._a).apply(null,arguments)},_._OrtCreateRunOptions=function(){return(_._OrtCreateRunOptions=_.asm.$a).apply(null,arguments)},_._OrtAddRunConfigEntry=function(){return(_._OrtAddRunConfigEntry=_.asm.ab).apply(null,arguments)},_._OrtReleaseRunOptions=function(){return(_._OrtReleaseRunOptions=_.asm.bb).apply(null,arguments)},_._OrtRun=function(){return(_._OrtRun=_.asm.cb).apply(null,arguments)},_._OrtEndProfiling=function(){return(_._OrtEndProfiling=_.asm.db).apply(null,arguments)};var er,Tn=_._malloc=function(){return(Tn=_._malloc=_.asm.eb).apply(null,arguments)},br=_._free=function(){return(br=_._free=_.asm.fb).apply(null,arguments)},cr=_._fflush=function(){return(cr=_._fflush=_.asm.gb).apply(null,arguments)},dr=_.___funcs_on_exit=function(){return(dr=_.___funcs_on_exit=_.asm.hb).apply(null,arguments)},sn=_._setThrew=function(){return(sn=_._setThrew=_.asm.jb).apply(null,arguments)},tn=_.stackSave=function(){return(tn=_.stackSave=_.asm.kb).apply(null,arguments)},on=_.stackRestore=function(){return(on=_.stackRestore=_.asm.lb).apply(null,arguments)},vr=_.stackAlloc=function(){return(vr=_.stackAlloc=_.asm.mb).apply(null,arguments)},wr=_.___cxa_can_catch=function(){return(wr=_.___cxa_can_catch=_.asm.nb).apply(null,arguments)},hr=_.___cxa_is_pointer_type=function(){return(hr=_.___cxa_is_pointer_type=_.asm.ob).apply(null,arguments)},Mr=_.dynCall_j=function(){return(Mr=_.dynCall_j=_.asm.pb).apply(null,arguments)},$n=_.dynCall_iiiiij=function(){return($n=_.dynCall_iiiiij=_.asm.qb).apply(null,arguments)},Or=_.dynCall_jii=function(){return(Or=_.dynCall_jii=_.asm.rb).apply(null,arguments)},fr=_.dynCall_viiiiij=function(){return(fr=_.dynCall_viiiiij=_.asm.sb).apply(null,arguments)},pr=_.dynCall_vjji=function(){return(pr=_.dynCall_vjji=_.asm.tb).apply(null,arguments)},Nr=_.dynCall_viiijjjii=function(){return(Nr=_.dynCall_viiijjjii=_.asm.ub).apply(null,arguments)},Fr=_.dynCall_iij=function(){return(Fr=_.dynCall_iij=_.asm.vb).apply(null,arguments)},ar=_.dynCall_ji=function(){return(ar=_.dynCall_ji=_.asm.wb).apply(null,arguments)},Lr=_.dynCall_iiiiiij=function(){return(Lr=_.dynCall_iiiiiij=_.asm.xb).apply(null,arguments)},$r=_.dynCall_iiij=function(){return($r=_.dynCall_iiij=_.asm.yb).apply(null,arguments)};function Er(){function Et(){if(!er&&(er=!0,_.calledRun=!0,!Pt)){if(rr(en),$(_),_.onRuntimeInitialized&&_.onRuntimeInitialized(),_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;){var Rt=_.postRun.shift();an.unshift(Rt)}rr(an)}}if(!(0<xn)){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)jn();rr(un),0<xn||(_.setStatus?(_.setStatus("Running..."),setTimeout(function(){setTimeout(function(){_.setStatus("")},1),Et()},1)):Et())}}if(_.UTF8ToString=Ct,_.stringToUTF8=function(Et,Rt,kt){return Gt(Et,Tt,Rt,kt)},_.lengthBytesUTF8=Wt,_.stackSave=tn,_.stackRestore=on,_.stackAlloc=vr,On=function Et(){er||Er(),er||(On=Et)},_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);0<_.preInit.length;)_.preInit.pop()();return Er(),h.ready});i.exports=c},4537:i=>{i.exports=function(e,o){for(var s=new Array(arguments.length-1),c=0,h=2,_=!0;h<arguments.length;)s[c++]=arguments[h++];return new Promise(function($,nt){s[c]=function(tt){if(_)if(_=!1,tt)nt(tt);else{for(var et=new Array(arguments.length-1),d=0;d<et.length;)et[d++]=arguments[d];$.apply(null,et)}};try{e.apply(o||null,s)}catch(tt){_&&(_=!1,nt(tt))}})}},7419:(i,e)=>{var o=e;o.length=function($){var nt=$.length;if(!nt)return 0;for(var tt=0;--nt%4>1&&$.charAt(nt)==="=";)++tt;return Math.ceil(3*$.length)/4-tt};for(var s=new Array(64),c=new Array(123),h=0;h<64;)c[s[h]=h<26?h+65:h<52?h+71:h<62?h-4:h-59|43]=h++;o.encode=function($,nt,tt){for(var et,d=null,a=[],g=0,j=0;nt<tt;){var rt=$[nt++];switch(j){case 0:a[g++]=s[rt>>2],et=(3&rt)<<4,j=1;break;case 1:a[g++]=s[et|rt>>4],et=(15&rt)<<2,j=2;break;case 2:a[g++]=s[et|rt>>6],a[g++]=s[63&rt],j=0}g>8191&&((d||(d=[])).push(String.fromCharCode.apply(String,a)),g=0)}return j&&(a[g++]=s[et],a[g++]=61,j===1&&(a[g++]=61)),d?(g&&d.push(String.fromCharCode.apply(String,a.slice(0,g))),d.join("")):String.fromCharCode.apply(String,a.slice(0,g))};var _="invalid encoding";o.decode=function($,nt,tt){for(var et,d=tt,a=0,g=0;g<$.length;){var j=$.charCodeAt(g++);if(j===61&&a>1)break;if((j=c[j])===void 0)throw Error(_);switch(a){case 0:et=j,a=1;break;case 1:nt[tt++]=et<<2|(48&j)>>4,et=j,a=2;break;case 2:nt[tt++]=(15&et)<<4|(60&j)>>2,et=j,a=3;break;case 3:nt[tt++]=(3&et)<<6|j,a=0}}if(a===1)throw Error(_);return tt-d},o.test=function($){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test($)}},9211:i=>{function e(){this._listeners={}}i.exports=e,e.prototype.on=function(o,s,c){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:s,ctx:c||this}),this},e.prototype.off=function(o,s){if(o===void 0)this._listeners={};else if(s===void 0)this._listeners[o]=[];else for(var c=this._listeners[o],h=0;h<c.length;)c[h].fn===s?c.splice(h,1):++h;return this},e.prototype.emit=function(o){var s=this._listeners[o];if(s){for(var c=[],h=1;h<arguments.length;)c.push(arguments[h++]);for(h=0;h<s.length;)s[h].fn.apply(s[h++].ctx,c)}return this}},945:i=>{function e(_){return typeof Float32Array<"u"?function(){var $=new Float32Array([-0]),nt=new Uint8Array($.buffer),tt=nt[3]===128;function et(j,rt,ot){$[0]=j,rt[ot]=nt[0],rt[ot+1]=nt[1],rt[ot+2]=nt[2],rt[ot+3]=nt[3]}function d(j,rt,ot){$[0]=j,rt[ot]=nt[3],rt[ot+1]=nt[2],rt[ot+2]=nt[1],rt[ot+3]=nt[0]}function a(j,rt){return nt[0]=j[rt],nt[1]=j[rt+1],nt[2]=j[rt+2],nt[3]=j[rt+3],$[0]}function g(j,rt){return nt[3]=j[rt],nt[2]=j[rt+1],nt[1]=j[rt+2],nt[0]=j[rt+3],$[0]}_.writeFloatLE=tt?et:d,_.writeFloatBE=tt?d:et,_.readFloatLE=tt?a:g,_.readFloatBE=tt?g:a}():function(){function $(tt,et,d,a){var g=et<0?1:0;if(g&&(et=-et),et===0)tt(1/et>0?0:2147483648,d,a);else if(isNaN(et))tt(2143289344,d,a);else if(et>34028234663852886e22)tt((g<<31|2139095040)>>>0,d,a);else if(et<11754943508222875e-54)tt((g<<31|Math.round(et/1401298464324817e-60))>>>0,d,a);else{var j=Math.floor(Math.log(et)/Math.LN2);tt((g<<31|j+127<<23|8388607&Math.round(et*Math.pow(2,-j)*8388608))>>>0,d,a)}}function nt(tt,et,d){var a=tt(et,d),g=2*(a>>31)+1,j=a>>>23&255,rt=8388607&a;return j===255?rt?NaN:g*(1/0):j===0?1401298464324817e-60*g*rt:g*Math.pow(2,j-150)*(rt+8388608)}_.writeFloatLE=$.bind(null,o),_.writeFloatBE=$.bind(null,s),_.readFloatLE=nt.bind(null,c),_.readFloatBE=nt.bind(null,h)}(),typeof Float64Array<"u"?function(){var $=new Float64Array([-0]),nt=new Uint8Array($.buffer),tt=nt[7]===128;function et(j,rt,ot){$[0]=j,rt[ot]=nt[0],rt[ot+1]=nt[1],rt[ot+2]=nt[2],rt[ot+3]=nt[3],rt[ot+4]=nt[4],rt[ot+5]=nt[5],rt[ot+6]=nt[6],rt[ot+7]=nt[7]}function d(j,rt,ot){$[0]=j,rt[ot]=nt[7],rt[ot+1]=nt[6],rt[ot+2]=nt[5],rt[ot+3]=nt[4],rt[ot+4]=nt[3],rt[ot+5]=nt[2],rt[ot+6]=nt[1],rt[ot+7]=nt[0]}function a(j,rt){return nt[0]=j[rt],nt[1]=j[rt+1],nt[2]=j[rt+2],nt[3]=j[rt+3],nt[4]=j[rt+4],nt[5]=j[rt+5],nt[6]=j[rt+6],nt[7]=j[rt+7],$[0]}function g(j,rt){return nt[7]=j[rt],nt[6]=j[rt+1],nt[5]=j[rt+2],nt[4]=j[rt+3],nt[3]=j[rt+4],nt[2]=j[rt+5],nt[1]=j[rt+6],nt[0]=j[rt+7],$[0]}_.writeDoubleLE=tt?et:d,_.writeDoubleBE=tt?d:et,_.readDoubleLE=tt?a:g,_.readDoubleBE=tt?g:a}():function(){function $(tt,et,d,a,g,j){var rt=a<0?1:0;if(rt&&(a=-a),a===0)tt(0,g,j+et),tt(1/a>0?0:2147483648,g,j+d);else if(isNaN(a))tt(0,g,j+et),tt(2146959360,g,j+d);else if(a>17976931348623157e292)tt(0,g,j+et),tt((rt<<31|2146435072)>>>0,g,j+d);else{var ot;if(a<22250738585072014e-324)tt((ot=a/5e-324)>>>0,g,j+et),tt((rt<<31|ot/4294967296)>>>0,g,j+d);else{var it=Math.floor(Math.log(a)/Math.LN2);it===1024&&(it=1023),tt(4503599627370496*(ot=a*Math.pow(2,-it))>>>0,g,j+et),tt((rt<<31|it+1023<<20|1048576*ot&1048575)>>>0,g,j+d)}}}function nt(tt,et,d,a,g){var j=tt(a,g+et),rt=tt(a,g+d),ot=2*(rt>>31)+1,it=rt>>>20&2047,at=4294967296*(1048575&rt)+j;return it===2047?at?NaN:ot*(1/0):it===0?5e-324*ot*at:ot*Math.pow(2,it-1075)*(at+4503599627370496)}_.writeDoubleLE=$.bind(null,o,0,4),_.writeDoubleBE=$.bind(null,s,4,0),_.readDoubleLE=nt.bind(null,c,0,4),_.readDoubleBE=nt.bind(null,h,4,0)}(),_}function o(_,$,nt){$[nt]=255&_,$[nt+1]=_>>>8&255,$[nt+2]=_>>>16&255,$[nt+3]=_>>>24}function s(_,$,nt){$[nt]=_>>>24,$[nt+1]=_>>>16&255,$[nt+2]=_>>>8&255,$[nt+3]=255&_}function c(_,$){return(_[$]|_[$+1]<<8|_[$+2]<<16|_[$+3]<<24)>>>0}function h(_,$){return(_[$]<<24|_[$+1]<<16|_[$+2]<<8|_[$+3])>>>0}i.exports=e(e)},7199:module=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(i){}return null}module.exports=inquire},6662:i=>{i.exports=function(e,o,s){var c=s||8192,h=c>>>1,_=null,$=c;return function(nt){if(nt<1||nt>h)return e(nt);$+nt>c&&(_=e(c),$=0);var tt=o.call(_,$,$+=nt);return 7&$&&($=1+(7|$)),tt}}},4997:(i,e)=>{var o=e;o.length=function(s){for(var c=0,h=0,_=0;_<s.length;++_)(h=s.charCodeAt(_))<128?c+=1:h<2048?c+=2:(64512&h)==55296&&(64512&s.charCodeAt(_+1))==56320?(++_,c+=4):c+=3;return c},o.read=function(s,c,h){if(h-c<1)return"";for(var _,$=null,nt=[],tt=0;c<h;)(_=s[c++])<128?nt[tt++]=_:_>191&&_<224?nt[tt++]=(31&_)<<6|63&s[c++]:_>239&&_<365?(_=((7&_)<<18|(63&s[c++])<<12|(63&s[c++])<<6|63&s[c++])-65536,nt[tt++]=55296+(_>>10),nt[tt++]=56320+(1023&_)):nt[tt++]=(15&_)<<12|(63&s[c++])<<6|63&s[c++],tt>8191&&(($||($=[])).push(String.fromCharCode.apply(String,nt)),tt=0);return $?(tt&&$.push(String.fromCharCode.apply(String,nt.slice(0,tt))),$.join("")):String.fromCharCode.apply(String,nt.slice(0,tt))},o.write=function(s,c,h){for(var _,$,nt=h,tt=0;tt<s.length;++tt)(_=s.charCodeAt(tt))<128?c[h++]=_:_<2048?(c[h++]=_>>6|192,c[h++]=63&_|128):(64512&_)==55296&&(64512&($=s.charCodeAt(tt+1)))==56320?(_=65536+((1023&_)<<10)+(1023&$),++tt,c[h++]=_>>18|240,c[h++]=_>>12&63|128,c[h++]=_>>6&63|128,c[h++]=63&_|128):(c[h++]=_>>12|224,c[h++]=_>>6&63|128,c[h++]=63&_|128);return h-nt}},3442:(i,e)=>{e.__esModule=!0;var o=function(){function s(c){if(!c)throw new TypeError("Invalid argument; `value` has no value.");this.value=s.EMPTY,c&&s.isGuid(c)&&(this.value=c)}return s.isGuid=function(c){var h=c.toString();return c&&(c instanceof s||s.validator.test(h))},s.create=function(){return new s([s.gen(2),s.gen(1),s.gen(1),s.gen(1),s.gen(3)].join("-"))},s.createEmpty=function(){return new s("emptyguid")},s.parse=function(c){return new s(c)},s.raw=function(){return[s.gen(2),s.gen(1),s.gen(1),s.gen(1),s.gen(3)].join("-")},s.gen=function(c){for(var h="",_=0;_<c;_++)h+=(65536*(1+Math.random())|0).toString(16).substring(1);return h},s.prototype.equals=function(c){return s.isGuid(c)&&this.value===c.toString()},s.prototype.isEmpty=function(){return this.value===s.EMPTY},s.prototype.toString=function(){return this.value},s.prototype.toJSON=function(){return{value:this.value}},s.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),s.EMPTY="00000000-0000-0000-0000-000000000000",s}();e.Guid=o},3720:i=>{i.exports=o;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function o(ut,_t,bt){this.low=0|ut,this.high=0|_t,this.unsigned=!!bt}function s(ut){return(ut&&ut.__isLong__)===!0}o.prototype.__isLong__,Object.defineProperty(o.prototype,"__isLong__",{value:!0}),o.isLong=s;var c={},h={};function _(ut,_t){var bt,vt,Tt;return _t?(Tt=0<=(ut>>>=0)&&ut<256)&&(vt=h[ut])?vt:(bt=nt(ut,(0|ut)<0?-1:0,!0),Tt&&(h[ut]=bt),bt):(Tt=-128<=(ut|=0)&&ut<128)&&(vt=c[ut])?vt:(bt=nt(ut,ut<0?-1:0,!1),Tt&&(c[ut]=bt),bt)}function $(ut,_t){if(isNaN(ut))return _t?it:ot;if(_t){if(ut<0)return it;if(ut>=g)return mt}else{if(ut<=-j)return ht;if(ut+1>=j)return dt}return ut<0?$(-ut,_t).neg():nt(ut%a|0,ut/a|0,_t)}function nt(ut,_t,bt){return new o(ut,_t,bt)}o.fromInt=_,o.fromNumber=$,o.fromBits=nt;var tt=Math.pow;function et(ut,_t,bt){if(ut.length===0)throw Error("empty string");if(ut==="NaN"||ut==="Infinity"||ut==="+Infinity"||ut==="-Infinity")return ot;if(typeof _t=="number"?(bt=_t,_t=!1):_t=!!_t,(bt=bt||10)<2||36<bt)throw RangeError("radix");var vt;if((vt=ut.indexOf("-"))>0)throw Error("interior hyphen");if(vt===0)return et(ut.substring(1),_t,bt).neg();for(var Tt=$(tt(bt,8)),Mt=ot,xt=0;xt<ut.length;xt+=8){var Pt=Math.min(8,ut.length-xt),It=parseInt(ut.substring(xt,xt+Pt),bt);if(Pt<8){var Dt=$(tt(bt,Pt));Mt=Mt.mul(Dt).add($(It))}else Mt=(Mt=Mt.mul(Tt)).add($(It))}return Mt.unsigned=_t,Mt}function d(ut,_t){return typeof ut=="number"?$(ut,_t):typeof ut=="string"?et(ut,_t):nt(ut.low,ut.high,typeof _t=="boolean"?_t:ut.unsigned)}o.fromString=et,o.fromValue=d;var a=4294967296,g=a*a,j=g/2,rt=_(1<<24),ot=_(0);o.ZERO=ot;var it=_(0,!0);o.UZERO=it;var at=_(1);o.ONE=at;var lt=_(1,!0);o.UONE=lt;var ct=_(-1);o.NEG_ONE=ct;var dt=nt(-1,2147483647,!1);o.MAX_VALUE=dt;var mt=nt(-1,-1,!0);o.MAX_UNSIGNED_VALUE=mt;var ht=nt(0,-2147483648,!1);o.MIN_VALUE=ht;var ft=o.prototype;ft.toInt=function(){return this.unsigned?this.low>>>0:this.low},ft.toNumber=function(){return this.unsigned?(this.high>>>0)*a+(this.low>>>0):this.high*a+(this.low>>>0)},ft.toString=function(ut){if((ut=ut||10)<2||36<ut)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(ht)){var _t=$(ut),bt=this.div(_t),vt=bt.mul(_t).sub(this);return bt.toString(ut)+vt.toInt().toString(ut)}return"-"+this.neg().toString(ut)}for(var Tt=$(tt(ut,6),this.unsigned),Mt=this,xt="";;){var Pt=Mt.div(Tt),It=(Mt.sub(Pt.mul(Tt)).toInt()>>>0).toString(ut);if((Mt=Pt).isZero())return It+xt;for(;It.length<6;)It="0"+It;xt=""+It+xt}},ft.getHighBits=function(){return this.high},ft.getHighBitsUnsigned=function(){return this.high>>>0},ft.getLowBits=function(){return this.low},ft.getLowBitsUnsigned=function(){return this.low>>>0},ft.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ht)?64:this.neg().getNumBitsAbs();for(var ut=this.high!=0?this.high:this.low,_t=31;_t>0&&!(ut&1<<_t);_t--);return this.high!=0?_t+33:_t+1},ft.isZero=function(){return this.high===0&&this.low===0},ft.eqz=ft.isZero,ft.isNegative=function(){return!this.unsigned&&this.high<0},ft.isPositive=function(){return this.unsigned||this.high>=0},ft.isOdd=function(){return(1&this.low)==1},ft.isEven=function(){return(1&this.low)==0},ft.equals=function(ut){return s(ut)||(ut=d(ut)),(this.unsigned===ut.unsigned||this.high>>>31!=1||ut.high>>>31!=1)&&this.high===ut.high&&this.low===ut.low},ft.eq=ft.equals,ft.notEquals=function(ut){return!this.eq(ut)},ft.neq=ft.notEquals,ft.ne=ft.notEquals,ft.lessThan=function(ut){return this.comp(ut)<0},ft.lt=ft.lessThan,ft.lessThanOrEqual=function(ut){return this.comp(ut)<=0},ft.lte=ft.lessThanOrEqual,ft.le=ft.lessThanOrEqual,ft.greaterThan=function(ut){return this.comp(ut)>0},ft.gt=ft.greaterThan,ft.greaterThanOrEqual=function(ut){return this.comp(ut)>=0},ft.gte=ft.greaterThanOrEqual,ft.ge=ft.greaterThanOrEqual,ft.compare=function(ut){if(s(ut)||(ut=d(ut)),this.eq(ut))return 0;var _t=this.isNegative(),bt=ut.isNegative();return _t&&!bt?-1:!_t&&bt?1:this.unsigned?ut.high>>>0>this.high>>>0||ut.high===this.high&&ut.low>>>0>this.low>>>0?-1:1:this.sub(ut).isNegative()?-1:1},ft.comp=ft.compare,ft.negate=function(){return!this.unsigned&&this.eq(ht)?ht:this.not().add(at)},ft.neg=ft.negate,ft.add=function(ut){s(ut)||(ut=d(ut));var _t=this.high>>>16,bt=65535&this.high,vt=this.low>>>16,Tt=65535&this.low,Mt=ut.high>>>16,xt=65535&ut.high,Pt=ut.low>>>16,It=0,Dt=0,Ct=0,Gt=0;return Ct+=(Gt+=Tt+(65535&ut.low))>>>16,Dt+=(Ct+=vt+Pt)>>>16,It+=(Dt+=bt+xt)>>>16,It+=_t+Mt,nt((Ct&=65535)<<16|(Gt&=65535),(It&=65535)<<16|(Dt&=65535),this.unsigned)},ft.subtract=function(ut){return s(ut)||(ut=d(ut)),this.add(ut.neg())},ft.sub=ft.subtract,ft.multiply=function(ut){if(this.isZero())return ot;if(s(ut)||(ut=d(ut)),e)return nt(e.mul(this.low,this.high,ut.low,ut.high),e.get_high(),this.unsigned);if(ut.isZero())return ot;if(this.eq(ht))return ut.isOdd()?ht:ot;if(ut.eq(ht))return this.isOdd()?ht:ot;if(this.isNegative())return ut.isNegative()?this.neg().mul(ut.neg()):this.neg().mul(ut).neg();if(ut.isNegative())return this.mul(ut.neg()).neg();if(this.lt(rt)&&ut.lt(rt))return $(this.toNumber()*ut.toNumber(),this.unsigned);var _t=this.high>>>16,bt=65535&this.high,vt=this.low>>>16,Tt=65535&this.low,Mt=ut.high>>>16,xt=65535&ut.high,Pt=ut.low>>>16,It=65535&ut.low,Dt=0,Ct=0,Gt=0,Wt=0;return Gt+=(Wt+=Tt*It)>>>16,Ct+=(Gt+=vt*It)>>>16,Gt&=65535,Ct+=(Gt+=Tt*Pt)>>>16,Dt+=(Ct+=bt*It)>>>16,Ct&=65535,Dt+=(Ct+=vt*Pt)>>>16,Ct&=65535,Dt+=(Ct+=Tt*xt)>>>16,Dt+=_t*It+bt*Pt+vt*xt+Tt*Mt,nt((Gt&=65535)<<16|(Wt&=65535),(Dt&=65535)<<16|(Ct&=65535),this.unsigned)},ft.mul=ft.multiply,ft.divide=function(ut){if(s(ut)||(ut=d(ut)),ut.isZero())throw Error("division by zero");var _t,bt,vt;if(e)return this.unsigned||this.high!==-2147483648||ut.low!==-1||ut.high!==-1?nt((this.unsigned?e.div_u:e.div_s)(this.low,this.high,ut.low,ut.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?it:ot;if(this.unsigned){if(ut.unsigned||(ut=ut.toUnsigned()),ut.gt(this))return it;if(ut.gt(this.shru(1)))return lt;vt=it}else{if(this.eq(ht))return ut.eq(at)||ut.eq(ct)?ht:ut.eq(ht)?at:(_t=this.shr(1).div(ut).shl(1)).eq(ot)?ut.isNegative()?at:ct:(bt=this.sub(ut.mul(_t)),vt=_t.add(bt.div(ut)));if(ut.eq(ht))return this.unsigned?it:ot;if(this.isNegative())return ut.isNegative()?this.neg().div(ut.neg()):this.neg().div(ut).neg();if(ut.isNegative())return this.div(ut.neg()).neg();vt=ot}for(bt=this;bt.gte(ut);){_t=Math.max(1,Math.floor(bt.toNumber()/ut.toNumber()));for(var Tt=Math.ceil(Math.log(_t)/Math.LN2),Mt=Tt<=48?1:tt(2,Tt-48),xt=$(_t),Pt=xt.mul(ut);Pt.isNegative()||Pt.gt(bt);)Pt=(xt=$(_t-=Mt,this.unsigned)).mul(ut);xt.isZero()&&(xt=at),vt=vt.add(xt),bt=bt.sub(Pt)}return vt},ft.div=ft.divide,ft.modulo=function(ut){return s(ut)||(ut=d(ut)),e?nt((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,ut.low,ut.high),e.get_high(),this.unsigned):this.sub(this.div(ut).mul(ut))},ft.mod=ft.modulo,ft.rem=ft.modulo,ft.not=function(){return nt(~this.low,~this.high,this.unsigned)},ft.and=function(ut){return s(ut)||(ut=d(ut)),nt(this.low&ut.low,this.high&ut.high,this.unsigned)},ft.or=function(ut){return s(ut)||(ut=d(ut)),nt(this.low|ut.low,this.high|ut.high,this.unsigned)},ft.xor=function(ut){return s(ut)||(ut=d(ut)),nt(this.low^ut.low,this.high^ut.high,this.unsigned)},ft.shiftLeft=function(ut){return s(ut)&&(ut=ut.toInt()),(ut&=63)==0?this:ut<32?nt(this.low<<ut,this.high<<ut|this.low>>>32-ut,this.unsigned):nt(0,this.low<<ut-32,this.unsigned)},ft.shl=ft.shiftLeft,ft.shiftRight=function(ut){return s(ut)&&(ut=ut.toInt()),(ut&=63)==0?this:ut<32?nt(this.low>>>ut|this.high<<32-ut,this.high>>ut,this.unsigned):nt(this.high>>ut-32,this.high>=0?0:-1,this.unsigned)},ft.shr=ft.shiftRight,ft.shiftRightUnsigned=function(ut){if(s(ut)&&(ut=ut.toInt()),(ut&=63)==0)return this;var _t=this.high;return ut<32?nt(this.low>>>ut|_t<<32-ut,_t>>>ut,this.unsigned):nt(ut===32?_t:_t>>>ut-32,0,this.unsigned)},ft.shru=ft.shiftRightUnsigned,ft.shr_u=ft.shiftRightUnsigned,ft.toSigned=function(){return this.unsigned?nt(this.low,this.high,!1):this},ft.toUnsigned=function(){return this.unsigned?this:nt(this.low,this.high,!0)},ft.toBytes=function(ut){return ut?this.toBytesLE():this.toBytesBE()},ft.toBytesLE=function(){var ut=this.high,_t=this.low;return[255&_t,_t>>>8&255,_t>>>16&255,_t>>>24,255&ut,ut>>>8&255,ut>>>16&255,ut>>>24]},ft.toBytesBE=function(){var ut=this.high,_t=this.low;return[ut>>>24,ut>>>16&255,ut>>>8&255,255&ut,_t>>>24,_t>>>16&255,_t>>>8&255,255&_t]},o.fromBytes=function(ut,_t,bt){return bt?o.fromBytesLE(ut,_t):o.fromBytesBE(ut,_t)},o.fromBytesLE=function(ut,_t){return new o(ut[0]|ut[1]<<8|ut[2]<<16|ut[3]<<24,ut[4]|ut[5]<<8|ut[6]<<16|ut[7]<<24,_t)},o.fromBytesBE=function(ut,_t){return new o(ut[4]<<24|ut[5]<<16|ut[6]<<8|ut[7],ut[0]<<24|ut[1]<<16|ut[2]<<8|ut[3],_t)}},1446:(i,e,o)=>{var s,c,h,_=o(2100),$=_.Reader,nt=_.Writer,tt=_.util,et=_.roots.default||(_.roots.default={});et.onnx=((h={}).Version=(s={},(c=Object.create(s))[s[0]="_START_VERSION"]=0,c[s[1]="IR_VERSION_2017_10_10"]=1,c[s[2]="IR_VERSION_2017_10_30"]=2,c[s[3]="IR_VERSION_2017_11_3"]=3,c[s[4]="IR_VERSION_2019_1_22"]=4,c[s[5]="IR_VERSION"]=5,c),h.AttributeProto=function(){function d(a){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.name="",d.prototype.refAttrName="",d.prototype.docString="",d.prototype.type=0,d.prototype.f=0,d.prototype.i=tt.Long?tt.Long.fromBits(0,0,!1):0,d.prototype.s=tt.newBuffer([]),d.prototype.t=null,d.prototype.g=null,d.prototype.floats=tt.emptyArray,d.prototype.ints=tt.emptyArray,d.prototype.strings=tt.emptyArray,d.prototype.tensors=tt.emptyArray,d.prototype.graphs=tt.emptyArray,d.create=function(a){return new d(a)},d.encode=function(a,g){if(g||(g=nt.create()),a.name!=null&&a.hasOwnProperty("name")&&g.uint32(10).string(a.name),a.f!=null&&a.hasOwnProperty("f")&&g.uint32(21).float(a.f),a.i!=null&&a.hasOwnProperty("i")&&g.uint32(24).int64(a.i),a.s!=null&&a.hasOwnProperty("s")&&g.uint32(34).bytes(a.s),a.t!=null&&a.hasOwnProperty("t")&&et.onnx.TensorProto.encode(a.t,g.uint32(42).fork()).ldelim(),a.g!=null&&a.hasOwnProperty("g")&&et.onnx.GraphProto.encode(a.g,g.uint32(50).fork()).ldelim(),a.floats!=null&&a.floats.length){g.uint32(58).fork();for(var j=0;j<a.floats.length;++j)g.float(a.floats[j]);g.ldelim()}if(a.ints!=null&&a.ints.length){for(g.uint32(66).fork(),j=0;j<a.ints.length;++j)g.int64(a.ints[j]);g.ldelim()}if(a.strings!=null&&a.strings.length)for(j=0;j<a.strings.length;++j)g.uint32(74).bytes(a.strings[j]);if(a.tensors!=null&&a.tensors.length)for(j=0;j<a.tensors.length;++j)et.onnx.TensorProto.encode(a.tensors[j],g.uint32(82).fork()).ldelim();if(a.graphs!=null&&a.graphs.length)for(j=0;j<a.graphs.length;++j)et.onnx.GraphProto.encode(a.graphs[j],g.uint32(90).fork()).ldelim();return a.docString!=null&&a.hasOwnProperty("docString")&&g.uint32(106).string(a.docString),a.type!=null&&a.hasOwnProperty("type")&&g.uint32(160).int32(a.type),a.refAttrName!=null&&a.hasOwnProperty("refAttrName")&&g.uint32(170).string(a.refAttrName),g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.AttributeProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.name=a.string();break;case 21:rt.refAttrName=a.string();break;case 13:rt.docString=a.string();break;case 20:rt.type=a.int32();break;case 2:rt.f=a.float();break;case 3:rt.i=a.int64();break;case 4:rt.s=a.bytes();break;case 5:rt.t=et.onnx.TensorProto.decode(a,a.uint32());break;case 6:rt.g=et.onnx.GraphProto.decode(a,a.uint32());break;case 7:if(rt.floats&&rt.floats.length||(rt.floats=[]),(7&ot)==2)for(var it=a.uint32()+a.pos;a.pos<it;)rt.floats.push(a.float());else rt.floats.push(a.float());break;case 8:if(rt.ints&&rt.ints.length||(rt.ints=[]),(7&ot)==2)for(it=a.uint32()+a.pos;a.pos<it;)rt.ints.push(a.int64());else rt.ints.push(a.int64());break;case 9:rt.strings&&rt.strings.length||(rt.strings=[]),rt.strings.push(a.bytes());break;case 10:rt.tensors&&rt.tensors.length||(rt.tensors=[]),rt.tensors.push(et.onnx.TensorProto.decode(a,a.uint32()));break;case 11:rt.graphs&&rt.graphs.length||(rt.graphs=[]),rt.graphs.push(et.onnx.GraphProto.decode(a,a.uint32()));break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.name!=null&&a.hasOwnProperty("name")&&!tt.isString(a.name))return"name: string expected";if(a.refAttrName!=null&&a.hasOwnProperty("refAttrName")&&!tt.isString(a.refAttrName))return"refAttrName: string expected";if(a.docString!=null&&a.hasOwnProperty("docString")&&!tt.isString(a.docString))return"docString: string expected";if(a.type!=null&&a.hasOwnProperty("type"))switch(a.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:}if(a.f!=null&&a.hasOwnProperty("f")&&typeof a.f!="number")return"f: number expected";if(a.i!=null&&a.hasOwnProperty("i")&&!(tt.isInteger(a.i)||a.i&&tt.isInteger(a.i.low)&&tt.isInteger(a.i.high)))return"i: integer|Long expected";if(a.s!=null&&a.hasOwnProperty("s")&&!(a.s&&typeof a.s.length=="number"||tt.isString(a.s)))return"s: buffer expected";if(a.t!=null&&a.hasOwnProperty("t")&&(j=et.onnx.TensorProto.verify(a.t)))return"t."+j;if(a.g!=null&&a.hasOwnProperty("g")&&(j=et.onnx.GraphProto.verify(a.g)))return"g."+j;if(a.floats!=null&&a.hasOwnProperty("floats")){if(!Array.isArray(a.floats))return"floats: array expected";for(var g=0;g<a.floats.length;++g)if(typeof a.floats[g]!="number")return"floats: number[] expected"}if(a.ints!=null&&a.hasOwnProperty("ints")){if(!Array.isArray(a.ints))return"ints: array expected";for(g=0;g<a.ints.length;++g)if(!(tt.isInteger(a.ints[g])||a.ints[g]&&tt.isInteger(a.ints[g].low)&&tt.isInteger(a.ints[g].high)))return"ints: integer|Long[] expected"}if(a.strings!=null&&a.hasOwnProperty("strings")){if(!Array.isArray(a.strings))return"strings: array expected";for(g=0;g<a.strings.length;++g)if(!(a.strings[g]&&typeof a.strings[g].length=="number"||tt.isString(a.strings[g])))return"strings: buffer[] expected"}if(a.tensors!=null&&a.hasOwnProperty("tensors")){if(!Array.isArray(a.tensors))return"tensors: array expected";for(g=0;g<a.tensors.length;++g)if(j=et.onnx.TensorProto.verify(a.tensors[g]))return"tensors."+j}if(a.graphs!=null&&a.hasOwnProperty("graphs")){if(!Array.isArray(a.graphs))return"graphs: array expected";for(g=0;g<a.graphs.length;++g){var j;if(j=et.onnx.GraphProto.verify(a.graphs[g]))return"graphs."+j}}return null},d.fromObject=function(a){if(a instanceof et.onnx.AttributeProto)return a;var g=new et.onnx.AttributeProto;switch(a.name!=null&&(g.name=String(a.name)),a.refAttrName!=null&&(g.refAttrName=String(a.refAttrName)),a.docString!=null&&(g.docString=String(a.docString)),a.type){case"UNDEFINED":case 0:g.type=0;break;case"FLOAT":case 1:g.type=1;break;case"INT":case 2:g.type=2;break;case"STRING":case 3:g.type=3;break;case"TENSOR":case 4:g.type=4;break;case"GRAPH":case 5:g.type=5;break;case"FLOATS":case 6:g.type=6;break;case"INTS":case 7:g.type=7;break;case"STRINGS":case 8:g.type=8;break;case"TENSORS":case 9:g.type=9;break;case"GRAPHS":case 10:g.type=10}if(a.f!=null&&(g.f=Number(a.f)),a.i!=null&&(tt.Long?(g.i=tt.Long.fromValue(a.i)).unsigned=!1:typeof a.i=="string"?g.i=parseInt(a.i,10):typeof a.i=="number"?g.i=a.i:typeof a.i=="object"&&(g.i=new tt.LongBits(a.i.low>>>0,a.i.high>>>0).toNumber())),a.s!=null&&(typeof a.s=="string"?tt.base64.decode(a.s,g.s=tt.newBuffer(tt.base64.length(a.s)),0):a.s.length&&(g.s=a.s)),a.t!=null){if(typeof a.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");g.t=et.onnx.TensorProto.fromObject(a.t)}if(a.g!=null){if(typeof a.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");g.g=et.onnx.GraphProto.fromObject(a.g)}if(a.floats){if(!Array.isArray(a.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");g.floats=[];for(var j=0;j<a.floats.length;++j)g.floats[j]=Number(a.floats[j])}if(a.ints){if(!Array.isArray(a.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(g.ints=[],j=0;j<a.ints.length;++j)tt.Long?(g.ints[j]=tt.Long.fromValue(a.ints[j])).unsigned=!1:typeof a.ints[j]=="string"?g.ints[j]=parseInt(a.ints[j],10):typeof a.ints[j]=="number"?g.ints[j]=a.ints[j]:typeof a.ints[j]=="object"&&(g.ints[j]=new tt.LongBits(a.ints[j].low>>>0,a.ints[j].high>>>0).toNumber())}if(a.strings){if(!Array.isArray(a.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(g.strings=[],j=0;j<a.strings.length;++j)typeof a.strings[j]=="string"?tt.base64.decode(a.strings[j],g.strings[j]=tt.newBuffer(tt.base64.length(a.strings[j])),0):a.strings[j].length&&(g.strings[j]=a.strings[j])}if(a.tensors){if(!Array.isArray(a.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(g.tensors=[],j=0;j<a.tensors.length;++j){if(typeof a.tensors[j]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");g.tensors[j]=et.onnx.TensorProto.fromObject(a.tensors[j])}}if(a.graphs){if(!Array.isArray(a.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(g.graphs=[],j=0;j<a.graphs.length;++j){if(typeof a.graphs[j]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");g.graphs[j]=et.onnx.GraphProto.fromObject(a.graphs[j])}}return g},d.toObject=function(a,g){g||(g={});var j={};if((g.arrays||g.defaults)&&(j.floats=[],j.ints=[],j.strings=[],j.tensors=[],j.graphs=[]),g.defaults){if(j.name="",j.f=0,tt.Long){var rt=new tt.Long(0,0,!1);j.i=g.longs===String?rt.toString():g.longs===Number?rt.toNumber():rt}else j.i=g.longs===String?"0":0;g.bytes===String?j.s="":(j.s=[],g.bytes!==Array&&(j.s=tt.newBuffer(j.s))),j.t=null,j.g=null,j.docString="",j.type=g.enums===String?"UNDEFINED":0,j.refAttrName=""}if(a.name!=null&&a.hasOwnProperty("name")&&(j.name=a.name),a.f!=null&&a.hasOwnProperty("f")&&(j.f=g.json&&!isFinite(a.f)?String(a.f):a.f),a.i!=null&&a.hasOwnProperty("i")&&(typeof a.i=="number"?j.i=g.longs===String?String(a.i):a.i:j.i=g.longs===String?tt.Long.prototype.toString.call(a.i):g.longs===Number?new tt.LongBits(a.i.low>>>0,a.i.high>>>0).toNumber():a.i),a.s!=null&&a.hasOwnProperty("s")&&(j.s=g.bytes===String?tt.base64.encode(a.s,0,a.s.length):g.bytes===Array?Array.prototype.slice.call(a.s):a.s),a.t!=null&&a.hasOwnProperty("t")&&(j.t=et.onnx.TensorProto.toObject(a.t,g)),a.g!=null&&a.hasOwnProperty("g")&&(j.g=et.onnx.GraphProto.toObject(a.g,g)),a.floats&&a.floats.length){j.floats=[];for(var ot=0;ot<a.floats.length;++ot)j.floats[ot]=g.json&&!isFinite(a.floats[ot])?String(a.floats[ot]):a.floats[ot]}if(a.ints&&a.ints.length)for(j.ints=[],ot=0;ot<a.ints.length;++ot)typeof a.ints[ot]=="number"?j.ints[ot]=g.longs===String?String(a.ints[ot]):a.ints[ot]:j.ints[ot]=g.longs===String?tt.Long.prototype.toString.call(a.ints[ot]):g.longs===Number?new tt.LongBits(a.ints[ot].low>>>0,a.ints[ot].high>>>0).toNumber():a.ints[ot];if(a.strings&&a.strings.length)for(j.strings=[],ot=0;ot<a.strings.length;++ot)j.strings[ot]=g.bytes===String?tt.base64.encode(a.strings[ot],0,a.strings[ot].length):g.bytes===Array?Array.prototype.slice.call(a.strings[ot]):a.strings[ot];if(a.tensors&&a.tensors.length)for(j.tensors=[],ot=0;ot<a.tensors.length;++ot)j.tensors[ot]=et.onnx.TensorProto.toObject(a.tensors[ot],g);if(a.graphs&&a.graphs.length)for(j.graphs=[],ot=0;ot<a.graphs.length;++ot)j.graphs[ot]=et.onnx.GraphProto.toObject(a.graphs[ot],g);return a.docString!=null&&a.hasOwnProperty("docString")&&(j.docString=a.docString),a.type!=null&&a.hasOwnProperty("type")&&(j.type=g.enums===String?et.onnx.AttributeProto.AttributeType[a.type]:a.type),a.refAttrName!=null&&a.hasOwnProperty("refAttrName")&&(j.refAttrName=a.refAttrName),j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d.AttributeType=function(){var a={},g=Object.create(a);return g[a[0]="UNDEFINED"]=0,g[a[1]="FLOAT"]=1,g[a[2]="INT"]=2,g[a[3]="STRING"]=3,g[a[4]="TENSOR"]=4,g[a[5]="GRAPH"]=5,g[a[6]="FLOATS"]=6,g[a[7]="INTS"]=7,g[a[8]="STRINGS"]=8,g[a[9]="TENSORS"]=9,g[a[10]="GRAPHS"]=10,g}(),d}(),h.ValueInfoProto=function(){function d(a){if(a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.name="",d.prototype.type=null,d.prototype.docString="",d.create=function(a){return new d(a)},d.encode=function(a,g){return g||(g=nt.create()),a.name!=null&&a.hasOwnProperty("name")&&g.uint32(10).string(a.name),a.type!=null&&a.hasOwnProperty("type")&&et.onnx.TypeProto.encode(a.type,g.uint32(18).fork()).ldelim(),a.docString!=null&&a.hasOwnProperty("docString")&&g.uint32(26).string(a.docString),g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.ValueInfoProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.name=a.string();break;case 2:rt.type=et.onnx.TypeProto.decode(a,a.uint32());break;case 3:rt.docString=a.string();break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.name!=null&&a.hasOwnProperty("name")&&!tt.isString(a.name))return"name: string expected";if(a.type!=null&&a.hasOwnProperty("type")){var g=et.onnx.TypeProto.verify(a.type);if(g)return"type."+g}return a.docString!=null&&a.hasOwnProperty("docString")&&!tt.isString(a.docString)?"docString: string expected":null},d.fromObject=function(a){if(a instanceof et.onnx.ValueInfoProto)return a;var g=new et.onnx.ValueInfoProto;if(a.name!=null&&(g.name=String(a.name)),a.type!=null){if(typeof a.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");g.type=et.onnx.TypeProto.fromObject(a.type)}return a.docString!=null&&(g.docString=String(a.docString)),g},d.toObject=function(a,g){g||(g={});var j={};return g.defaults&&(j.name="",j.type=null,j.docString=""),a.name!=null&&a.hasOwnProperty("name")&&(j.name=a.name),a.type!=null&&a.hasOwnProperty("type")&&(j.type=et.onnx.TypeProto.toObject(a.type,g)),a.docString!=null&&a.hasOwnProperty("docString")&&(j.docString=a.docString),j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d}(),h.NodeProto=function(){function d(a){if(this.input=[],this.output=[],this.attribute=[],a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.input=tt.emptyArray,d.prototype.output=tt.emptyArray,d.prototype.name="",d.prototype.opType="",d.prototype.domain="",d.prototype.attribute=tt.emptyArray,d.prototype.docString="",d.create=function(a){return new d(a)},d.encode=function(a,g){if(g||(g=nt.create()),a.input!=null&&a.input.length)for(var j=0;j<a.input.length;++j)g.uint32(10).string(a.input[j]);if(a.output!=null&&a.output.length)for(j=0;j<a.output.length;++j)g.uint32(18).string(a.output[j]);if(a.name!=null&&a.hasOwnProperty("name")&&g.uint32(26).string(a.name),a.opType!=null&&a.hasOwnProperty("opType")&&g.uint32(34).string(a.opType),a.attribute!=null&&a.attribute.length)for(j=0;j<a.attribute.length;++j)et.onnx.AttributeProto.encode(a.attribute[j],g.uint32(42).fork()).ldelim();return a.docString!=null&&a.hasOwnProperty("docString")&&g.uint32(50).string(a.docString),a.domain!=null&&a.hasOwnProperty("domain")&&g.uint32(58).string(a.domain),g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.NodeProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.input&&rt.input.length||(rt.input=[]),rt.input.push(a.string());break;case 2:rt.output&&rt.output.length||(rt.output=[]),rt.output.push(a.string());break;case 3:rt.name=a.string();break;case 4:rt.opType=a.string();break;case 7:rt.domain=a.string();break;case 5:rt.attribute&&rt.attribute.length||(rt.attribute=[]),rt.attribute.push(et.onnx.AttributeProto.decode(a,a.uint32()));break;case 6:rt.docString=a.string();break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.input!=null&&a.hasOwnProperty("input")){if(!Array.isArray(a.input))return"input: array expected";for(var g=0;g<a.input.length;++g)if(!tt.isString(a.input[g]))return"input: string[] expected"}if(a.output!=null&&a.hasOwnProperty("output")){if(!Array.isArray(a.output))return"output: array expected";for(g=0;g<a.output.length;++g)if(!tt.isString(a.output[g]))return"output: string[] expected"}if(a.name!=null&&a.hasOwnProperty("name")&&!tt.isString(a.name))return"name: string expected";if(a.opType!=null&&a.hasOwnProperty("opType")&&!tt.isString(a.opType))return"opType: string expected";if(a.domain!=null&&a.hasOwnProperty("domain")&&!tt.isString(a.domain))return"domain: string expected";if(a.attribute!=null&&a.hasOwnProperty("attribute")){if(!Array.isArray(a.attribute))return"attribute: array expected";for(g=0;g<a.attribute.length;++g){var j=et.onnx.AttributeProto.verify(a.attribute[g]);if(j)return"attribute."+j}}return a.docString!=null&&a.hasOwnProperty("docString")&&!tt.isString(a.docString)?"docString: string expected":null},d.fromObject=function(a){if(a instanceof et.onnx.NodeProto)return a;var g=new et.onnx.NodeProto;if(a.input){if(!Array.isArray(a.input))throw TypeError(".onnx.NodeProto.input: array expected");g.input=[];for(var j=0;j<a.input.length;++j)g.input[j]=String(a.input[j])}if(a.output){if(!Array.isArray(a.output))throw TypeError(".onnx.NodeProto.output: array expected");for(g.output=[],j=0;j<a.output.length;++j)g.output[j]=String(a.output[j])}if(a.name!=null&&(g.name=String(a.name)),a.opType!=null&&(g.opType=String(a.opType)),a.domain!=null&&(g.domain=String(a.domain)),a.attribute){if(!Array.isArray(a.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(g.attribute=[],j=0;j<a.attribute.length;++j){if(typeof a.attribute[j]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");g.attribute[j]=et.onnx.AttributeProto.fromObject(a.attribute[j])}}return a.docString!=null&&(g.docString=String(a.docString)),g},d.toObject=function(a,g){g||(g={});var j={};if((g.arrays||g.defaults)&&(j.input=[],j.output=[],j.attribute=[]),g.defaults&&(j.name="",j.opType="",j.docString="",j.domain=""),a.input&&a.input.length){j.input=[];for(var rt=0;rt<a.input.length;++rt)j.input[rt]=a.input[rt]}if(a.output&&a.output.length)for(j.output=[],rt=0;rt<a.output.length;++rt)j.output[rt]=a.output[rt];if(a.name!=null&&a.hasOwnProperty("name")&&(j.name=a.name),a.opType!=null&&a.hasOwnProperty("opType")&&(j.opType=a.opType),a.attribute&&a.attribute.length)for(j.attribute=[],rt=0;rt<a.attribute.length;++rt)j.attribute[rt]=et.onnx.AttributeProto.toObject(a.attribute[rt],g);return a.docString!=null&&a.hasOwnProperty("docString")&&(j.docString=a.docString),a.domain!=null&&a.hasOwnProperty("domain")&&(j.domain=a.domain),j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d}(),h.ModelProto=function(){function d(a){if(this.opsetImport=[],this.metadataProps=[],a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.irVersion=tt.Long?tt.Long.fromBits(0,0,!1):0,d.prototype.opsetImport=tt.emptyArray,d.prototype.producerName="",d.prototype.producerVersion="",d.prototype.domain="",d.prototype.modelVersion=tt.Long?tt.Long.fromBits(0,0,!1):0,d.prototype.docString="",d.prototype.graph=null,d.prototype.metadataProps=tt.emptyArray,d.create=function(a){return new d(a)},d.encode=function(a,g){if(g||(g=nt.create()),a.irVersion!=null&&a.hasOwnProperty("irVersion")&&g.uint32(8).int64(a.irVersion),a.producerName!=null&&a.hasOwnProperty("producerName")&&g.uint32(18).string(a.producerName),a.producerVersion!=null&&a.hasOwnProperty("producerVersion")&&g.uint32(26).string(a.producerVersion),a.domain!=null&&a.hasOwnProperty("domain")&&g.uint32(34).string(a.domain),a.modelVersion!=null&&a.hasOwnProperty("modelVersion")&&g.uint32(40).int64(a.modelVersion),a.docString!=null&&a.hasOwnProperty("docString")&&g.uint32(50).string(a.docString),a.graph!=null&&a.hasOwnProperty("graph")&&et.onnx.GraphProto.encode(a.graph,g.uint32(58).fork()).ldelim(),a.opsetImport!=null&&a.opsetImport.length)for(var j=0;j<a.opsetImport.length;++j)et.onnx.OperatorSetIdProto.encode(a.opsetImport[j],g.uint32(66).fork()).ldelim();if(a.metadataProps!=null&&a.metadataProps.length)for(j=0;j<a.metadataProps.length;++j)et.onnx.StringStringEntryProto.encode(a.metadataProps[j],g.uint32(114).fork()).ldelim();return g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.ModelProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.irVersion=a.int64();break;case 8:rt.opsetImport&&rt.opsetImport.length||(rt.opsetImport=[]),rt.opsetImport.push(et.onnx.OperatorSetIdProto.decode(a,a.uint32()));break;case 2:rt.producerName=a.string();break;case 3:rt.producerVersion=a.string();break;case 4:rt.domain=a.string();break;case 5:rt.modelVersion=a.int64();break;case 6:rt.docString=a.string();break;case 7:rt.graph=et.onnx.GraphProto.decode(a,a.uint32());break;case 14:rt.metadataProps&&rt.metadataProps.length||(rt.metadataProps=[]),rt.metadataProps.push(et.onnx.StringStringEntryProto.decode(a,a.uint32()));break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.irVersion!=null&&a.hasOwnProperty("irVersion")&&!(tt.isInteger(a.irVersion)||a.irVersion&&tt.isInteger(a.irVersion.low)&&tt.isInteger(a.irVersion.high)))return"irVersion: integer|Long expected";if(a.opsetImport!=null&&a.hasOwnProperty("opsetImport")){if(!Array.isArray(a.opsetImport))return"opsetImport: array expected";for(var g=0;g<a.opsetImport.length;++g)if(j=et.onnx.OperatorSetIdProto.verify(a.opsetImport[g]))return"opsetImport."+j}if(a.producerName!=null&&a.hasOwnProperty("producerName")&&!tt.isString(a.producerName))return"producerName: string expected";if(a.producerVersion!=null&&a.hasOwnProperty("producerVersion")&&!tt.isString(a.producerVersion))return"producerVersion: string expected";if(a.domain!=null&&a.hasOwnProperty("domain")&&!tt.isString(a.domain))return"domain: string expected";if(a.modelVersion!=null&&a.hasOwnProperty("modelVersion")&&!(tt.isInteger(a.modelVersion)||a.modelVersion&&tt.isInteger(a.modelVersion.low)&&tt.isInteger(a.modelVersion.high)))return"modelVersion: integer|Long expected";if(a.docString!=null&&a.hasOwnProperty("docString")&&!tt.isString(a.docString))return"docString: string expected";if(a.graph!=null&&a.hasOwnProperty("graph")&&(j=et.onnx.GraphProto.verify(a.graph)))return"graph."+j;if(a.metadataProps!=null&&a.hasOwnProperty("metadataProps")){if(!Array.isArray(a.metadataProps))return"metadataProps: array expected";for(g=0;g<a.metadataProps.length;++g){var j;if(j=et.onnx.StringStringEntryProto.verify(a.metadataProps[g]))return"metadataProps."+j}}return null},d.fromObject=function(a){if(a instanceof et.onnx.ModelProto)return a;var g=new et.onnx.ModelProto;if(a.irVersion!=null&&(tt.Long?(g.irVersion=tt.Long.fromValue(a.irVersion)).unsigned=!1:typeof a.irVersion=="string"?g.irVersion=parseInt(a.irVersion,10):typeof a.irVersion=="number"?g.irVersion=a.irVersion:typeof a.irVersion=="object"&&(g.irVersion=new tt.LongBits(a.irVersion.low>>>0,a.irVersion.high>>>0).toNumber())),a.opsetImport){if(!Array.isArray(a.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");g.opsetImport=[];for(var j=0;j<a.opsetImport.length;++j){if(typeof a.opsetImport[j]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");g.opsetImport[j]=et.onnx.OperatorSetIdProto.fromObject(a.opsetImport[j])}}if(a.producerName!=null&&(g.producerName=String(a.producerName)),a.producerVersion!=null&&(g.producerVersion=String(a.producerVersion)),a.domain!=null&&(g.domain=String(a.domain)),a.modelVersion!=null&&(tt.Long?(g.modelVersion=tt.Long.fromValue(a.modelVersion)).unsigned=!1:typeof a.modelVersion=="string"?g.modelVersion=parseInt(a.modelVersion,10):typeof a.modelVersion=="number"?g.modelVersion=a.modelVersion:typeof a.modelVersion=="object"&&(g.modelVersion=new tt.LongBits(a.modelVersion.low>>>0,a.modelVersion.high>>>0).toNumber())),a.docString!=null&&(g.docString=String(a.docString)),a.graph!=null){if(typeof a.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");g.graph=et.onnx.GraphProto.fromObject(a.graph)}if(a.metadataProps){if(!Array.isArray(a.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(g.metadataProps=[],j=0;j<a.metadataProps.length;++j){if(typeof a.metadataProps[j]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");g.metadataProps[j]=et.onnx.StringStringEntryProto.fromObject(a.metadataProps[j])}}return g},d.toObject=function(a,g){g||(g={});var j={};if((g.arrays||g.defaults)&&(j.opsetImport=[],j.metadataProps=[]),g.defaults){if(tt.Long){var rt=new tt.Long(0,0,!1);j.irVersion=g.longs===String?rt.toString():g.longs===Number?rt.toNumber():rt}else j.irVersion=g.longs===String?"0":0;j.producerName="",j.producerVersion="",j.domain="",tt.Long?(rt=new tt.Long(0,0,!1),j.modelVersion=g.longs===String?rt.toString():g.longs===Number?rt.toNumber():rt):j.modelVersion=g.longs===String?"0":0,j.docString="",j.graph=null}if(a.irVersion!=null&&a.hasOwnProperty("irVersion")&&(typeof a.irVersion=="number"?j.irVersion=g.longs===String?String(a.irVersion):a.irVersion:j.irVersion=g.longs===String?tt.Long.prototype.toString.call(a.irVersion):g.longs===Number?new tt.LongBits(a.irVersion.low>>>0,a.irVersion.high>>>0).toNumber():a.irVersion),a.producerName!=null&&a.hasOwnProperty("producerName")&&(j.producerName=a.producerName),a.producerVersion!=null&&a.hasOwnProperty("producerVersion")&&(j.producerVersion=a.producerVersion),a.domain!=null&&a.hasOwnProperty("domain")&&(j.domain=a.domain),a.modelVersion!=null&&a.hasOwnProperty("modelVersion")&&(typeof a.modelVersion=="number"?j.modelVersion=g.longs===String?String(a.modelVersion):a.modelVersion:j.modelVersion=g.longs===String?tt.Long.prototype.toString.call(a.modelVersion):g.longs===Number?new tt.LongBits(a.modelVersion.low>>>0,a.modelVersion.high>>>0).toNumber():a.modelVersion),a.docString!=null&&a.hasOwnProperty("docString")&&(j.docString=a.docString),a.graph!=null&&a.hasOwnProperty("graph")&&(j.graph=et.onnx.GraphProto.toObject(a.graph,g)),a.opsetImport&&a.opsetImport.length){j.opsetImport=[];for(var ot=0;ot<a.opsetImport.length;++ot)j.opsetImport[ot]=et.onnx.OperatorSetIdProto.toObject(a.opsetImport[ot],g)}if(a.metadataProps&&a.metadataProps.length)for(j.metadataProps=[],ot=0;ot<a.metadataProps.length;++ot)j.metadataProps[ot]=et.onnx.StringStringEntryProto.toObject(a.metadataProps[ot],g);return j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d}(),h.StringStringEntryProto=function(){function d(a){if(a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.key="",d.prototype.value="",d.create=function(a){return new d(a)},d.encode=function(a,g){return g||(g=nt.create()),a.key!=null&&a.hasOwnProperty("key")&&g.uint32(10).string(a.key),a.value!=null&&a.hasOwnProperty("value")&&g.uint32(18).string(a.value),g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.StringStringEntryProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.key=a.string();break;case 2:rt.value=a.string();break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){return typeof a!="object"||a===null?"object expected":a.key!=null&&a.hasOwnProperty("key")&&!tt.isString(a.key)?"key: string expected":a.value!=null&&a.hasOwnProperty("value")&&!tt.isString(a.value)?"value: string expected":null},d.fromObject=function(a){if(a instanceof et.onnx.StringStringEntryProto)return a;var g=new et.onnx.StringStringEntryProto;return a.key!=null&&(g.key=String(a.key)),a.value!=null&&(g.value=String(a.value)),g},d.toObject=function(a,g){g||(g={});var j={};return g.defaults&&(j.key="",j.value=""),a.key!=null&&a.hasOwnProperty("key")&&(j.key=a.key),a.value!=null&&a.hasOwnProperty("value")&&(j.value=a.value),j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d}(),h.TensorAnnotation=function(){function d(a){if(this.quantParameterTensorNames=[],a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.tensorName="",d.prototype.quantParameterTensorNames=tt.emptyArray,d.create=function(a){return new d(a)},d.encode=function(a,g){if(g||(g=nt.create()),a.tensorName!=null&&a.hasOwnProperty("tensorName")&&g.uint32(10).string(a.tensorName),a.quantParameterTensorNames!=null&&a.quantParameterTensorNames.length)for(var j=0;j<a.quantParameterTensorNames.length;++j)et.onnx.StringStringEntryProto.encode(a.quantParameterTensorNames[j],g.uint32(18).fork()).ldelim();return g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.TensorAnnotation;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.tensorName=a.string();break;case 2:rt.quantParameterTensorNames&&rt.quantParameterTensorNames.length||(rt.quantParameterTensorNames=[]),rt.quantParameterTensorNames.push(et.onnx.StringStringEntryProto.decode(a,a.uint32()));break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.tensorName!=null&&a.hasOwnProperty("tensorName")&&!tt.isString(a.tensorName))return"tensorName: string expected";if(a.quantParameterTensorNames!=null&&a.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(a.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var g=0;g<a.quantParameterTensorNames.length;++g){var j=et.onnx.StringStringEntryProto.verify(a.quantParameterTensorNames[g]);if(j)return"quantParameterTensorNames."+j}}return null},d.fromObject=function(a){if(a instanceof et.onnx.TensorAnnotation)return a;var g=new et.onnx.TensorAnnotation;if(a.tensorName!=null&&(g.tensorName=String(a.tensorName)),a.quantParameterTensorNames){if(!Array.isArray(a.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");g.quantParameterTensorNames=[];for(var j=0;j<a.quantParameterTensorNames.length;++j){if(typeof a.quantParameterTensorNames[j]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");g.quantParameterTensorNames[j]=et.onnx.StringStringEntryProto.fromObject(a.quantParameterTensorNames[j])}}return g},d.toObject=function(a,g){g||(g={});var j={};if((g.arrays||g.defaults)&&(j.quantParameterTensorNames=[]),g.defaults&&(j.tensorName=""),a.tensorName!=null&&a.hasOwnProperty("tensorName")&&(j.tensorName=a.tensorName),a.quantParameterTensorNames&&a.quantParameterTensorNames.length){j.quantParameterTensorNames=[];for(var rt=0;rt<a.quantParameterTensorNames.length;++rt)j.quantParameterTensorNames[rt]=et.onnx.StringStringEntryProto.toObject(a.quantParameterTensorNames[rt],g)}return j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d}(),h.GraphProto=function(){function d(a){if(this.node=[],this.initializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.node=tt.emptyArray,d.prototype.name="",d.prototype.initializer=tt.emptyArray,d.prototype.docString="",d.prototype.input=tt.emptyArray,d.prototype.output=tt.emptyArray,d.prototype.valueInfo=tt.emptyArray,d.prototype.quantizationAnnotation=tt.emptyArray,d.create=function(a){return new d(a)},d.encode=function(a,g){if(g||(g=nt.create()),a.node!=null&&a.node.length)for(var j=0;j<a.node.length;++j)et.onnx.NodeProto.encode(a.node[j],g.uint32(10).fork()).ldelim();if(a.name!=null&&a.hasOwnProperty("name")&&g.uint32(18).string(a.name),a.initializer!=null&&a.initializer.length)for(j=0;j<a.initializer.length;++j)et.onnx.TensorProto.encode(a.initializer[j],g.uint32(42).fork()).ldelim();if(a.docString!=null&&a.hasOwnProperty("docString")&&g.uint32(82).string(a.docString),a.input!=null&&a.input.length)for(j=0;j<a.input.length;++j)et.onnx.ValueInfoProto.encode(a.input[j],g.uint32(90).fork()).ldelim();if(a.output!=null&&a.output.length)for(j=0;j<a.output.length;++j)et.onnx.ValueInfoProto.encode(a.output[j],g.uint32(98).fork()).ldelim();if(a.valueInfo!=null&&a.valueInfo.length)for(j=0;j<a.valueInfo.length;++j)et.onnx.ValueInfoProto.encode(a.valueInfo[j],g.uint32(106).fork()).ldelim();if(a.quantizationAnnotation!=null&&a.quantizationAnnotation.length)for(j=0;j<a.quantizationAnnotation.length;++j)et.onnx.TensorAnnotation.encode(a.quantizationAnnotation[j],g.uint32(114).fork()).ldelim();return g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.GraphProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.node&&rt.node.length||(rt.node=[]),rt.node.push(et.onnx.NodeProto.decode(a,a.uint32()));break;case 2:rt.name=a.string();break;case 5:rt.initializer&&rt.initializer.length||(rt.initializer=[]),rt.initializer.push(et.onnx.TensorProto.decode(a,a.uint32()));break;case 10:rt.docString=a.string();break;case 11:rt.input&&rt.input.length||(rt.input=[]),rt.input.push(et.onnx.ValueInfoProto.decode(a,a.uint32()));break;case 12:rt.output&&rt.output.length||(rt.output=[]),rt.output.push(et.onnx.ValueInfoProto.decode(a,a.uint32()));break;case 13:rt.valueInfo&&rt.valueInfo.length||(rt.valueInfo=[]),rt.valueInfo.push(et.onnx.ValueInfoProto.decode(a,a.uint32()));break;case 14:rt.quantizationAnnotation&&rt.quantizationAnnotation.length||(rt.quantizationAnnotation=[]),rt.quantizationAnnotation.push(et.onnx.TensorAnnotation.decode(a,a.uint32()));break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.node!=null&&a.hasOwnProperty("node")){if(!Array.isArray(a.node))return"node: array expected";for(var g=0;g<a.node.length;++g)if(j=et.onnx.NodeProto.verify(a.node[g]))return"node."+j}if(a.name!=null&&a.hasOwnProperty("name")&&!tt.isString(a.name))return"name: string expected";if(a.initializer!=null&&a.hasOwnProperty("initializer")){if(!Array.isArray(a.initializer))return"initializer: array expected";for(g=0;g<a.initializer.length;++g)if(j=et.onnx.TensorProto.verify(a.initializer[g]))return"initializer."+j}if(a.docString!=null&&a.hasOwnProperty("docString")&&!tt.isString(a.docString))return"docString: string expected";if(a.input!=null&&a.hasOwnProperty("input")){if(!Array.isArray(a.input))return"input: array expected";for(g=0;g<a.input.length;++g)if(j=et.onnx.ValueInfoProto.verify(a.input[g]))return"input."+j}if(a.output!=null&&a.hasOwnProperty("output")){if(!Array.isArray(a.output))return"output: array expected";for(g=0;g<a.output.length;++g)if(j=et.onnx.ValueInfoProto.verify(a.output[g]))return"output."+j}if(a.valueInfo!=null&&a.hasOwnProperty("valueInfo")){if(!Array.isArray(a.valueInfo))return"valueInfo: array expected";for(g=0;g<a.valueInfo.length;++g)if(j=et.onnx.ValueInfoProto.verify(a.valueInfo[g]))return"valueInfo."+j}if(a.quantizationAnnotation!=null&&a.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(a.quantizationAnnotation))return"quantizationAnnotation: array expected";for(g=0;g<a.quantizationAnnotation.length;++g){var j;if(j=et.onnx.TensorAnnotation.verify(a.quantizationAnnotation[g]))return"quantizationAnnotation."+j}}return null},d.fromObject=function(a){if(a instanceof et.onnx.GraphProto)return a;var g=new et.onnx.GraphProto;if(a.node){if(!Array.isArray(a.node))throw TypeError(".onnx.GraphProto.node: array expected");g.node=[];for(var j=0;j<a.node.length;++j){if(typeof a.node[j]!="object")throw TypeError(".onnx.GraphProto.node: object expected");g.node[j]=et.onnx.NodeProto.fromObject(a.node[j])}}if(a.name!=null&&(g.name=String(a.name)),a.initializer){if(!Array.isArray(a.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(g.initializer=[],j=0;j<a.initializer.length;++j){if(typeof a.initializer[j]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");g.initializer[j]=et.onnx.TensorProto.fromObject(a.initializer[j])}}if(a.docString!=null&&(g.docString=String(a.docString)),a.input){if(!Array.isArray(a.input))throw TypeError(".onnx.GraphProto.input: array expected");for(g.input=[],j=0;j<a.input.length;++j){if(typeof a.input[j]!="object")throw TypeError(".onnx.GraphProto.input: object expected");g.input[j]=et.onnx.ValueInfoProto.fromObject(a.input[j])}}if(a.output){if(!Array.isArray(a.output))throw TypeError(".onnx.GraphProto.output: array expected");for(g.output=[],j=0;j<a.output.length;++j){if(typeof a.output[j]!="object")throw TypeError(".onnx.GraphProto.output: object expected");g.output[j]=et.onnx.ValueInfoProto.fromObject(a.output[j])}}if(a.valueInfo){if(!Array.isArray(a.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(g.valueInfo=[],j=0;j<a.valueInfo.length;++j){if(typeof a.valueInfo[j]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");g.valueInfo[j]=et.onnx.ValueInfoProto.fromObject(a.valueInfo[j])}}if(a.quantizationAnnotation){if(!Array.isArray(a.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(g.quantizationAnnotation=[],j=0;j<a.quantizationAnnotation.length;++j){if(typeof a.quantizationAnnotation[j]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");g.quantizationAnnotation[j]=et.onnx.TensorAnnotation.fromObject(a.quantizationAnnotation[j])}}return g},d.toObject=function(a,g){g||(g={});var j={};if((g.arrays||g.defaults)&&(j.node=[],j.initializer=[],j.input=[],j.output=[],j.valueInfo=[],j.quantizationAnnotation=[]),g.defaults&&(j.name="",j.docString=""),a.node&&a.node.length){j.node=[];for(var rt=0;rt<a.node.length;++rt)j.node[rt]=et.onnx.NodeProto.toObject(a.node[rt],g)}if(a.name!=null&&a.hasOwnProperty("name")&&(j.name=a.name),a.initializer&&a.initializer.length)for(j.initializer=[],rt=0;rt<a.initializer.length;++rt)j.initializer[rt]=et.onnx.TensorProto.toObject(a.initializer[rt],g);if(a.docString!=null&&a.hasOwnProperty("docString")&&(j.docString=a.docString),a.input&&a.input.length)for(j.input=[],rt=0;rt<a.input.length;++rt)j.input[rt]=et.onnx.ValueInfoProto.toObject(a.input[rt],g);if(a.output&&a.output.length)for(j.output=[],rt=0;rt<a.output.length;++rt)j.output[rt]=et.onnx.ValueInfoProto.toObject(a.output[rt],g);if(a.valueInfo&&a.valueInfo.length)for(j.valueInfo=[],rt=0;rt<a.valueInfo.length;++rt)j.valueInfo[rt]=et.onnx.ValueInfoProto.toObject(a.valueInfo[rt],g);if(a.quantizationAnnotation&&a.quantizationAnnotation.length)for(j.quantizationAnnotation=[],rt=0;rt<a.quantizationAnnotation.length;++rt)j.quantizationAnnotation[rt]=et.onnx.TensorAnnotation.toObject(a.quantizationAnnotation[rt],g);return j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d}(),h.TensorProto=function(){function d(a){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.dims=tt.emptyArray,d.prototype.dataType=0,d.prototype.segment=null,d.prototype.floatData=tt.emptyArray,d.prototype.int32Data=tt.emptyArray,d.prototype.stringData=tt.emptyArray,d.prototype.int64Data=tt.emptyArray,d.prototype.name="",d.prototype.docString="",d.prototype.rawData=tt.newBuffer([]),d.prototype.externalData=tt.emptyArray,d.prototype.dataLocation=0,d.prototype.doubleData=tt.emptyArray,d.prototype.uint64Data=tt.emptyArray,d.create=function(a){return new d(a)},d.encode=function(a,g){if(g||(g=nt.create()),a.dims!=null&&a.dims.length){g.uint32(10).fork();for(var j=0;j<a.dims.length;++j)g.int64(a.dims[j]);g.ldelim()}if(a.dataType!=null&&a.hasOwnProperty("dataType")&&g.uint32(16).int32(a.dataType),a.segment!=null&&a.hasOwnProperty("segment")&&et.onnx.TensorProto.Segment.encode(a.segment,g.uint32(26).fork()).ldelim(),a.floatData!=null&&a.floatData.length){for(g.uint32(34).fork(),j=0;j<a.floatData.length;++j)g.float(a.floatData[j]);g.ldelim()}if(a.int32Data!=null&&a.int32Data.length){for(g.uint32(42).fork(),j=0;j<a.int32Data.length;++j)g.int32(a.int32Data[j]);g.ldelim()}if(a.stringData!=null&&a.stringData.length)for(j=0;j<a.stringData.length;++j)g.uint32(50).bytes(a.stringData[j]);if(a.int64Data!=null&&a.int64Data.length){for(g.uint32(58).fork(),j=0;j<a.int64Data.length;++j)g.int64(a.int64Data[j]);g.ldelim()}if(a.name!=null&&a.hasOwnProperty("name")&&g.uint32(66).string(a.name),a.rawData!=null&&a.hasOwnProperty("rawData")&&g.uint32(74).bytes(a.rawData),a.doubleData!=null&&a.doubleData.length){for(g.uint32(82).fork(),j=0;j<a.doubleData.length;++j)g.double(a.doubleData[j]);g.ldelim()}if(a.uint64Data!=null&&a.uint64Data.length){for(g.uint32(90).fork(),j=0;j<a.uint64Data.length;++j)g.uint64(a.uint64Data[j]);g.ldelim()}if(a.docString!=null&&a.hasOwnProperty("docString")&&g.uint32(98).string(a.docString),a.externalData!=null&&a.externalData.length)for(j=0;j<a.externalData.length;++j)et.onnx.StringStringEntryProto.encode(a.externalData[j],g.uint32(106).fork()).ldelim();return a.dataLocation!=null&&a.hasOwnProperty("dataLocation")&&g.uint32(112).int32(a.dataLocation),g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.TensorProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:if(rt.dims&&rt.dims.length||(rt.dims=[]),(7&ot)==2)for(var it=a.uint32()+a.pos;a.pos<it;)rt.dims.push(a.int64());else rt.dims.push(a.int64());break;case 2:rt.dataType=a.int32();break;case 3:rt.segment=et.onnx.TensorProto.Segment.decode(a,a.uint32());break;case 4:if(rt.floatData&&rt.floatData.length||(rt.floatData=[]),(7&ot)==2)for(it=a.uint32()+a.pos;a.pos<it;)rt.floatData.push(a.float());else rt.floatData.push(a.float());break;case 5:if(rt.int32Data&&rt.int32Data.length||(rt.int32Data=[]),(7&ot)==2)for(it=a.uint32()+a.pos;a.pos<it;)rt.int32Data.push(a.int32());else rt.int32Data.push(a.int32());break;case 6:rt.stringData&&rt.stringData.length||(rt.stringData=[]),rt.stringData.push(a.bytes());break;case 7:if(rt.int64Data&&rt.int64Data.length||(rt.int64Data=[]),(7&ot)==2)for(it=a.uint32()+a.pos;a.pos<it;)rt.int64Data.push(a.int64());else rt.int64Data.push(a.int64());break;case 8:rt.name=a.string();break;case 12:rt.docString=a.string();break;case 9:rt.rawData=a.bytes();break;case 13:rt.externalData&&rt.externalData.length||(rt.externalData=[]),rt.externalData.push(et.onnx.StringStringEntryProto.decode(a,a.uint32()));break;case 14:rt.dataLocation=a.int32();break;case 10:if(rt.doubleData&&rt.doubleData.length||(rt.doubleData=[]),(7&ot)==2)for(it=a.uint32()+a.pos;a.pos<it;)rt.doubleData.push(a.double());else rt.doubleData.push(a.double());break;case 11:if(rt.uint64Data&&rt.uint64Data.length||(rt.uint64Data=[]),(7&ot)==2)for(it=a.uint32()+a.pos;a.pos<it;)rt.uint64Data.push(a.uint64());else rt.uint64Data.push(a.uint64());break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.dims!=null&&a.hasOwnProperty("dims")){if(!Array.isArray(a.dims))return"dims: array expected";for(var g=0;g<a.dims.length;++g)if(!(tt.isInteger(a.dims[g])||a.dims[g]&&tt.isInteger(a.dims[g].low)&&tt.isInteger(a.dims[g].high)))return"dims: integer|Long[] expected"}if(a.dataType!=null&&a.hasOwnProperty("dataType")&&!tt.isInteger(a.dataType))return"dataType: integer expected";if(a.segment!=null&&a.hasOwnProperty("segment")&&(j=et.onnx.TensorProto.Segment.verify(a.segment)))return"segment."+j;if(a.floatData!=null&&a.hasOwnProperty("floatData")){if(!Array.isArray(a.floatData))return"floatData: array expected";for(g=0;g<a.floatData.length;++g)if(typeof a.floatData[g]!="number")return"floatData: number[] expected"}if(a.int32Data!=null&&a.hasOwnProperty("int32Data")){if(!Array.isArray(a.int32Data))return"int32Data: array expected";for(g=0;g<a.int32Data.length;++g)if(!tt.isInteger(a.int32Data[g]))return"int32Data: integer[] expected"}if(a.stringData!=null&&a.hasOwnProperty("stringData")){if(!Array.isArray(a.stringData))return"stringData: array expected";for(g=0;g<a.stringData.length;++g)if(!(a.stringData[g]&&typeof a.stringData[g].length=="number"||tt.isString(a.stringData[g])))return"stringData: buffer[] expected"}if(a.int64Data!=null&&a.hasOwnProperty("int64Data")){if(!Array.isArray(a.int64Data))return"int64Data: array expected";for(g=0;g<a.int64Data.length;++g)if(!(tt.isInteger(a.int64Data[g])||a.int64Data[g]&&tt.isInteger(a.int64Data[g].low)&&tt.isInteger(a.int64Data[g].high)))return"int64Data: integer|Long[] expected"}if(a.name!=null&&a.hasOwnProperty("name")&&!tt.isString(a.name))return"name: string expected";if(a.docString!=null&&a.hasOwnProperty("docString")&&!tt.isString(a.docString))return"docString: string expected";if(a.rawData!=null&&a.hasOwnProperty("rawData")&&!(a.rawData&&typeof a.rawData.length=="number"||tt.isString(a.rawData)))return"rawData: buffer expected";if(a.externalData!=null&&a.hasOwnProperty("externalData")){if(!Array.isArray(a.externalData))return"externalData: array expected";for(g=0;g<a.externalData.length;++g){var j;if(j=et.onnx.StringStringEntryProto.verify(a.externalData[g]))return"externalData."+j}}if(a.dataLocation!=null&&a.hasOwnProperty("dataLocation"))switch(a.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(a.doubleData!=null&&a.hasOwnProperty("doubleData")){if(!Array.isArray(a.doubleData))return"doubleData: array expected";for(g=0;g<a.doubleData.length;++g)if(typeof a.doubleData[g]!="number")return"doubleData: number[] expected"}if(a.uint64Data!=null&&a.hasOwnProperty("uint64Data")){if(!Array.isArray(a.uint64Data))return"uint64Data: array expected";for(g=0;g<a.uint64Data.length;++g)if(!(tt.isInteger(a.uint64Data[g])||a.uint64Data[g]&&tt.isInteger(a.uint64Data[g].low)&&tt.isInteger(a.uint64Data[g].high)))return"uint64Data: integer|Long[] expected"}return null},d.fromObject=function(a){if(a instanceof et.onnx.TensorProto)return a;var g=new et.onnx.TensorProto;if(a.dims){if(!Array.isArray(a.dims))throw TypeError(".onnx.TensorProto.dims: array expected");g.dims=[];for(var j=0;j<a.dims.length;++j)tt.Long?(g.dims[j]=tt.Long.fromValue(a.dims[j])).unsigned=!1:typeof a.dims[j]=="string"?g.dims[j]=parseInt(a.dims[j],10):typeof a.dims[j]=="number"?g.dims[j]=a.dims[j]:typeof a.dims[j]=="object"&&(g.dims[j]=new tt.LongBits(a.dims[j].low>>>0,a.dims[j].high>>>0).toNumber())}if(a.dataType!=null&&(g.dataType=0|a.dataType),a.segment!=null){if(typeof a.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");g.segment=et.onnx.TensorProto.Segment.fromObject(a.segment)}if(a.floatData){if(!Array.isArray(a.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(g.floatData=[],j=0;j<a.floatData.length;++j)g.floatData[j]=Number(a.floatData[j])}if(a.int32Data){if(!Array.isArray(a.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(g.int32Data=[],j=0;j<a.int32Data.length;++j)g.int32Data[j]=0|a.int32Data[j]}if(a.stringData){if(!Array.isArray(a.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(g.stringData=[],j=0;j<a.stringData.length;++j)typeof a.stringData[j]=="string"?tt.base64.decode(a.stringData[j],g.stringData[j]=tt.newBuffer(tt.base64.length(a.stringData[j])),0):a.stringData[j].length&&(g.stringData[j]=a.stringData[j])}if(a.int64Data){if(!Array.isArray(a.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(g.int64Data=[],j=0;j<a.int64Data.length;++j)tt.Long?(g.int64Data[j]=tt.Long.fromValue(a.int64Data[j])).unsigned=!1:typeof a.int64Data[j]=="string"?g.int64Data[j]=parseInt(a.int64Data[j],10):typeof a.int64Data[j]=="number"?g.int64Data[j]=a.int64Data[j]:typeof a.int64Data[j]=="object"&&(g.int64Data[j]=new tt.LongBits(a.int64Data[j].low>>>0,a.int64Data[j].high>>>0).toNumber())}if(a.name!=null&&(g.name=String(a.name)),a.docString!=null&&(g.docString=String(a.docString)),a.rawData!=null&&(typeof a.rawData=="string"?tt.base64.decode(a.rawData,g.rawData=tt.newBuffer(tt.base64.length(a.rawData)),0):a.rawData.length&&(g.rawData=a.rawData)),a.externalData){if(!Array.isArray(a.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(g.externalData=[],j=0;j<a.externalData.length;++j){if(typeof a.externalData[j]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");g.externalData[j]=et.onnx.StringStringEntryProto.fromObject(a.externalData[j])}}switch(a.dataLocation){case"DEFAULT":case 0:g.dataLocation=0;break;case"EXTERNAL":case 1:g.dataLocation=1}if(a.doubleData){if(!Array.isArray(a.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(g.doubleData=[],j=0;j<a.doubleData.length;++j)g.doubleData[j]=Number(a.doubleData[j])}if(a.uint64Data){if(!Array.isArray(a.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(g.uint64Data=[],j=0;j<a.uint64Data.length;++j)tt.Long?(g.uint64Data[j]=tt.Long.fromValue(a.uint64Data[j])).unsigned=!0:typeof a.uint64Data[j]=="string"?g.uint64Data[j]=parseInt(a.uint64Data[j],10):typeof a.uint64Data[j]=="number"?g.uint64Data[j]=a.uint64Data[j]:typeof a.uint64Data[j]=="object"&&(g.uint64Data[j]=new tt.LongBits(a.uint64Data[j].low>>>0,a.uint64Data[j].high>>>0).toNumber(!0))}return g},d.toObject=function(a,g){g||(g={});var j={};if((g.arrays||g.defaults)&&(j.dims=[],j.floatData=[],j.int32Data=[],j.stringData=[],j.int64Data=[],j.doubleData=[],j.uint64Data=[],j.externalData=[]),g.defaults&&(j.dataType=0,j.segment=null,j.name="",g.bytes===String?j.rawData="":(j.rawData=[],g.bytes!==Array&&(j.rawData=tt.newBuffer(j.rawData))),j.docString="",j.dataLocation=g.enums===String?"DEFAULT":0),a.dims&&a.dims.length){j.dims=[];for(var rt=0;rt<a.dims.length;++rt)typeof a.dims[rt]=="number"?j.dims[rt]=g.longs===String?String(a.dims[rt]):a.dims[rt]:j.dims[rt]=g.longs===String?tt.Long.prototype.toString.call(a.dims[rt]):g.longs===Number?new tt.LongBits(a.dims[rt].low>>>0,a.dims[rt].high>>>0).toNumber():a.dims[rt]}if(a.dataType!=null&&a.hasOwnProperty("dataType")&&(j.dataType=a.dataType),a.segment!=null&&a.hasOwnProperty("segment")&&(j.segment=et.onnx.TensorProto.Segment.toObject(a.segment,g)),a.floatData&&a.floatData.length)for(j.floatData=[],rt=0;rt<a.floatData.length;++rt)j.floatData[rt]=g.json&&!isFinite(a.floatData[rt])?String(a.floatData[rt]):a.floatData[rt];if(a.int32Data&&a.int32Data.length)for(j.int32Data=[],rt=0;rt<a.int32Data.length;++rt)j.int32Data[rt]=a.int32Data[rt];if(a.stringData&&a.stringData.length)for(j.stringData=[],rt=0;rt<a.stringData.length;++rt)j.stringData[rt]=g.bytes===String?tt.base64.encode(a.stringData[rt],0,a.stringData[rt].length):g.bytes===Array?Array.prototype.slice.call(a.stringData[rt]):a.stringData[rt];if(a.int64Data&&a.int64Data.length)for(j.int64Data=[],rt=0;rt<a.int64Data.length;++rt)typeof a.int64Data[rt]=="number"?j.int64Data[rt]=g.longs===String?String(a.int64Data[rt]):a.int64Data[rt]:j.int64Data[rt]=g.longs===String?tt.Long.prototype.toString.call(a.int64Data[rt]):g.longs===Number?new tt.LongBits(a.int64Data[rt].low>>>0,a.int64Data[rt].high>>>0).toNumber():a.int64Data[rt];if(a.name!=null&&a.hasOwnProperty("name")&&(j.name=a.name),a.rawData!=null&&a.hasOwnProperty("rawData")&&(j.rawData=g.bytes===String?tt.base64.encode(a.rawData,0,a.rawData.length):g.bytes===Array?Array.prototype.slice.call(a.rawData):a.rawData),a.doubleData&&a.doubleData.length)for(j.doubleData=[],rt=0;rt<a.doubleData.length;++rt)j.doubleData[rt]=g.json&&!isFinite(a.doubleData[rt])?String(a.doubleData[rt]):a.doubleData[rt];if(a.uint64Data&&a.uint64Data.length)for(j.uint64Data=[],rt=0;rt<a.uint64Data.length;++rt)typeof a.uint64Data[rt]=="number"?j.uint64Data[rt]=g.longs===String?String(a.uint64Data[rt]):a.uint64Data[rt]:j.uint64Data[rt]=g.longs===String?tt.Long.prototype.toString.call(a.uint64Data[rt]):g.longs===Number?new tt.LongBits(a.uint64Data[rt].low>>>0,a.uint64Data[rt].high>>>0).toNumber(!0):a.uint64Data[rt];if(a.docString!=null&&a.hasOwnProperty("docString")&&(j.docString=a.docString),a.externalData&&a.externalData.length)for(j.externalData=[],rt=0;rt<a.externalData.length;++rt)j.externalData[rt]=et.onnx.StringStringEntryProto.toObject(a.externalData[rt],g);return a.dataLocation!=null&&a.hasOwnProperty("dataLocation")&&(j.dataLocation=g.enums===String?et.onnx.TensorProto.DataLocation[a.dataLocation]:a.dataLocation),j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d.DataType=function(){var a={},g=Object.create(a);return g[a[0]="UNDEFINED"]=0,g[a[1]="FLOAT"]=1,g[a[2]="UINT8"]=2,g[a[3]="INT8"]=3,g[a[4]="UINT16"]=4,g[a[5]="INT16"]=5,g[a[6]="INT32"]=6,g[a[7]="INT64"]=7,g[a[8]="STRING"]=8,g[a[9]="BOOL"]=9,g[a[10]="FLOAT16"]=10,g[a[11]="DOUBLE"]=11,g[a[12]="UINT32"]=12,g[a[13]="UINT64"]=13,g[a[14]="COMPLEX64"]=14,g[a[15]="COMPLEX128"]=15,g[a[16]="BFLOAT16"]=16,g}(),d.Segment=function(){function a(g){if(g)for(var j=Object.keys(g),rt=0;rt<j.length;++rt)g[j[rt]]!=null&&(this[j[rt]]=g[j[rt]])}return a.prototype.begin=tt.Long?tt.Long.fromBits(0,0,!1):0,a.prototype.end=tt.Long?tt.Long.fromBits(0,0,!1):0,a.create=function(g){return new a(g)},a.encode=function(g,j){return j||(j=nt.create()),g.begin!=null&&g.hasOwnProperty("begin")&&j.uint32(8).int64(g.begin),g.end!=null&&g.hasOwnProperty("end")&&j.uint32(16).int64(g.end),j},a.encodeDelimited=function(g,j){return this.encode(g,j).ldelim()},a.decode=function(g,j){g instanceof $||(g=$.create(g));for(var rt=j===void 0?g.len:g.pos+j,ot=new et.onnx.TensorProto.Segment;g.pos<rt;){var it=g.uint32();switch(it>>>3){case 1:ot.begin=g.int64();break;case 2:ot.end=g.int64();break;default:g.skipType(7&it)}}return ot},a.decodeDelimited=function(g){return g instanceof $||(g=new $(g)),this.decode(g,g.uint32())},a.verify=function(g){return typeof g!="object"||g===null?"object expected":g.begin!=null&&g.hasOwnProperty("begin")&&!(tt.isInteger(g.begin)||g.begin&&tt.isInteger(g.begin.low)&&tt.isInteger(g.begin.high))?"begin: integer|Long expected":g.end!=null&&g.hasOwnProperty("end")&&!(tt.isInteger(g.end)||g.end&&tt.isInteger(g.end.low)&&tt.isInteger(g.end.high))?"end: integer|Long expected":null},a.fromObject=function(g){if(g instanceof et.onnx.TensorProto.Segment)return g;var j=new et.onnx.TensorProto.Segment;return g.begin!=null&&(tt.Long?(j.begin=tt.Long.fromValue(g.begin)).unsigned=!1:typeof g.begin=="string"?j.begin=parseInt(g.begin,10):typeof g.begin=="number"?j.begin=g.begin:typeof g.begin=="object"&&(j.begin=new tt.LongBits(g.begin.low>>>0,g.begin.high>>>0).toNumber())),g.end!=null&&(tt.Long?(j.end=tt.Long.fromValue(g.end)).unsigned=!1:typeof g.end=="string"?j.end=parseInt(g.end,10):typeof g.end=="number"?j.end=g.end:typeof g.end=="object"&&(j.end=new tt.LongBits(g.end.low>>>0,g.end.high>>>0).toNumber())),j},a.toObject=function(g,j){j||(j={});var rt={};if(j.defaults){if(tt.Long){var ot=new tt.Long(0,0,!1);rt.begin=j.longs===String?ot.toString():j.longs===Number?ot.toNumber():ot}else rt.begin=j.longs===String?"0":0;tt.Long?(ot=new tt.Long(0,0,!1),rt.end=j.longs===String?ot.toString():j.longs===Number?ot.toNumber():ot):rt.end=j.longs===String?"0":0}return g.begin!=null&&g.hasOwnProperty("begin")&&(typeof g.begin=="number"?rt.begin=j.longs===String?String(g.begin):g.begin:rt.begin=j.longs===String?tt.Long.prototype.toString.call(g.begin):j.longs===Number?new tt.LongBits(g.begin.low>>>0,g.begin.high>>>0).toNumber():g.begin),g.end!=null&&g.hasOwnProperty("end")&&(typeof g.end=="number"?rt.end=j.longs===String?String(g.end):g.end:rt.end=j.longs===String?tt.Long.prototype.toString.call(g.end):j.longs===Number?new tt.LongBits(g.end.low>>>0,g.end.high>>>0).toNumber():g.end),rt},a.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},a}(),d.DataLocation=function(){var a={},g=Object.create(a);return g[a[0]="DEFAULT"]=0,g[a[1]="EXTERNAL"]=1,g}(),d}(),h.TensorShapeProto=function(){function d(a){if(this.dim=[],a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.dim=tt.emptyArray,d.create=function(a){return new d(a)},d.encode=function(a,g){if(g||(g=nt.create()),a.dim!=null&&a.dim.length)for(var j=0;j<a.dim.length;++j)et.onnx.TensorShapeProto.Dimension.encode(a.dim[j],g.uint32(10).fork()).ldelim();return g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.TensorShapeProto;a.pos<j;){var ot=a.uint32();ot>>>3==1?(rt.dim&&rt.dim.length||(rt.dim=[]),rt.dim.push(et.onnx.TensorShapeProto.Dimension.decode(a,a.uint32()))):a.skipType(7&ot)}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.dim!=null&&a.hasOwnProperty("dim")){if(!Array.isArray(a.dim))return"dim: array expected";for(var g=0;g<a.dim.length;++g){var j=et.onnx.TensorShapeProto.Dimension.verify(a.dim[g]);if(j)return"dim."+j}}return null},d.fromObject=function(a){if(a instanceof et.onnx.TensorShapeProto)return a;var g=new et.onnx.TensorShapeProto;if(a.dim){if(!Array.isArray(a.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");g.dim=[];for(var j=0;j<a.dim.length;++j){if(typeof a.dim[j]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");g.dim[j]=et.onnx.TensorShapeProto.Dimension.fromObject(a.dim[j])}}return g},d.toObject=function(a,g){g||(g={});var j={};if((g.arrays||g.defaults)&&(j.dim=[]),a.dim&&a.dim.length){j.dim=[];for(var rt=0;rt<a.dim.length;++rt)j.dim[rt]=et.onnx.TensorShapeProto.Dimension.toObject(a.dim[rt],g)}return j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d.Dimension=function(){function a(j){if(j)for(var rt=Object.keys(j),ot=0;ot<rt.length;++ot)j[rt[ot]]!=null&&(this[rt[ot]]=j[rt[ot]])}var g;return a.prototype.dimValue=tt.Long?tt.Long.fromBits(0,0,!1):0,a.prototype.dimParam="",a.prototype.denotation="",Object.defineProperty(a.prototype,"value",{get:tt.oneOfGetter(g=["dimValue","dimParam"]),set:tt.oneOfSetter(g)}),a.create=function(j){return new a(j)},a.encode=function(j,rt){return rt||(rt=nt.create()),j.dimValue!=null&&j.hasOwnProperty("dimValue")&&rt.uint32(8).int64(j.dimValue),j.dimParam!=null&&j.hasOwnProperty("dimParam")&&rt.uint32(18).string(j.dimParam),j.denotation!=null&&j.hasOwnProperty("denotation")&&rt.uint32(26).string(j.denotation),rt},a.encodeDelimited=function(j,rt){return this.encode(j,rt).ldelim()},a.decode=function(j,rt){j instanceof $||(j=$.create(j));for(var ot=rt===void 0?j.len:j.pos+rt,it=new et.onnx.TensorShapeProto.Dimension;j.pos<ot;){var at=j.uint32();switch(at>>>3){case 1:it.dimValue=j.int64();break;case 2:it.dimParam=j.string();break;case 3:it.denotation=j.string();break;default:j.skipType(7&at)}}return it},a.decodeDelimited=function(j){return j instanceof $||(j=new $(j)),this.decode(j,j.uint32())},a.verify=function(j){if(typeof j!="object"||j===null)return"object expected";var rt={};if(j.dimValue!=null&&j.hasOwnProperty("dimValue")&&(rt.value=1,!(tt.isInteger(j.dimValue)||j.dimValue&&tt.isInteger(j.dimValue.low)&&tt.isInteger(j.dimValue.high))))return"dimValue: integer|Long expected";if(j.dimParam!=null&&j.hasOwnProperty("dimParam")){if(rt.value===1)return"value: multiple values";if(rt.value=1,!tt.isString(j.dimParam))return"dimParam: string expected"}return j.denotation!=null&&j.hasOwnProperty("denotation")&&!tt.isString(j.denotation)?"denotation: string expected":null},a.fromObject=function(j){if(j instanceof et.onnx.TensorShapeProto.Dimension)return j;var rt=new et.onnx.TensorShapeProto.Dimension;return j.dimValue!=null&&(tt.Long?(rt.dimValue=tt.Long.fromValue(j.dimValue)).unsigned=!1:typeof j.dimValue=="string"?rt.dimValue=parseInt(j.dimValue,10):typeof j.dimValue=="number"?rt.dimValue=j.dimValue:typeof j.dimValue=="object"&&(rt.dimValue=new tt.LongBits(j.dimValue.low>>>0,j.dimValue.high>>>0).toNumber())),j.dimParam!=null&&(rt.dimParam=String(j.dimParam)),j.denotation!=null&&(rt.denotation=String(j.denotation)),rt},a.toObject=function(j,rt){rt||(rt={});var ot={};return rt.defaults&&(ot.denotation=""),j.dimValue!=null&&j.hasOwnProperty("dimValue")&&(typeof j.dimValue=="number"?ot.dimValue=rt.longs===String?String(j.dimValue):j.dimValue:ot.dimValue=rt.longs===String?tt.Long.prototype.toString.call(j.dimValue):rt.longs===Number?new tt.LongBits(j.dimValue.low>>>0,j.dimValue.high>>>0).toNumber():j.dimValue,rt.oneofs&&(ot.value="dimValue")),j.dimParam!=null&&j.hasOwnProperty("dimParam")&&(ot.dimParam=j.dimParam,rt.oneofs&&(ot.value="dimParam")),j.denotation!=null&&j.hasOwnProperty("denotation")&&(ot.denotation=j.denotation),ot},a.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},a}(),d}(),h.TypeProto=function(){function d(g){if(g)for(var j=Object.keys(g),rt=0;rt<j.length;++rt)g[j[rt]]!=null&&(this[j[rt]]=g[j[rt]])}var a;return d.prototype.tensorType=null,d.prototype.denotation="",Object.defineProperty(d.prototype,"value",{get:tt.oneOfGetter(a=["tensorType"]),set:tt.oneOfSetter(a)}),d.create=function(g){return new d(g)},d.encode=function(g,j){return j||(j=nt.create()),g.tensorType!=null&&g.hasOwnProperty("tensorType")&&et.onnx.TypeProto.Tensor.encode(g.tensorType,j.uint32(10).fork()).ldelim(),g.denotation!=null&&g.hasOwnProperty("denotation")&&j.uint32(50).string(g.denotation),j},d.encodeDelimited=function(g,j){return this.encode(g,j).ldelim()},d.decode=function(g,j){g instanceof $||(g=$.create(g));for(var rt=j===void 0?g.len:g.pos+j,ot=new et.onnx.TypeProto;g.pos<rt;){var it=g.uint32();switch(it>>>3){case 1:ot.tensorType=et.onnx.TypeProto.Tensor.decode(g,g.uint32());break;case 6:ot.denotation=g.string();break;default:g.skipType(7&it)}}return ot},d.decodeDelimited=function(g){return g instanceof $||(g=new $(g)),this.decode(g,g.uint32())},d.verify=function(g){if(typeof g!="object"||g===null)return"object expected";if(g.tensorType!=null&&g.hasOwnProperty("tensorType")){var j=et.onnx.TypeProto.Tensor.verify(g.tensorType);if(j)return"tensorType."+j}return g.denotation!=null&&g.hasOwnProperty("denotation")&&!tt.isString(g.denotation)?"denotation: string expected":null},d.fromObject=function(g){if(g instanceof et.onnx.TypeProto)return g;var j=new et.onnx.TypeProto;if(g.tensorType!=null){if(typeof g.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");j.tensorType=et.onnx.TypeProto.Tensor.fromObject(g.tensorType)}return g.denotation!=null&&(j.denotation=String(g.denotation)),j},d.toObject=function(g,j){j||(j={});var rt={};return j.defaults&&(rt.denotation=""),g.tensorType!=null&&g.hasOwnProperty("tensorType")&&(rt.tensorType=et.onnx.TypeProto.Tensor.toObject(g.tensorType,j),j.oneofs&&(rt.value="tensorType")),g.denotation!=null&&g.hasOwnProperty("denotation")&&(rt.denotation=g.denotation),rt},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d.Tensor=function(){function g(j){if(j)for(var rt=Object.keys(j),ot=0;ot<rt.length;++ot)j[rt[ot]]!=null&&(this[rt[ot]]=j[rt[ot]])}return g.prototype.elemType=0,g.prototype.shape=null,g.create=function(j){return new g(j)},g.encode=function(j,rt){return rt||(rt=nt.create()),j.elemType!=null&&j.hasOwnProperty("elemType")&&rt.uint32(8).int32(j.elemType),j.shape!=null&&j.hasOwnProperty("shape")&&et.onnx.TensorShapeProto.encode(j.shape,rt.uint32(18).fork()).ldelim(),rt},g.encodeDelimited=function(j,rt){return this.encode(j,rt).ldelim()},g.decode=function(j,rt){j instanceof $||(j=$.create(j));for(var ot=rt===void 0?j.len:j.pos+rt,it=new et.onnx.TypeProto.Tensor;j.pos<ot;){var at=j.uint32();switch(at>>>3){case 1:it.elemType=j.int32();break;case 2:it.shape=et.onnx.TensorShapeProto.decode(j,j.uint32());break;default:j.skipType(7&at)}}return it},g.decodeDelimited=function(j){return j instanceof $||(j=new $(j)),this.decode(j,j.uint32())},g.verify=function(j){if(typeof j!="object"||j===null)return"object expected";if(j.elemType!=null&&j.hasOwnProperty("elemType")&&!tt.isInteger(j.elemType))return"elemType: integer expected";if(j.shape!=null&&j.hasOwnProperty("shape")){var rt=et.onnx.TensorShapeProto.verify(j.shape);if(rt)return"shape."+rt}return null},g.fromObject=function(j){if(j instanceof et.onnx.TypeProto.Tensor)return j;var rt=new et.onnx.TypeProto.Tensor;if(j.elemType!=null&&(rt.elemType=0|j.elemType),j.shape!=null){if(typeof j.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");rt.shape=et.onnx.TensorShapeProto.fromObject(j.shape)}return rt},g.toObject=function(j,rt){rt||(rt={});var ot={};return rt.defaults&&(ot.elemType=0,ot.shape=null),j.elemType!=null&&j.hasOwnProperty("elemType")&&(ot.elemType=j.elemType),j.shape!=null&&j.hasOwnProperty("shape")&&(ot.shape=et.onnx.TensorShapeProto.toObject(j.shape,rt)),ot},g.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},g}(),d}(),h.OperatorSetIdProto=function(){function d(a){if(a)for(var g=Object.keys(a),j=0;j<g.length;++j)a[g[j]]!=null&&(this[g[j]]=a[g[j]])}return d.prototype.domain="",d.prototype.version=tt.Long?tt.Long.fromBits(0,0,!1):0,d.create=function(a){return new d(a)},d.encode=function(a,g){return g||(g=nt.create()),a.domain!=null&&a.hasOwnProperty("domain")&&g.uint32(10).string(a.domain),a.version!=null&&a.hasOwnProperty("version")&&g.uint32(16).int64(a.version),g},d.encodeDelimited=function(a,g){return this.encode(a,g).ldelim()},d.decode=function(a,g){a instanceof $||(a=$.create(a));for(var j=g===void 0?a.len:a.pos+g,rt=new et.onnx.OperatorSetIdProto;a.pos<j;){var ot=a.uint32();switch(ot>>>3){case 1:rt.domain=a.string();break;case 2:rt.version=a.int64();break;default:a.skipType(7&ot)}}return rt},d.decodeDelimited=function(a){return a instanceof $||(a=new $(a)),this.decode(a,a.uint32())},d.verify=function(a){return typeof a!="object"||a===null?"object expected":a.domain!=null&&a.hasOwnProperty("domain")&&!tt.isString(a.domain)?"domain: string expected":a.version!=null&&a.hasOwnProperty("version")&&!(tt.isInteger(a.version)||a.version&&tt.isInteger(a.version.low)&&tt.isInteger(a.version.high))?"version: integer|Long expected":null},d.fromObject=function(a){if(a instanceof et.onnx.OperatorSetIdProto)return a;var g=new et.onnx.OperatorSetIdProto;return a.domain!=null&&(g.domain=String(a.domain)),a.version!=null&&(tt.Long?(g.version=tt.Long.fromValue(a.version)).unsigned=!1:typeof a.version=="string"?g.version=parseInt(a.version,10):typeof a.version=="number"?g.version=a.version:typeof a.version=="object"&&(g.version=new tt.LongBits(a.version.low>>>0,a.version.high>>>0).toNumber())),g},d.toObject=function(a,g){g||(g={});var j={};if(g.defaults)if(j.domain="",tt.Long){var rt=new tt.Long(0,0,!1);j.version=g.longs===String?rt.toString():g.longs===Number?rt.toNumber():rt}else j.version=g.longs===String?"0":0;return a.domain!=null&&a.hasOwnProperty("domain")&&(j.domain=a.domain),a.version!=null&&a.hasOwnProperty("version")&&(typeof a.version=="number"?j.version=g.longs===String?String(a.version):a.version:j.version=g.longs===String?tt.Long.prototype.toString.call(a.version):g.longs===Number?new tt.LongBits(a.version.low>>>0,a.version.high>>>0).toNumber():a.version),j},d.prototype.toJSON=function(){return this.constructor.toObject(this,_.util.toJSONOptions)},d}(),h),i.exports=et},2100:(i,e,o)=>{i.exports=o(9482)},9482:(i,e,o)=>{var s=e;function c(){s.util._configure(),s.Writer._configure(s.BufferWriter),s.Reader._configure(s.BufferReader)}s.build="minimal",s.Writer=o(1173),s.BufferWriter=o(3155),s.Reader=o(1408),s.BufferReader=o(593),s.util=o(9693),s.rpc=o(5994),s.roots=o(5054),s.configure=c,c()},1408:(i,e,o)=>{i.exports=nt;var s,c=o(9693),h=c.LongBits,_=c.utf8;function $(rt,ot){return RangeError("index out of range: "+rt.pos+" + "+(ot||1)+" > "+rt.len)}function nt(rt){this.buf=rt,this.pos=0,this.len=rt.length}var tt,et=typeof Uint8Array<"u"?function(rt){if(rt instanceof Uint8Array||Array.isArray(rt))return new nt(rt);throw Error("illegal buffer")}:function(rt){if(Array.isArray(rt))return new nt(rt);throw Error("illegal buffer")},d=function(){return c.Buffer?function(rt){return(nt.create=function(ot){return c.Buffer.isBuffer(ot)?new s(ot):et(ot)})(rt)}:et};function a(){var rt=new h(0,0),ot=0;if(!(this.len-this.pos>4)){for(;ot<3;++ot){if(this.pos>=this.len)throw $(this);if(rt.lo=(rt.lo|(127&this.buf[this.pos])<<7*ot)>>>0,this.buf[this.pos++]<128)return rt}return rt.lo=(rt.lo|(127&this.buf[this.pos++])<<7*ot)>>>0,rt}for(;ot<4;++ot)if(rt.lo=(rt.lo|(127&this.buf[this.pos])<<7*ot)>>>0,this.buf[this.pos++]<128)return rt;if(rt.lo=(rt.lo|(127&this.buf[this.pos])<<28)>>>0,rt.hi=(rt.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return rt;if(ot=0,this.len-this.pos>4){for(;ot<5;++ot)if(rt.hi=(rt.hi|(127&this.buf[this.pos])<<7*ot+3)>>>0,this.buf[this.pos++]<128)return rt}else for(;ot<5;++ot){if(this.pos>=this.len)throw $(this);if(rt.hi=(rt.hi|(127&this.buf[this.pos])<<7*ot+3)>>>0,this.buf[this.pos++]<128)return rt}throw Error("invalid varint encoding")}function g(rt,ot){return(rt[ot-4]|rt[ot-3]<<8|rt[ot-2]<<16|rt[ot-1]<<24)>>>0}function j(){if(this.pos+8>this.len)throw $(this,8);return new h(g(this.buf,this.pos+=4),g(this.buf,this.pos+=4))}nt.create=d(),nt.prototype._slice=c.Array.prototype.subarray||c.Array.prototype.slice,nt.prototype.uint32=(tt=4294967295,function(){if(tt=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(tt=(tt|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(tt=(tt|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(tt=(tt|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(tt=(tt|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return tt;if((this.pos+=5)>this.len)throw this.pos=this.len,$(this,10);return tt}),nt.prototype.int32=function(){return 0|this.uint32()},nt.prototype.sint32=function(){var rt=this.uint32();return rt>>>1^-(1&rt)|0},nt.prototype.bool=function(){return this.uint32()!==0},nt.prototype.fixed32=function(){if(this.pos+4>this.len)throw $(this,4);return g(this.buf,this.pos+=4)},nt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw $(this,4);return 0|g(this.buf,this.pos+=4)},nt.prototype.float=function(){if(this.pos+4>this.len)throw $(this,4);var rt=c.float.readFloatLE(this.buf,this.pos);return this.pos+=4,rt},nt.prototype.double=function(){if(this.pos+8>this.len)throw $(this,4);var rt=c.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,rt},nt.prototype.bytes=function(){var rt=this.uint32(),ot=this.pos,it=this.pos+rt;if(it>this.len)throw $(this,rt);return this.pos+=rt,Array.isArray(this.buf)?this.buf.slice(ot,it):ot===it?new this.buf.constructor(0):this._slice.call(this.buf,ot,it)},nt.prototype.string=function(){var rt=this.bytes();return _.read(rt,0,rt.length)},nt.prototype.skip=function(rt){if(typeof rt=="number"){if(this.pos+rt>this.len)throw $(this,rt);this.pos+=rt}else do if(this.pos>=this.len)throw $(this);while(128&this.buf[this.pos++]);return this},nt.prototype.skipType=function(rt){switch(rt){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(rt=7&this.uint32())!=4;)this.skipType(rt);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+rt+" at offset "+this.pos)}return this},nt._configure=function(rt){s=rt,nt.create=d(),s._configure();var ot=c.Long?"toLong":"toNumber";c.merge(nt.prototype,{int64:function(){return a.call(this)[ot](!1)},uint64:function(){return a.call(this)[ot](!0)},sint64:function(){return a.call(this).zzDecode()[ot](!1)},fixed64:function(){return j.call(this)[ot](!0)},sfixed64:function(){return j.call(this)[ot](!1)}})}},593:(i,e,o)=>{i.exports=h;var s=o(1408);(h.prototype=Object.create(s.prototype)).constructor=h;var c=o(9693);function h(_){s.call(this,_)}h._configure=function(){c.Buffer&&(h.prototype._slice=c.Buffer.prototype.slice)},h.prototype.string=function(){var _=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+_,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+_,this.len))},h._configure()},5054:i=>{i.exports={}},5994:(i,e,o)=>{e.Service=o(7948)},7948:(i,e,o)=>{i.exports=c;var s=o(9693);function c(h,_,$){if(typeof h!="function")throw TypeError("rpcImpl must be a function");s.EventEmitter.call(this),this.rpcImpl=h,this.requestDelimited=!!_,this.responseDelimited=!!$}(c.prototype=Object.create(s.EventEmitter.prototype)).constructor=c,c.prototype.rpcCall=function h(_,$,nt,tt,et){if(!tt)throw TypeError("request must be specified");var d=this;if(!et)return s.asPromise(h,d,_,$,nt,tt);if(d.rpcImpl)try{return d.rpcImpl(_,$[d.requestDelimited?"encodeDelimited":"encode"](tt).finish(),function(a,g){if(a)return d.emit("error",a,_),et(a);if(g!==null){if(!(g instanceof nt))try{g=nt[d.responseDelimited?"decodeDelimited":"decode"](g)}catch(j){return d.emit("error",j,_),et(j)}return d.emit("data",g,_),et(null,g)}d.end(!0)})}catch(a){return d.emit("error",a,_),void setTimeout(function(){et(a)},0)}else setTimeout(function(){et(Error("already ended"))},0)},c.prototype.end=function(h){return this.rpcImpl&&(h||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:(i,e,o)=>{i.exports=c;var s=o(9693);function c(nt,tt){this.lo=nt>>>0,this.hi=tt>>>0}var h=c.zero=new c(0,0);h.toNumber=function(){return 0},h.zzEncode=h.zzDecode=function(){return this},h.length=function(){return 1};var _=c.zeroHash="\0\0\0\0\0\0\0\0";c.fromNumber=function(nt){if(nt===0)return h;var tt=nt<0;tt&&(nt=-nt);var et=nt>>>0,d=(nt-et)/4294967296>>>0;return tt&&(d=~d>>>0,et=~et>>>0,++et>4294967295&&(et=0,++d>4294967295&&(d=0))),new c(et,d)},c.from=function(nt){if(typeof nt=="number")return c.fromNumber(nt);if(s.isString(nt)){if(!s.Long)return c.fromNumber(parseInt(nt,10));nt=s.Long.fromString(nt)}return nt.low||nt.high?new c(nt.low>>>0,nt.high>>>0):h},c.prototype.toNumber=function(nt){if(!nt&&this.hi>>>31){var tt=1+~this.lo>>>0,et=~this.hi>>>0;return tt||(et=et+1>>>0),-(tt+4294967296*et)}return this.lo+4294967296*this.hi},c.prototype.toLong=function(nt){return s.Long?new s.Long(0|this.lo,0|this.hi,!!nt):{low:0|this.lo,high:0|this.hi,unsigned:!!nt}};var $=String.prototype.charCodeAt;c.fromHash=function(nt){return nt===_?h:new c(($.call(nt,0)|$.call(nt,1)<<8|$.call(nt,2)<<16|$.call(nt,3)<<24)>>>0,($.call(nt,4)|$.call(nt,5)<<8|$.call(nt,6)<<16|$.call(nt,7)<<24)>>>0)},c.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},c.prototype.zzEncode=function(){var nt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^nt)>>>0,this.lo=(this.lo<<1^nt)>>>0,this},c.prototype.zzDecode=function(){var nt=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^nt)>>>0,this.hi=(this.hi>>>1^nt)>>>0,this},c.prototype.length=function(){var nt=this.lo,tt=(this.lo>>>28|this.hi<<4)>>>0,et=this.hi>>>24;return et===0?tt===0?nt<16384?nt<128?1:2:nt<2097152?3:4:tt<16384?tt<128?5:6:tt<2097152?7:8:et<128?9:10}},9693:function(i,e,o){var s=e;function c(_,$,nt){for(var tt=Object.keys($),et=0;et<tt.length;++et)_[tt[et]]!==void 0&&nt||(_[tt[et]]=$[tt[et]]);return _}function h(_){function $(nt,tt){if(!(this instanceof $))return new $(nt,tt);Object.defineProperty(this,"message",{get:function(){return nt}}),Error.captureStackTrace?Error.captureStackTrace(this,$):Object.defineProperty(this,"stack",{value:new Error().stack||""}),tt&&c(this,tt)}return($.prototype=Object.create(Error.prototype)).constructor=$,Object.defineProperty($.prototype,"name",{get:function(){return _}}),$.prototype.toString=function(){return this.name+": "+this.message},$}s.asPromise=o(4537),s.base64=o(7419),s.EventEmitter=o(9211),s.float=o(945),s.inquire=o(7199),s.utf8=o(4997),s.pool=o(6662),s.LongBits=o(1945),s.isNode=!!(o.g!==void 0&&o.g&&o.g.process&&o.g.process.versions&&o.g.process.versions.node),s.global=s.isNode&&o.g||typeof window<"u"&&window||typeof self<"u"&&self||this,s.emptyArray=Object.freeze?Object.freeze([]):[],s.emptyObject=Object.freeze?Object.freeze({}):{},s.isInteger=Number.isInteger||function(_){return typeof _=="number"&&isFinite(_)&&Math.floor(_)===_},s.isString=function(_){return typeof _=="string"||_ instanceof String},s.isObject=function(_){return _&&typeof _=="object"},s.isset=s.isSet=function(_,$){var nt=_[$];return!(nt==null||!_.hasOwnProperty($))&&(typeof nt!="object"||(Array.isArray(nt)?nt.length:Object.keys(nt).length)>0)},s.Buffer=function(){try{var _=s.inquire("buffer").Buffer;return _.prototype.utf8Write?_:null}catch{return null}}(),s._Buffer_from=null,s._Buffer_allocUnsafe=null,s.newBuffer=function(_){return typeof _=="number"?s.Buffer?s._Buffer_allocUnsafe(_):new s.Array(_):s.Buffer?s._Buffer_from(_):typeof Uint8Array>"u"?_:new Uint8Array(_)},s.Array=typeof Uint8Array<"u"?Uint8Array:Array,s.Long=s.global.dcodeIO&&s.global.dcodeIO.Long||s.global.Long||s.inquire("long"),s.key2Re=/^true|false|0|1$/,s.key32Re=/^-?(?:0|[1-9][0-9]*)$/,s.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,s.longToHash=function(_){return _?s.LongBits.from(_).toHash():s.LongBits.zeroHash},s.longFromHash=function(_,$){var nt=s.LongBits.fromHash(_);return s.Long?s.Long.fromBits(nt.lo,nt.hi,$):nt.toNumber(!!$)},s.merge=c,s.lcFirst=function(_){return _.charAt(0).toLowerCase()+_.substring(1)},s.newError=h,s.ProtocolError=h("ProtocolError"),s.oneOfGetter=function(_){for(var $={},nt=0;nt<_.length;++nt)$[_[nt]]=1;return function(){for(var tt=Object.keys(this),et=tt.length-1;et>-1;--et)if($[tt[et]]===1&&this[tt[et]]!==void 0&&this[tt[et]]!==null)return tt[et]}},s.oneOfSetter=function(_){return function($){for(var nt=0;nt<_.length;++nt)_[nt]!==$&&delete this[_[nt]]}},s.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},s._configure=function(){var _=s.Buffer;_?(s._Buffer_from=_.from!==Uint8Array.from&&_.from||function($,nt){return new _($,nt)},s._Buffer_allocUnsafe=_.allocUnsafe||function($){return new _($)}):s._Buffer_from=s._Buffer_allocUnsafe=null}},1173:(i,e,o)=>{i.exports=d;var s,c=o(9693),h=c.LongBits,_=c.base64,$=c.utf8;function nt(at,lt,ct){this.fn=at,this.len=lt,this.next=void 0,this.val=ct}function tt(){}function et(at){this.head=at.head,this.tail=at.tail,this.len=at.len,this.next=at.states}function d(){this.len=0,this.head=new nt(tt,0,0),this.tail=this.head,this.states=null}var a=function(){return c.Buffer?function(){return(d.create=function(){return new s})()}:function(){return new d}};function g(at,lt,ct){lt[ct]=255&at}function j(at,lt){this.len=at,this.next=void 0,this.val=lt}function rt(at,lt,ct){for(;at.hi;)lt[ct++]=127&at.lo|128,at.lo=(at.lo>>>7|at.hi<<25)>>>0,at.hi>>>=7;for(;at.lo>127;)lt[ct++]=127&at.lo|128,at.lo=at.lo>>>7;lt[ct++]=at.lo}function ot(at,lt,ct){lt[ct]=255&at,lt[ct+1]=at>>>8&255,lt[ct+2]=at>>>16&255,lt[ct+3]=at>>>24}d.create=a(),d.alloc=function(at){return new c.Array(at)},c.Array!==Array&&(d.alloc=c.pool(d.alloc,c.Array.prototype.subarray)),d.prototype._push=function(at,lt,ct){return this.tail=this.tail.next=new nt(at,lt,ct),this.len+=lt,this},j.prototype=Object.create(nt.prototype),j.prototype.fn=function(at,lt,ct){for(;at>127;)lt[ct++]=127&at|128,at>>>=7;lt[ct]=at},d.prototype.uint32=function(at){return this.len+=(this.tail=this.tail.next=new j((at>>>=0)<128?1:at<16384?2:at<2097152?3:at<268435456?4:5,at)).len,this},d.prototype.int32=function(at){return at<0?this._push(rt,10,h.fromNumber(at)):this.uint32(at)},d.prototype.sint32=function(at){return this.uint32((at<<1^at>>31)>>>0)},d.prototype.uint64=function(at){var lt=h.from(at);return this._push(rt,lt.length(),lt)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(at){var lt=h.from(at).zzEncode();return this._push(rt,lt.length(),lt)},d.prototype.bool=function(at){return this._push(g,1,at?1:0)},d.prototype.fixed32=function(at){return this._push(ot,4,at>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(at){var lt=h.from(at);return this._push(ot,4,lt.lo)._push(ot,4,lt.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(at){return this._push(c.float.writeFloatLE,4,at)},d.prototype.double=function(at){return this._push(c.float.writeDoubleLE,8,at)};var it=c.Array.prototype.set?function(at,lt,ct){lt.set(at,ct)}:function(at,lt,ct){for(var dt=0;dt<at.length;++dt)lt[ct+dt]=at[dt]};d.prototype.bytes=function(at){var lt=at.length>>>0;if(!lt)return this._push(g,1,0);if(c.isString(at)){var ct=d.alloc(lt=_.length(at));_.decode(at,ct,0),at=ct}return this.uint32(lt)._push(it,lt,at)},d.prototype.string=function(at){var lt=$.length(at);return lt?this.uint32(lt)._push($.write,lt,at):this._push(g,1,0)},d.prototype.fork=function(){return this.states=new et(this),this.head=this.tail=new nt(tt,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new nt(tt,0,0),this.len=0),this},d.prototype.ldelim=function(){var at=this.head,lt=this.tail,ct=this.len;return this.reset().uint32(ct),ct&&(this.tail.next=at.next,this.tail=lt,this.len+=ct),this},d.prototype.finish=function(){for(var at=this.head.next,lt=this.constructor.alloc(this.len),ct=0;at;)at.fn(at.val,lt,ct),ct+=at.len,at=at.next;return lt},d._configure=function(at){s=at,d.create=a(),s._configure()}},3155:(i,e,o)=>{i.exports=h;var s=o(1173);(h.prototype=Object.create(s.prototype)).constructor=h;var c=o(9693);function h(){s.call(this)}function _($,nt,tt){$.length<40?c.utf8.write($,nt,tt):nt.utf8Write?nt.utf8Write($,tt):nt.write($,tt)}h._configure=function(){h.alloc=c._Buffer_allocUnsafe,h.writeBytesBuffer=c.Buffer&&c.Buffer.prototype instanceof Uint8Array&&c.Buffer.prototype.set.name==="set"?function($,nt,tt){nt.set($,tt)}:function($,nt,tt){if($.copy)$.copy(nt,tt,0,$.length);else for(var et=0;et<$.length;)nt[tt++]=$[et++]}},h.prototype.bytes=function($){c.isString($)&&($=c._Buffer_from($,"base64"));var nt=$.length>>>0;return this.uint32(nt),nt&&this._push(h.writeBytesBuffer,nt,$),this},h.prototype.string=function($){var nt=c.Buffer.byteLength($);return this.uint32(nt),nt&&this._push(_,nt,$),this},h._configure()},7714:(i,e,o)=>{e.R=void 0;const s=o(6919),c=o(7448);e.R=new class{async init(){}async createSessionHandler(h,_){const $=new s.Session(_);return await $.loadModel(h),new c.OnnxjsSessionHandler($)}}},4200:(i,e,o)=>{e.c8=e.rX=void 0;const s=o(1670),c=o(5381),h=o(2157),_=o(2306);e.rX=()=>{if((typeof s.env.wasm.initTimeout!="number"||s.env.wasm.initTimeout<0)&&(s.env.wasm.initTimeout=0),typeof s.env.wasm.simd!="boolean"&&(s.env.wasm.simd=!0),typeof s.env.wasm.proxy!="boolean"&&(s.env.wasm.proxy=!1),typeof s.env.wasm.numThreads!="number"||!Number.isInteger(s.env.wasm.numThreads)||s.env.wasm.numThreads<=0){const $=typeof navigator>"u"?(0,c.cpus)().length:navigator.hardwareConcurrency;s.env.wasm.numThreads=Math.min(4,Math.ceil(($||1)/2))}},e.c8=new class{async init(){(0,e.rX)(),await(0,h.initWasm)()}async createSessionHandler($,nt){const tt=new _.OnnxruntimeWebAssemblySessionHandler;return await tt.loadModel($,nt),Promise.resolve(tt)}}},6018:function(i,e,o){var s=this&&this.__createBinding||(Object.create?function(_,$,nt,tt){tt===void 0&&(tt=nt);var et=Object.getOwnPropertyDescriptor($,nt);et&&!("get"in et?!$.__esModule:et.writable||et.configurable)||(et={enumerable:!0,get:function(){return $[nt]}}),Object.defineProperty(_,tt,et)}:function(_,$,nt,tt){tt===void 0&&(tt=nt),_[tt]=$[nt]}),c=this&&this.__exportStar||function(_,$){for(var nt in _)nt==="default"||Object.prototype.hasOwnProperty.call($,nt)||s($,_,nt)};Object.defineProperty(e,"__esModule",{value:!0}),c(o(1670),e);const h=o(1670);{const _=o(7714).R;(0,h.registerBackend)("webgl",_,-10)}{const _=o(4200).c8;(0,h.registerBackend)("cpu",_,10),(0,h.registerBackend)("wasm",_,10),(0,h.registerBackend)("xnnpack",_,9)}},246:(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createAttributeWithCacheKey=void 0;class o{constructor(c){Object.assign(this,c)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map(c=>`${this[c]}`).join(";")),this._cacheKey}}e.createAttributeWithCacheKey=s=>new o(s)},7778:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Attribute=void 0;const s=o(1446),c=o(9395),h=o(9162),_=o(2517);var $=c.onnxruntime.experimental.fbs;class nt{constructor(et){if(this._attributes=new Map,et!=null){for(const d of et)d instanceof s.onnx.AttributeProto?this._attributes.set(d.name,[nt.getValue(d),nt.getType(d)]):d instanceof $.Attribute&&this._attributes.set(d.name(),[nt.getValue(d),nt.getType(d)]);if(this._attributes.size<et.length)throw new Error("duplicated attribute names")}}set(et,d,a){this._attributes.set(et,[a,d])}delete(et){this._attributes.delete(et)}getFloat(et,d){return this.get(et,"float",d)}getInt(et,d){return this.get(et,"int",d)}getString(et,d){return this.get(et,"string",d)}getTensor(et,d){return this.get(et,"tensor",d)}getFloats(et,d){return this.get(et,"floats",d)}getInts(et,d){return this.get(et,"ints",d)}getStrings(et,d){return this.get(et,"strings",d)}getTensors(et,d){return this.get(et,"tensors",d)}get(et,d,a){const g=this._attributes.get(et);if(g===void 0){if(a!==void 0)return a;throw new Error(`required attribute not found: ${et}`)}if(g[1]!==d)throw new Error(`type mismatch: expected ${d} but got ${g[1]}`);return g[0]}static getType(et){const d=et instanceof s.onnx.AttributeProto?et.type:et.type();switch(d){case s.onnx.AttributeProto.AttributeType.FLOAT:return"float";case s.onnx.AttributeProto.AttributeType.INT:return"int";case s.onnx.AttributeProto.AttributeType.STRING:return"string";case s.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case s.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case s.onnx.AttributeProto.AttributeType.INTS:return"ints";case s.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case s.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${s.onnx.AttributeProto.AttributeType[d]}`)}}static getValue(et){const d=et instanceof s.onnx.AttributeProto?et.type:et.type();if(d===s.onnx.AttributeProto.AttributeType.GRAPH||d===s.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");const a=this.getValueNoCheck(et);if(d===s.onnx.AttributeProto.AttributeType.INT&&_.LongUtil.isLong(a))return _.LongUtil.longToNumber(a);if(d===s.onnx.AttributeProto.AttributeType.INTS){const g=a,j=new Array(g.length);for(let rt=0;rt<g.length;rt++){const ot=g[rt];j[rt]=_.LongUtil.longToNumber(ot)}return j}if(d===s.onnx.AttributeProto.AttributeType.TENSOR)return et instanceof s.onnx.AttributeProto?h.Tensor.fromProto(a):h.Tensor.fromOrtTensor(a);if(d===s.onnx.AttributeProto.AttributeType.TENSORS){if(et instanceof s.onnx.AttributeProto)return a.map(g=>h.Tensor.fromProto(g));if(et instanceof $.Attribute)return a.map(g=>h.Tensor.fromOrtTensor(g))}if(d===s.onnx.AttributeProto.AttributeType.STRING&&et instanceof s.onnx.AttributeProto){const g=a;return(0,_.decodeUtf8String)(g)}return d===s.onnx.AttributeProto.AttributeType.STRINGS&&et instanceof s.onnx.AttributeProto?a.map(_.decodeUtf8String):a}static getValueNoCheck(et){return et instanceof s.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(et):this.getValueNoCheckFromOrtFormat(et)}static getValueNoCheckFromOnnxFormat(et){switch(et.type){case s.onnx.AttributeProto.AttributeType.FLOAT:return et.f;case s.onnx.AttributeProto.AttributeType.INT:return et.i;case s.onnx.AttributeProto.AttributeType.STRING:return et.s;case s.onnx.AttributeProto.AttributeType.TENSOR:return et.t;case s.onnx.AttributeProto.AttributeType.GRAPH:return et.g;case s.onnx.AttributeProto.AttributeType.FLOATS:return et.floats;case s.onnx.AttributeProto.AttributeType.INTS:return et.ints;case s.onnx.AttributeProto.AttributeType.STRINGS:return et.strings;case s.onnx.AttributeProto.AttributeType.TENSORS:return et.tensors;case s.onnx.AttributeProto.AttributeType.GRAPHS:return et.graphs;default:throw new Error(`unsupported attribute type: ${s.onnx.AttributeProto.AttributeType[et.type]}`)}}static getValueNoCheckFromOrtFormat(et){switch(et.type()){case $.AttributeType.FLOAT:return et.f();case $.AttributeType.INT:return et.i();case $.AttributeType.STRING:return et.s();case $.AttributeType.TENSOR:return et.t();case $.AttributeType.GRAPH:return et.g();case $.AttributeType.FLOATS:return et.floatsArray();case $.AttributeType.INTS:{const d=[];for(let a=0;a<et.intsLength();a++)d.push(et.ints(a));return d}case $.AttributeType.STRINGS:{const d=[];for(let a=0;a<et.stringsLength();a++)d.push(et.strings(a));return d}case $.AttributeType.TENSORS:{const d=[];for(let a=0;a<et.tensorsLength();a++)d.push(et.tensors(a));return d}default:throw new Error(`unsupported attribute type: ${$.AttributeType[et.type()]}`)}}}e.Attribute=nt},7091:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.resolveBackend=e.backend=void 0;const s=o(5038),c=new Map;async function h(_){const $=e.backend;if($[_]!==void 0&&function(nt){const tt=nt;return"initialize"in tt&&typeof tt.initialize=="function"&&"createSessionHandler"in tt&&typeof tt.createSessionHandler=="function"&&"dispose"in tt&&typeof tt.dispose=="function"}($[_])){const nt=$[_];let tt=nt.initialize();if(typeof tt=="object"&&"then"in tt&&(tt=await tt),tt)return c.set(_,nt),nt}}e.backend={webgl:new s.WebGLBackend},e.resolveBackend=async function _($){if(!$)return _(["webgl"]);{const nt=typeof $=="string"?[$]:$;for(const tt of nt){const et=c.get(tt);if(et)return et;const d=await h(tt);if(d)return d}}throw new Error("no available backend to use")}},5038:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLBackend=void 0;const s=o(1670),c=o(6231),h=o(6416),_=o(7305);e.WebGLBackend=class{get contextId(){return s.env.webgl.contextId}set contextId($){s.env.webgl.contextId=$}get matmulMaxBatchSize(){return s.env.webgl.matmulMaxBatchSize}set matmulMaxBatchSize($){s.env.webgl.matmulMaxBatchSize=$}get textureCacheMode(){return s.env.webgl.textureCacheMode}set textureCacheMode($){s.env.webgl.textureCacheMode=$}get pack(){return s.env.webgl.pack}set pack($){s.env.webgl.pack=$}get async(){return s.env.webgl.async}set async($){s.env.webgl.async=$}initialize(){try{return this.glContext=(0,_.createWebGLContext)(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),c.Logger.setWithEnv(s.env),c.Logger.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch($){return c.Logger.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${$}`),!1}}createSessionHandler($){return new h.WebGLSessionHandler(this,$)}dispose(){this.glContext.dispose()}}},5107:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CoordsGlslLib=void 0;const s=o(2517),c=o(8520),h=o(5060),_=o(7859),$=o(9390);class nt extends c.GlslLib{constructor(et){super(et)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new c.GlslLibRoutine(`
      vec2 offsetToCoords(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){return{coordsToOffset:new c.GlslLibRoutine(`
      int coordsToOffset(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){const et=this.context.outputTextureLayout;return et.isPacked?this.getPackedOutputSamplingSnippet(et):this.getUnpackedOutputSamplingSnippet(et)}getPackedOutputSamplingSnippet(et){const d=et.unpackedShape,a=[et.width,et.height],g={},j="getOutputCoords";switch(d.length){case 0:g[j]=this.getOutputScalarCoords();break;case 1:g[j]=this.getOutputPacked1DCoords(d,a);break;case 2:g[j]=this.getOutputPacked2DCoords(d,a);break;case 3:g[j]=this.getOutputPacked3DCoords(d,a);break;default:g[j]=this.getOutputPackedNDCoords(d,a)}const rt=`
      void setOutput(vec4 val) {
        ${(0,h.getGlsl)(this.context.glContext.version).output} = val;
      }
    `;return g.floatTextureSetRGBA=new c.GlslLibRoutine(rt),g}getUnpackedOutputSamplingSnippet(et){const d=et.unpackedShape,a=[et.width,et.height],g={},j="getOutputCoords";switch(d.length){case 0:g[j]=this.getOutputScalarCoords();break;case 1:g[j]=this.getOutputUnpacked1DCoords(d,a);break;case 2:g[j]=this.getOutputUnpacked2DCoords(d,a);break;case 3:g[j]=this.getOutputUnpacked3DCoords(d,a);break;case 4:g[j]=this.getOutputUnpacked4DCoords(d,a);break;case 5:g[j]=this.getOutputUnpacked5DCoords(d,a);break;case 6:g[j]=this.getOutputUnpacked6DCoords(d,a);break;default:throw new Error(`Unsupported output dimensionality: ${d.length}`)}const rt=`
        void setOutput(float val) {
          ${(0,h.getGlsl)(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `;return g.floatTextureSetR=new c.GlslLibRoutine(rt),g}getOutputScalarCoords(){return new c.GlslLibRoutine(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(et,d){const a=d;let g="";return a[0]===1?(g=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${a[1]}.0);
          }
        `,new c.GlslLibRoutine(g)):a[1]===1?(g=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${a[0]}.0);
          }
        `,new c.GlslLibRoutine(g)):(g=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${a[0]}, ${a[1]}));
          return 2 * (resTexRC.y * ${a[0]} + resTexRC.x);
        }
      `,new c.GlslLibRoutine(g))}getOutputPacked2DCoords(et,d){let a="";if(s.ArrayUtil.arraysEqual(et,d))return a=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${d[0]}, ${d[1]}));
        }
      `,new c.GlslLibRoutine(a);const g=d,j=Math.ceil(et[1]/2);return a=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${g[0]}, ${g[1]}));

          int index = resTexRC.y * ${g[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${j}) * 2;
          int c = 2 * (index / ${j});

          return ivec2(r, c);
        }
      `,new c.GlslLibRoutine(a)}getOutputPacked3DCoords(et,d){const a=[d[0],d[1]],g=Math.ceil(et[2]/2),j=g*Math.ceil(et[1]/2),rt=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${a[0]}, ${a[1]}));
          int index = resTexRC.y * ${a[0]} + resTexRC.x;

          int b = index / ${j};
          index -= b * ${j};

          // reverse r and c order for packed texture
          int r = imod(index, ${g}) * 2;
          int c = 2 * (index / ${g});

          return ivec3(b, r, c);
        }
      `;return new c.GlslLibRoutine(rt)}getOutputPackedNDCoords(et,d){const a=[d[0],d[1]],g=Math.ceil(et[et.length-1]/2),j=g*Math.ceil(et[et.length-2]/2);let rt=j,ot="",it="b, r, c";for(let lt=2;lt<et.length-1;lt++)rt*=et[et.length-lt-1],ot=`
      int b${lt} = index / ${rt};
      index -= b${lt} * ${rt};
    `+ot,it=`b${lt}, `+it;const at=`
      ivec${et.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${a[0]}, ${a[1]}));
        int index = resTexRC.y * ${a[0]} + resTexRC.x;

        ${ot}

        int b = index / ${j};
        index -= b * ${j};

        // reverse r and c order for packed texture
        int r = imod(index, ${g}) * 2;
        int c = 2 * (index / ${g});

        return ivec${et.length}(${it});
      }
    `;return new c.GlslLibRoutine(at)}getOutputUnpacked1DCoords(et,d){const a=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${d[0]}, ${d[1]}));
          return resTexRC.y * ${d[0]} + resTexRC.x;
        }
      `;return new c.GlslLibRoutine(a)}getOutputUnpacked2DCoords(et,d){const a=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${d[0]}, ${d[1]}));
          int index = resTexRC.y * ${d[0]} + resTexRC.x;
          int r = index / ${et[1]};
          int c = index - r * ${et[1]};
          return ivec2(r, c);
        }
      `;return new c.GlslLibRoutine(a)}getOutputUnpacked3DCoords(et,d){let a="";const g=et.length;let j=null;g<2&&(j=[]),j=new Array(g-1),j[g-2]=et[g-1];for(let it=g-3;it>=0;--it)j[it]=j[it+1]*et[it+1];const rt=["r","c","d"],ot=j.map((it,at)=>`int ${rt[at]} = index / ${it}; ${at===j.length-1?`int ${rt[at+1]} = index - ${rt[at]} * ${it}`:`index -= ${rt[at]} * ${it}`};`).join("");return a=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${d[0]}, ${d[1]}));
          int index = resTexRC.y * ${d[0]} + resTexRC.x;
          ${ot}
          return ivec3(r, c, d);
        }
      `,new c.GlslLibRoutine(a)}getOutputUnpacked4DCoords(et,d){let a="";const g=et.length;let j=null;g<2&&(j=[]),j=new Array(g-1),j[g-2]=et[g-1];for(let it=g-3;it>=0;--it)j[it]=j[it+1]*et[it+1];const rt=["r","c","d","d2"],ot=j.map((it,at)=>`int ${rt[at]} = index / ${it}; ${at===j.length-1?`int ${rt[at+1]} = index - ${rt[at]} * ${it}`:`index -= ${rt[at]} * ${it}`};`).join("");return a=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${d[0]}, ${d[1]}));
          int index = resTexRC.y * ${d[0]} + resTexRC.x;
          ${ot}
          return ivec4(r, c, d, d2);
        }
      `,new c.GlslLibRoutine(a)}getOutputUnpacked5DCoords(et,d){let a="";const g=et.length;let j=null;g<2&&(j=[]),j=new Array(g-1),j[g-2]=et[g-1];for(let it=g-3;it>=0;--it)j[it]=j[it+1]*et[it+1];const rt=["r","c","d","d2","d3"],ot=j.map((it,at)=>`int ${rt[at]} = index / ${it}; ${at===j.length-1?`int ${rt[at+1]} = index - ${rt[at]} * ${it}`:`index -= ${rt[at]} * ${it}`};`).join("");return a=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${d[0]}, ${d[1]}));
          int index = resTexRC.y * ${d[0]} + resTexRC.x;
          ${ot}
          return ivec5(r, c, d, d2, d3);
        }
      `,new c.GlslLibRoutine(a)}getOutputUnpacked6DCoords(et,d){let a="";const g=et.length;let j=null;g<2&&(j=[]),j=new Array(g-1),j[g-2]=et[g-1];for(let it=g-3;it>=0;--it)j[it]=j[it+1]*et[it+1];const rt=["r","c","d","d2","d3","d4"],ot=j.map((it,at)=>`int ${rt[at]} = index / ${it}; ${at===j.length-1?`int ${rt[at+1]} = index - ${rt[at]} * ${it}`:`index -= ${rt[at]} * ${it}`};`).join("");return a=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${d[0]}, ${d[1]}));
         int index = resTexRC.y * ${d[0]} + resTexRC.x;
         ${ot}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new c.GlslLibRoutine(a)}getCommonUtilFuncs(){const et={};let d="uvFromFlat";et[d]=new c.GlslLibRoutine(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),d="packedUVfrom1D",et[d]=new c.GlslLibRoutine(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),d="packedUVfrom2D",et[d]=new c.GlslLibRoutine(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),d="packedUVfrom3D",et[d]=new c.GlslLibRoutine(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),d="sampleTexture";const a=(0,h.getGlsl)(this.context.glContext.version);return et[d]=new c.GlslLibRoutine(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${a.texture2D}(textureSampler, uv).r;
        }`),et}getInputsSamplingSnippets(){const et={},d=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((a,g)=>{const j=this.context.inputTextureLayouts[g],rt=(0,$.generateShaderFuncNameFromInputSamplerName)(a);j.isPacked?et[rt]=this.getPackedSamplerFromInput(rt,a,j):et[rt]=this.getUnpackedSamplerFromInput(rt,a,j);const ot=(0,$.generateShaderFuncNameFromInputSamplerNameAtOutCoords)(a);j.unpackedShape.length<=d.unpackedShape.length&&(j.isPacked?et[ot]=this.getPackedSamplerAtOutputCoords(ot,j,d,a):et[ot]=this.getUnpackedSamplerAtOutputCoords(ot,j,d,a))}),et}getPackedSamplerAtOutputCoords(et,d,a,g){const j=d.unpackedShape,rt=a.unpackedShape,ot=g,it=(0,$.generateShaderFuncNameFromInputSamplerName)(ot),at=j.length,lt=rt.length,ct=s.BroadcastUtil.getBroadcastDims(j,rt),dt=(0,$.getCoordsDataType)(lt),mt=lt-at;let ht;const ft=(0,$.getGlChannels)();ht=at===0?"":lt<2&&ct.length>=1?"coords = 0;":ct.map(Mt=>`coords.${ft[Mt+mt]} = 0;`).join(`
`);let ut="";ut=lt<2&&at>0?"coords":j.map((Mt,xt)=>`coords.${ft[xt+mt]}`).join(", ");let _t="return outputValue;";const bt=s.ShapeUtil.size(j)===1,vt=s.ShapeUtil.size(rt)===1;if(at!==1||bt||vt){if(bt&&!vt)_t=lt===1?`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:`
          return vec4(outputValue.x);
        `;else if(ct.length){const Mt=at-2,xt=at-1;ct.indexOf(Mt)>-1&&ct.indexOf(xt)>-1?_t="return vec4(outputValue.x);":ct.indexOf(Mt)>-1?_t="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":ct.indexOf(xt)>-1&&(_t="return vec4(outputValue.xx, outputValue.zz);")}}else _t=`
        return vec4(outputValue.xy, outputValue.xy);
      `;const Tt=`
      vec4 ${et}() {
        ${dt} coords = getOutputCoords();
        
        int lastDim = coords.${ft[lt-1]};
        coords.${ft[lt-1]} = coords.${ft[lt-2]};
        coords.${ft[lt-2]} = lastDim;
      
        ${ht}
        vec4 outputValue = ${it}(${ut});
        ${_t}
      }
    `;return new c.GlslLibRoutine(Tt,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(et,d,a,g){const j=[a.width,a.height],rt=[d.width,d.height],ot=d.unpackedShape.length,it=a.unpackedShape.length,at=d.unpackedShape,lt=a.unpackedShape,ct=(0,$.generateShaderFuncNameFromInputSamplerName)(g);if(ot===it&&s.ArrayUtil.arraysEqual(rt,j)){const vt=`
          float ${et}() {
            return sampleTexture(${g}, TexCoords);
          }
        `;return new c.GlslLibRoutine(vt,["coordinates.sampleTexture"])}const dt=(0,$.getCoordsDataType)(it),mt=s.BroadcastUtil.getBroadcastDims(at,lt),ht=it-ot;let ft;const ut=(0,$.getGlChannels)();ft=ot===0?"":it<2&&mt.length>=1?"coords = 0;":mt.map(vt=>`coords.${ut[vt+ht]} = 0;`).join(`
`);let _t="";_t=it<2&&ot>0?"coords":d.unpackedShape.map((vt,Tt)=>`coords.${ut[Tt+ht]}`).join(", ");const bt=`
        float ${et}() {
          ${dt} coords = getOutputCoords();
          ${ft}
          return ${ct}(${_t});
        }
      `;return new c.GlslLibRoutine(bt,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(et,d,a){switch(a.unpackedShape.length){case 0:return this.getPackedSamplerScalar(et,d);case 1:return this.getPackedSampler1D(et,d,a);case 2:return this.getPackedSampler2D(et,d,a);case 3:return this.getPackedSampler3D(et,d,a);default:return this.getPackedSamplerND(et,d,a)}}getUnpackedSamplerFromInput(et,d,a){const g=a.unpackedShape;switch(g.length){case 0:return this.getUnpackedSamplerScalar(et,d,a);case 1:return this.getUnpackedSampler1D(et,d,a);case 2:return this.getUnpackedSampler2D(et,d,a);case 3:return this.getUnpackedSampler3D(et,d,a);case 4:return this.getUnpackedSampler4D(et,d,a);case 5:return this.getUnpackedSampler5D(et,d,a);case 6:return this.getUnpackedSampler6D(et,d,a);default:throw new Error(`Unsupported dimension ${g.length}-D`)}}getPackedSamplerScalar(et,d){const a=`
          vec4 ${et}() {
            return ${(0,h.getGlsl)(this.context.glContext.version).texture2D}(${d}, halfCR);
          }
        `;return new c.GlslLibRoutine(a)}getPackedSampler1D(et,d,a){const g=[a.width,a.height],j=[g[1],g[0]],rt=(0,h.getGlsl)(this.context.glContext.version),ot=`vec4 ${et}(int index) {
      vec2 uv = packedUVfrom1D(
      ${j[0]}, ${j[1]}, index);
      return ${rt.texture2D}(${d}, uv);
    }`;return new c.GlslLibRoutine(ot,["coordinates.packedUVfrom1D"])}getPackedSampler2D(et,d,a){const g=a.unpackedShape,j=[a.width,a.height],rt=(0,h.getGlsl)(this.context.glContext.version),ot=j[0],it=j[1];if(j!=null&&s.ArrayUtil.arraysEqual(g,j)){const dt=`vec4 ${et}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${it}.0, ${ot}.0);
        return ${rt.texture2D}(${d}, uv);
      }`;return new c.GlslLibRoutine(dt)}const at=j,lt=Math.ceil(g[1]/2),ct=`vec4 ${et}(int row, int col) {
      vec2 uv = packedUVfrom2D(${at[1]}, ${at[0]}, ${lt}, row, col);
      return ${rt.texture2D}(${d}, uv);
    }`;return new c.GlslLibRoutine(ct,["coordinates.packedUVfrom2D"])}getPackedSampler3D(et,d,a){const g=a.unpackedShape,j=[a.width,a.height],rt=[j[0],j[1]],ot=(0,h.getGlsl)(this.context.glContext.version);if(g[0]===1){const dt=g.slice(1),mt=[1,2],ht=(0,$.squeezeInputShape)(g,dt),ft=["b","row","col"],ut=JSON.parse(JSON.stringify(a));ut.unpackedShape=ht;const _t=this.getPackedSamplerFromInput(et,d,ut),bt=`${_t.routineBody}
      vec4 ${et}(int b, int row, int col) {
        return ${et}(${(0,$.getSqueezedParams)(ft,mt)});
      } `;return new c.GlslLibRoutine(bt,_t.dependencies)}const it=rt[0],at=rt[1],lt=Math.ceil(g[2]/2),ct=`vec4 ${et}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${at}, ${it}, ${lt*Math.ceil(g[1]/2)}, ${lt}, b, row, col);
      return ${ot.texture2D}(${d}, uv);}`;return new c.GlslLibRoutine(ct,["coordinates.packedUVfrom3D"])}getPackedSamplerND(et,d,a){const g=a.unpackedShape,j=g.length,rt=[a.width,a.height],ot=(0,h.getGlsl)(this.context.glContext.version),it=[rt[0],rt[1]],at=it[1],lt=it[0],ct=Math.ceil(g[j-1]/2);let dt=ct*Math.ceil(g[j-2]/2),mt="int b, int row, int col",ht=`b * ${dt} + (row / 2) * ${ct} + (col / 2)`;for(let ut=2;ut<j-1;ut++)mt=`int b${ut}, `+mt,dt*=g[j-ut-1],ht=`b${ut} * ${dt} + `+ht;const ft=`vec4 ${et}(${mt}) {
      int index = ${ht};
      int texR = index / ${lt};
      int texC = index - texR * ${lt};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${lt}, ${at});
      return ${ot.texture2D}(${d}, uv);
    }`;return new c.GlslLibRoutine(ft)}getUnpackedSamplerScalar(et,d,a){const[g,j]=[a.width,a.height];if(g===1&&j===1){const ot=`
          float ${et}() {
            return sampleTexture(${d}, halfCR);
          }
        `;return new c.GlslLibRoutine(ot,["coordinates.sampleTexture"])}const rt=`
        float ${et}() {
          int offset_${d} = coordsToOffset(TexCoords, ${g}, ${j});
          vec2 uv = uvFromFlat(${g}, ${j}, offset_${d});
          return sampleTexture(${d}, uv);
        }
      `;return new c.GlslLibRoutine(rt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(et,d,a){const g=a.width,j=a.height;if(j===1&&g===1){const ot=`
        float ${et}(int index) {
          return sampleTexture(${d}, halfCR);
        }
      `;return new c.GlslLibRoutine(ot,["coordinates.sampleTexture"])}if(j===1){const ot=`
          float ${et}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${g}.0, 0.5);
            return sampleTexture(${d}, uv);
          }
        `;return new c.GlslLibRoutine(ot,["coordinates.sampleTexture"])}if(g===1){const ot=`
          float ${et}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${j}.0);
            return sampleTexture(${d}, uv);
          }
        `;return new c.GlslLibRoutine(ot,["coordinates.sampleTexture"])}const rt=`
        float ${et}(int index) {
          vec2 uv = uvFromFlat(${g}, ${j}, index);
          return sampleTexture(${d}, uv);
        }
      `;return new c.GlslLibRoutine(rt,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(et,d,a){const g=a.unpackedShape,j=[a.height,a.width];if(j!=null&&s.ArrayUtil.arraysEqual(g,j)){const dt=`
          float ${et}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${j[1]}.0, ${j[0]}.0);
            return sampleTexture(${d}, uv);
          }
        `;return new c.GlslLibRoutine(dt,["coordinates.sampleTexture"])}const{newShape:rt,keptDims:ot}=(0,_.squeezeShape)(g),it=rt;if(it.length<g.length){const dt=(0,$.squeezeInputShape)(g,it),mt=JSON.parse(JSON.stringify(a));mt.unpackedShape=dt;const ht=["col","row"],ft=`
          ${this.getUnpackedSamplerFromInput(et,d,mt).routineBody}
          float ${et}(int row, int col) {
            return ${et}(${(0,$.getSqueezedParams)(ht,ot)});
          }
        `;return new c.GlslLibRoutine(ft,["coordinates.sampleTexture"])}const at=j[1],lt=j[0];if(lt===1){const dt=`
          float ${et}(int row, int col) {
            int offset_${d} = coordsToOffset(TexCoords, ${at}, ${lt});
            float index = dot(vec3(row, col, offset_${d}), vec3(${g[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${at}.0);
            return sampleTexture(${d}, uv);
          }
        `;return new c.GlslLibRoutine(dt,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(at===1){const dt=`
          float ${et}(int row, int col) {
            int offset_${d} = coordsToOffset(TexCoords, ${at}, ${lt});
            float index = dot(vec3(row, col, offset_${d}), vec3(${g[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${lt}.0, 0.5);
            return sampleTexture(${d}, uv);
          }
        `;return new c.GlslLibRoutine(dt,["coordinates.sampleTexture","coordinates.coordsToOffset"])}const ct=`
        float ${et}(int row, int col) {
          int index = col * ${g[1]} + row;
          vec2 uv = uvFromFlat(${at}, ${lt}, index);
          return sampleTexture(${d}, uv);
        }
      `;return new c.GlslLibRoutine(ct,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(et,d,a){const g=a.unpackedShape,j=g[1]*g[2],rt=g[2],{newShape:ot,keptDims:it}=(0,_.squeezeShape)(g),at=ot;if(at.length<g.length){const ct=(0,$.squeezeInputShape)(g,at),dt=["batch","col","row"],mt=JSON.parse(JSON.stringify(a));mt.unpackedShape=ct;const ht=this.getUnpackedSamplerFromInput(et,d,mt),ft=it.reverse(),ut=`
          ${ht.routineBody}
          float ${et}(int batch, int row, int col) {
            return ${et}(${(0,$.getSqueezedParams)(dt,ft)});
          }
        `;return new c.GlslLibRoutine(ut,ht.dependencies)}const lt=`
          float ${et}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${j} + col * ${rt} + row;
            vec2 uv = uvFromFlat(${a.width}, ${a.height}, index);
            return sampleTexture(${d}, uv);
          }
      `;return new c.GlslLibRoutine(lt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(et,d,a){const g=a.unpackedShape,j=g[3],rt=g[2]*j,ot=`
        float ${et}(int row, int col, int depth, int depth2) {
          int index = row * ${g[1]*rt} + col * ${rt} +
              depth2 * ${j} + depth;
          vec2 uv = uvFromFlat(${a.width}, ${a.height}, index);
          return sampleTexture(${d}, uv);
        }
      `;return new c.GlslLibRoutine(ot,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(et,d,a){const g=a.unpackedShape,j=g[4],rt=g[3]*j,ot=g[2]*rt,it=g[1]*ot,{newShape:at,keptDims:lt}=(0,_.squeezeShape)(g);if(at.length<g.length){const dt=(0,$.squeezeInputShape)(g,at),mt=["row","col","depth","depth2","depth3"],ht=JSON.parse(JSON.stringify(a));ht.unpackedShape=dt;const ft=`
          ${this.getUnpackedSamplerFromInput(et,d,ht).routineBody}
          float ${et}(int row, int col, int depth, int depth2, int depth3) {
            return ${et}(${(0,$.getSqueezedParams)(mt,lt)});
          }
        `;return new c.GlslLibRoutine(ft,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const ct=`
        float ${et}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${it} + col * ${ot} + depth * ${rt} +
          depth3 * ${j} + depth2;
          vec2 uv = uvFromFlat(${a.width}, ${a.height}, index);
          return sampleTexture(${d}, uv);
        }
      `;return new c.GlslLibRoutine(ct,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(et,d,a){const g=a.unpackedShape,j=g[5],rt=g[4]*j,ot=g[3]*rt,it=g[2]*ot,at=g[1]*it,{newShape:lt,keptDims:ct}=(0,_.squeezeShape)(g);if(lt.length<g.length){const mt=(0,$.squeezeInputShape)(g,lt),ht=["row","col","depth","depth2","depth3","depth4"],ft=JSON.parse(JSON.stringify(a));ft.unpackedShape=mt;const ut=`
            ${this.getUnpackedSamplerFromInput(et,d,ft).routineBody}
            float ${et}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${et}(${(0,$.getSqueezedParams)(ht,ct)});
            }
          `;return new c.GlslLibRoutine(ut,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const dt=`
          float ${et}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${at} + col * ${it} + depth * ${ot} +
            depth2 * ${rt} + depth3 * ${j} + depth4;
            vec2 uv = uvFromFlat(${a.width}, ${a.height}, index);
            return sampleTexture(${d}, uv);
          }
        `;return new c.GlslLibRoutine(dt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){const et=this.context.outputTextureLayout,d=et.shape.length,a=et.strides,g=et.width,j=et.height,rt=[];for(let it=0;it<d-1;++it)rt.push(`
        c[${it}] = offset / ${a[it]};`),rt.push(`
        offset -= c[${it}] * ${a[it]};`);rt.push(`
        c[${d-1}] = offset;`);const ot=`
      void toVec(vec2 texCoords, out int c[${d}]) {
        int offset = coordsToOffset(texCoords, ${g}, ${j});
        ${rt.join("")}
      }
      void toVec(int offset, out int c[${d}]) {
        ${rt.join("")}
      }
    `;return{toVec:new c.GlslLibRoutine(ot,["coordinates.coordsToOffset"])}}valueFrom(){const et={};return this.context.programInfo.inputNames.forEach((d,a)=>{const g=this.context.inputTextureLayouts[a],j=(g.unpackedShape.length>0?g.unpackedShape:g.shape).length;let rt=`_${d}`;et[rt]=new c.GlslLibRoutine(this.getValueFromSingle(d,j,g.width,g.height,!1),[`shapeUtils.indicesToOffset${rt}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),rt+="_T",et[rt]=new c.GlslLibRoutine(this.getValueFromSingle(d,j,g.width,g.height,!0),[`shapeUtils.indicesToOffset${rt}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),et}getValueFromSingle(et,d,a,g,j){let rt=`_${et}`;return j&&(rt+="_T"),`
        float ${rt}(int m[${d}]) {
          int offset = indicesToOffset${rt}(m);
          vec2 coords = offsetToCoords(offset, ${a}, ${g});
          float value = getColorAsFloat(${(0,h.getGlsl)(this.context.glContext.version).texture2D}(${et}, coords));
          return value;
        }
        `}getPackedValueFrom(et,d,a,g,j){let rt=`_${et}_Pack`;return j&&(rt+="_T"),`
        vec4 ${rt}(int m[${d}]) {
          int offset = indicesToOffset_${et}(m);
          vec2 coords = offsetToCoords(offset, ${a}, ${g});
          return ${(0,h.getGlsl)(this.context.glContext.version).texture2D}(${et}, coords);
        }
        `}}e.CoordsGlslLib=nt},8520:(i,e)=>{var o;Object.defineProperty(e,"__esModule",{value:!0}),e.TopologicalSortGlslRoutines=e.GlslLibRoutineNode=e.GlslLibRoutine=e.GlslLib=e.GlslContext=e.FunctionType=void 0,(o=e.FunctionType||(e.FunctionType={}))[o.ValueBased=0]="ValueBased",o[o.Positional=1]="Positional",e.GlslContext=class{constructor(s,c,h,_){this.glContext=s,this.programInfo=c,this.inputTextureLayouts=h,this.outputTextureLayout=_}},e.GlslLib=class{constructor(s){this.context=s}},e.GlslLibRoutine=class{constructor(s,c){this.routineBody=s,this.dependencies=c}},e.GlslLibRoutineNode=class{constructor(s,c,h){this.name=s,this.dependencies=h||[],c&&(this.routineBody=c)}addDependency(s){s&&this.dependencies.push(s)}},e.TopologicalSortGlslRoutines=class{static returnOrderedNodes(s){if(!s||s.length===0)return[];if(s.length===1)return s;const c=new Set,h=new Set,_=new Array;return this.createOrderedNodes(s,c,h,_),_}static createOrderedNodes(s,c,h,_){for(let $=0;$<s.length;++$)this.dfsTraverse(s[$],c,h,_)}static dfsTraverse(s,c,h,_){if(!s||h.has(s.name))return;if(c.has(s.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");c.add(s.name);const $=s.dependencies;if($&&$.length>0)for(let nt=0;nt<$.length;++nt)this.dfsTraverse($[nt],c,h,_);_.push(s),h.add(s.name),c.delete(s.name)}}},7341:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EncodingGlslLib=void 0;const s=o(8520);class c extends s.GlslLib{constructor(_){super(_)}getFunctions(){return Object.assign(Object.assign({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new s.GlslLibRoutine(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new s.GlslLibRoutine(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){const _=c.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new s.GlslLibRoutine(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${_}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){const _=c.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new s.GlslLibRoutine(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${_}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){const _=new ArrayBuffer(4),$=new Uint32Array(_),nt=new Uint8Array(_);if($[0]=3735928559,nt[0]===239)return!0;if(nt[0]===222)return!1;throw new Error("unknown endianness")}}e.EncodingGlslLib=c},9894:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FragColorGlslLib=void 0;const s=o(8520),c=o(5060);class h extends s.GlslLib{constructor($){super($)}getFunctions(){return Object.assign(Object.assign({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){const $=(0,c.getGlsl)(this.context.glContext.version);return{setFragColor:new s.GlslLibRoutine(`
        void setFragColor(float value) {
            ${$.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new s.GlslLibRoutine(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}e.FragColorGlslLib=h},2848:(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.replaceInlines=void 0;const o=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm;e.replaceInlines=function(s){const c={};let h;for(;(h=o.exec(s))!==null;){const _=h[3].split(",").map($=>{const nt=$.trim().split(" ");return nt&&nt.length===2?{type:nt[0],name:nt[1]}:null}).filter($=>$!==null);c[h[2]]={params:_,body:h[4]}}for(const _ in c){const $="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;".replace("__FUNC__",_),nt=new RegExp($,"gm");for(;(h=nt.exec(s))!==null;){const tt=h[1],et=h[2],d=h[3].split(","),a=tt?`${tt} ${et};`:"";let g=c[_].body,j="";c[_].params.forEach((ot,it)=>{ot&&(j+=`${ot.type} ${ot.name} = ${d[it]};
`)}),g=`${j}
 ${g}`,g=g.replace("return",`${et} = `);const rt=`
      ${a}
      {
        ${g}
      }
      `;s=s.replace(h[0],rt)}}return s.replace(o,"")}},8879:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlslPreprocessor=void 0;const s=o(8520),c=o(2848),h=o(5483),_=o(5060);e.GlslPreprocessor=class{constructor($,nt,tt,et){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new s.GlslContext($,nt,tt,et),Object.keys(h.glslRegistry).forEach(a=>{const g=new h.glslRegistry[a](this.context);this.libs[a]=g});const d=this.glslLibRoutineDependencyGraph;for(const a in this.libs){const g=this.libs[a].getFunctions();for(const j in g){const rt=a+"."+j;let ot;d[rt]?(ot=d[rt],ot.routineBody=g[j].routineBody):(ot=new s.GlslLibRoutineNode(rt,g[j].routineBody),d[rt]=ot);const it=g[j].dependencies;if(it)for(let at=0;at<it.length;++at)if(d[it[at]])ot.addDependency(d[it[at]]);else{const lt=new s.GlslLibRoutineNode(it[at]);d[it[at]]=lt,ot.addDependency(lt)}}}}preprocess(){const $=this.context.programInfo;let nt=$.shaderSource;return this.context.programInfo.hasMain||(nt=`${nt}
      ${(0,_.getDefaultFragShaderMain)(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),nt=(0,c.replaceInlines)(nt),`${(0,_.getFragShaderPreamble)(this.context.glContext.version)}
    ${this.getUniforms($.inputNames,$.variables)}
    ${this.getImports(nt)}
    ${nt}`}getImports($){const nt=this.selectGlslLibRoutinesToBeIncluded($);if(nt.length===0)return"";let tt="";for(let et=0;et<nt.length;++et){if(!nt[et].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${nt[et].name}`);tt+=nt[et].routineBody+`
`}return tt}selectGlslLibRoutinesToBeIncluded($){const nt=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(tt=>{const et=tt.split(".")[1];$.indexOf(et)!==-1&&nt.push(this.glslLibRoutineDependencyGraph[tt])}),s.TopologicalSortGlslRoutines.returnOrderedNodes(nt)}getUniforms($,nt){const tt=[];if($)for(const et of $)tt.push(`uniform sampler2D ${et};`);if(nt)for(const et of nt)tt.push(`uniform ${et.type} ${et.name}${et.arrayLength?`[${et.arrayLength}]`:""};`);return tt.join(`
`)}}},5483:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.glslRegistry=void 0;const s=o(5107),c=o(7341),h=o(9894),_=o(2655),$=o(3891);e.glslRegistry={encoding:c.EncodingGlslLib,fragcolor:h.FragColorGlslLib,vec:$.VecGlslLib,shapeUtils:_.ShapeUtilsGlslLib,coordinates:s.CoordsGlslLib}},2655:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeUtilsGlslLib=void 0;const s=o(8520);class c extends s.GlslLib{constructor(_){super(_)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){const _=this.context.outputTextureLayout.shape.length,$={};return this.context.programInfo.inputNames.forEach((nt,tt)=>{const et=this.context.inputTextureLayouts[tt].unpackedShape;if(et.length<=_){const d=et.length,a=_-d,g=`bcastIndices_${nt}`;let j="";for(let ot=0;ot<d;++ot)j+=`
          realIndices[${ot}] = int( mod(float(bcastedIndices[${a+ot}]), ${et[ot]}.0) );
          `;const rt=`
        void ${g} (int bcastedIndices[${_}], out int realIndices[${d}]) {
          ${j}
        }
        `;$[g]=new s.GlslLibRoutine(rt)}}),$}bcastMatmulIndex(){const _=this.context.outputTextureLayout.shape.length,$={};return this.context.programInfo.inputNames.forEach((nt,tt)=>{const et=this.context.inputTextureLayouts[tt].shape;if(!(et.length<2||et.length>_)){const d=et.length,a=_-d,g=`bcastMatmulIndices_${nt}`;let j="";for(let ot=0;ot<d-2;++ot)j+=`
          realIndices[${ot}] = int( mod(float(bcastedIndices[${a+ot}]), ${et[ot]}.0) );
          `;const rt=`
        void ${g}(int bcastedIndices[${_}], out int realIndices[${d}]) {
          ${j}
          realIndices[${d-1}] = bcastedIndices[${_-1}];
          realIndices[${d-2}] = bcastedIndices[${_-2}];
        }
        `;$[g]=new s.GlslLibRoutine(rt)}}),$}indicesToOffset(){const _={};return this.context.programInfo.inputNames.forEach(($,nt)=>{const tt=this.context.inputTextureLayouts[nt].shape,et=this.context.inputTextureLayouts[nt].strides,d=tt.length;let a=`indicesToOffset_${$}`;_[a]=new s.GlslLibRoutine(c.indexToOffsetSingle(a,d,et)),a=`indicesToOffset_${$}_T`,_[a]=new s.GlslLibRoutine(c.indexToOffsetSingle(a,d,et.slice().reverse()))}),_}static indexToOffsetSingle(_,$,nt){let tt="";for(let et=$-1;et>=0;--et)tt+=`
        offset += indices[${et}] * ${nt[et]};
        `;return`
      int ${_}(int indices[${$}]) {
        int offset = 0;
        ${tt}
        return offset;
      }
      `}offsetToIndices(){const _={};return this.context.programInfo.inputNames.forEach(($,nt)=>{const tt=this.context.inputTextureLayouts[nt].shape,et=this.context.inputTextureLayouts[nt].strides,d=tt.length;let a=`offsetToIndices_${$}`;_[a]=new s.GlslLibRoutine(c.offsetToIndicesSingle(a,d,et)),a=`offsetToIndices_${$}_T`,_[a]=new s.GlslLibRoutine(c.offsetToIndicesSingle(a,d,et.slice().reverse()))}),_}static offsetToIndicesSingle(_,$,nt){const tt=[];for(let et=0;et<$-1;++et)tt.push(`
      indices[${et}] = offset / ${nt[et]};`),tt.push(`
        offset -= indices[${et}] * ${nt[et]};`);return tt.push(`
      indices[${$-1}] = offset;`),`
      void ${_}(int offset, out int indices[${$}]) {
        ${tt.join("")}
      }
      `}incrementIndices(){const _={};return this.context.programInfo.inputNames.forEach(($,nt)=>{const tt=this.context.inputTextureLayouts[nt].shape,et=tt.length,d=`incrementIndices_${$}`;let a="";for(let j=0;j<et;++j)a+=`
        shape[${j}] = ${tt[j]};`;const g=`
        void ${d}(int axis, out int indices[${et}]) {
          int shape[${et}];
          ${a};
          for(int i = ${et} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;_[d]=new s.GlslLibRoutine(g)}),_}}e.ShapeUtilsGlslLib=c},5060:(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultFragShaderMain=e.getFragShaderPreamble=e.getVertexShaderSource=e.getGlsl=void 0;const o={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},s={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};function c(h){return h===1?o:s}e.getGlsl=c,e.getVertexShaderSource=function(h){const _=c(h);return`${_.version}
      precision highp float;
      ${_.attribute} vec3 position;
      ${_.attribute} vec2 textureCoord;

      ${_.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`},e.getFragShaderPreamble=function(h){const _=c(h);return`${_.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${_.varyingFrag} vec2 TexCoords;
    ${_.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `},e.getDefaultFragShaderMain=function(h,_){return`
  void main() {
    int indices[${_}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${c(h).output} = result;
  }
  `}},3891:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VecGlslLib=void 0;const s=o(8520);class c extends s.GlslLib{constructor(_){super(_)}getCustomTypes(){return{}}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){const _=this.context.outputTextureLayout.shape.length,$={add:"+=",sub:"-=",mul:"*=",div:"/="},nt={};for(const tt in $){const et=`${tt}Vec`;let d="";for(let g=0;g<_;++g)d+=`
          dest[${g}] ${$[tt]} src[${g}];
          `;const a=`
        void ${et}(int src[${_}], out int dest[${_}]) {
          ${d}
        }
        `;nt[et]=new s.GlslLibRoutine(a)}return nt}copyVec(){const _=this.context.outputTextureLayout.shape.length;let $="";for(let tt=0;tt<_;++tt)$+=`
        dest[${tt}] = src[${tt}];
        `;const nt=`
      void copyVec(int src[${_}], out int dest[${_}]) {
        ${$}
      }
      `;return{copyVec:new s.GlslLibRoutine(nt)}}setVecItem(){const _=this.context.outputTextureLayout.shape.length;let $=`
        if(index < 0)
            index =${_} + index;
        if (index == 0)
            m[0] = value;
        `;for(let tt=1;tt<_-1;++tt)$+=`
        else if (index == ${tt})
            m[${tt}] = value;
            `;$+=`
        else
            m[${_-1}] = value;
        `;const nt=`
      void setVecItem(out int m[${_}], int index, int value) {
        ${$}
      }
        `;return{setVecItem:new s.GlslLibRoutine(nt)}}getVecItem(){const _=this.context.outputTextureLayout.shape.length;let $=`
        if(index < 0)
            index = ${_} + index;
        if (index == 0)
            return m[0];
      `;for(let tt=1;tt<_-1;++tt)$+=`
        else if (index == ${tt})
            return m[${tt}];
      `;$+=`
        else
            return m[${_-1}];
        `;const nt=`
      int getVecItem(int m[${_}], int index) {
        ${$}
      }
    `;return{getVecItem:new s.GlslLibRoutine(nt)}}}e.VecGlslLib=c},8316:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLInferenceHandler=void 0;const s=o(6231),c=o(9162),h=o(2517),_=o(2403),$=o(7019),nt=o(8710),tt=o(5611),et=o(4057),d=o(2039);e.WebGLInferenceHandler=class{constructor(a){this.session=a,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(a,g){return(0,et.calculateTextureWidthAndHeight)(this.session.layoutStrategy,a,g)}executeProgram(a,g){if(g.length<a.inputNames.length)throw new Error(`Input size mustn't be less than ${a.inputNames.length}.`);if(a.inputNames.length!==a.inputTypes.length)throw new Error("input names size does not match input types");const j=[];for(let ct=0;ct<a.inputNames.length;++ct)j[ct]=this.getOrCreateTextureData(g[ct],a.inputTypes[ct]);const rt=((ct,dt)=>{const mt=dt.map(ft=>`${ft.unpackedShape.join(",")};${ft.width}x${ft.height}`).join("_");let ht=ct.name;return ct.cacheHint&&(ht+="["+ct.cacheHint+"]"),ht+=":"+mt,ht})(a,j);let ot=this.session.programManager.getArtifact(rt);const it=ot?ot.programInfo:typeof a.get=="function"?a.get():a,at=(0,et.createTextureLayoutFromTextureType)(this.session.layoutStrategy,it.output.dims,it.output.textureType),lt=this.createTextureData(at,it.output.type);return ot||(ot=this.session.programManager.build(it,j,lt),this.session.programManager.setArtifact(rt,ot)),this.runProgram(ot,j,lt),lt}run(a,g){return this.executeProgram(a,g).tensor}runProgram(a,g,j){for(let rt=0;rt<g.length;++rt)if(!!g[rt].isPacked!=(a.programInfo.inputTypes[rt]===d.TextureType.packed))throw new Error(`input[${rt}] property packed inconsistent`);if(!!j.isPacked!=(a.programInfo.output.textureType===d.TextureType.packed))throw new Error("output property packed inconsistent");this.session.programManager.run(a,g,j)}getOrCreateTextureData(a,g){let j=this.getTextureData(a.dataId,g===d.TextureType.packed);if(!j&&(j=this.getTextureData(a.dataId,g!==d.TextureType.packed),j))return g===d.TextureType.packed?this.pack(j):this.unpack(j);if(!j){const rt=(0,et.createTextureLayoutFromTextureType)(this.session.layoutStrategy,a.dims,g);if(g===d.TextureType.packedLastDimension){const at=a.dims;if(at.length===4){const lt=[at[0],Math.ceil(at[1]*at[2]*at[3]/4)],ct=(0,et.createTextureLayoutFromTextureType)(this.session.layoutStrategy,lt,g);let dt=a.numberData;if(at[1]*at[2]*at[3]%4!=0){const mt=at[0],ht=at[1]*at[2]*at[3],ft=Math.ceil(ht*1/4)*4;dt=new Float32Array(mt*ft);for(let ut=0;ut<mt;++ut){const _t=ut*ht,bt=ut*ft+ut%1*ht;dt.set(a.numberData.subarray(_t,_t+ht),bt)}}return this.createTextureData(ct,a.type,dt,a,1)}}if(g===d.TextureType.packed){const ot=(0,et.createTextureLayoutFromShape)(this.session.layoutStrategy,a.dims,1,[],{reverseWH:!0}),it=this.createTextureData(ot,a.type,a.numberData,a,1);j=this.pack(it)}else j=this.createTextureData(rt,a.type,a.numberData,a,1)}return j}createTextureDataFromLayoutBindTensor(a,g,j,rt){return this.createTextureData(a,g,j,rt,1)}createTextureData(a,g,j,rt,ot){s.Logger.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(a)}]`);const it=this.session.textureManager.createTextureFromLayout(g,a,j,ot);return this.createTextureDataFromTexture(a,g,it,rt)}reshapeUnpacked(a,g){const j=this.getOrCreateTextureData(a,d.TextureType.unpacked),rt={channels:j.channels,height:j.height,width:j.width,shape:g.length!==0?g:[1],strides:h.ShapeUtil.computeStrides(g),unpackedShape:g};return this.createTextureDataFromTexture(rt,a.type,j.texture).tensor}reshapePacked(a,g){const j=this.getOrCreateTextureData(a,d.TextureType.packed);if((0,$.isReshapeCheap)(a.dims,g)){const lt={channels:j.channels,height:j.height,width:j.width,shape:g.length!==0?g:[1],strides:h.ShapeUtil.computeStrides(g),unpackedShape:g,isPacked:!0};return this.createTextureDataFromTexture(lt,a.type,j.texture).tensor}const rt=(0,$.processDims3D)(a.dims),ot=(0,$.processDims3D)(g),it=this.reshapePacked(a,rt),at=this.run((0,$.createPackedReshape3DProgramInfoLoader)(this,it,ot),[it]);return this.reshapePacked(at,g)}cast(a,g){const j=this.getOrCreateTextureData(a,d.TextureType.unpacked);return this.createTextureDataFromTexture(j,g,j.texture).tensor}createTextureDataFromTexture(a,g,j,rt,ot){const it=Object.assign(Object.assign({},a),{tensor:rt||new c.Tensor(a.unpackedShape,g,at=>this.readTexture(it),async at=>this.readTextureAsync(it),void 0,ot),texture:j});return this.setTextureData(it.tensor.dataId,it,a.isPacked),it}getTextureData(a,g=!1){return this.session.isInitializer(a)?this.session.getTextureData(a,g):g?this.packedTextureDataCache.get(a):this.unpackedTextureDataCache.get(a)}setTextureData(a,g,j=!1){this.session.isInitializer(a)?this.session.setTextureData(a,g,j):(j?this.packedTextureDataCache:this.unpackedTextureDataCache).set(a,g)}isTextureLayoutCached(a,g=!1){return!!this.getTextureData(a.dataId,g)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(a=>this.session.textureManager.releaseTexture(a)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(a=>this.session.textureManager.releaseTexture(a)),this.unpackedTextureDataCache=new Map}readTexture(a){return a.isPacked?this.readTexture(this.unpack(a)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(a,a.tensor.type,a.channels):this.session.textureManager.readUint8TextureAsFloat((0,nt.encodeAsUint8)(this,a))}async readTextureAsync(a){return a.isPacked?this.readTextureAsync(this.unpack(a)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(a,a.tensor.type,a.channels):this.session.textureManager.readUint8TextureAsFloat((0,nt.encodeAsUint8)(this,a))}pack(a){return this.executeProgram((0,_.createPackProgramInfoLoader)(this,a.tensor),[a.tensor])}unpack(a){return this.executeProgram((0,tt.createUnpackProgramInfoLoader)(this,a.tensor),[a.tensor])}}},1640:function(i,e,o){var s=this&&this.__createBinding||(Object.create?function(Ct,Gt,Wt,Qt){Qt===void 0&&(Qt=Wt);var nn=Object.getOwnPropertyDescriptor(Gt,Wt);nn&&!("get"in nn?!Gt.__esModule:nn.writable||nn.configurable)||(nn={enumerable:!0,get:function(){return Gt[Wt]}}),Object.defineProperty(Ct,Qt,nn)}:function(Ct,Gt,Wt,Qt){Qt===void 0&&(Qt=Wt),Ct[Qt]=Gt[Wt]}),c=this&&this.__setModuleDefault||(Object.create?function(Ct,Gt){Object.defineProperty(Ct,"default",{enumerable:!0,value:Gt})}:function(Ct,Gt){Ct.default=Gt}),h=this&&this.__importStar||function(Ct){if(Ct&&Ct.__esModule)return Ct;var Gt={};if(Ct!=null)for(var Wt in Ct)Wt!=="default"&&Object.prototype.hasOwnProperty.call(Ct,Wt)&&s(Gt,Ct,Wt);return c(Gt,Ct),Gt};Object.defineProperty(e,"__esModule",{value:!0}),e.WEBGL_OP_RESOLVE_RULES=void 0;const _=o(2898),$=h(o(7839)),nt=o(4196),tt=o(2069),et=o(8138),d=o(9663),a=o(5193),g=o(7992),j=o(1253),rt=o(4776),ot=o(6572),it=o(3346),at=o(5623),lt=o(2870),ct=o(2143),dt=o(4939),mt=o(718),ht=o(2268),ft=o(8117),ut=o(2278),_t=o(5524),bt=o(5975),vt=o(3933),Tt=o(6558),Mt=o(5723),xt=o(3738),Pt=h(o(4909)),It=o(8428),Dt=o(9793);e.WEBGL_OP_RESOLVE_RULES=[["Abs","","6+",Pt.abs],["Acos","","7+",Pt.acos],["Add","","7+",$.add],["And","","7+",$.and],["Asin","","7+",Pt.asin],["Atan","","7+",Pt.atan],["AveragePool","","7+",ct.averagePool,ct.parseAveragePoolAttributes],["BatchNormalization","","7+",_.batchNormalization,_.parseBatchNormalizationAttributes],["Cast","","6+",nt.cast,nt.parseCastAttributes],["Ceil","","6+",Pt.ceil],["Clip","","6-10",Pt.clip,Pt.parseClipAttributes],["Clip","","11+",Pt.clipV11],["Concat","","4+",tt.concat,tt.parseConcatAttributes],["Conv","","1+",et.conv,et.parseConvAttributes],["ConvTranspose","","1+",d.convTranspose,d.parseConvTransposeAttributes],["Cos","","7+",Pt.cos],["Div","","7+",$.div],["Dropout","","7+",Pt.identity],["DepthToSpace","","1+",a.depthToSpace,a.parseDepthToSpaceAttributes],["Equal","","7+",$.equal],["Elu","","6+",Pt.elu,Pt.parseEluAttributes],["Exp","","6+",Pt.exp],["Flatten","","1+",g.flatten,g.parseFlattenAttributes],["Floor","","6+",Pt.floor],["FusedConv","com.microsoft","1+",et.conv,et.parseConvAttributes],["Gather","","1+",j.gather,j.parseGatherAttributes],["Gemm","","7-10",rt.gemm,rt.parseGemmAttributesV7],["Gemm","","11+",rt.gemm,rt.parseGemmAttributesV11],["GlobalAveragePool","","1+",ct.globalAveragePool,ct.parseGlobalAveragePoolAttributes],["GlobalMaxPool","","1+",ct.globalMaxPool],["Greater","","7+",$.greater],["Identity","","1+",Pt.identity],["ImageScaler","","1+",ot.imageScaler,ot.parseImageScalerAttributes],["InstanceNormalization","","6+",it.instanceNormalization,it.parseInstanceNormalizationAttributes],["LeakyRelu","","6+",Pt.leakyRelu,Pt.parseLeakyReluAttributes],["Less","","7+",$.less],["Log","","6+",Pt.log],["MatMul","","1+",at.matMul,at.parseMatMulAttributes],["MaxPool","","1+",ct.maxPool,ct.parseMaxPoolAttributes],["Mul","","7+",$.mul],["Neg","","6+",Pt.neg],["Not","","1+",Pt.not],["Or","","7+",$.or],["Pad","","2-10",lt.padV2,lt.parsePadAttributesV2],["Pad","","11+",lt.padV11,lt.parsePadAttributesV11],["Pow","","7+",$.pow],["PRelu","","7+",$.pRelu],["ReduceLogSum","","1+",dt.reduceLogSum,dt.parseReduceAttributes],["ReduceMax","","1+",dt.reduceMax,dt.parseReduceAttributes],["ReduceMean","","1+",dt.reduceMean,dt.parseReduceAttributes],["ReduceMin","","1+",dt.reduceMin,dt.parseReduceAttributes],["ReduceProd","","1+",dt.reduceProd,dt.parseReduceAttributes],["ReduceSum","","1-12",dt.reduceSum,dt.parseReduceAttributes],["ReduceSumSquare","","1+",dt.reduceLogSumSquare,dt.parseReduceAttributes],["Relu","","6+",Pt.relu],["Reshape","","5+",mt.reshape],["Resize","","10",ht.resize,ht.parseResizeAttributesV10],["Resize","","11+",ht.resize,ht.parseResizeAttributesV11],["Shape","","1+",ft.shape],["Sigmoid","","6+",Pt.sigmoid],["Sin","","7+",Pt.sin],["Slice","","10+",ut.sliceV10],["Slice","","1-9",ut.slice,ut.parseSliceAttributes],["Softmax","","1-12",_t.softmax,_t.parseSoftmaxAttributes],["Softmax","","13+",_t.softmaxV13,_t.parseSoftmaxAttributesV13],["Split","","2-12",bt.split,bt.parseSplitAttributes],["Sqrt","","6+",Pt.sqrt],["Squeeze","","1-12",vt.squeeze,vt.parseSqueezeAttributes],["Squeeze","","13+",vt.squeezeV13],["Sub","","7+",$.sub],["Sum","","6+",Tt.sum],["Tan","","7+",Pt.tan],["Tanh","","6+",Pt.tanh],["Tile","","6+",Mt.tile],["Transpose","","1+",xt.transpose,xt.parseTransposeAttributes],["Upsample","","7-8",Dt.upsample,Dt.parseUpsampleAttributesV7],["Upsample","","9",Dt.upsample,Dt.parseUpsampleAttributesV9],["Unsqueeze","","1-12",It.unsqueeze,It.parseUnsqueezeAttributes],["Unsqueeze","","13+",It.unsqueezeV13],["Xor","","7+",$.xor]]},2898:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseBatchNormalizationAttributes=e.batchNormalization=void 0;const s=o(246),c=o(5060),h=o(2039),_={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[h.TextureType.unpacked,h.TextureType.unpacked,h.TextureType.unpacked,h.TextureType.unpacked,h.TextureType.unpacked]};e.batchNormalization=(tt,et,d)=>(nt(et),[tt.run(Object.assign(Object.assign({},_),{cacheHint:d.cacheKey,get:()=>$(tt,et,d)}),et)]),e.parseBatchNormalizationAttributes=tt=>{const et=tt.attributes.getFloat("epsilon",1e-5),d=tt.attributes.getFloat("momentum",.9),a=tt.attributes.getInt("spatial",1);return(0,s.createAttributeWithCacheKey)({epsilon:et,momentum:d,spatial:a})};const $=(tt,et,d)=>{const a=(0,c.getGlsl)(tt.session.backend.glContext.version),g=et[0].dims.length,[j,rt]=tt.calculateTextureWidthAndHeight(et[1].dims,h.TextureType.unpacked),ot=`
  float process(int[${g}] indices) {
    vec2 position = offsetToCoords(indices[1], ${j}, ${rt});
    float scale = getColorAsFloat(${a.texture2D}(Scale, position));
    float mean = getColorAsFloat(${a.texture2D}(Mean, position));
    float variance = getColorAsFloat(${a.texture2D}(Variance, position));
    float b = getColorAsFloat(${a.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${d.epsilon})) ) + b;
  }`;return Object.assign(Object.assign({},_),{output:{dims:et[0].dims,type:et[0].type,textureType:h.TextureType.unpacked},shaderSource:ot})},nt=tt=>{if(!tt||tt.length!==5)throw new Error("BatchNormalization requires 5 inputs.");const et=tt[0],d=tt[1],a=tt[2],g=tt[3],j=tt[4];if(et.dims.length<3||d.dims.length!==1||a.dims.length!==1||g.dims.length!==1||j.dims.length!==1)throw new Error("invalid input shape.");if(d.dims[0]!==et.dims[1]||a.dims[0]!==et.dims[1]||g.dims[0]!==et.dims[1]||j.dims[0]!==et.dims[1])throw new Error("invalid input shape.");if(et.type!=="float32"&&et.type!=="float64"||d.type!=="float32"&&d.type!=="float64"||a.type!=="float32"&&a.type!=="float64"||g.type!=="float32"&&g.type!=="float64"||j.type!=="float32"&&j.type!=="float64")throw new Error("invalid input tensor types.")}},7839:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.xor=e.sub=e.pRelu=e.pow=e.or=e.mul=e.less=e.greater=e.equal=e.div=e.and=e.add=e.glslPRelu=e.glslPow=e.glslXor=e.glslOr=e.glslAnd=e.glslLess=e.glslGreater=e.glslEqual=e.glslSub=e.glslMul=e.glslDiv=e.glslAdd=void 0;const s=o(2517),c=o(8520),h=o(5060),_=o(2039);function $(){const dt="add_";return{body:`
  float ${dt}(float a, float b) {
    return a + b;
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function nt(){const dt="div_";return{body:`
  float ${dt}(float a, float b) {
    return a / b;
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function tt(){const dt="mul_";return{body:`
  float ${dt}(float a, float b) {
    return a * b;
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function et(){const dt="sub_";return{body:`
  float ${dt}(float a, float b) {
    return a - b;
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function d(){const dt="equal_";return{body:`
  float ${dt}(float a, float b) {
    return float(a == b);
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function a(){const dt="greater_";return{body:`
  float ${dt}(float a, float b) {
    return float(a > b);
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function g(){const dt="less_";return{body:`
  float ${dt}(float a, float b) {
    return float(a < b);
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function j(){const dt="and_";return{body:`
  float ${dt}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function rt(){const dt="or_";return{body:`
  float ${dt}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function ot(){const dt="xor_";return{body:`
  float ${dt}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:dt,type:c.FunctionType.ValueBased}}function it(){return function(dt){const mt=`${dt}_`;return{body:`
  float ${mt}(float a, float b) {
    return ${dt}(a, b);
  }
  vec4 ${mt}(vec4 v1, vec4 v2) {
    return ${dt}(v1, v2);
  }
  `,name:mt,type:c.FunctionType.ValueBased}}("pow")}function at(){const dt="prelu_";return{body:`
  float ${dt}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${dt}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:dt,type:c.FunctionType.ValueBased}}e.glslAdd=$,e.glslDiv=nt,e.glslMul=tt,e.glslSub=et,e.glslEqual=d,e.glslGreater=a,e.glslLess=g,e.glslAnd=j,e.glslOr=rt,e.glslXor=ot,e.glslPow=it,e.glslPRelu=at;const lt=(dt,mt,ht,ft=mt[0].type,ut)=>{const _t=dt.session.pack?_.TextureType.packed:_.TextureType.unpacked;return{name:ht.name,inputNames:["A","B"],inputTypes:[_t,_t],cacheHint:ut,get:()=>ct(dt,mt,ht,ft)}},ct=(dt,mt,ht,ft=mt[0].type)=>{const ut=dt.session.pack?_.TextureType.packed:_.TextureType.unpacked,_t=!s.ShapeUtil.areEqual(mt[0].dims,mt[1].dims);let bt=mt[0].dims;const vt=dt.session.pack;if(_t){const xt=s.BroadcastUtil.calcShape(mt[0].dims,mt[1].dims,!1);if(!xt)throw new Error("Can't perform binary op on the given tensors");bt=xt;const Pt=bt.length,It=mt[0].dims.length!==0?mt[0].dims.length:1,Dt=mt[1].dims.length!==0?mt[1].dims.length:1,Ct=mt[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",Gt=mt[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",Wt=(0,h.getGlsl)(dt.session.backend.glContext.version),Qt=vt?`
      ${ht.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${ht.name}(a, b);
        ${Wt.output} = result;
      }`:`
      ${ht.body}
      float process(int indices[${Pt}]) {
        int aindices[${It}];
        int bindices[${Dt}];
        ${Ct}
        ${Gt}
        return ${ht.name}(_A(aindices), _B(bindices));
      }`;return{name:ht.name,inputNames:["A","B"],inputTypes:[ut,ut],output:{dims:bt,type:ft,textureType:ut},shaderSource:Qt,hasMain:vt}}const Tt=(0,h.getGlsl)(dt.session.backend.glContext.version),Mt=`
    ${ht.body}
    void main() {
      vec4 v1 = ${Tt.texture2D}(A, TexCoords);
      vec4 v2 = ${Tt.texture2D}(B, TexCoords);
      vec4 result = ${ht.name}(v1, v2);
      ${Tt.output} = result;
    }
    `;return{name:ht.name,inputNames:["A","B"],inputTypes:[ut,ut],output:{dims:mt[0].dims,type:ft,textureType:ut},shaderSource:Mt,hasMain:!0}};e.add=(dt,mt)=>[dt.run(lt(dt,mt,$()),mt)],e.and=(dt,mt)=>[dt.run(lt(dt,mt,j(),"bool"),mt)],e.div=(dt,mt)=>[dt.run(lt(dt,mt,nt()),mt)],e.equal=(dt,mt)=>[dt.run(lt(dt,mt,d(),"bool"),mt)],e.greater=(dt,mt)=>[dt.run(lt(dt,mt,a(),"bool"),mt)],e.less=(dt,mt)=>[dt.run(lt(dt,mt,g(),"bool"),mt)],e.mul=(dt,mt)=>[dt.run(lt(dt,mt,tt()),mt)],e.or=(dt,mt)=>[dt.run(lt(dt,mt,rt(),"bool"),mt)],e.pow=(dt,mt)=>[dt.run(lt(dt,mt,it()),mt)],e.pRelu=(dt,mt)=>[dt.run(lt(dt,mt,at()),mt)],e.sub=(dt,mt)=>[dt.run(lt(dt,mt,et()),mt)],e.xor=(dt,mt)=>[dt.run(lt(dt,mt,ot(),"bool"),mt)]},4196:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseCastAttributes=e.cast=void 0;const s=o(2517);e.cast=(h,_,$)=>(c(_),[h.cast(_[0],$)]),e.parseCastAttributes=h=>s.ProtoUtil.tensorDataTypeFromProto(h.attributes.getInt("to"));const c=h=>{if(!h||h.length!==1)throw new Error("Cast requires 1 input.");if(h[0].type==="string")throw new Error("Invalid input type.")}},1163:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createPackedConcatProgramInfoLoader=void 0;const s=o(5060),c=o(2039),h=o(9390),_=o(2827);e.createPackedConcatProgramInfoLoader=(nt,tt,et)=>{const d=(a=tt.length,g=et.cacheKey,{name:"Concat (packed)",inputNames:Array.from({length:a},(j,rt)=>`X${rt}`),inputTypes:Array(a).fill(c.TextureType.packed),cacheHint:g});var a,g;return Object.assign(Object.assign({},d),{get:()=>((j,rt,ot,it)=>{const at=ot[0].dims.slice();if(it>=at.length||it<-1*at.length)throw new Error("axis specified for concat doesn't match input dimensionality");it<0&&(it=at.length+it);const lt=at.slice(0);for(let Ct=1;Ct<ot.length;Ct++){const Gt=ot[Ct].dims.slice();for(let Wt=0;Wt<at.length;Wt++)if(Wt===it)lt[it]+=Gt[Wt];else if(at[Wt]!==Gt[Wt])throw new Error("non concat dimensions must match")}const ct=lt.length,dt=(0,_.getChannels)("coords",ct),mt=(0,h.getCoordsDataType)(ct),ht=(0,_.unpackFromChannel)(),ft=ot.map(Ct=>Ct.dims),ut=(0,h.getGlChannels)(ct),_t=new Array(ft.length-1);_t[0]=ft[0][it];for(let Ct=1;Ct<_t.length;Ct++)_t[Ct]=_t[Ct-1]+ft[Ct][it];const bt=ut[it],vt=ut.slice(-2),Tt=ut.join();let Mt=`if (${bt} < ${_t[0]}) {
        return getChannel(
            getX0(${Tt}), vec2(${vt.join()}));
        }`;for(let Ct=1;Ct<_t.length;Ct++){const Gt=_t[Ct-1];Mt+=`
            if (${bt} < ${_t[Ct]}  && ${bt} >= ${_t[Ct-1]}) {
              return getChannel(
                getX${Ct}(${$(ut,bt,Gt)}),
                vec2(${$(vt,bt,Gt)}));
            }`}const xt=_t.length,Pt=_t[_t.length-1];Mt+=`
            return getChannel(
              getX${xt}(${$(ut,bt,Pt)}),
              vec2(${$(vt,bt,Pt)}));`;const It=(0,s.getGlsl)(j.session.backend.glContext.version),Dt=`
          ${ht}
          float getValue(${ut.map(Ct=>"int "+Ct)}) {
            ${Mt}
          }

          void main() {
            ${mt} coords = getOutputCoords();
            int lastDim = coords.${ut[ct-1]};
            coords.${ut[ct-1]} = coords.${ut[ct-2]};
            coords.${ut[ct-2]} = lastDim;

            vec4 result = vec4(getValue(${dt}), 0., 0., 0.);

            ${dt[ct-1]} = ${dt[ct-1]} + 1;
            if (${dt[ct-1]} < ${lt[ct-1]}) {
              result.g = getValue(${dt});
            }

            ${dt[ct-2]} = ${dt[ct-2]} + 1;
            if (${dt[ct-2]} < ${lt[ct-2]}) {
              result.a = getValue(${dt});
            }

            ${dt[ct-1]} = ${dt[ct-1]} - 1;
            if (${dt[ct-2]} < ${lt[ct-2]} &&
                ${dt[ct-1]} < ${lt[ct-1]}) {
              result.b = getValue(${dt});
            }
            ${It.output} = result;
          }
        `;return Object.assign(Object.assign({},rt),{output:{dims:lt,type:ot[0].type,textureType:c.TextureType.packed},shaderSource:Dt,hasMain:!0})})(nt,d,tt,et.axis)})};const $=(nt,tt,et)=>{const d=nt.indexOf(tt);return nt.map((a,g)=>g===d?`${a} - ${et}`:a).join()}},2069:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseConcatAttributes=e.concat=void 0;const s=o(246),c=o(2039),h=o(1163);e.concat=(a,g,j)=>(d(g),a.session.pack&&g[0].dims.length>1?[a.run((0,h.createPackedConcatProgramInfoLoader)(a,g,j),g)]:[a.run(_(a,g,j),g)]);const _=(a,g,j)=>{const rt=(ot=g.length,it=j.cacheKey,{name:"Concat",inputNames:Array.from({length:ot},(at,lt)=>`X${lt}`),inputTypes:Array(ot).fill(c.TextureType.unpacked),cacheHint:it});var ot,it;return Object.assign(Object.assign({},rt),{get:()=>((at,lt,ct,dt)=>{const mt=ct[0].dims.slice();if(dt>=mt.length||dt<-1*mt.length)throw new Error("axis specified for concat doesn't match input dimensionality");dt<0&&(dt=mt.length+dt);const ht=mt.slice(0);for(let Tt=1;Tt<ct.length;Tt++){const Mt=ct[Tt].dims.slice();for(let xt=0;xt<mt.length;xt++)if(xt===dt)ht[dt]+=Mt[xt];else if(mt[xt]!==Mt[xt])throw new Error("non concat dimensions must match")}const ft=ht.length,ut=new Array(ct.length);let _t=0;for(let Tt=0;Tt<ut.length;++Tt)_t+=ct[Tt].dims[dt],ut[Tt]=_t;let bt="";bt=ct.length<5?$(ut):nt(ut);const vt=`
        ${tt(ct.length,ft)}
        ${et(ut)}
        ${bt}
        float process(int indices[${ft}]) {
          int textureIndex = getTextureWhereDataResides (indices[${dt}]);

          if(textureIndex != 0) {
            indices[${dt}] = indices[${dt}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return Object.assign(Object.assign({},lt),{output:{dims:ht,type:ct[0].type,textureType:c.TextureType.unpacked},shaderSource:vt})})(0,rt,g,j.axis)})},$=a=>`int getTextureWhereDataResides(int index) {
      ${a.map((g,j)=>`if(index<${g}) {return ${j};}
`).join("")}
    }`,nt=a=>$(a),tt=(a,g)=>{const j=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${g}]) {`];for(let rt=0;rt<a;++rt)rt===0?j.push(`	if (textureIndex == ${rt}) { return _X${rt}(indices); }`):rt===a-1?j.push(`	else { return _X${rt}(indices); }`):j.push(`	else if (textureIndex == ${rt}) { return _X${rt}(indices); }`);return j.push("	}"),j.join(`
`)},et=a=>{const g=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let j=0;j<a.length;++j)j===0?g.push(`	if (index == ${j}) { return ${a[j]}; }`):j===a.length-1?g.push(`	else { return ${a[j]}; }`):g.push(`	else if (index == ${j}) { return ${a[j]}; }`);return g.push("	}"),g.join(`
`)};e.parseConcatAttributes=a=>(0,s.createAttributeWithCacheKey)({axis:a.attributes.getInt("axis")});const d=a=>{if(!a||a.length<1)throw new Error("too few inputs");const g=a[0].type,j=a[0].dims.length;if(g==="string")throw new Error("string tensor is not supported yet");for(const rt of a){if(rt.type!==g)throw new Error("input tensors should be one type");if(rt.dims.length!==j)throw new Error("input tensors should have the same shape")}}},4770:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createUnpackedGroupedConvProgramInfoLoader=void 0;const s=o(6231),c=o(5060),h=o(2039),_=o(8138),$=o(2823);e.createUnpackedGroupedConvProgramInfoLoader=(nt,tt,et)=>{const d=(a=tt.length>2,g=et.cacheKey,{name:"GroupedConv",inputNames:a?["X","W","Bias"]:["X","W"],inputTypes:a?[h.TextureType.unpacked,h.TextureType.unpacked,h.TextureType.unpacked]:[h.TextureType.unpacked,h.TextureType.unpacked],cacheHint:g});var a,g;return Object.assign(Object.assign({},d),{get:()=>((j,rt,ot,it)=>{const at=rt.length>2?"value += getBias(output_channel);":"",lt=rt[0].dims.slice(),ct=rt[1].dims.slice(),dt=ct[0]/it.group;s.Logger.verbose("GroupedConv",`autpPad:${it.autoPad}, dilations:${it.dilations}, group:${it.group}, kernelShape:${it.kernelShape}, pads:${it.pads}, strides:${it.strides}`);const mt=(0,_.calculateOutputShape)(lt,ct,it.dilations,it.pads,it.strides),ht=(0,c.getGlsl)(j.session.backend.glContext.version),{activationFunction:ft,applyActivation:ut}=(0,$.getActivationSnippet)(it),_t=`
  const ivec2 strides = ivec2(${it.strides[0]}, ${it.strides[1]});
  const ivec2 pads = ivec2(${it.pads[0]}, ${it.pads[1]});
  ${ft}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${dt};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${ct[1]}; wInChannel++) {
      int input_channel = group_id * ${ct[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${ct[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${it.dilations[0]};

        if (xHeight < 0 || xHeight >= ${lt[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${ct[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${it.dilations[1]};
          if (xWidth < 0 || xWidth >= ${lt[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${at}
    ${ut}
    ${ht.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},ot),{output:{dims:mt,type:rt[0].type,textureType:h.TextureType.unpacked},shaderSource:_t,hasMain:!0})})(nt,tt,d,et)})}},1386:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.conv2DPacked=e.conv2DPackedPointwise=void 0;const s=o(8138),c=o(8555),h=o(708);e.conv2DPackedPointwise=(_,$,nt)=>{const tt=$[0].dims,et=$[1].dims,d=(0,s.calculateOutputShape)(tt,et,nt.dilations,nt.pads,nt.strides),a=_.reshapePacked($[0],[tt[1],tt[2]*tt[3]]),g=_.reshapePacked($[1],[et[0],et[1]]),j=$.length>2?[g,a,$[2]]:[g,a],rt=_.run((0,h.createPackedMatmulProgramInfoLoader)(_,j,nt),j);return _.reshapePacked(rt,d)},e.conv2DPacked=(_,$,nt)=>{const tt=$[0].dims,et=$[1].dims,d=(0,s.calculateOutputShape)(tt,et,nt.dilations,nt.pads,nt.strides),a=_.run((0,c.createPackedIm2ColProgramInfoLoader)(_,$[0],$[1],d,nt),[$[0]]),g=_.reshapePacked($[1],[et[0],et[1]*et[2]*et[3]]),j=$.length===3?[g,a,$[2]]:[g,a],rt=_.run((0,h.createPackedMatmulProgramInfoLoader)(_,j,nt),j);return _.reshapePacked(rt,d)}},9663:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseConvTransposeAttributes=e.convTranspose=void 0;const s=o(246),c=o(5060),h=o(2039),_=o(2823),$=(g,j,rt,ot,it,at)=>(g-1)*j+rt+(ot-1)*it+1-at,nt=(g,j,rt,ot,it)=>{const at=Math.floor(g/2);j==="SAME_UPPER"?(rt[ot]=at,rt[it]=g-at):j==="SAME_LOWER"&&(rt[ot]=g-at,rt[it]=at)};e.convTranspose=(g,j,rt)=>(a(j,rt),tt(g,j,rt));const tt=(g,j,rt)=>{const ot=d(rt,j);return[et(g,j,ot)]},et=(g,j,rt)=>g.run(((ot,it,at)=>{const lt=(ct=it.length>2,dt=at.cacheKey,{name:"ConvTranspose",inputNames:ct?["X","W","B"]:["X","W"],inputTypes:ct?[h.TextureType.unpacked,h.TextureType.unpacked,h.TextureType.unpacked]:[h.TextureType.unpacked,h.TextureType.unpacked],cacheHint:dt});var ct,dt;return Object.assign(Object.assign({},lt),{get:()=>((mt,ht,ft,ut)=>{const _t=ht.length>2?"getB(output_channel)":"0.0",bt=ht[0].dims,vt=ht[1].dims,Tt=vt[1],Mt=vt[0]/ut.group,xt=[ht[0].dims[0],ht[1].dims[1]*ut.group,...ut.outputShape],Pt=(0,c.getGlsl)(mt.session.backend.glContext.version),{activationFunction:It,applyActivation:Dt}=(0,_.getActivationSnippet)(ut),Ct=`
  const ivec2 strides = ivec2(${ut.strides[0]}, ${ut.strides[1]});
  const ivec2 pads = ivec2(${ut.pads[0]}, ${ut.pads[1]});
  ${It}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${Tt};
    int wOutChannel = output_channel - group_id * ${Tt};

    float value = ${_t};
    for (int inChannelOffset = 0; inChannelOffset < ${Mt}; inChannelOffset++) {
      int input_channel = group_id * ${Mt} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${vt[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${vt[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${ut.dilations[0]}, wHOff * ${ut.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${bt[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${bt[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${Dt}
    ${Pt.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},ft),{output:{dims:xt,type:ht[0].type,textureType:h.TextureType.unpacked},shaderSource:Ct,hasMain:!0})})(ot,it,lt,at)})})(g,j,rt),j),d=(g,j)=>{const rt=g.kernelShape.slice();if(g.kernelShape.length===0)for(let lt=2;lt<j[1].dims.length;++lt)rt.push(j[1].dims[lt]);const ot=g.pads.slice(),it=g.outputShape.slice();((lt,ct,dt,mt,ht,ft,ut,_t)=>{const bt=lt.length-2,vt=_t.length===0;for(let Tt=0;Tt<bt;++Tt){const Mt=vt?lt[Tt+2]*ft[Tt]:_t[Tt],xt=$(lt[Tt+2],ft[Tt],ht[Tt],ct[Tt],dt[Tt],Mt);nt(xt,mt,ht,Tt,Tt+bt),vt&&_t.push(ft[Tt]*(lt[Tt+2]-1)+ut[Tt]+(ct[Tt]-1)*dt[Tt]+1-ht[Tt]-ht[Tt+bt])}})(j[0].dims,rt,g.dilations,g.autoPad,ot,g.strides,g.outputPadding,it);const at=Object.assign({},g);return Object.assign(at,{kernelShape:rt,pads:ot,outputShape:it,cacheKey:g.cacheKey}),at};e.parseConvTransposeAttributes=g=>{const j=g.attributes,rt=(0,_.parseInternalActivationAttributes)(j),ot=j.getString("auto_pad","NOTSET"),it=j.getInts("dilations",[1,1]),at=j.getInt("group",1),lt=j.getInts("kernel_shape",[]),ct=j.getInts("output_padding",[0,0]),dt=j.getInts("output_shape",[]),mt=j.getInts("pads",[0,0,0,0]),ht=j.getInts("strides",[1,1]);return(0,s.createAttributeWithCacheKey)(Object.assign({autoPad:ot,dilations:it,group:at,kernelShape:lt,outputPadding:ct,outputShape:dt,pads:mt,strides:ht},rt))};const a=(g,j)=>{if(!g||g.length!==2&&g.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(g[0].dims.length!==4||g[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(g[0].dims[1]!==g[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");const rt=g[1].dims[1]*j.group;if(g.length===3&&(g[2].dims.length!==1||g[2].dims[0]!==rt))throw new Error("invalid bias");const ot=g[0].dims.length-2;if(j.dilations.length!==ot)throw new Error(`dilations should be ${ot}D`);if(j.strides.length!==ot)throw new Error(`strides should be ${ot}D`);if(j.pads.length!==2*ot)throw new Error(`pads should be ${2*ot}D`);if(j.outputPadding.length!==ot)throw new Error(`output_padding should be ${ot}D`);if(j.kernelShape.length!==0&&j.kernelShape.length!==g[1].dims.length-2)throw new Error("invalid kernel shape");if(j.outputShape.length!==0&&j.outputShape.length!==g[0].dims.length-2)throw new Error("invalid output shape");if(g[0].type!=="float32"||g[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(g.length===3&&g[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}},8138:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseConvAttributes=e.conv=e.calculateOutputShape=void 0;const s=o(246),c=o(2517),h=o(4770),_=o(1386),$=o(9828),nt=o(2823),tt=o(3248),et=o(5623);e.calculateOutputShape=(ot,it,at,lt,ct)=>{const dt=ot[0],mt=ot.slice(2),ht=mt.length,ft=it[0],ut=it.slice(2).map((bt,vt)=>bt+(bt-1)*(at[vt]-1)),_t=mt.map((bt,vt)=>bt+lt[vt]+lt[vt+ht]).map((bt,vt)=>Math.floor((bt-ut[vt]+ct[vt])/ct[vt]));return[dt,ft].concat(..._t)},e.conv=(ot,it,at)=>(rt(it,at),d(ot,it,at));const d=(ot,it,at)=>{const lt=j(at,it),ct=ot.session.pack,dt=lt.kernelShape[0]===1&&lt.kernelShape[1]===1;return lt.group>1?[ot.run((0,h.createUnpackedGroupedConvProgramInfoLoader)(ot,it,lt),it)]:dt&&ct?[a(ot,it,lt)]:ct&&it[0].dims.length===4&&it[0].dims[0]===1&&!dt?[(0,_.conv2DPacked)(ot,it,lt)]:[g(ot,it,lt)]},a=(ot,it,at)=>{const lt=it[0].dims,ct=it[1].dims,dt=(0,e.calculateOutputShape)(lt,ct,at.dilations,at.pads,at.strides),mt=ot.reshapeUnpacked(it[0],[lt[1],lt[2]*lt[3]]),ht=ot.reshapeUnpacked(it[1],[ct[0],ct[1]]),ft=it.length>2?[ht,mt,it[2]]:[ht,mt],ut=ot.run((0,et.createMatmulProgramInfoLoader)(ft,at),ft);return ot.reshapeUnpacked(ut,dt)},g=(ot,it,at)=>{const lt=it[0].dims,ct=it[1].dims,dt=(0,e.calculateOutputShape)(lt,ct,at.dilations,at.pads,at.strides),mt=ot.run((0,tt.createIm2ColProgramInfoLoader)(ot,it[0],it[1],dt,at),[it[0]]),ht=it.length===3?[mt,it[1],it[2]]:[mt,it[1]];return ot.run((0,$.createDotProductProgramInfoLoader)(ot,it,dt,at),ht)},j=(ot,it)=>{const at=ot.kernelShape.slice();if(ot.kernelShape.length===0)for(let dt=2;dt<it[1].dims.length;++dt)at.push(it[1].dims[dt]);const lt=ot.pads.slice();c.PoolConvUtil.adjustPadsBasedOnAutoPad(it[0].dims,ot.strides,ot.dilations,at,lt,ot.autoPad);const ct=Object.assign({},ot);return Object.assign(ct,{kernelShape:at,pads:lt,cacheKey:ot.cacheKey}),ct};e.parseConvAttributes=ot=>{const it=ot.attributes,at=(0,nt.parseInternalActivationAttributes)(it),lt=it.getString("auto_pad","NOTSET"),ct=it.getInts("dilations",[1,1]),dt=it.getInt("group",1),mt=it.getInts("kernel_shape",[]),ht=it.getInts("pads",[0,0,0,0]),ft=it.getInts("strides",[1,1]);return(0,s.createAttributeWithCacheKey)(Object.assign({autoPad:lt,dilations:ct,group:dt,kernelShape:mt,pads:ht,strides:ft},at))};const rt=(ot,it)=>{if(!ot||ot.length!==2&&ot.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(ot[0].dims.length!==4||ot[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(ot[0].dims[1]!==ot[1].dims[1]*it.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(ot.length===3&&(ot[2].dims.length!==1||ot[1].dims[0]!==ot[2].dims[0]))throw new Error("invalid bias");const at=ot[0].dims.length-2;if(it.dilations.length!==at)throw new Error(`dilations should be ${at}D`);if(it.strides.length!==at)throw new Error(`strides should be ${at}D`);if(it.pads.length!==2*at)throw new Error(`pads should be ${2*at}D`);if(it.kernelShape.length!==0&&it.kernelShape.length!==ot[1].dims.length-2)throw new Error("invalid kernel shape");if(ot[0].type!=="float32"||ot[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(ot.length===3&&ot[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}},5193:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseDepthToSpaceAttributes=e.depthToSpace=void 0;const s=o(3738);e.depthToSpace=(h,_,$)=>{c(_);const nt=$.blocksize,tt=nt*nt,et=$.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],d=$.mode==="DCR"?[_[0].dims[0],nt,nt,_[0].dims[1]/tt,_[0].dims[2],_[0].dims[3]]:[_[0].dims[0],_[0].dims[1]/tt,nt,nt,_[0].dims[2],_[0].dims[3]],a=h.reshapeUnpacked(_[0],d),g={perm:et,cacheKey:`${et}`},[j]=(0,s.transpose)(h,[a],g),rt=[_[0].dims[0],_[0].dims[1]/tt,_[0].dims[2]*nt,_[0].dims[3]*nt];return[h.reshapeUnpacked(j,rt)]},e.parseDepthToSpaceAttributes=h=>{const _=h.attributes.getInt("blocksize");if(_<1)throw new Error(`blocksize must be >= 1, but got : ${_} for DepthToSpace`);const $=h.attributes.getString("mode","DCR");if($!=="DCR"&&$!=="CRD")throw new Error(`unrecognized mode: ${$} for DepthToSpace`);return{mode:$,blocksize:_}};const c=h=>{if(h.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${h.length}`);if(h[0].type==="string"||h[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}},9828:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDotProductProgramInfoLoader=void 0;const s=o(2517),c=o(5060),h=o(2039),_=o(2823),$=o(3248);e.createDotProductProgramInfoLoader=(nt,tt,et,d)=>{const a=((g,j)=>({name:"ConvDotProduct",inputNames:g?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:g?[h.TextureType.unpacked,h.TextureType.packedLastDimension,h.TextureType.unpacked]:[h.TextureType.unpacked,h.TextureType.packedLastDimension],cacheKey:j.activationCacheKey}))(tt.length>2,d);return Object.assign(Object.assign({},a),{get:()=>((g,j,rt,ot,it)=>{const at=rt[0].dims,lt=rt[1].dims,ct=[lt[0],Math.ceil(at[1]*lt[2]*lt[3]/4)],dt=(0,$.calculateIm2ColDims)(at,lt,ot),[mt,ht]=g.calculateTextureWidthAndHeight(ct,h.TextureType.packedLastDimension),ft=s.ShapeUtil.computeStrides(dt),[ut,_t]=g.calculateTextureWidthAndHeight(dt,h.TextureType.packedLastDimension),bt=ot.length,vt=rt.length<3?"0.0":"_B(b)",Tt=Math.ceil(at[1]*lt[2]*lt[3]/4),{activationFunction:Mt,applyActivation:xt}=(0,_.getActivationSnippet)(it),Pt=(0,c.getGlsl)(g.session.backend.glContext.version),It=`
${Mt}
float process(int indices[${bt}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${ft[0]} + im2col[1] * ${ft[1]} + im2col[2] * ${ft[2]};
  int kernelOffset = indices[1] * ${ct[1]};
  float value = ${vt};
  for (int i = 0; i < ${Tt}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${ut}, ${_t});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${mt}, ${ht});
    value += dot(${Pt.texture2D}(Im2Col, im2colCoords), ${Pt.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${xt}
  return value;
}`;return Object.assign(Object.assign({},j),{output:{dims:ot,type:rt[0].type,textureType:h.TextureType.unpacked},shaderSource:It})})(nt,a,tt,et,d)})}},7992:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseFlattenAttributes=e.flatten=void 0;const s=o(2517);e.flatten=(h,_,$)=>{c(_,$);const nt=s.ShapeUtil.flattenShape(_[0].dims,$);return[h.reshapeUnpacked(_[0],nt)]},e.parseFlattenAttributes=h=>h.attributes.getInt("axis",1);const c=(h,_)=>{if(!h||h.length!==1)throw new Error("Flatten requires 1 input.");const $=h[0].dims.length;if($===0)throw new Error("scalar tensor is not supported.");if(_<-$||_>$)throw new Error("Invalid axis");if(h[0].type==="string")throw new Error("string tensor is not supported.")}},2823:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseInternalActivationAttributes=e.getActivationSnippet=void 0;const s=o(2517),c=o(4909);e.getActivationSnippet=function(h){let _;switch(h.activation){case"Relu":_=(0,c.glslRelu)();break;case"Sigmoid":_=(0,c.glslSigmoid)();break;case"Clip":_=(0,c.glslClip)(h.clipMin,h.clipMax);break;default:return{activationFunction:"",applyActivation:""}}const $=_.name;return{activationFunction:_.body,applyActivation:`value = ${$}_(value);`}},e.parseInternalActivationAttributes=h=>{const _=h.getString("activation","");if(_==="Clip"){const[$,nt]=h.getFloats("activation_params",[s.MIN_CLIP,s.MAX_CLIP]);return{activation:_,clipMax:nt,clipMin:$,activationCacheKey:`${_}:${$},${nt}`}}return{activation:_,activationCacheKey:_}}},1253:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseGatherAttributes=e.gather=void 0;const s=o(246),c=o(782),h=o(2517),_=o(2039);e.gather=(et,d,a)=>(tt(d,a.axis),[et.run(nt(et,d,a),d)]),e.parseGatherAttributes=et=>(0,s.createAttributeWithCacheKey)({axis:et.attributes.getInt("axis",0)});const $={name:"Gather",inputNames:["A","B"],inputTypes:[_.TextureType.unpacked,_.TextureType.unpacked]},nt=(et,d,a)=>{const g=Object.assign(Object.assign({},$),{cacheHint:a.cacheKey});return Object.assign(Object.assign({},g),{get:()=>((j,rt,ot,it)=>{const at=ot[0].dims.slice(),lt=ot[1].dims.slice(),ct=new Array(at.length+lt.length-1);it=h.ShapeUtil.normalizeAxis(it,at.length);const dt=[];for(let ht=0;ht<ct.length;ht++)ht<it?(ct[ht]=at[ht],dt.push(`inputIdx[${ht}] = outputIdx[${ht}];`)):ht<it+lt.length?(ct[ht]=lt[ht-it],dt.push(`indexDataIdx[${ht-it}] = outputIdx[${ht}];`)):(ct[ht]=at[ht-lt.length+1],dt.push(`inputIdx[${ht-lt.length+1}] = outputIdx[${ht}];`));const mt=`
      float process(int outputIdx[${ct.length||1}]) {
        int inputIdx[${at.length}];
        int indexDataIdx[${lt.length||1}];
        indexDataIdx[0] = 0;
        ${dt.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${it}] = idx < 0 ? idx + ${at[it]} : idx;
        return _A(inputIdx);
      }`;return Object.assign(Object.assign({},rt),{output:{dims:ct,type:ot[0].type,textureType:_.TextureType.unpacked},shaderSource:mt})})(0,g,d,a.axis)})},tt=(et,d)=>{if(!et||et.length!==2)throw new Error("Gather requires 2 inputs.");const a=et[0].dims.length;if(a<1)throw new Error("Invalid input shape.");if(d<-a||d>a-1)throw new Error("Invalid axis.");if(c.NUMBER_TYPES.indexOf(et[0].type)===-1)throw new Error("Invaid input type.");if(et[1].type!=="int32"&&et[1].type!=="int16")throw new Error("Invaid input type.")}},4776:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseGemmAttributesV11=e.parseGemmAttributesV7=e.gemm=void 0;const s=o(246),c=o(2517),h=o(2039);e.gemm=(et,d,a)=>(tt(d,a),[et.run($(d,a),d)]);const _=(et,d)=>{const a=et.attributes.getInt("transA",0)!==0,g=et.attributes.getInt("transB",0)!==0,j=et.attributes.getFloat("alpha",1),rt=et.attributes.getFloat("beta",1);return(0,s.createAttributeWithCacheKey)({transA:a,transB:g,alpha:j,beta:rt,isOptionalC:d})};e.parseGemmAttributesV7=et=>_(et,!1),e.parseGemmAttributesV11=et=>_(et,!0);const $=(et,d)=>{const a={name:"Gemm",inputNames:et.length===3?["A","B","C"]:["A","B"],inputTypes:et.length===3?[h.TextureType.unpacked,h.TextureType.unpacked,h.TextureType.unpacked]:[h.TextureType.unpacked,h.TextureType.unpacked],key:d.cacheKey};return Object.assign(Object.assign({},a),{get:()=>nt(a,et,d)})},nt=(et,d,a)=>{const g=d[0].dims.slice(),j=d[1].dims.slice(),[rt,ot]=c.GemmUtil.getShapeOfGemmResult(g,a.transA,j,a.transB,d.length===3?d[2].dims:void 0),it=[rt,ot];if(!it)throw new Error("Can't use gemm on the given tensors");let at=g[g.length-1],lt="";a.transA&&(at=g[0]),a.transA&&a.transB?lt="value += _A_T(a) * _B_T(b);":a.transA&&!a.transB?lt="value += _A_T(a) * _B(b);":!a.transA&&a.transB?lt="value += _A(a) * _B_T(b);":a.transA||a.transB||(lt="value += _A(a) * _B(b);");const ct=it.length,dt=`
      float process(int indices[${ct}]) {
          int a[${ct}];
          int b[${ct}];
          ${d.length===3?`int c[${d[2].dims.length}];`:""}

          copyVec(indices, a);
          copyVec(indices, b);
          ${d.length===3?"bcastIndices_C(indices, c);":""}

          float value = 0.0;
          for (int k=0; k<${at}; ++k) {
              a[${ct-1}] = k;
              b[${ct-2}] = k;
              ${lt}
          }

          value = value * alpha;
          ${d.length===3?"value += beta * _C(c);":""}
          return value;
      }`;return Object.assign(Object.assign({},et),{output:{dims:it,type:d[0].type,textureType:h.TextureType.unpacked},variables:[{name:"alpha",type:"float",data:a.alpha},{name:"beta",type:"float",data:a.beta}],shaderSource:dt})},tt=(et,d)=>{if(!et)throw new Error("Input is missing");if(d.isOptionalC&&(et.length<2||et.length>3))throw new Error("Invaid input shape.");if(!d.isOptionalC&&et.length!==3)throw new Error("Gemm requires 3 inputs");if(et.length===3&&et[2].dims.length!==1&&et[2].dims.length!==2)throw new Error("Invalid input shape of C");if(et[0].type!=="float32"&&et[0].type!=="float64"||et[1].type!=="float32"&&et[1].type!=="float64"||et.length===3&&et[2].type!=="float32"&&et[2].type!=="float64")throw new Error("Invalid input type.");if(et[0].type!==et[1].type||et.length===3&&et[0].type!==et[2].type)throw new Error("Input types are mismatched")}},8555:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createPackedIm2ColProgramInfoLoader=void 0;const s=o(5060),c=o(2039),h=o(2827);e.createPackedIm2ColProgramInfoLoader=(_,$,nt,tt,et)=>{const d=(a=et.cacheKey,{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[c.TextureType.packed],cacheHint:a});var a;return Object.assign(Object.assign({},d),{get:()=>((g,j,rt,ot,it,at)=>{const lt=rt.dims,ct=ot.dims,dt=it.length,mt=[ct[1]*ct[2]*ct[3],it[2]*it[3]],ht=ct[2]*ct[3],ft=(0,h.unpackFromChannel)(),ut=(0,s.getGlsl)(g.session.backend.glContext.version);let _t="";for(let vt=0;vt<=1;vt++)for(let Tt=0;Tt<=1;Tt++)_t+=`
            blockIndex = rc.x + ${Tt};
            pos = rc.y + ${vt};

            if(blockIndex < ${mt[1]} && pos < ${mt[0]}) {
              offsetY = int(blockIndex / (${it[dt-1]})) * ${at.strides[0]} -
                ${at.pads[0]};
              d0 = offsetY + ${at.dilations[0]} * (imod(pos, ${ht}) / ${ct[2]});

              if(d0 < ${lt[2]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${it[dt-1]}) * ${at.strides[1]} -
                  ${at.pads[1]};
                d1 = offsetX + ${at.dilations[1]} * imod(imod(pos, ${ht}), ${ct[2]});

                if(d1 < ${lt[3]} && d1 >= 0) {

                  ch = int(float(pos)/ ${ht}.);
                    innerDims = vec2(d0, d1);
                    result[${2*vt+Tt}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;const bt=`
      ${ft}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${_t}
          ${ut.output} = result;
      }
            `;return Object.assign(Object.assign({},j),{output:{dims:mt,type:rt.type,textureType:c.TextureType.packed},shaderSource:bt,hasMain:!0})})(_,d,$,nt,tt,et)})}},3248:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.calculateIm2ColDims=e.createIm2ColProgramInfoLoader=void 0;const s=o(2039);e.createIm2ColProgramInfoLoader=(c,h,_,$,nt)=>{const tt=(et=nt.cacheKey,{name:"Im2Col",inputNames:["X"],inputTypes:[s.TextureType.unpacked],cacheHint:et});var et;return Object.assign(Object.assign({},tt),{get:()=>((d,a,g,j,rt,ot)=>{const it=g.dims,at=j.dims,lt=rt.length,ct=(0,e.calculateIm2ColDims)(it,at,rt,4),dt=`
        const int XC = ${it[1]};
        const int XH = ${it[2]};
        const int XW = ${it[3]};
        const int KH = ${ot.kernelShape[0]};
        const int KW = ${ot.kernelShape[1]};
        const int dilationH = ${ot.dilations[0]};
        const int dilationW = ${ot.dilations[1]};
        const int strideH = ${ot.strides[0]};
        const int strideW = ${ot.strides[1]};
        const int padH = ${ot.pads[0]};
        const int padW = ${ot.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${lt}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${it.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return Object.assign(Object.assign({},a),{output:{dims:ct,type:g.type,textureType:s.TextureType.packedLastDimension},shaderSource:dt})})(0,tt,h,_,$,nt)})},e.calculateIm2ColDims=(c,h,_,$=4)=>[_[0],_[2],_[3],Math.ceil(c[1]*h[2]*h[3]/$)]},6572:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseImageScalerAttributes=e.imageScaler=void 0;const s=o(246),c=o(2039);e.imageScaler=(tt,et,d)=>(nt(et),[tt.run(_(tt,et,d),et)]),e.parseImageScalerAttributes=tt=>{const et=tt.attributes.getFloat("scale"),d=tt.attributes.getFloats("bias");return(0,s.createAttributeWithCacheKey)({scale:et,bias:d})};const h={name:"ImageScaler",inputNames:["X"],inputTypes:[c.TextureType.unpacked]},_=(tt,et,d)=>{const a=Object.assign(Object.assign({},h),{cacheHint:d.cacheKey});return Object.assign(Object.assign({},a),{get:()=>((g,j,rt,ot)=>{const it=rt[0].dims.slice(),at=it.length,lt=`
      ${$(ot.bias.length)}
      float process(int indices[${at}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return Object.assign(Object.assign({},j),{output:{dims:it,type:rt[0].type,textureType:c.TextureType.unpacked},variables:[{name:"bias",type:"float",arrayLength:ot.bias.length,data:ot.bias},{name:"scale",type:"float",data:ot.scale}],shaderSource:lt})})(0,a,et,d)})},$=tt=>{const et=[`float getBias(float bias[${tt}], int channel) {`];for(let d=0;d<tt;++d)d===0?et.push(`	if (channel == ${d}) { return bias[${d}]; }`):d===tt-1?et.push(`	else { return bias[${d}]; }`):et.push(`	else if (channel == ${d}) { return bias[${d}]; }`);return et.push("	}"),et.join(`
`)},nt=tt=>{if(!tt||tt.length!==1)throw new Error("ImageScaler requires 1 input.");if(tt[0].dims.length!==4)throw new Error("Invalid input shape.");if(tt[0].type!=="float32"&&tt[0].type!=="float64")throw new Error("Invalid input type.")}},3346:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseInstanceNormalizationAttributes=e.instanceNormalization=void 0;const s=o(5060),c=o(2039);e.instanceNormalization=(et,d,a)=>{tt(d);const g=et.run(_(d[0]),d);return[et.run(nt(et,d[0],a,g.dims),[d[0],g,d[1],d[2]])]},e.parseInstanceNormalizationAttributes=et=>et.attributes.getFloat("epsilon",1e-5);const h={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[c.TextureType.unpacked]},_=et=>Object.assign(Object.assign({},h),{get:()=>((d,a)=>{const g=a.dims.slice(),j=g[1],rt=g[2]*g[3],ot=[g[0],j],it=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${g[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${g[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${rt});
        temp = 0.0;
        for(int a2=0; a2<${g[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${g[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${rt});

        return v;
      }`;return Object.assign(Object.assign({},d),{output:{dims:ot,type:a.type,textureType:c.TextureType.packedLastDimension},shaderSource:it})})(h,et)}),$={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[c.TextureType.unpacked,c.TextureType.packedLastDimension,c.TextureType.unpacked,c.TextureType.unpacked]},nt=(et,d,a,g)=>{const j=Object.assign(Object.assign({},$),{cacheHint:`${a}`});return Object.assign(Object.assign({},j),{get:()=>((rt,ot,it,at,lt)=>{const ct=(0,s.getGlsl)(rt.session.backend.glContext.version),[dt,mt]=rt.calculateTextureWidthAndHeight(lt,c.TextureType.packedLastDimension),[ht,ft]=[dt/4,mt],ut=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${ht}, ${ft});
        return ${ct.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return Object.assign(Object.assign({},ot),{output:{dims:it.dims,type:it.type,textureType:c.TextureType.unpacked},variables:[{name:"epsilon",type:"float",data:at}],shaderSource:ut})})(et,j,d,a,g)})},tt=et=>{if(!et||et.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");const d=et[0],a=et[1],g=et[2];if(d.dims.length<3||a.dims.length!==1||g.dims.length!==1)throw new Error("Invalid input shape.");if(a.dims[0]!==d.dims[1]||g.dims[0]!==d.dims[1])throw new Error("Input shapes are mismatched.");if(d.type!=="float32"&&d.type!=="float64"||a.type!=="float32"&&a.type!=="float64"||g.type!=="float32"&&g.type!=="float64")throw new Error("Invalid input type.");if(et[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}},708:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createPackedMatmulProgramInfoLoader=void 0;const s=o(2517),c=o(5060),h=o(2039),_=o(9390),$=o(2823),nt=o(5623);e.createPackedMatmulProgramInfoLoader=(tt,et,d)=>{const a=(g=et.length>2,j=d.activationCacheKey,{name:"MatMul (packed)",inputNames:g?["A","B","Bias"]:["A","B"],inputTypes:g?[h.TextureType.packed,h.TextureType.packed,h.TextureType.packed]:[h.TextureType.packed,h.TextureType.packed],cacheHint:j});var g,j;return Object.assign(Object.assign({},a),{get:()=>((rt,ot,it,at)=>{const lt=it.length>2,ct=lt?"value += getBiasForMatmul();":"",dt=it[0].dims,mt=it[1].dims,ht=s.BroadcastUtil.calcShape(dt,mt,!0),ft=!s.ShapeUtil.areEqual(it[0].dims,it[1].dims);if(!ht)throw new Error("Can't use matmul on the given tensors");const ut=dt[dt.length-1],_t=Math.ceil(ut/2),bt=dt.length,vt=mt.length,Tt=(0,c.getGlsl)(rt.session.backend.glContext.version),Mt=(0,_.getCoordsDataType)(ht.length),xt=ht.length,Pt=(0,_.getGlChannels)(),{activationFunction:It,applyActivation:Dt}=(0,$.getActivationSnippet)(at),Ct=lt?`${(0,nt.getBiasForMatmul)(Mt,Pt,it[2].dims,ht,!0)}`:"",Gt=ft?`${function(un,en,cn,an){let kn=[],jn=[];const bn=cn[0].dims,xn=cn[1].dims,On=bn.length,An=xn.length,vn=an.length,Bn=vn-On,zn=vn-An;kn=bn.map((Rn,Un)=>`coords.${en[Un+Bn]}`),kn[On-1]="i*2",kn.join(", "),jn=xn.map((Rn,Un)=>`coords.${en[Un+zn]}`),jn[An-2]="i*2",jn.join(", ");const qn=s.BroadcastUtil.getBroadcastDims(bn,an),rr=s.BroadcastUtil.getBroadcastDims(xn,an),ir=qn.map(Rn=>`coords.${en[Rn+Bn]} = 0;`).join(`
`),Hn=rr.map(Rn=>`coords.${en[Rn+zn]} = 0;`).join(`
`),Kn=`int lastDim = coords.${en[vn-1]};
  coords.${en[vn-1]} = coords.${en[vn-2]};
  coords.${en[vn-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${un} coords = getOutputCoords();
  ${Kn}
  ${ir}
  vec4 outputValue = getA(${kn});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${un} coords = getOutputCoords();
  ${Kn}
  ${Hn}
  vec4 outputValue = getB(${jn});
  return outputValue;
}`}(Mt,Pt,it,ht)}`:"",Wt=ft?"getAAtOutCoordsMatmul(i)":`getA(${function(un,en){let cn="";for(let an=0;an<en-2;an++)cn+=`rc.${un[an]}, `;return cn+=`rc.${un[en-2]}, i*2`,cn}(Pt,bt)})`,Qt=ft?"getBAtOutCoordsMatmul(i)":`getB(${function(un,en){let cn="";for(let an=0;an<en-2;an++)cn+=`rc.${un[an]}, `;return cn+=`i*2, rc.${un[en-1]}`,cn}(Pt,vt)})`,nn=`
            ${Gt}
            ${Ct}
            ${It}
            void main() {
              ${ft?"":`${Mt} rc =
          getOutputCoords(); int lastDim = rc.${Pt[xt-1]}; rc.${Pt[xt-1]} =
          rc.${Pt[xt-2]}; rc.${Pt[xt-2]} = lastDim;
      `}

              vec4 value = vec4(0);
              for (int i = 0; i < ${_t}; i++) {
                vec4 a = ${Wt};
                vec4 b = ${Qt};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${ct}
              ${Dt}
              ${Tt.output} = value;
            }`;return Object.assign(Object.assign({},ot),{output:{dims:ht,type:it[0].type,textureType:h.TextureType.packed},shaderSource:nn,hasMain:!0})})(tt,a,et,d)})}},5623:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getBiasForMatmul=e.createMatmulProgramInfoLoader=e.parseMatMulAttributes=e.matMul=void 0;const s=o(2517),c=o(2039),h=o(9390),_=o(2823),$=o(708);function nt(d,a){const g=(j=d.length>2,rt=a.activationCacheKey,{name:"MatMul",inputNames:j?["A","B","Bias"]:["A","B"],inputTypes:j?[c.TextureType.unpacked,c.TextureType.unpacked,c.TextureType.unpacked]:[c.TextureType.unpacked,c.TextureType.unpacked],cacheHint:rt});var j,rt;return Object.assign(Object.assign({},g),{get:()=>function(ot,it,at){const lt=it[0].dims,ct=it[1].dims,dt=s.BroadcastUtil.calcShape(lt,ct,!0);if(!dt)throw new Error("Can't use matmul on the given tensors");const mt=(0,h.getCoordsDataType)(dt.length),ht=(0,h.getGlChannels)(),{activationFunction:ft,applyActivation:ut}=(0,_.getActivationSnippet)(at),_t=it.length>2,bt=_t?"value += getBiasForMatmul();":"",vt=_t?`${et(mt,ht,it[2].dims,dt,!1)}`:"",Tt=dt.length,Mt=lt.length,xt=ct.length,Pt=`
    ${ft}
    ${vt}
    float process(int indices[${Tt}]) {
        int a[${Mt}];
        int b[${xt}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${lt[lt.length-1]}; ++k) {
            a[${Mt-1}] = k;
            b[${xt-2}] = k;
            value += _A(a) * _B(b);
        }
        ${bt}
        ${ut}
        return value;
    }`;return Object.assign(Object.assign({},ot),{output:{dims:dt,type:it[0].type,textureType:c.TextureType.unpacked},shaderSource:Pt})}(g,d,a)})}e.matMul=(d,a,g)=>(tt(a),d.session.pack?[d.run((0,$.createPackedMatmulProgramInfoLoader)(d,a,g),a)]:[d.run(nt(a,g),a)]),e.parseMatMulAttributes=d=>(0,_.parseInternalActivationAttributes)(d.attributes),e.createMatmulProgramInfoLoader=nt;const tt=d=>{if(!d||d.length!==2)throw new Error("MatMul requires 2 inputs.");if(d[0].dims[d[0].dims.length-1]!==d[1].dims[d[1].dims.length-2])throw new Error("shared dimension does not match.");if(d[0].type!=="float32"&&d[0].type!=="float64"||d[1].type!=="float32"&&d[1].type!=="float64")throw new Error("inputs should be float type");if(d[0].type!==d[1].type)throw new Error("inputs types should match")};function et(d,a,g,j,rt){let ot="";const it=g.length,at=j.length,lt=at-it;ot=at<2&&it>0?"coords":g.map((mt,ht)=>`coords.${a[ht+lt]}`).join(", ");const ct=s.BroadcastUtil.getBroadcastDims(g,j).map(mt=>`coords.${a[mt+lt]} = 0;`).join(`
`);let dt="vec4(outputValue.xx, outputValue.yy)";return s.ShapeUtil.size(g)===1&&(dt="vec4(outputValue.x)"),rt?`
vec4 getBiasForMatmul() {
  ${d} coords = getOutputCoords();
  ${ct}
  vec4 outputValue = getBias(${ot});
  return ${dt};
}`:`
float getBiasForMatmul() {
  ${d} coords = getOutputCoords();
  ${ct}
  return getBias(coords.x);
}`}e.getBiasForMatmul=et},2403:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createPackProgramInfoLoader=void 0;const s=o(5060),c=o(2039),h=o(9390),_=o(2827),$={name:"pack",inputNames:["A"],inputTypes:[c.TextureType.unpackedReversed]};e.createPackProgramInfoLoader=(nt,tt)=>Object.assign(Object.assign({},$),{get:()=>((et,d)=>{const a=(0,s.getGlsl)(et.session.backend.glContext.version),g=d.dims,j=g.length,rt=d.dims.length,ot=(0,h.getCoordsDataType)(rt),it=(0,_.getChannels)("rc",rt),at=(lt=rt,ct=it,dt=g[g.length-2],mt=g[g.length-1],lt===0||lt===1?"":`
    int r = ${ct[lt-2]};
    int c = ${ct[lt-1]};
    int rp1 = ${ct[lt-2]} + 1;
    int cp1 = ${ct[lt-1]} + 1;
    bool rEdge = rp1 >= ${mt};
    bool cEdge = cp1 >= ${dt};
    `);var lt,ct,dt,mt;let ht;ht=j===0?[1,1]:j===1?[g[0],1]:[g[rt-1],g[rt-2]];const ft=function(bt,vt,Tt){if(bt===0)return"false";if(bt===1)return`rc > ${vt[0]}`;let Mt="";for(let xt=bt-2;xt<bt;xt++)Mt+=`${Tt[xt]} >= ${vt[xt-bt+2]}`,xt<bt-1&&(Mt+="||");return Mt}(rt,ht,it),ut=function(bt,vt){const Tt=bt.length;if(Tt===0)return"getA(), 0, 0, 0";if(Tt===1)return`getA(rc),
            rc + 1 >= ${bt[0]} ? 0. : getA(rc + 1),
            0, 0`;let Mt="";if(Tt>2)for(let xt=0;xt<Tt-2;++xt)Mt+=`${vt[xt]},`;return`getA(${Mt}r, c),
          rEdge ? 0. : getA(${Mt}rp1, c),
          cEdge ? 0. : getA(${Mt}r, cp1),
          rEdge || cEdge ? 0. : getA(${Mt}rp1, cp1)`}(g,it),_t=`
        void main() {
          ${ot} rc = getOutputCoords();

          if(${ft}) {
            ${a.output} = vec4(0);
          } else {
            ${at}

            ${a.output} = vec4(${ut});
          }
        }
      `;return Object.assign(Object.assign({},$),{hasMain:!0,output:{dims:d.dims,type:d.type,textureType:c.TextureType.packed},shaderSource:_t})})(nt,tt)})},2827:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.unpackFromChannel=e.getChannels=e.getVecChannels=void 0;const s=o(9390);function c(h,_){return(0,s.getGlChannels)(_).map($=>`${h}.${$}`)}e.getVecChannels=c,e.getChannels=function(h,_){return _===1?[h]:c(h,_)},e.unpackFromChannel=function(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}},2870:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parsePadAttributesV11=e.padV11=e.parsePadAttributesV2=e.padV2=void 0;const s=o(246),c=o(2517),h=o(5060),_=o(2039),$={name:"Pad",inputNames:["A"],inputTypes:[_.TextureType.unpacked]};e.padV2=(ot,it,at)=>(et(it),[ot.run(Object.assign(Object.assign({},$),{cacheHint:at.cacheKey,get:()=>tt(ot,it[0],at)}),it)]),e.parsePadAttributesV2=ot=>{const it=ot.attributes.getString("mode","constant"),at=ot.attributes.getFloat("value",0),lt=ot.attributes.getInts("pads");return(0,s.createAttributeWithCacheKey)({mode:it,value:at,pads:lt})},e.padV11=(ot,it,at)=>{d(it);const lt=nt(ot,it,at);return(0,e.padV2)(ot,[it[0]],lt)},e.parsePadAttributesV11=ot=>ot.attributes.getString("mode","constant");const nt=(ot,it,at)=>{if(!ot.session.isInitializer(it[1].dataId)||it.length>=3&&!ot.session.isInitializer(it[2].dataId))throw new Error("dynamic pad attributes are not allowed");const lt=Array.from(it[1].integerData),ct=it.length>=3?it[2].floatData[0]:0;return(0,s.createAttributeWithCacheKey)({mode:at,pads:lt,value:ct})},tt=(ot,it,at)=>{const lt=c.ShapeUtil.padShape(it.dims.slice(),at.pads),ct=lt.length,dt=`
      ${a(ot,it,at)}
      float process(int[${ct}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[_.TextureType.unpacked],output:{dims:lt,type:it.type,textureType:_.TextureType.unpacked},shaderSource:dt}},et=ot=>{if(!ot||ot.length!==1)throw new Error("Pad requires 1 input");if(ot[0].type!=="float32"&&ot[0].type!=="float64")throw new Error("Invalid input type.")},d=ot=>{if(!ot||ot.length!==2&&ot.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(ot[1].type!=="int32")throw new Error("Invalid input type.");if(ot.length>=3&&ot[2].type==="string")throw new Error("Invalid input type.")},a=(ot,it,at)=>{const lt=(0,h.getGlsl)(ot.session.backend.glContext.version),[ct,dt]=ot.calculateTextureWidthAndHeight(it.dims,_.TextureType.unpacked),mt=c.ShapeUtil.computeStrides(it.dims);switch(at.mode){case"constant":return g(lt,it.dims,mt,ct,dt,at.pads,at.value);case"reflect":return j(lt,it.dims,mt,ct,dt,at.pads);case"edge":return rt(lt,it.dims,mt,ct,dt,at.pads);default:throw new Error("Invalid mode")}},g=(ot,it,at,lt,ct,dt,mt)=>{const ht=it.length;let ft="";for(let ut=ht-1;ut>=0;--ut)ft+=`
        k = m[${ut}] - ${dt[ut]};
        if (k < 0)  return constant;
        if (k >= ${it[ut]}) return constant;
        offset += k * ${at[ut]};
        `;return`
      float padA(int m[${ht}]) {
        const float constant = float(${mt});
        int offset = 0;
        int k = 0;
        ${ft}
        vec2 coords = offsetToCoords(offset, ${lt}, ${ct});
        float value = getColorAsFloat(${ot.texture2D}(A, coords));
        return value;
      }
      `},j=(ot,it,at,lt,ct,dt)=>{const mt=it.length;let ht="";for(let ft=mt-1;ft>=0;--ft)ht+=`
        k = m[${ft}] - ${dt[ft]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(it[ft]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${it[ft]}) { k = _2n_1 - k; }
        }
        offset += k * ${at[ft]};
        `;return`
      float padA(int m[${mt}]) {
        int offset = 0;
        int k = 0;
        ${ht}
        vec2 coords = offsetToCoords(offset, ${lt}, ${ct});
        float value = getColorAsFloat(${ot.texture2D}(A, coords));
        return value;
      }
      `},rt=(ot,it,at,lt,ct,dt)=>{const mt=it.length;let ht="";for(let ft=mt-1;ft>=0;--ft)ht+=`
        k = m[${ft}] - ${dt[ft]};
        if (k < 0)  k = 0;
        if (k >= ${it[ft]}) k = ${it[ft]-1};
        offset += k * ${at[ft]};
      `;return`
      float padA(int m[${mt}]) {
        int offset = 0;
        int k = 0;
        ${ht}
        vec2 coords = offsetToCoords(offset, ${lt}, ${ct});
        float value = getColorAsFloat(${ot.texture2D}(A, coords));
        return value;
      }
      `}},2143:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.globalMaxPool=e.parseMaxPoolAttributes=e.maxPool=e.parseGlobalAveragePoolAttributes=e.globalAveragePool=e.parseAveragePoolAttributes=e.averagePool=void 0;const s=o(246),c=o(2517),h=o(2039);e.averagePool=(rt,ot,it)=>{d(ot);const at={name:"AveragePool",inputNames:["X"],inputTypes:[h.TextureType.unpacked],cacheHint:it.cacheKey};return[rt.run(Object.assign(Object.assign({},at),{get:()=>_(ot,at,!1,it)}),ot)]},e.parseAveragePoolAttributes=rt=>{const ot=rt.attributes.getString("auto_pad","NOTSET"),it=rt.attributes.getInt("ceil_mode",0),at=rt.attributes.getInt("count_include_pad",0)!==0,lt=rt.attributes.getInts("kernel_shape"),ct=rt.attributes.getInts("strides",[]),dt=rt.attributes.getInts("pads",[]);if(it!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,s.createAttributeWithCacheKey)({autoPad:ot,ceilMode:it,countIncludePad:at,kernelShape:lt,strides:ct,pads:dt})};const _=(rt,ot,it,at)=>{const[lt,ct]=nt(rt,at,it),dt=c.ShapeUtil.size(lt.kernelShape);let mt="";lt.countIncludePad?mt+=`value /= float(${dt});`:mt+=`value /= float(${dt} - pad);`;const ht=`
        ${a(rt[0].dims,lt,"value += _X(x);",mt,"0.0")}
      `;return Object.assign(Object.assign({},ot),{output:{dims:ct,type:rt[0].type,textureType:h.TextureType.unpacked},shaderSource:ht})};e.globalAveragePool=(rt,ot,it)=>{d(ot);const at={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[h.TextureType.unpacked],cacheHint:`${it.countIncludePad}`};return[rt.run(Object.assign(Object.assign({},at),{get:()=>_(ot,at,!0,it)}),ot)]},e.parseGlobalAveragePoolAttributes=rt=>{const ot=rt.attributes.getInt("count_include_pad",0)!==0;return(0,s.createAttributeWithCacheKey)({autoPad:"",ceilMode:0,countIncludePad:ot,kernelShape:[],strides:[],pads:[]})},e.maxPool=(rt,ot,it)=>{d(ot);const at={name:"MaxPool",inputNames:["X"],inputTypes:[h.TextureType.unpacked],cacheHint:it.cacheKey};return[rt.run(Object.assign(Object.assign({},at),{get:()=>$(ot,at,!1,it)}),ot)]},e.parseMaxPoolAttributes=rt=>{const ot=rt.attributes.getString("auto_pad","NOTSET"),it=rt.attributes.getInt("ceil_mode",0),at=rt.attributes.getInts("kernel_shape"),lt=rt.attributes.getInts("strides",[]),ct=rt.attributes.getInts("pads",[]),dt=rt.attributes.getInt("storage_order",0),mt=rt.attributes.getInts("dilations",[]);if(dt!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(it!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,s.createAttributeWithCacheKey)({autoPad:ot,ceilMode:it,countIncludePad:!1,kernelShape:at,strides:lt,pads:ct,storageOrder:dt,dilations:mt})};const $=(rt,ot,it,at)=>{const[lt,ct]=nt(rt,at,it),dt=`
      ${a(rt[0].dims,lt,`
      value = max(_X(x), value);
    `,"","-1e5")}
    `;return Object.assign(Object.assign({},ot),{output:{dims:ct,type:rt[0].type,textureType:h.TextureType.unpacked},shaderSource:dt})},nt=(rt,ot,it)=>{const at=rt[0].dims.slice(),lt=Object.hasOwnProperty.call(ot,"dilations"),ct=ot.kernelShape.slice(),dt=ot.strides.slice(),mt=lt?ot.dilations.slice():[],ht=ot.pads.slice();c.PoolConvUtil.adjustPoolAttributes(it,at,ct,dt,mt,ht);const ft=c.PoolConvUtil.computePoolOutputShape(it,at,dt,mt,ct,ht,ot.autoPad),ut=Object.assign({},ot);return lt?Object.assign(ut,{kernelShape:ct,strides:dt,pads:ht,dilations:mt,cacheKey:ot.cacheKey}):Object.assign(ut,{kernelShape:ct,strides:dt,pads:ht,cacheKey:ot.cacheKey}),[ut,ft]},tt={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},et={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[h.TextureType.unpacked]};e.globalMaxPool=(rt,ot)=>(d(ot),[rt.run(Object.assign(Object.assign({},et),{get:()=>$(ot,et,!0,tt)}),ot)]);const d=rt=>{if(!rt||rt.length!==1)throw new Error("Pool ops requires 1 input.");if(rt[0].type!=="float32"&&rt[0].type!=="float64")throw new Error("Invalid input type.")},a=(rt,ot,it,at,lt)=>{const ct=rt.length;if(ot.kernelShape.length<=2){const dt=ot.kernelShape[ot.kernelShape.length-1],mt=ot.strides[ot.strides.length-1],ht=ot.pads[ot.pads.length/2-1],ft=ot.pads[ot.pads.length-1],ut=rt[ct-1];let _t="",bt="",vt="";if(_t=ht+ft!==0?`
          for (int i = 0; i < ${dt}; i++) {
            x[${ct} - 1] = indices[${ct} - 1] * ${mt} - ${ht} + i;
            if (x[${ct} - 1] < 0 || x[${ct} - 1] >= ${ut}) {
              pad++;
              continue;
            }
            ${it}
          }`:`
          for (int i = 0; i < ${dt}; i++) {
            x[${ct} - 1] = indices[${ct} - 1] * ${mt} - ${ht} + i;
            ${it}
          }`,ot.kernelShape.length===2){const Tt=ot.kernelShape[ot.kernelShape.length-2],Mt=ot.strides[ot.strides.length-2],xt=ot.pads[ot.pads.length/2-2],Pt=ot.pads[ot.pads.length-2],It=rt[ct-2];bt=xt+Pt!==0?`
            for (int j = 0; j < ${Tt}; j++) {
              x[${ct} - 2] = indices[${ct} - 2] * ${Mt} - ${xt} + j;
              if (x[${ct} - 2] < 0 || x[${ct} - 2] >= ${It}) {
                pad+= ${dt};
                continue;
              }
          `:`
            for (int j = 0; j < ${Tt}; j++) {
              x[${ct} - 2] = indices[${ct} - 2] * ${Mt} - ${xt} + j;
            `,vt=`
          }
        `}return`
        float process(int indices[${ct}]) {
          int x[${ct}];
          copyVec(indices, x);

          float value = ${lt};
          int pad = 0;
          ${bt}
          ${_t}
          ${vt}
          ${at}
          return value;
        }
      `}{const dt=c.ShapeUtil.size(ot.kernelShape),mt=c.ShapeUtil.computeStrides(ot.kernelShape),ht=mt.length,ft=ot.pads.length,ut=j(ht),_t=g(rt,"inputDims"),bt=g(ot.pads,"pads"),vt=g(mt,"kernelStrides"),Tt=g(ot.strides,"strides");let Mt="";return Mt=ot.pads.reduce((xt,Pt)=>xt+Pt)?`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${it}
          }`:`
          }
          ${it}
        `,`
        ${ut}
        float process(int indices[${ct}]) {
          int x[${ct}];
          copyVec(indices, x);
          int offset[${ht}];
          int pads[${ft}];
          int inputDims[${ct}];
          int kernelStrides[${ht}];
          int strides[${ht}];
          ${bt}
          ${_t}
          ${Tt}
          ${vt}

          float value = ${lt};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${dt}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${ct} - ${ht}; j < ${ct}; j++) {
              x[j] = indices[j] * strides[j - ${ct} + ${ht}]
                + offset[j - ${ct} + ${ht}] - pads[j - 2];
              ${Mt}
          }
          ${at}

          return value;
        }
      `}},g=(rt,ot)=>{let it="";for(let at=0;at<rt.length;at++)it+=`
      ${ot}[${at}] = ${rt[at]};
    `;return it},j=rt=>`
  void offsetToIndices(int offset, int[${rt}] strides, out int[${rt}] indices) {
    if (${rt} == 0) {
      return;
    }
    for (int i = 0; i < ${rt} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${rt} - 1] = offset;
  }`},4939:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.reduceLogSumSquare=e.reduceLogSum=e.reduceProd=e.reduceMin=e.reduceMax=e.reduceMean=e.reduceSum=e.parseReduceAttributes=void 0;const s=o(246),c=o(782),h=o(2517),_=o(2039),$=(et,d,a,g,j)=>{tt(d);const rt={name:g,inputNames:["A"],inputTypes:[_.TextureType.unpacked]};return[et.run(Object.assign(Object.assign({},rt),{cacheHint:a.cacheKey,get:()=>nt(et,d,a,g,j,rt)}),d)]};e.parseReduceAttributes=et=>{const d=et.attributes.getInts("axes",[]),a=et.attributes.getInt("keepdims",1)===1;return(0,s.createAttributeWithCacheKey)({axes:d,keepDims:a})};const nt=(et,d,a,g,j,rt)=>{const ot=[],it=d[0].dims.length||1,at=[],lt=h.ShapeUtil.normalizeAxes(a.axes,d[0].dims.length),ct=j(d,lt);let dt=ct[1];for(let ht=0;ht<d[0].dims.length;ht++)lt.indexOf(ht)>=0||lt.length===0?(a.keepDims&&ot.push(1),dt=`
          for(int j${ht} = 0; j${ht} < ${d[0].dims[ht]}; j${ht}++) {
            inputIdx[${ht}] = j${ht};
            ${dt}
          }`):(at.push(`inputIdx[${ht}] = outputIdx[${ot.length}];`),ot.push(d[0].dims[ht]));const mt=`
      float process(int outputIdx[${ot.length||1}]) {
        float value;                 // final result
        int inputIdx[${it}];      // addressing input data
        ${at.join(`
`)}
        ${ct[0]}       // init ops for reduce max/min
        ${dt}
        ${ct[2]}       // final computation for reduce mean
        return value;
      }`;return Object.assign(Object.assign({},rt),{output:{dims:ot,type:d[0].type,textureType:_.TextureType.unpacked},shaderSource:mt})},tt=et=>{if(!et||et.length!==1)throw new Error("Reduce op requires 1 input.");if(c.NUMBER_TYPES.indexOf(et[0].type)===-1)throw new Error("Invalid input type.")};e.reduceSum=(et,d,a)=>$(et,d,a,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),e.reduceMean=(et,d,a)=>$(et,d,a,"ReduceMean",(g,j)=>{let rt=1;for(let ot=0;ot<g[0].dims.length;ot++)(j.indexOf(ot)>=0||j.length===0)&&(rt*=g[0].dims[ot]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${rt}.;`]}),e.reduceMax=(et,d,a)=>$(et,d,a,"ReduceMax",(g,j)=>{const rt=[];for(let ot=0;ot<g[0].dims.length;ot++)(j.indexOf(ot)>=0||j.length===0)&&rt.push(`inputIdx[${ot}] = 0;`);return[`${rt.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),e.reduceMin=(et,d,a)=>$(et,d,a,"ReduceMin",(g,j)=>{const rt=[];for(let ot=0;ot<g[0].dims.length;ot++)(j.indexOf(ot)>=0||j.length===0)&&rt.push(`inputIdx[${ot}] = 0;`);return[`${rt.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),e.reduceProd=(et,d,a)=>$(et,d,a,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),e.reduceLogSum=(et,d,a)=>$(et,d,a,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),e.reduceLogSumSquare=(et,d,a)=>$(et,d,a,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])},7019:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isReshapeCheap=e.processDims3D=e.createPackedReshape3DProgramInfoLoader=void 0;const s=o(2517),c=o(5060),h=o(2039),_=o(2827);e.createPackedReshape3DProgramInfoLoader=($,nt,tt)=>{const et=(d=>({name:"Reshape (packed)",inputTypes:[h.TextureType.packed],inputNames:["A"],cacheHint:`${d}`}))(tt);return Object.assign(Object.assign({},et),{get:()=>((d,a,g,j)=>{const rt=a.dims,ot=j;let it="";for(let ct=0;ct<4;ct++){let dt="";switch(ct){case 0:dt="outputCoords = rc;";break;case 1:dt="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:dt="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:dt="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}it+=`
        ${dt}
        ${ct>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${ct}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${ct>0?"}":""}
      `}const at=(0,c.getGlsl)(d.session.backend.glContext.version),lt=`
      ${function(ct){const dt=s.ShapeUtil.computeStrides(ct),mt=["b","r","c"],ht="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${dt.map((ft,ut)=>`int ${mt[ut]} = ${ht} / ${ft}; ${ut===dt.length-1?`int ${mt[ut+1]} = ${ht} - ${mt[ut]} * ${ft}`:`index -= ${mt[ut]} * ${ft}`};`).join("")}
      return ivec3(b, r, c);
    }
  `}(rt)}
      ${function(ct){const dt=s.ShapeUtil.computeStrides(ct);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${dt[0]} + coords.z * ${dt[1]} + coords.y;
  }
`}(ot)}
      ${(0,_.unpackFromChannel)()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${ot[2]};
        int cols = ${ot[1]};

        ${it}
        ${at.output} = result;
      }
    `;return Object.assign(Object.assign({},g),{output:{dims:ot,type:a.type,textureType:h.TextureType.packed},shaderSource:lt,hasMain:!0})})($,nt,et,tt)})},e.processDims3D=function($){if($.length===0)return[1,1,1];let nt=1;for(let tt=0;tt<$.length-2;++tt)nt*=$[tt];return[nt,$.length>1?$[$.length-2]:1,$[$.length-1]]},e.isReshapeCheap=function($,nt){let tt=!1;return tt=$.length===0||nt.length===0||($.length<2||nt.length<2?$[$.length-1]===nt[nt.length-1]:$[$.length-1]===nt[nt.length-1]&&$[$.length-2]===nt[nt.length-2]),tt}},718:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.reshape=void 0;const s=o(2517);e.reshape=(c,h)=>{const _=s.ShapeUtil.calculateReshapedDims(h[0].dims,h[1].integerData);return c.session.pack?[c.reshapePacked(h[0],_)]:[c.reshapeUnpacked(h[0],_)]}},2268:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseResizeAttributesV11=e.parseResizeAttributesV10=e.resize=void 0;const s=o(5060),c=o(2039),h=o(9390),_=o(2827),$=o(9793),nt={name:"Resize",inputNames:["A"],inputTypes:[c.TextureType.packed]};e.resize=(g,j,rt)=>((0,$.validateInputs)(j,rt),[g.run(Object.assign(Object.assign({},nt),{cacheHint:rt.cacheKey,get:()=>tt(g,j,rt)}),j)]),e.parseResizeAttributesV10=g=>(0,$.parseUpsampleAttributes)(g,10),e.parseResizeAttributesV11=g=>(0,$.parseUpsampleAttributes)(g,11);const tt=(g,j,rt)=>{const ot=(0,s.getGlsl)(g.session.backend.glContext.version),[it,at]=et(j,rt);if(it.every(Mt=>Mt===1)&&rt.coordinateTransformMode!=="tf_crop_and_resize")return Object.assign(Object.assign({},nt),{output:{dims:at,type:j[0].type,textureType:c.TextureType.packed},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${ot.texture2D}(X, TexCoords);
                    ${ot.output} = v;
                }`});const lt=at.length;if(lt<2)throw new Error(`output dimension should be at least 2, but got ${lt}`);const ct=at[lt-2],dt=at[lt-1],mt=j[0].dims;if(lt!==mt.length)throw new Error(`output dimension should match input ${mt.length}, but got ${lt}`);const ht=mt[lt-2],ft=mt[lt-1],ut=it[lt-2],_t=it[lt-1];let bt="";if(rt.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${rt.mode}'`);switch(rt.coordinateTransformMode){case"asymmetric":bt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":bt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":bt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${dt}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${ct}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${dt}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${ct}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":bt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${dt}.0 - 1.0, ${ct}.0 - 1.0, ${dt}.0 - 1.0,
                            ${ct}.0 - 1.0);
                        vec4 original = vec4(${ft}.0 - 1.0, ${ht}.0 - 1.0, ${ft}.0 - 1.0,
                            ${ht}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${rt.coordinateTransformMode}'`)}const vt=(0,h.getCoordsDataType)(lt),Tt=`
            const vec2 inputWH = vec2(${ht}.0, ${ft}.0);
            const vec4 scaleWHWH = vec4(float(${ut}), float(${_t}), float(${ut}), float(${_t}));
            ${(0,_.unpackFromChannel)()}
            ${bt}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${vt} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${ct-1};
                bool hasNextCol = rc.z < ${dt-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${ot.output} = vec4(newValue);
            }
        `;return Object.assign(Object.assign({},nt),{output:{dims:at,type:j[0].type,textureType:c.TextureType.packed},hasMain:!0,shaderSource:Tt})},et=(g,j)=>{const rt=g[0].dims;let ot,it=j.scales;if(it.length===0){const lt=g[j.scalesInputIdx];if(lt&&lt.size!==0){if(g[j.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");it=d(lt,j.mode,j.isResize)}else{const ct=g[j.sizesInputIdx];if(!ct||ct.size===0)throw new Error("Either scales or sizes MUST be provided as input.");ot=Array.from(ct.integerData),it=a(ot,rt,j.mode,j.isResize)}}else if(g[j.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");const at=ot||rt.map((lt,ct)=>Math.floor(lt*it[ct]));return[it,at]},d=(g,j,rt)=>{const ot=Array.from(g.floatData);return(0,$.scalesValidation)(ot,j,rt),ot},a=(g,j,rt,ot)=>{const it=j.length,at=new Array(it);for(let lt=0,ct=it;lt<ct;lt++)if(j[lt]===0){if(g[lt]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");at[lt]=1}else at[lt]=g[lt]/j[lt];return(0,$.scalesValidation)(at,rt,ot),at}},8117:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.shape=void 0;const s=o(9162);e.shape=(h,_)=>(c(_),[new s.Tensor([_[0].dims.length],"int32",void 0,void 0,new Int32Array(_[0].dims))]);const c=h=>{if(!h||h.length!==1)throw new Error("Shape requires 1 input.")}},2278:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sliceV10=e.parseSliceAttributes=e.slice=void 0;const s=o(246),c=o(782),h=o(2517),_=o(2039),$={name:"Slice",inputNames:["A"],inputTypes:[_.TextureType.unpacked]};e.slice=(a,g,j)=>(tt(g),[a.run(Object.assign(Object.assign({},$),{cacheHint:j.cacheKey,get:()=>nt(a,g[0],j)}),g)]),e.parseSliceAttributes=a=>{const g=a.attributes.getInts("starts"),j=a.attributes.getInts("ends"),rt=a.attributes.getInts("axes",[]);return(0,s.createAttributeWithCacheKey)({starts:g,ends:j,axes:rt})};const nt=(a,g,j)=>{const rt=j.axes.length===0?g.dims.slice(0).map((mt,ht)=>ht):j.axes,ot=h.ShapeUtil.normalizeAxes(rt,g.dims.length),it=j.starts.map((mt,ht)=>mt>g.dims[ot[ht]]-1?g.dims[ot[ht]]:h.ShapeUtil.normalizeAxis(mt,g.dims[ot[ht]])),at=j.ends.map((mt,ht)=>mt>g.dims[ot[ht]]-1?g.dims[ot[ht]]:h.ShapeUtil.normalizeAxis(mt,g.dims[ot[ht]])),lt=g.dims.slice(),ct=[];for(let mt=0;mt<ot.length;mt++)lt[ot[mt]]=at[mt]-it[mt],it[mt]>0&&ct.push(`outputIdx[${ot[mt]}] += ${it[mt]};`);const dt=`
      float process(int outputIdx[${lt.length}]) {
        ${ct.join(`
      `)}
        return _A(outputIdx);
      }`;return Object.assign(Object.assign({},$),{output:{dims:lt,type:g.type,textureType:_.TextureType.unpacked},shaderSource:dt})},tt=a=>{if(!a||a.length!==1)throw new Error("Slice requires 1 input.");if(c.NUMBER_TYPES.indexOf(a[0].type)===-1)throw new Error("Invalid input type.")};e.sliceV10=(a,g)=>{d(g);const j=et(a,g);return[a.run(Object.assign(Object.assign({},$),{cacheHint:j.cacheKey,get:()=>nt(a,g[0],j)}),[g[0]])]};const et=(a,g)=>{if(!a.session.isInitializer(g[1].dataId)||!a.session.isInitializer(g[2].dataId)||g.length>=4&&!a.session.isInitializer(g[3].dataId)||g.length>=5&&!a.session.isInitializer(g[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(g.length>=5&&g[4].integerData.some(it=>it!==1))throw new Error("currently non-1 steps is not supported for Slice");const j=Array.from(g[1].integerData),rt=Array.from(g[2].integerData),ot=g.length>=4?Array.from(g[3].integerData):[];return{starts:j,ends:rt,axes:ot,cacheKey:`${ot};${j};${rt}`}},d=a=>{if(!a||a.length<3||a.length>5)throw new Error("Invalid input number.");if(a[1].type!=="int32"||a[1].dims.length!==1)throw new Error("Invalid input type.");if(a[2].type!=="int32"||a[2].dims.length!==1)throw new Error("Invalid input type.");if(a.length>=4&&(a[3].type!=="int32"||a[3].dims.length!==1))throw new Error("Invalid input type.");if(a.length>=5&&(a[4].type!=="int32"||a[4].dims.length!==1))throw new Error("Invalid input type.")}},5524:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.softmaxV13=e.parseSoftmaxAttributesV13=e.parseSoftmaxAttributes=e.softmax=void 0;const s=o(246),c=o(2517),h=o(5060),_=o(2039),$=o(3738),nt={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[_.TextureType.unpacked]},tt={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[_.TextureType.unpacked,_.TextureType.unpacked]},et={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[_.TextureType.unpacked,_.TextureType.unpacked,_.TextureType.unpacked]};e.softmax=(ot,it,at)=>{rt(it);const lt=it[0].dims.slice(),ct=c.ShapeUtil.normalizeAxis(at.axis,lt.length),dt=c.ShapeUtil.sizeToDimension(lt,ct),mt=c.ShapeUtil.sizeFromDimension(lt,ct);return d(ot,it,at,dt,mt)},e.parseSoftmaxAttributes=ot=>(0,s.createAttributeWithCacheKey)({axis:ot.attributes.getInt("axis",1)}),e.parseSoftmaxAttributesV13=ot=>(0,s.createAttributeWithCacheKey)({axis:ot.attributes.getInt("axis",-1)}),e.softmaxV13=(ot,it,at)=>{rt(it);const lt=it[0].dims.slice(),ct=c.ShapeUtil.normalizeAxis(at.axis,lt.length),dt=lt.length,mt=ct!==dt-1,ht=[];let ft,ut=[],_t=[];mt&&(ut=Array.from({length:dt}).map((Mt,xt)=>xt),ut[ct]=dt-1,ut[dt-1]=ct,ut.map(Mt=>ht.push(lt[Mt])),ft=(0,s.createAttributeWithCacheKey)({perm:ut}),_t=(0,$.transpose)(ot,it,ft));const bt=mt?c.ShapeUtil.sizeToDimension(ht,dt-1):c.ShapeUtil.sizeToDimension(lt,dt-1),vt=mt?c.ShapeUtil.sizeFromDimension(ht,dt-1):c.ShapeUtil.sizeFromDimension(lt,dt-1),Tt=d(ot,mt?_t:it,at,bt,vt);return mt?(0,$.transpose)(ot,Tt,ft):Tt};const d=(ot,it,at,lt,ct)=>{const dt=a(ot,it[0],lt,ct,[lt]),mt=ot.run(Object.assign(Object.assign({},nt),{cacheHint:at.cacheKey,get:()=>dt}),it),ht=g(ot,it[0],lt,ct,dt.output.dims,[lt]),ft=ot.run(Object.assign(Object.assign({},tt),{cacheHint:at.cacheKey,get:()=>ht}),[it[0],mt]),ut=j(ot,it[0],lt,ct,dt.output.dims,ht.output.dims);return[ot.run(Object.assign(Object.assign({},et),{cacheHint:at.cacheKey,get:()=>ut}),[it[0],mt,ft])]},a=(ot,it,at,lt,ct)=>{const[dt,mt]=ot.calculateTextureWidthAndHeight(it.dims,_.TextureType.unpacked),ht=ct.length;if(at<1||lt<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(ct.length!==1)throw new Error("Dimensionality of the output should be 1");if(ct[0]!==at)throw new Error("Shape of the output should be equal to logical row count");const ft=(0,h.getGlsl)(ot.session.backend.glContext.version),ut=`
      float process(int[${ht}] indices) {
        int logical_row_start_offset = indices[0] * ${lt};

        float max = getColorAsFloat(${ft.texture2D}(A, offsetToCoords(logical_row_start_offset, ${dt},
        ${mt} )));
        for(int i=1; i<${lt}; ++i)
        {
          float current = getColorAsFloat(${ft.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${dt}, ${mt})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return Object.assign(Object.assign({},nt),{output:{dims:ct,type:it.type,textureType:_.TextureType.unpacked},shaderSource:ut})},g=(ot,it,at,lt,ct,dt)=>{const[mt,ht]=ot.calculateTextureWidthAndHeight(it.dims,_.TextureType.unpacked),ft=dt.length;if(at<1||lt<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(dt.length!==1)throw new Error("Dimensionality of the output should be 1");if(dt[0]!==at)throw new Error("Shape of the output should be equal to logical row count");if(ct.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(ct[0]!==at)throw new Error("Shape of the intermediate results should be equal to logical row count");const ut=`
      float process(int[${ft}] indices) {
        int logical_row_start_offset = indices[0] * ${lt};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${lt}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${(0,h.getGlsl)(ot.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${mt}, ${ht}))) - max);
        }

        return norm_factor;
      }`;return Object.assign(Object.assign({},tt),{output:{dims:dt,type:it.type,textureType:_.TextureType.unpacked},shaderSource:ut})},j=(ot,it,at,lt,ct,dt)=>{const[mt,ht]=ot.calculateTextureWidthAndHeight(it.dims,_.TextureType.unpacked),ft=it.dims.length;if(at<1||lt<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(ct.length!==1||dt.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(ct[0]!==at||dt[0]!==at)throw new Error("Shape of the intermediate results should be equal to logical row count");const ut=`
      float process(int[${ft}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${mt}, ${ht});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${lt};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return Object.assign(Object.assign({},et),{output:{dims:it.dims,type:it.type,textureType:_.TextureType.unpacked},shaderSource:ut})},rt=ot=>{if(!ot||ot.length!==1)throw new Error("Softmax requires 1 input.");if(ot[0].type!=="float32"&&ot[0].type!=="float64")throw new Error("Invalid input type")}},5975:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseSplitAttributes=e.split=void 0;const s=o(246),c=o(2517),h=o(2039),_={name:"Split",inputNames:["A"],inputTypes:[h.TextureType.unpacked]};e.split=(et,d,a)=>{tt(d);const g=c.ShapeUtil.normalizeAxis(a.axis,d[0].dims.length),j=$(et,d,g,a),rt=[];for(let ot=0;ot<j;++ot)rt.push(et.run(Object.assign(Object.assign({},_),{cacheHint:`${a.cacheKey};${ot}`,get:()=>nt(et,d[0],a,g,ot)}),d));return rt},e.parseSplitAttributes=et=>{const d=et.attributes.getInt("axis",0),a=et.attributes.getInts("split",[]),g=et.outputs.length;return(0,s.createAttributeWithCacheKey)({axis:d,split:a,numOutputs:g})};const $=(et,d,a,g)=>{const[,j]=c.SplitUtil.splitShape(d[0].dims,a,g.split,g.numOutputs);return j.length},nt=(et,d,a,g,j)=>{const[rt,ot]=c.SplitUtil.splitShape(d.dims,g,a.split,a.numOutputs),it=ot[j],at=rt[j],lt=`
      float process(int indices[${at.length}]) {
        indices[${g}] += ${it};
        return _A(indices);
      }
    `;return Object.assign(Object.assign({},_),{cacheHint:`${a.cacheKey}:${j}`,output:{dims:at,type:d.type,textureType:h.TextureType.unpacked},shaderSource:lt})},tt=et=>{if(!et||et.length!==1)throw new Error("Split requires one input.");if(et[0].type!=="int8"&&et[0].type!=="uint8"&&et[0].type!=="int16"&&et[0].type!=="uint16"&&et[0].type!=="int32"&&et[0].type!=="uint32"&&et[0].type!=="float32"&&et[0].type!=="float64"&&et[0].type!=="bool")throw new Error("Invalid input type.")}},3933:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseSqueezeAttributes=e.squeezeV13=e.squeeze=void 0;const s=o(2517);e.squeeze=(_,$,nt)=>{c($);const tt=s.ShapeUtil.squeezeShape($[0].dims,nt);return[_.reshapeUnpacked($[0],tt)]},e.squeezeV13=(_,$)=>(h($),(0,e.squeeze)(_,[$[0]],Array.from($[1].integerData))),e.parseSqueezeAttributes=_=>_.attributes.getInts("axes");const c=_=>{if(!_||_.length!==1)throw new Error("Squeeze requires 1 input.");if(_[0].type==="string")throw new Error("invalid input tensor types.")},h=_=>{if(!_||_.length!==2)throw new Error("Squeeze requires 2 inputs.");if(_[1].type!=="int32")throw new Error("Invalid input type.")}},6558:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sum=void 0;const s=o(5060),c=o(2039);e.sum=($,nt)=>{_(nt);const tt={name:"Sum",inputNames:nt.map((et,d)=>`X${d}`),inputTypes:new Array(nt.length).fill(c.TextureType.unpacked)};return[$.run(Object.assign(Object.assign({},tt),{get:()=>h($,nt,tt)}),nt)]};const h=($,nt,tt)=>{const et=(0,s.getGlsl)($.session.backend.glContext.version),d=nt[0].dims.slice(),a=`
      void main() {
        vec4 result = ${nt.map((g,j)=>`${et.texture2D}(X${j},TexCoords)`).join(" + ")};
        ${et.output} = result;
      }
    `;return Object.assign(Object.assign({},tt),{output:{dims:d,type:nt[0].type,textureType:c.TextureType.unpacked},hasMain:!0,shaderSource:a})},_=$=>{if(!$||$.length===0)throw new Error("Sum requires inputs.");const nt=$[0].dims.length;for(let tt=1;tt<$.length;tt++){if(nt!==$[tt].dims.length)throw new Error("Input shapes are mismatched.");for(let et=0;et<nt;et++)if($[0].dims[et]!==$[tt].dims[et])throw new Error("Input shapes are not matched.")}if($[0].type!=="float32"&&$[0].type!=="float64")throw new Error("Invalid input type.");for(let tt=1;tt<$.length;tt++)if($[0].type!==$[tt].type)throw new Error("Input types are not matched.")}},5723:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tile=void 0;const s=o(782),c=o(2039);e.tile=($,nt)=>{_(nt);const tt={name:"Tile",inputNames:["A"],inputTypes:[c.TextureType.unpacked]};return[$.run(Object.assign(Object.assign({},tt),{get:()=>h($,nt,tt)}),nt)]};const h=($,nt,tt)=>{const et=nt[0].dims.slice(),d=new Array(et.length),a=[];for(let rt=0;rt<et.length;rt++)d[rt]=et[rt]*nt[1].numberData[rt],a.push(`inputIdx[${rt}] = int(mod(float(outputIdx[${rt}]), ${et[rt]}.));`);const g=d.length,j=`
      float process(int outputIdx[${g}]) {
        int inputIdx[${g}];
        ${a.join(`
`)}
        return _A(inputIdx);
      }
    `;return Object.assign(Object.assign({},tt),{output:{dims:d,type:nt[0].type,textureType:c.TextureType.unpacked},shaderSource:j})},_=$=>{if(!$||$.length!==2)throw new Error("Tile requires 2 input.");if($[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if($[1].dims[0]!==$[0].dims.length)throw new Error("Invalid input shape.");if(s.NUMBER_TYPES.indexOf($[0].type)===-1)throw new Error("Invalid input type.");if($[1].type!=="int32"&&$[1].type!=="int16")throw new Error("Invalid repeat type.")}},3738:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseTransposeAttributes=e.transpose=void 0;const s=o(246),c=o(2517),h=o(2039),_={name:"Transpose",inputNames:["A"],inputTypes:[h.TextureType.unpacked]};e.transpose=(a,g,j)=>(d(g),[a.run(Object.assign(Object.assign({},_),{cacheHint:j.cacheKey,get:()=>$(a,g[0],j.perm)}),g)]),e.parseTransposeAttributes=a=>(0,s.createAttributeWithCacheKey)({perm:a.attributes.getInts("perm",[])});const $=(a,g,j)=>{const rt=g.dims;j=nt(rt,j);const ot=tt(rt,j),it=rt.length,at=`
      ${et("perm",j,it)}
      float process(int indices[${it}]) {
        int a[${it}];
        perm(a, indices);
        return _A(a);
      }`;return Object.assign(Object.assign({},_),{output:{dims:ot,type:g.type,textureType:h.TextureType.unpacked},shaderSource:at})},nt=(a,g)=>(g&&g.length!==a.length&&(g=[...a.keys()].reverse()),g),tt=(a,g)=>(g=nt(a,g),c.ShapeUtil.sortBasedOnPerm(a,g)),et=(a,g,j)=>{const rt=[];rt.push(`void ${a}(out int a[${j}], int src[${j}]) {`);for(let ot=0;ot<j;++ot)rt.push(`	a[${g[ot]}]=src[${ot}];`);return rt.push("	}"),rt.join(`
`)},d=a=>{if(!a||a.length!==1)throw new Error("Transpose requires 1 input.");if(a[0].type!=="float32"&&a[0].type!=="float64")throw new Error("input should be float tensor")}},8710:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.encodeAsUint8=void 0;const s=o(5060),c=o(2039);e.encodeAsUint8=(h,_)=>{const $=_.shape,nt=(0,s.getGlsl)(h.session.backend.glContext.version),tt=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${nt.texture2D}(X,TexCoords).r;
      ${nt.output} = encodeAsUint8(value);
    }`,et={name:"Uint8Encode",inputTypes:[c.TextureType.unpacked],inputNames:["X"],output:{dims:$,type:_.tensor.type,textureType:c.TextureType.downloadUint8AsFloat},shaderSource:tt,hasMain:!0};return h.executeProgram(et,[_.tensor])}},4909:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tanh=e.tan=e.sqrt=e.sin=e.sigmoid=e.relu=e.not=e.neg=e.log=e.parseLeakyReluAttributes=e.leakyRelu=e.identity=e.floor=e.exp=e.parseEluAttributes=e.elu=e.cos=e.ceil=e.clipV11=e.parseClipAttributes=e.clip=e.atan=e.asin=e.acos=e.abs=e.glslTanh=e.glslTan=e.glslSqrt=e.glslSigmoid=e.glslRelu=e.glslSin=e.glslNot=e.glslNeg=e.glslLog=e.glslLeakyRelu=e.glslIdentity=e.glslClip=e.glslFloor=e.glslExp=e.glslElu=e.glslCos=e.glslCeil=e.glslAtan=e.glslAsin=e.glslAcos=e.glslAbs=void 0;const s=o(246),c=o(2517),h=o(8520),_=o(5060),$=o(2039);function nt(){return Tt("abs")}function tt(){return Tt("acos")}function et(){return Tt("asin")}function d(){return Tt("atan")}function a(){return Tt("ceil")}function g(){return Tt("cos")}function j(Pt){const It="elu";return{body:`
  const float alpha = float(${Pt});

  float ${It}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${It}_(vec4 v) {
    return vec4(${It}_(v.x), ${It}_(v.y), ${It}_(v.z), ${It}_(v.w));
  }
  `,name:It,type:h.FunctionType.ValueBased}}function rt(){return Tt("exp")}function ot(){return Tt("floor")}function it(Pt,It){const Dt="clip";return{body:`
  const float min = float(${Pt});
  const float max = float(${It});

  float ${Dt}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${Dt}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:Dt,type:h.FunctionType.ValueBased}}function at(){const Pt="indentity";return{body:`
  float ${Pt}_(float a) {
    return a;
  }
  vec4 ${Pt}_(vec4 v) {
    return v;
  }
  `,name:Pt,type:h.FunctionType.ValueBased}}function lt(Pt){const It="leakyRelu";return{body:`
  const float alpha = float(${Pt});

  float ${It}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${It}_(vec4 v) {
    return vec4(${It}_(v.x), ${It}_(v.y), ${It}_(v.z), ${It}_(v.w));
  }
  `,name:It,type:h.FunctionType.ValueBased}}function ct(){return Tt("log")}function dt(){const Pt="neg";return{body:`
  float ${Pt}_(float a) {
    return -a;
  }
  vec4 ${Pt}_(vec4 v) {
    return -v;
  }
  `,name:Pt,type:h.FunctionType.ValueBased}}function mt(){const Pt="not";return{body:`
  float ${Pt}_(float a) {
    return float( ! bool(a) );
  }
  bool ${Pt}_(bool a) {
    return !a;
  }
  vec4 ${Pt}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${Pt}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:Pt,type:h.FunctionType.ValueBased}}function ht(){return Tt("sin")}function ft(){const Pt="relu";return{body:`
  float ${Pt}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${Pt}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:Pt,type:h.FunctionType.ValueBased}}function ut(){const Pt="sigmoid";return{body:`
  float ${Pt}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${Pt}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:Pt,type:h.FunctionType.ValueBased}}function _t(){return Tt("sqrt")}function bt(){return Tt("tan")}function vt(){const Pt="tanh";return{body:`
  float ${Pt}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${Pt}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:Pt,type:h.FunctionType.ValueBased}}function Tt(Pt){return{body:`
  float ${Pt}_(float a) {
    return ${Pt}(a);
  }
  vec4 ${Pt}_(vec4 v) {
    return ${Pt}(v);
  }
  `,name:Pt,type:h.FunctionType.ValueBased}}e.glslAbs=nt,e.glslAcos=tt,e.glslAsin=et,e.glslAtan=d,e.glslCeil=a,e.glslCos=g,e.glslElu=j,e.glslExp=rt,e.glslFloor=ot,e.glslClip=it,e.glslIdentity=at,e.glslLeakyRelu=lt,e.glslLog=ct,e.glslNeg=dt,e.glslNot=mt,e.glslSin=ht,e.glslRelu=ft,e.glslSigmoid=ut,e.glslSqrt=_t,e.glslTan=bt,e.glslTanh=vt;const Mt=(Pt,It,Dt,Ct)=>{const Gt=Pt.session.pack?$.TextureType.packed:$.TextureType.unpacked,Wt={name:Dt.name,inputTypes:[Gt],inputNames:["A"],cacheHint:Ct};return Object.assign(Object.assign({},Wt),{get:()=>((Qt,nn,un,en)=>{const cn=Qt.session.pack?$.TextureType.packed:$.TextureType.unpacked,an=(0,_.getGlsl)(Qt.session.backend.glContext.version);return Object.assign(Object.assign({},nn),{output:{dims:un.dims,type:un.type,textureType:cn},shaderSource:`
     ${en.body}
     void main() {
       vec4 v = ${an.texture2D}(A, TexCoords);
       v = ${en.name}_(v);
       ${an.output} = v;
     }
     `,hasMain:!0})})(Pt,Wt,It,Dt)})};e.abs=(Pt,It)=>[Pt.run(Mt(Pt,It[0],nt()),It)],e.acos=(Pt,It)=>[Pt.run(Mt(Pt,It[0],tt()),It)],e.asin=(Pt,It)=>[Pt.run(Mt(Pt,It[0],et()),It)],e.atan=(Pt,It)=>[Pt.run(Mt(Pt,It[0],d()),It)],e.clip=(Pt,It,Dt)=>[Pt.run(Mt(Pt,It[0],it(Dt.min,Dt.max),Dt.cacheKey),It)],e.parseClipAttributes=Pt=>(0,s.createAttributeWithCacheKey)({min:Pt.attributes.getFloat("min",c.MIN_CLIP),max:Pt.attributes.getFloat("max",c.MAX_CLIP)}),e.clipV11=(Pt,It)=>{const Dt=xt(Pt,It);return(0,e.clip)(Pt,[It[0]],Dt)};const xt=(Pt,It)=>{if(It.length>=3&&(!Pt.session.isInitializer(It[1].dataId)||!Pt.session.isInitializer(It[2].dataId)))throw new Error("dynamic clip attributes are not allowed");const Dt=It.length>=3?It[1].numberData[0]:c.MIN_CLIP,Ct=It.length>=3?It[2].numberData[0]:c.MAX_CLIP;return(0,s.createAttributeWithCacheKey)({min:Dt,max:Ct})};e.ceil=(Pt,It)=>[Pt.run(Mt(Pt,It[0],a()),It)],e.cos=(Pt,It)=>[Pt.run(Mt(Pt,It[0],g()),It)],e.elu=(Pt,It,Dt)=>[Pt.run(Mt(Pt,It[0],j(Dt.alpha),Dt.cacheKey),It)],e.parseEluAttributes=Pt=>(0,s.createAttributeWithCacheKey)({alpha:Pt.attributes.getFloat("alpha",1)}),e.exp=(Pt,It)=>[Pt.run(Mt(Pt,It[0],rt()),It)],e.floor=(Pt,It)=>[Pt.run(Mt(Pt,It[0],ot()),It)],e.identity=(Pt,It)=>[Pt.run(Mt(Pt,It[0],at()),It)],e.leakyRelu=(Pt,It,Dt)=>[Pt.run(Mt(Pt,It[0],lt(Dt.alpha),Dt.cacheKey),It)],e.parseLeakyReluAttributes=Pt=>(0,s.createAttributeWithCacheKey)({alpha:Pt.attributes.getFloat("alpha",.01)}),e.log=(Pt,It)=>[Pt.run(Mt(Pt,It[0],ct()),It)],e.neg=(Pt,It)=>[Pt.run(Mt(Pt,It[0],dt()),It)],e.not=(Pt,It)=>[Pt.run(Mt(Pt,It[0],mt()),It)],e.relu=(Pt,It)=>[Pt.run(Mt(Pt,It[0],ft()),It)],e.sigmoid=(Pt,It)=>[Pt.run(Mt(Pt,It[0],ut()),It)],e.sin=(Pt,It)=>[Pt.run(Mt(Pt,It[0],ht()),It)],e.sqrt=(Pt,It)=>[Pt.run(Mt(Pt,It[0],_t()),It)],e.tan=(Pt,It)=>[Pt.run(Mt(Pt,It[0],bt()),It)],e.tanh=(Pt,It)=>[Pt.run(Mt(Pt,It[0],vt()),It)]},5611:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createUnpackProgramInfoLoader=e.createUnpackProgramInfo=void 0;const s=o(5060),c=o(2039),h=o(9390),_=o(2827),$={name:"unpack",inputNames:["A"],inputTypes:[c.TextureType.packed]};e.createUnpackProgramInfo=(nt,tt)=>{const et=tt.dims.length,d=(0,_.getChannels)("rc",et),a=d.slice(-2),g=(0,h.getCoordsDataType)(et),j=(0,_.unpackFromChannel)(),rt=tt.dims.length===0?"":function(at,lt){if(at===1)return"rc";let ct="";for(let dt=0;dt<at;dt++)ct+=lt[dt],dt<at-1&&(ct+=",");return ct}(et,d),ot=et<=1?"rc":`vec2(${a.join(",")})`,it=`
    ${j}
    void main() {
      ${g} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${rt});

       ${(0,s.getGlsl)(nt.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${ot}), 0, 0, 0);
     }
   `;return Object.assign(Object.assign({},$),{hasMain:!0,output:{dims:tt.dims,type:tt.type,textureType:c.TextureType.unpacked},shaderSource:it})},e.createUnpackProgramInfoLoader=(nt,tt)=>Object.assign(Object.assign({},$),{get:()=>(0,e.createUnpackProgramInfo)(nt,tt)})},8428:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseUnsqueezeAttributes=e.unsqueezeV13=e.unsqueeze=void 0;const s=o(2517);e.unsqueeze=(_,$,nt)=>{c($);const tt=s.ShapeUtil.unsqueezeShape($[0].dims,nt);return[_.reshapeUnpacked($[0],tt)]},e.unsqueezeV13=(_,$)=>(h($),(0,e.unsqueeze)(_,[$[0]],Array.from($[1].integerData))),e.parseUnsqueezeAttributes=_=>_.attributes.getInts("axes");const c=_=>{if(!_||_.length!==1)throw new Error("Unsqueeze requires 1 input.");if(_[0].type==="string")throw new Error("invalid input tensor types.")},h=_=>{if(!_||_.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(_[1].type!=="int32")throw new Error("Invalid input type.")}},9793:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.scalesValidation=e.validateInputs=e.parseUpsampleAttributes=e.parseUpsampleAttributesV9=e.parseUpsampleAttributesV7=e.upsample=void 0;const s=o(246),c=o(5060),h=o(2039),_={name:"Upsample",inputNames:["X"],inputTypes:[h.TextureType.unpacked]};e.upsample=(nt,tt,et)=>((0,e.validateInputs)(tt,et),[nt.run(Object.assign(Object.assign({},_),{cacheHint:et.cacheKey,get:()=>$(nt,tt,et)}),tt)]),e.parseUpsampleAttributesV7=nt=>(0,e.parseUpsampleAttributes)(nt,7),e.parseUpsampleAttributesV9=nt=>(0,e.parseUpsampleAttributes)(nt,9),e.parseUpsampleAttributes=(nt,tt)=>{const et=tt>=10,d=nt.attributes.getString("mode","nearest");if(d!=="nearest"&&d!=="linear"&&(tt<11||d!=="cubic"))throw new Error(`unrecognized mode: ${d}`);let a=[];tt<9&&(a=nt.attributes.getFloats("scales"),(0,e.scalesValidation)(a,d,et));const g=nt.attributes.getFloat("extrapolation_value",0),j=tt>10?nt.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(j)===-1)throw new Error(`coordinate_transform_mode '${j}' is not supported`);const rt=j==="tf_crop_and_resize",ot=rt,it=d==="nearest"&&tt>=11?nt.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(it)===-1)throw new Error(`nearest_mode '${it}' is not supported`);const at=nt.attributes.getFloat("cubic_coeff_a",-.75),lt=nt.attributes.getInt("exclude_outside",0)!==0;if(lt&&d!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");const ct=tt<11||d==="nearest"&&j==="asymmetric"&&it==="floor";let dt=0,mt=0,ht=0;return tt>10?nt.inputs.length>2?(dt=1,mt=2,ht=3):(mt=1,ht=2):tt===9&&(mt=1),(0,s.createAttributeWithCacheKey)({opset:tt,isResize:et,mode:d,scales:a,extrapolationValue:g,coordinateTransformMode:j,useExtrapolation:ot,needRoiInput:rt,nearestMode:it,cubicCoefficientA:at,excludeOutside:lt,useNearest2xOptimization:ct,roiInputIdx:dt,scalesInputIdx:mt,sizesInputIdx:ht})};const $=(nt,tt,et)=>{const d=(0,c.getGlsl)(nt.session.backend.glContext.version),[a,g]=nt.calculateTextureWidthAndHeight(tt[0].dims,h.TextureType.unpacked),j=tt[0].dims.map((ht,ft)=>Math.floor(ht*et.scales[ft])),[rt,ot]=nt.calculateTextureWidthAndHeight(j,h.TextureType.unpacked),it=j.length,at=new Array(it),lt=new Array(it);let ct=`
      int output_pitches[${it}];
      int input_pitches[${it}];
      `;for(let ht=it-1;ht>=0;ht--)at[ht]=ht===it-1?1:at[ht+1]*j[ht+1],lt[ht]=ht===it-1?1:lt[ht+1]*tt[0].dims[ht+1],ct+=`
        output_pitches[${ht}] = ${at[ht]};
        input_pitches[${ht}] = ${lt[ht]};
        `;const dt=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${a}, ${g});
        float value = getColorAsFloat(${d.texture2D}(X, coords));
        return value;
      }
      `,mt=et.mode==="nearest"?`
    ${dt}
    float process(int indices[${it}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${rt}, ${ot});

      ${ct}

      int d, m;
      for (int dim = 0; dim < ${it}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:it===4?`
    ${dt}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${rt}, ${ot});

      ${ct}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${tt[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${dt}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${rt}, ${ot});

      ${ct}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${tt[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return Object.assign(Object.assign({},_),{output:{dims:j,type:tt[0].type,textureType:h.TextureType.unpacked},shaderSource:mt,variables:[{name:"scales",type:"int",arrayLength:et.scales.length,data:et.scales.map(ht=>Math.ceil(ht))}]})};e.validateInputs=(nt,tt)=>{if(!nt||tt.opset<9&&nt.length!==1||tt.opset>=9&&tt.opset<11&&nt.length!==2||tt.opset>=11&&nt.length<2)throw new Error("invalid inputs.");if(tt.scales.length>0&&nt[0].dims.length!==tt.scales.length)throw new Error("Invalid input shape.");if(nt[0].type==="string")throw new Error("Invalid input tensor types.")},e.scalesValidation=(nt,tt,et)=>{if(et){for(const d of nt)if(d<=0)throw new Error("Scale value should be greater than 0.")}else for(const d of nt)if(d<1)throw new Error("Scale value should be greater than or equal to 1.");if(!(tt!=="linear"&&tt!=="cubic"||nt.length===2||nt.length===4&&nt[0]===1&&nt[1]===1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${et?"Resize":"Upsample"} opeartor.`)}},1958:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramManager=void 0;const s=o(1670),c=o(6231),h=o(8879),_=o(5060);e.ProgramManager=class{constructor($,nt,tt){this.profiler=$,this.glContext=nt,this.textureLayoutStrategy=tt,this.repo=new Map,this.attributesBound=!1}getArtifact($){return this.repo.get($)}setArtifact($,nt){this.repo.set($,nt)}run($,nt,tt){var et;this.profiler.event("op",`ProgramManager.run ${(et=$.programInfo.name)!==null&&et!==void 0?et:"unknown kernel"}`,()=>{var d;const a=this.glContext.gl,g=$.program;a.useProgram(g);try{this.bindOutput(tt),this.attributesBound||this.bindAttributes($.attribLocations),this.bindUniforms($.uniformLocations,(d=$.programInfo.variables)!==null&&d!==void 0?d:[],nt)}catch(j){throw c.Logger.error("ProgramManager",$.programInfo.shaderSource),j}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach($=>this.glContext.deleteProgram($.program))}build($,nt,tt){return this.profiler.event("backend","ProgramManager.build",()=>{const et=new h.GlslPreprocessor(this.glContext,$,nt,tt),d=et.preprocess(),a=this.compile(d);return{programInfo:$,program:a,uniformLocations:this.getUniformLocations(a,et.context.programInfo.inputNames,et.context.programInfo.variables),attribLocations:this.getAttribLocations(a)}})}compile($){if(!this.vertexShader){c.Logger.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");const et=(0,_.getVertexShaderSource)(this.glContext.version);this.vertexShader=this.glContext.compileShader(et,this.glContext.gl.VERTEX_SHADER)}s.env.debug&&c.Logger.verbose("ProrgramManager",`FragShader:
${$}
`);const nt=this.glContext.compileShader($,this.glContext.gl.FRAGMENT_SHADER),tt=this.glContext.createProgram(this.vertexShader,nt);return this.glContext.deleteShader(nt),tt}bindOutput($){const nt=$.width,tt=$.height;c.Logger.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${nt}/${tt}, shape=${$.shape}, type=${$.tensor.type}`),this.glContext.attachFramebuffer($.texture,nt,tt)}bindAttributes($){const nt=$.position,tt=$.textureCoord;this.glContext.setVertexAttributes(nt,tt),this.attributesBound=!0}bindUniforms($,nt,tt){var et;const d=this.glContext.gl;let a=0;for(const{name:g,type:j,location:rt,arrayLength:ot}of $){const it=(et=nt.find(at=>at.name===g))===null||et===void 0?void 0:et.data;if(j!=="sampler2D"&&!it)throw new Error(`variable '${g}' does not have data defined in program info`);switch(j){case"sampler2D":this.bindTexture(tt[a],rt,a),a++;break;case"float":ot?d.uniform1fv(rt,it):d.uniform1f(rt,it);break;case"int":ot?d.uniform1iv(rt,it):d.uniform1i(rt,it);break;default:throw new Error(`Uniform not implemented: ${j}`)}}}bindTexture($,nt,tt){this.glContext.bindTextureToUniform($.texture,tt,nt)}getAttribLocations($){return{position:this.getAttribLocation($,"position"),textureCoord:this.getAttribLocation($,"textureCoord")}}getUniformLocations($,nt,tt){const et=[];if(nt)for(const d of nt)et.push({name:d,type:"sampler2D",location:this.getUniformLocation($,d)});if(tt)for(const d of tt)et.push(Object.assign(Object.assign({},d),{location:this.getUniformLocation($,d.name)}));return et}getUniformLocation($,nt){const tt=this.glContext.gl.getUniformLocation($,nt);if(tt===null)throw new Error(`Uniform ${nt} not found.`);return tt}getAttribLocation($,nt){return this.glContext.gl.getAttribLocation($,nt)}}},6416:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLSessionHandler=void 0;const s=o(6231),c=o(1047),h=o(8316),_=o(1640),$=o(1958),nt=o(7859),tt=o(5702);e.WebGLSessionHandler=class{constructor(et,d){this.backend=et,this.context=d,this.layoutStrategy=new nt.PreferLogicalStrategy(et.glContext.maxTextureSize),this.programManager=new $.ProgramManager(this.context.profiler,et.glContext,this.layoutStrategy),this.textureManager=new tt.TextureManager(et.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:et.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=et.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new h.WebGLInferenceHandler(this)}onGraphInitialized(et){const d=et.getValues().filter(a=>a.from===-1&&a.tensor).map(a=>a.tensor.dataId);this.initializers=new Set(d)}isInitializer(et){return!!this.initializers&&this.initializers.has(et)}addInitializer(et){this.initializers.add(et)}getTextureData(et,d){return d?this.packedTextureDataCache.get(et):this.unpackedTextureDataCache.get(et)}setTextureData(et,d,a=!1){s.Logger.verbose("WebGLSessionHandler","Storing Texture data in cache"),a?this.packedTextureDataCache.set(et,d):this.unpackedTextureDataCache.set(et,d)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(et=>this.textureManager.releaseTexture(et,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(et=>this.textureManager.releaseTexture(et,!0)),this.unpackedTextureDataCache=new Map}resolve(et,d,a){const g=(0,c.resolveOperator)(et,d,_.WEBGL_OP_RESOLVE_RULES);return{impl:g.opImpl,context:g.opInit?g.opInit(et,a):et}}}},7769:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Uint8DataEncoder=e.RGBAFloatDataEncoder=e.RedFloat32DataEncoder=void 0;const s=o(6231);e.RedFloat32DataEncoder=class{constructor(c,h=1){if(h===1)this.internalFormat=c.R32F,this.format=c.RED,this.textureType=c.FLOAT,this.channelSize=h;else{if(h!==4)throw new Error(`Invalid number of channels: ${h}`);this.internalFormat=c.RGBA32F,this.format=c.RGBA,this.textureType=c.FLOAT,this.channelSize=h}}encode(c,h){let _,$;return c.constructor!==Float32Array&&(s.Logger.warning("Encoder","data was not of type Float32; creating new Float32Array"),$=new Float32Array(c)),h*this.channelSize>c.length?(s.Logger.warning("Encoder","Source data too small. Allocating larger array"),$=c,_=this.allocate(h*this.channelSize),$.forEach((nt,tt)=>_[tt]=nt)):($=c,_=$),_}allocate(c){return new Float32Array(4*c)}decode(c,h){return this.channelSize===1?c.filter((_,$)=>$%4==0).subarray(0,h):c.subarray(0,h)}},e.RGBAFloatDataEncoder=class{constructor(c,h=1,_){if(h!==1&&h!==4)throw new Error(`Invalid number of channels: ${h}`);this.internalFormat=c.RGBA,this.format=c.RGBA,this.channelSize=h,this.textureType=_||c.FLOAT}encode(c,h){let _=c;return this.channelSize===1&&(s.Logger.verbose("Encoder","Exploding into a larger array"),_=this.allocate(h),c.forEach(($,nt)=>_[4*nt]=$)),_}allocate(c){return new Float32Array(4*c)}decode(c,h){return this.channelSize===1?c.filter((_,$)=>$%4==0).subarray(0,h):c.subarray(0,h)}},e.Uint8DataEncoder=class{constructor(c,h=1){if(this.channelSize=4,h===1)this.internalFormat=c.ALPHA,this.format=c.ALPHA,this.textureType=c.UNSIGNED_BYTE,this.channelSize=h;else{if(h!==4)throw new Error(`Invalid number of channels: ${h}`);this.internalFormat=c.RGBA,this.format=c.RGBA,this.textureType=c.UNSIGNED_BYTE,this.channelSize=h}}encode(c,h){return new Uint8Array(c.buffer,c.byteOffset,c.byteLength)}allocate(c){return new Uint8Array(c*this.channelSize)}decode(c,h){if(c instanceof Uint8Array)return c.subarray(0,h);throw new Error(`Invalid array type: ${c.constructor}`)}}},7859:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getBatchDim=e.sizeToSquarishShape=e.getRowsCols=e.sizeFromShape=e.isInt=e.parseAxisParam=e.squeezeShape=e.PreferLogicalStrategy=e.AlwaysKeepOriginalSizeStrategy=void 0;const s=o(6231),c=o(2517);function h(et,d){const a=[],g=[],j=d!=null&&Array.isArray(d)&&d.length===0,rt=d==null||j?null:_(d,et).sort();let ot=0;for(let it=0;it<et.length;++it){if(rt!=null){if(rt[ot]===it&&et[it]!==1)throw new Error(`Can't squeeze axis ${it} since its dim '${et[it]}' is not 1`);(rt[ot]==null||rt[ot]>it)&&et[it]===1&&(a.push(et[it]),g.push(it)),rt[ot]<=it&&ot++}et[it]!==1&&(a.push(et[it]),g.push(it))}return{newShape:a,keptDims:g}}function _(et,d){const a=d.length;return et=et==null?d.map((g,j)=>j):[].concat(et),(0,c.assert)(et.every(g=>g>=-a&&g<a),()=>`All values in axis param must be in range [-${a}, ${a}) but got axis ${et}`),(0,c.assert)(et.every($),()=>`All values in axis param must be integers but got axis ${et}`),et.map(g=>g<0?a+g:g)}function $(et){return et%1==0}function nt(et){if(et.length===0)return 1;let d=et[0];for(let a=1;a<et.length;a++)d*=et[a];return d}function tt(et){const d=Math.ceil(Math.sqrt(et));return[d,Math.ceil(et/d)]}e.AlwaysKeepOriginalSizeStrategy=class{constructor(et){this.maxTextureSize=et}computeTextureWH(et,d){if(et.length===0)return[1,1];const a=this.maxTextureSize;if(d&&d.breakAxis!==void 0){const rt=d.breakAxis>=et.length?1:et.slice(d.breakAxis).reduce((it,at)=>it*at),ot=d.breakAxis<=0?1:et.slice(0,d.breakAxis).reduce((it,at)=>it*at);if(!(rt>a||ot>a))return[rt,ot];s.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${et}, breakAxis:${d.breakAxis}`)}const g=et.reduce((rt,ot)=>rt*ot);let j=Math.floor(Math.sqrt(g));for(;j<a&&j<g&&g%j!=0;j++);if(j>=a||g%j!=0)throw new Error(`The given dimensions are outside this GPU's boundaries: ${et}`);return[j,g/j]}},e.PreferLogicalStrategy=class{constructor(et){this.maxTextureSize=et}computeTextureWH(et,d){const a=this.computeTexture(et,d);return d&&d.isPacked&&(a[0]/=2,a[1]/=2),d&&d.reverseWH?[a[1],a[0]]:a}computeTexture(et,d){const a=d&&d.isPacked;if(et.length===0)return a?[2,2]:[1,1];let g=this.maxTextureSize;if(d&&d.breakAxis!==void 0){const ot=d.breakAxis>=et.length?1:et.slice(d.breakAxis).reduce((at,lt)=>at*lt),it=d.breakAxis<=0?1:et.slice(0,d.breakAxis).reduce((at,lt)=>at*lt);if(!(ot>g||it>g))return[ot,it];s.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${et}, breakAxis:${d.breakAxis}`)}let j=et.slice(0);a&&(g*=2,j=j.map((ot,it)=>it>=j.length-2?j[it]%2==0?j[it]:j[it]+1:j[it]),j.length===1&&(j=[2,j[0]])),j.length!==2&&(j=h(j).newShape);const rt=nt(j);return j.length<=1&&rt<=g?[1,rt]:j.length===2&&j[0]<=g&&j[1]<=g?j:j.length===3&&j[0]*j[1]<=g&&j[2]<=g?[j[0]*j[1],j[2]]:j.length===3&&j[0]<=g&&j[1]*j[2]<=g?[j[0],j[1]*j[2]]:j.length===4&&j[0]*j[1]*j[2]<=g&&j[3]<=g?[j[0]*j[1]*j[2],j[3]]:j.length===4&&j[0]<=g&&j[1]*j[2]*j[3]<=g?[j[0],j[1]*j[2]*j[3]]:a?tt(rt/4).map(ot=>2*ot):tt(rt)}},e.squeezeShape=h,e.parseAxisParam=_,e.isInt=$,e.sizeFromShape=nt,e.getRowsCols=function(et){if(et.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[et.length>1?et[et.length-2]:1,et[et.length-1]]},e.sizeToSquarishShape=tt,e.getBatchDim=function(et,d=2){return nt(et.slice(0,et.length-d))}},4057:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createTextureLayoutFromShape=e.calculateTextureWidthAndHeight=e.createTextureLayoutFromTextureType=void 0;const s=o(2517),c=o(2039);e.createTextureLayoutFromTextureType=(h,_,$)=>{const nt=$===c.TextureType.unpacked||$===c.TextureType.unpackedReversed?1:4,tt=$===c.TextureType.packed,et=$===c.TextureType.unpackedReversed||$===c.TextureType.packed,d=$===c.TextureType.packedLastDimension?_.length-1:void 0,a=$===c.TextureType.packedLastDimension?_.map((g,j)=>j===_.length-1?4*g:g):void 0;return(0,e.createTextureLayoutFromShape)(h,_,nt,a,{isPacked:tt,reverseWH:et,breakAxis:d})},e.calculateTextureWidthAndHeight=(h,_,$)=>{const nt=(0,e.createTextureLayoutFromTextureType)(h,_,$);return[nt.width,nt.height]},e.createTextureLayoutFromShape=(h,_,$=1,nt,tt)=>{const et=!(!tt||!tt.isPacked),[d,a]=h.computeTextureWH(et&&nt||_,tt),g=_.length;let j=_.slice(0);if(g===0&&(j=[1]),$===1)nt=_;else if(et){if($!==4)throw new Error("a packed texture must be 4-channel");nt=_,g>0&&(j[g-1]=Math.ceil(j[g-1]/2)),g>1&&(j[g-2]=Math.ceil(j[g-2]/2))}else if(!nt)throw new Error("Unpacked shape is needed when using channels > 1");return{width:d,height:a,channels:$,isPacked:et,shape:j,strides:s.ShapeUtil.computeStrides(j),unpackedShape:nt,reversedWH:tt&&tt.reverseWH}}},5702:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextureManager=void 0;const s=o(6231);e.TextureManager=class{constructor(c,h,_,$){this.glContext=c,this.layoutStrategy=h,this.profiler=_,this.config=$,this.pendingRead=new Map,$.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(c,h,_,$){const nt=this.toEncoderType(c),tt=this.glContext.getEncoder(nt,h.channels||1,$);if(h.isPacked&&$===1)throw new Error("not implemented");const et=h.width,d=h.height;let a,g;if(this.config.reuseTextures){a=`${et}x${d}_${tt.format}_${tt.internalFormat}_${tt.textureType}`,g=this.inUseTextures.get(a),g||(g=[],this.inUseTextures.set(a,g));const rt=this.idleTextures.get(a);if(rt&&rt.length>0){const ot=rt.pop();return g.push(ot),$===1&&this.glContext.updateTexture(ot,et,d,tt,this.toTextureData(c,_)),ot}}s.Logger.verbose("TextureManager",`Creating new texture of size ${h.width}x${h.height}`);const j=this.glContext.allocateTexture(et,d,tt,this.toTextureData(c,_));return this.config.reuseTextures&&(g.push(j),this.textureLookup.set(j,a)),j}readTexture(c,h,_){return _||(_=1),this.profiler.event("backend","TextureManager.readTexture",()=>{const $=c.shape.reduce((tt,et)=>tt*et)*_,nt=this.glContext.readTexture(c.texture,c.width,c.height,$,this.toEncoderType(h),_);return this.toTensorData(h,nt)})}async readTextureAsync(c,h,_){const $=c.tensor.dataId;if(_||(_=1),this.pendingRead.has($)){const nt=this.pendingRead.get($);return new Promise(tt=>nt==null?void 0:nt.push(tt))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set($,[]);const nt=c.shape.reduce((a,g)=>a*g)*_;await this.glContext.createAndWaitForFence();const tt=this.glContext.readTexture(c.texture,c.width,c.height,nt,this.toEncoderType(h),_),et=this.toTensorData(h,tt),d=this.pendingRead.get($);return this.pendingRead.delete($),d==null||d.forEach(a=>a(et)),et})}readUint8TextureAsFloat(c){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{const h=c.shape.reduce(($,nt)=>$*nt),_=this.glContext.readTexture(c.texture,c.width,c.height,4*h,"byte",4);return new Float32Array(_.buffer,_.byteOffset,h)})}releaseTexture(c,h){let _;if(this.config.reuseTextures&&(_=this.textureLookup.get(c.texture),_)){h&&this.textureLookup.delete(_);const $=this.inUseTextures.get(_);if($){const nt=$.indexOf(c.texture);if(nt!==-1){$.splice(nt,1);let tt=this.idleTextures.get(_);tt||(tt=[],this.idleTextures.set(_,tt)),tt.push(c.texture)}}}_&&!h||(s.Logger.verbose("TextureManager",`Deleting texture of size ${c.width}x${c.height}`),this.glContext.deleteTexture(c.texture))}toTensorData(c,h){switch(c){case"int16":return h instanceof Int16Array?h:Int16Array.from(h);case"int32":return h instanceof Int32Array?h:Int32Array.from(h);case"int8":return h instanceof Int8Array?h:Int8Array.from(h);case"uint16":return h instanceof Uint16Array?h:Uint16Array.from(h);case"uint32":return h instanceof Uint32Array?h:Uint32Array.from(h);case"uint8":case"bool":return h instanceof Uint8Array?h:Uint8Array.from(h);case"float32":return h instanceof Float32Array?h:Float32Array.from(h);case"float64":return h instanceof Float64Array?h:Float64Array.from(h);default:throw new Error(`TensorData type ${c} is not supported`)}}toTextureData(c,h){if(h)return h instanceof Float32Array?h:new Float32Array(h)}toEncoderType(c){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}},2039:(i,e)=>{var o;Object.defineProperty(e,"__esModule",{value:!0}),e.TextureType=void 0,(o=e.TextureType||(e.TextureType={}))[o.unpacked=0]="unpacked",o[o.unpackedReversed=1]="unpackedReversed",o[o.packed=2]="packed",o[o.downloadUint8AsFloat=3]="downloadUint8AsFloat",o[o.packedLastDimension=4]="packedLastDimension"},9390:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getGlChannels=e.getCoordsDataType=e.getSqueezedParams=e.squeezeInputShape=e.generateShaderFuncNameFromInputSamplerNameAtOutCoords=e.generateShaderFuncNameFromInputSamplerName=e.repeatedTry=e.getPackedShape=void 0;const s=o(2517);e.getPackedShape=function(c){const h=c.length;return c.slice(0,h-1).concat(c[h-1]/4)},e.repeatedTry=async function(c,h=$=>0,_){return new Promise(($,nt)=>{let tt=0;const et=()=>{if(c())return void $();tt++;const d=h(tt);_!=null&&tt>=_?nt():setTimeout(et,d)};et()})},e.generateShaderFuncNameFromInputSamplerName=function(c){return(0,s.assert)(c!==void 0&&c.length!==0,()=>"empty string found for sampler name"),"get"+c.charAt(0).toUpperCase()+c.slice(1)},e.generateShaderFuncNameFromInputSamplerNameAtOutCoords=function(c){return(0,s.assert)(c!==void 0&&c.length!==0,()=>"empty string found for sampler name"),"get"+c.charAt(0).toUpperCase()+c.slice(1)+"AtOutCoords"},e.squeezeInputShape=function(c,h){let _=JSON.parse(JSON.stringify(c));return _=h,_},e.getSqueezedParams=function(c,h){return h.map(_=>c[_]).join(", ")},e.getCoordsDataType=function(c){if(c<=1)return"int";if(c===2)return"ivec2";if(c===3)return"ivec3";if(c===4)return"ivec4";if(c===5)return"ivec5";if(c===6)return"ivec6";throw Error(`GPU for rank ${c} is not yet supported`)},e.getGlChannels=function(c=6){return["x","y","z","w","u","v"].slice(0,c)}},7305:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createNewWebGLContext=e.createWebGLContext=void 0;const s=o(6231),c=o(1713),h={};function _($){const nt=function(){if(typeof document>"u"){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}const d=document.createElement("canvas");return d.width=1,d.height=1,d}();let tt;const et={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!$||$==="webgl2")&&(tt=nt.getContext("webgl2",et),tt))try{return new c.WebGLContext(tt,2)}catch(d){s.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${d}`)}if((!$||$==="webgl")&&(tt=nt.getContext("webgl",et)||nt.getContext("experimental-webgl",et),tt))try{return new c.WebGLContext(tt,1)}catch(d){s.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${d}`)}throw new Error("WebGL is not supported")}e.createWebGLContext=function $(nt){let tt;nt&&nt!=="webgl2"||!("webgl2"in h)?nt&&nt!=="webgl"||!("webgl"in h)||(tt=h.webgl):tt=h.webgl2,tt=tt||_(nt),nt=nt||tt.version===1?"webgl":"webgl2";const et=tt.gl;return h[nt]=tt,et.isContextLost()?(delete h[nt],$(nt)):(et.disable(et.DEPTH_TEST),et.disable(et.STENCIL_TEST),et.disable(et.BLEND),et.disable(et.DITHER),et.disable(et.POLYGON_OFFSET_FILL),et.disable(et.SAMPLE_COVERAGE),et.enable(et.SCISSOR_TEST),et.enable(et.CULL_FACE),et.cullFace(et.BACK),tt)},e.createNewWebGLContext=_},1713:function(i,e,o){var s=this&&this.__createBinding||(Object.create?function(et,d,a,g){g===void 0&&(g=a);var j=Object.getOwnPropertyDescriptor(d,a);j&&!("get"in j?!d.__esModule:j.writable||j.configurable)||(j={enumerable:!0,get:function(){return d[a]}}),Object.defineProperty(et,g,j)}:function(et,d,a,g){g===void 0&&(g=a),et[g]=d[a]}),c=this&&this.__setModuleDefault||(Object.create?function(et,d){Object.defineProperty(et,"default",{enumerable:!0,value:d})}:function(et,d){et.default=d}),h=this&&this.__importStar||function(et){if(et&&et.__esModule)return et;var d={};if(et!=null)for(var a in et)a!=="default"&&Object.prototype.hasOwnProperty.call(et,a)&&s(d,et,a);return c(d,et),d};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLContext=e.linearSearchLastTrue=void 0;const _=o(1670),$=h(o(7769)),nt=o(9390);function tt(et){let d=0;for(;d<et.length&&et[d]();++d);return d-1}e.linearSearchLastTrue=tt,e.WebGLContext=class{constructor(et,d){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=et,this.version=d,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(et,d,a,g){const j=this.gl,rt=j.createTexture();j.bindTexture(j.TEXTURE_2D,rt),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.NEAREST),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.NEAREST),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE);const ot=g?a.encode(g,et*d):null;return j.texImage2D(j.TEXTURE_2D,0,a.internalFormat,et,d,0,a.format,a.textureType,ot),this.checkError(),rt}updateTexture(et,d,a,g,j){const rt=this.gl;rt.bindTexture(rt.TEXTURE_2D,et);const ot=g.encode(j,d*a);rt.texSubImage2D(rt.TEXTURE_2D,0,0,0,d,a,g.format,g.textureType,ot),this.checkError()}attachFramebuffer(et,d,a){const g=this.gl;g.bindTexture(g.TEXTURE_2D,et),g.bindFramebuffer(g.FRAMEBUFFER,this.framebuffer),g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,et,0),this.checkError(),g.viewport(0,0,d,a),g.scissor(0,0,d,a)}readTexture(et,d,a,g,j,rt){const ot=this.gl;rt||(rt=1),this.frameBufferBound||this.attachFramebuffer(et,d,a);const it=this.getEncoder(j,rt),at=it.allocate(d*a);return ot.bindTexture(ot.TEXTURE_2D,et),ot.framebufferTexture2D(ot.FRAMEBUFFER,ot.COLOR_ATTACHMENT0,ot.TEXTURE_2D,et,0),ot.readPixels(0,0,d,a,ot.RGBA,it.textureType,at),this.checkError(),it.decode(at,g)}isFramebufferReady(){return!0}getActiveTexture(){const et=this.gl;return"TEXTURE"+(et.getParameter(this.gl.ACTIVE_TEXTURE)-et.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(et,d){const a=this.gl;a.vertexAttribPointer(et,3,a.FLOAT,!1,20,0),a.enableVertexAttribArray(et),d!==-1&&(a.vertexAttribPointer(d,2,a.FLOAT,!1,20,12),a.enableVertexAttribArray(d)),this.checkError()}createProgram(et,d){const a=this.gl,g=a.createProgram();return a.attachShader(g,et),a.attachShader(g,d),a.linkProgram(g),g}compileShader(et,d){const a=this.gl,g=a.createShader(d);if(!g)throw new Error(`createShader() returned null with type ${d}`);if(a.shaderSource(g,et),a.compileShader(g),a.getShaderParameter(g,a.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${a.getShaderInfoLog(g)}
Shader source:
${et}`);return g}deleteShader(et){this.gl.deleteShader(et)}bindTextureToUniform(et,d,a){const g=this.gl;g.activeTexture(g.TEXTURE0+d),this.checkError(),g.bindTexture(g.TEXTURE_2D,et),this.checkError(),g.uniform1i(a,d),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(_.env.debug){const et=this.gl,d=et.getError();let a="";switch(d){case et.NO_ERROR:return;case et.INVALID_ENUM:a="INVALID_ENUM";break;case et.INVALID_VALUE:a="INVALID_VALUE";break;case et.INVALID_OPERATION:a="INVALID_OPERATION";break;case et.INVALID_FRAMEBUFFER_OPERATION:a="INVALID_FRAMEBUFFER_OPERATION";break;case et.OUT_OF_MEMORY:a="OUT_OF_MEMORY";break;case et.CONTEXT_LOST_WEBGL:a="CONTEXT_LOST_WEBGL";break;default:a=`Unknown WebGL Error: ${d.toString(16)}`}throw new Error(a)}}deleteTexture(et){this.gl.deleteTexture(et)}deleteProgram(et){this.gl.deleteProgram(et)}getEncoder(et,d,a=0){if(this.version===2)return new $.RedFloat32DataEncoder(this.gl,d);switch(et){case"float":return a===1||this.isRenderFloat32Supported?new $.RGBAFloatDataEncoder(this.gl,d):new $.RGBAFloatDataEncoder(this.gl,d,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new $.Uint8DataEncoder(this.gl,d);default:throw new Error(`Invalid dataType: ${et}`)}}clearActiveTextures(){const et=this.gl;for(let d=0;d<this.maxTextureImageUnits;++d)et.activeTexture(et.TEXTURE0+d),et.bindTexture(et.TEXTURE_2D,null)}dispose(){if(this.disposed)return;const et=this.gl;et.bindFramebuffer(et.FRAMEBUFFER,null),et.deleteFramebuffer(this.framebuffer),et.bindBuffer(et.ARRAY_BUFFER,null),et.deleteBuffer(this.vertexbuffer),et.bindBuffer(et.ELEMENT_ARRAY_BUFFER,null),et.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){const et=this.gl,d=et.createBuffer();if(!d)throw new Error("createBuffer() returned null");const a=this.createDefaultGeometry();return et.bindBuffer(et.ARRAY_BUFFER,d),et.bufferData(et.ARRAY_BUFFER,a,et.STATIC_DRAW),this.checkError(),d}createFramebuffer(){const et=this.gl.createFramebuffer();if(!et)throw new Error("createFramebuffer returned null");return et}queryVitalParameters(){const et=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=et.getParameter(et.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=et.getParameter(et.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){const et=this.gl,d=et.createTexture();et.bindTexture(et.TEXTURE_2D,d);const a=this.version===2?et.RGBA32F:et.RGBA;et.texImage2D(et.TEXTURE_2D,0,a,1,1,0,et.RGBA,et.FLOAT,null);const g=et.createFramebuffer();et.bindFramebuffer(et.FRAMEBUFFER,g),et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,d,0);const j=et.checkFramebufferStatus(et.FRAMEBUFFER)===et.FRAMEBUFFER_COMPLETE;return et.bindTexture(et.TEXTURE_2D,null),et.bindFramebuffer(et.FRAMEBUFFER,null),et.deleteTexture(d),et.deleteFramebuffer(g),j}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){const et=this.gl;let d,a,g,j,rt;try{d=et.createTexture(),a=et.createFramebuffer(),et.bindTexture(et.TEXTURE_2D,d);const ot=this.version===2?et.RGBA32F:et.RGBA;return et.texImage2D(et.TEXTURE_2D,0,ot,1,1,0,et.RGBA,et.FLOAT,null),et.bindFramebuffer(et.FRAMEBUFFER,a),et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,d,0),et.enable(et.BLEND),g=et.createShader(et.VERTEX_SHADER),!!g&&(et.shaderSource(g,"void main(){}"),et.compileShader(g),j=et.createShader(et.FRAGMENT_SHADER),!!j&&(et.shaderSource(j,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),et.compileShader(j),rt=et.createProgram(),!!rt&&(et.attachShader(rt,g),et.attachShader(rt,j),et.linkProgram(rt),et.useProgram(rt),et.drawArrays(et.POINTS,0,1),et.getError()===et.NO_ERROR)))}finally{et.disable(et.BLEND),rt&&et.deleteProgram(rt),g&&et.deleteShader(g),j&&et.deleteShader(j),a&&(et.bindFramebuffer(et.FRAMEBUFFER,null),et.deleteFramebuffer(a)),d&&(et.bindTexture(et.TEXTURE_2D,null),et.deleteTexture(d))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){const et=this.gl,d=this.disjointTimerQueryWebgl2Extension,a=et.createQuery();return et.beginQuery(d.TIME_ELAPSED_EXT,a),a}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const et=this.gl,d=this.disjointTimerQueryWebgl2Extension;et.endQuery(d.TIME_ELAPSED_EXT)}}isTimerResultAvailable(et){let d=!1,a=!1;if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const g=this.gl,j=this.disjointTimerQueryWebgl2Extension;d=g.getQueryParameter(et,g.QUERY_RESULT_AVAILABLE),a=g.getParameter(j.GPU_DISJOINT_EXT)}return d&&!a}getTimerResult(et){let d=0;if(this.version!==2)throw new Error("WebGL1 profiling currently not supported");{const a=this.gl;d=a.getQueryParameter(et,a.QUERY_RESULT),a.deleteQuery(et)}return d/1e6}async waitForQueryAndGetTime(et){return await(0,nt.repeatedTry)(()=>this.isTimerResultAvailable(et)),this.getTimerResult(et)}async createAndWaitForFence(){const et=this.createFence(this.gl);return this.pollFence(et)}createFence(et){let d;const a=et,g=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);return et.flush(),d=g===null?()=>!0:()=>{const j=a.clientWaitSync(g,0,0);return j===a.ALREADY_SIGNALED||j===a.CONDITION_SATISFIED},{query:g,isFencePassed:d}}async pollFence(et){return new Promise(d=>{this.addItemToPoll(()=>et.isFencePassed(),()=>d())})}pollItems(){const et=tt(this.itemsToPoll.map(d=>d.isDoneFn));for(let d=0;d<=et;++d){const{resolveFn:a}=this.itemsToPoll[d];a()}this.itemsToPoll=this.itemsToPoll.slice(et+1)}async addItemToPoll(et,d){this.itemsToPoll.push({isDoneFn:et,resolveFn:d}),this.itemsToPoll.length>1||await(0,nt.repeatedTry)(()=>(this.pollItems(),this.itemsToPoll.length===0))}}},1036:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExecutionPlan=void 0;const s=o(6231);class c{constructor(_,$){this.op=_,this.node=$}}e.ExecutionPlan=class{constructor(h,_,$){this.graph=h,this.profiler=$,this.initialize(_)}initialize(h){this.profiler.event("session","ExecutionPlan.initialize",()=>{const _=this.graph.getNodes();if(_.length!==h.length)throw new Error("The size of nodes and OPs do not match.");this._ops=h.map(($,nt)=>new c($,_[nt])),this.reset(),this._starter=[],this._ops.forEach(($,nt)=>{let tt=!0;for(const et of $.node.inputs)if(!this._values[et]&&this.graph.getInputIndices().indexOf(et)===-1){tt=!1;break}tt&&this._starter.push(nt)})})}reset(){this._values=this.graph.getValues().map(h=>h.tensor)}async execute(h,_){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();const $=h.createInferenceHandler(),nt=this.graph.getInputIndices();if(_.length!==nt.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${_.length} expected: ${nt.length}`);_.forEach((j,rt)=>{const ot=nt[rt];this._values[ot]=j});const tt=this._starter.slice(0),et=this.graph.getValues(),d=this.graph.getNodes();let a=0;for(;a<tt.length;){const j=tt[a++],rt=this._ops[j],ot=rt.node.inputs.map(ct=>this._values[ct]);if(ot.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${rt.node}`);const it=ot;s.Logger.verbose("ExecPlan",`Runing op:${rt.node.name} (${it.map((ct,dt)=>`'${rt.node.inputs[dt]}': ${ct.type}[${ct.dims.join(",")}]`).join(", ")})`);const at=await this.profiler.event("node",rt.node.name,async()=>rt.op.impl($,it,rt.op.context));if(at.length!==rt.node.outputs.length)throw new Error("the size of output does not match model definition.");at.forEach((ct,dt)=>{const mt=rt.node.outputs[dt];if(this._values[mt])throw new Error(`output [${mt}] already has value: op:${rt.node.name}`);this._values[mt]=ct});const lt=new Set;at.forEach((ct,dt)=>{const mt=rt.node.outputs[dt];for(const ht of et[mt].to){const ft=d[ht];let ut=!0;for(const _t of ft.inputs)if(!this._values[_t]){ut=!1;break}ut&&lt.add(ht)}}),tt.push(...lt)}const g=[];for(let j=0;j<this.graph.getOutputIndices().length;j++){const rt=this.graph.getOutputIndices()[j],ot=this._values[rt];if(ot===void 0)throw new Error(`required output [${rt}] does not have value`);rt===0?await ot.getData():ot.data,g.push(ot)}return s.Logger.verbose("ExecPlan","disposing of inferenceHandler"),$.dispose(),g})}}},7070:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Graph=void 0;const s=o(1446),c=o(7778),h=o(9395),_=o(9162),$=o(2517);var nt=h.onnxruntime.experimental.fbs;e.Graph={from:(a,g)=>new d(a,g)};class tt{constructor(g){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,g&&(this.type=$.ProtoUtil.tensorValueTypeFromProto(g.type.tensorType))}get from(){return this._from}get to(){return this._to}}class et{constructor(g,j){g instanceof s.onnx.NodeProto?(this.name=g.name,this.opType=g.opType,this.attributes=new c.Attribute(g.attribute)):g instanceof nt.Node&&(this.name=j??g.name(),this.opType=g.opType(),this.attributes=new c.Attribute($.ProtoUtil.tensorAttributesFromORTFormat(g))),this.inputs=[],this.outputs=[],this.executeNode=!0}}class d{constructor(g,j){if(!g)throw new TypeError("graph is empty");this.buildGraph(g),this.transformGraph(j),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(g){if(g instanceof s.onnx.GraphProto)this.buildGraphFromOnnxFormat(g);else{if(!(g instanceof nt.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(g)}}buildGraphFromOnnxFormat(g){const j=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const rt=new Map;if(!g.input)throw new Error("missing information in graph: input");const ot=[];for(const it of g.input){if(j.has(it.name))throw new Error(`duplicated input name: ${it.name}`);const at=this._allData.push(new tt(it))-1;j.set(it.name,at),ot.push(it.name)}if(!g.initializer)throw new Error("missing information in graph: initializer");for(const it of g.initializer){let at=j.get(it.name);if(at===void 0){const lt=new tt;lt.type={shape:{dims:$.ProtoUtil.tensorDimsFromProto(it.dims)},tensorType:$.ProtoUtil.tensorDataTypeFromProto(it.dataType)},at=this._allData.push(lt)-1,j.set(it.name,at)}this._allData[at]._from=-1,this._allData[at].tensor=_.Tensor.fromProto(it)}for(let it=0;it<this._allData.length;it++)this._allData[it].tensor||(this._allInputIndices.push(it),this._allInputNames.push(ot[it]));if(!g.output)throw new Error("missing information in graph: output");for(const it of g.output){if(j.has(it.name))throw new Error(`duplicated output name: ${it.name}`);const at=this._allData.push(new tt(it))-1;j.set(it.name,at),this._allOutputIndices.push(at),this._allOutputNames.push(it.name)}if(!g.node)throw new Error("missing information in graph: node");for(const it of g.node){if(!it.name)for(let lt=0;;lt++){const ct=`unnamed_${it.opType}_${lt}`;if(!rt.has(ct)){it.name=ct;break}}if(rt.has(it.name))throw new Error(`duplicated node name: ${it.name}`);const at=this._nodes.push(new et(it))-1;rt.set(it.name,at)}for(let it=0;it<this._nodes.length;it++){const at=this._nodes[it],lt=g.node[it];if(!lt.output)throw new Error(`missing output for node: ${lt.name}`);for(const ct of lt.output){let dt=j.get(ct);if(dt===void 0&&(dt=this._allData.push(new tt)-1,j.set(ct,dt)),at.outputs.push(dt),this._allData[dt]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${dt}`);if(this._allData[dt]._from=it,lt.opType==="Constant"){if(!lt.attribute||lt.attribute.length!==1||!lt.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!lt.output||lt.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");at.outputs.pop(),at.executeNode=!1,this._allData[dt]._from=-1,this._allData[dt].tensor=_.Tensor.fromProto(lt.attribute[0].t)}}}for(let it=0;it<this._nodes.length;it++){const at=this._nodes[it],lt=g.node[it];if(!lt.input)throw new Error(`missing input for node: ${lt.name}`);for(const ct of lt.input){const dt=j.get(ct);if(dt===void 0){if(ct===""&&lt.input.length===3&&lt.opType==="Resize")continue;throw new Error(`unrecognized input '${ct}' for node: ${lt.name}`)}at.inputs.push(dt),this._allData[dt]._to.push(it)}}return!0}buildGraphFromOrtFormat(g){var j,rt,ot;const it=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const at=new Map,lt=[];for(let ct=0;ct<g.inputsLength();ct++){const dt=g.inputs(ct);if(it.has(dt))throw new Error(`duplicated input name: ${dt}`);for(let mt=0;mt<g.nodeArgsLength();mt++)if(((j=g.nodeArgs(mt))===null||j===void 0?void 0:j.name())===dt){const ht=new tt;if(((ot=(rt=g.nodeArgs(mt))===null||rt===void 0?void 0:rt.type())===null||ot===void 0?void 0:ot.valueType())!==nt.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");const ft=g.nodeArgs(mt).type().value(new nt.TensorTypeAndShape),ut=$.ProtoUtil.tensorDataTypeFromProto(ft.elemType()),_t=ft.shape(),bt=[];for(let Tt=0;Tt<_t.dimLength();Tt++)bt.push($.LongUtil.longToNumber(_t.dim(Tt).value().dimValue()));ht.type={shape:{dims:bt},tensorType:ut};const vt=this._allData.push(ht)-1;it.set(dt,vt),lt.push(dt)}}for(let ct=0;ct<g.initializersLength();ct++){const dt=g.initializers(ct);let mt=it.get(dt.name());if(mt===void 0){const ht=new tt,ft=$.ProtoUtil.tensorDimsFromORTFormat(dt),ut=$.ProtoUtil.tensorDataTypeFromProto(dt.dataType());ht.type={shape:{dims:ft},tensorType:ut},mt=this._allData.push(ht)-1,it.set(dt.name(),mt)}this._allData[mt]._from=-1,this._allData[mt].tensor=_.Tensor.fromOrtTensor(dt)}for(let ct=0;ct<this._allData.length;ct++)this._allData[ct].tensor||(this._allInputIndices.push(ct),this._allInputNames.push(lt[ct]));for(let ct=0;ct<g.outputsLength();ct++){const dt=g.outputs(ct);if(it.has(dt))throw new Error(`duplicated output name: ${dt}`);const mt=this._allData.push(new tt)-1;it.set(dt,mt),this._allOutputIndices.push(mt),this._allOutputNames.push(dt)}if(!g.nodes)throw new Error("missing information in graph: node");for(let ct=0;ct<g.nodesLength();ct++){const dt=g.nodes(ct);let mt=dt.name();if(!mt)for(let ft=0;mt=`unnamed_${dt.opType()}_${ft}`,at.has(mt);ft++);if(at.has(mt))throw new Error(`duplicated node name: ${mt}`);const ht=this._nodes.push(new et(dt,mt))-1;at.set(mt,ht)}for(let ct=0;ct<this._nodes.length;ct++){const dt=this._nodes[ct],mt=g.nodes(ct);if(mt==null)throw new Error(`No node exists at index ${ct}`);if((mt==null?void 0:mt.outputsLength())===0)throw new Error(`missing output for node: ${mt.name}`);for(let ht=0;ht<(mt==null?void 0:mt.outputsLength());ht++){const ft=mt==null?void 0:mt.outputs(ht);let ut=it.get(ft);if(ut===void 0&&(ut=this._allData.push(new tt)-1,it.set(ft,ut)),dt.outputs.push(ut),this._allData[ut]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${ut}`);if(this._allData[ut]._from=ct,mt.opType()==="Constant"){if(mt.attributesLength()!==1||!mt.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(mt.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");dt.outputs.pop(),dt.executeNode=!1,this._allData[ut]._from=-1,this._allData[ut].tensor=_.Tensor.fromOrtTensor(mt.attributes(0).t())}}}for(let ct=0;ct<this._nodes.length;ct++){const dt=this._nodes[ct],mt=g.nodes(ct);if(mt.inputsLength()===0)throw new Error(`missing input for node: ${mt.name}`);for(let ht=0;ht<mt.inputsLength();ht++){const ft=mt.inputs(ht),ut=it.get(ft);if(ut===void 0)throw new Error(`unrecognized input '${ft}' for node: ${mt.name()}`);dt.inputs.push(ut),this._allData[ut]._to.push(ct)}}}checkIsAcyclic(){const g=new Set;this._allInputIndices.forEach(ot=>{this._allData[ot]._to.forEach(it=>{g.add(it)})});const j=Array.from(g),rt=new Array(this._nodes.length).fill("white");for(;j.length>0;){const ot=j.pop();rt[ot]==="gray"?rt[ot]="black":(j.push(ot),rt[ot]="gray",this._nodes[ot].outputs.forEach(it=>{const at=this._allData[it];if(at.tensor!==void 0)throw new Error("node outputs should not be initialized");if(at._from!==ot)throw new Error("from property of the Value object doesn't match index of Node being processed");at._to.forEach(lt=>{if(rt[lt]==="gray")throw new Error("model graph is cyclic");rt[lt]==="white"&&j.push(lt)})}))}}transformGraph(g){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),g&&g.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let g=0;for(let j=0;j<this._nodes.length;j++)this._nodes[j].executeNode?g>0&&(this._nodes[j].inputs.forEach(rt=>{const ot=this._allData[rt]._to.indexOf(j+g);ot!==-1&&(this._allData[rt]._to[ot]=j)}),this._nodes[j].outputs.forEach(rt=>{this._allData[rt]._from&&this._allData[rt]._from===j+g&&(this._allData[rt]._from=j)})):(g++,this._nodes[j].outputs.forEach(rt=>{this._allData[rt]._from=-2}),this._nodes.splice(j,1),j--);g=0;for(let j=0;j<this._allData.length;j++)if(this._allData[j].from!==-2||this._allOutputIndices.indexOf(j+g)!==-1){if(g>0){let rt=-1;this._allData[j].from!==void 0&&this._allData[j].from!==-1?(rt=this._nodes[this._allData[j].from].outputs.indexOf(j+g),rt!==-1&&(this._nodes[this._allData[j].from].outputs[rt]=j)):(rt=this._allInputIndices.indexOf(j+g),rt!==-1&&(this._allInputIndices[rt]=j)),this._allData[j].to.forEach(ot=>{rt=this._nodes[ot].inputs.indexOf(j+g),rt!==-1&&(this._nodes[ot].inputs[rt]=j)}),this._allData[j].to.length===0&&(rt=this._allOutputIndices.indexOf(j+g),rt!==-1&&(this._allOutputIndices[rt]=j))}}else g++,this._allData.splice(j,1),j--}deleteNode(g){const j=this._nodes[g];if(j.outputs.length>1){for(let ct=1;ct<j.outputs.length;ct++)if(this._allData[j.outputs[ct]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}j.executeNode=!1;const rt=j.inputs[0],ot=j.outputs[0],it=this._allData[ot].to,at=this._allData[rt].to.indexOf(g);if(at===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[rt].to.splice(at,1),this._allData[ot]._to=[];const lt=this._allOutputIndices.indexOf(ot);if(lt!==-1&&(this._allOutputIndices[lt]=rt),it&&it.length>0)for(const ct of it){const dt=this._nodes[ct].inputs.indexOf(ot);if(dt===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[ct].inputs[dt]=rt,this._allData[rt].to.push(ct)}}removeAllDropoutNodes(){let g=0;for(const j of this._nodes){if(j.opType==="Dropout"){if(j.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(j.outputs.length!==1&&j.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(j.outputs.length===2&&this._allData[j.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(g)}g++}}removeAllIdentityNodes(){let g=0;for(const j of this._nodes)j.opType==="Identity"&&this.deleteNode(g),g++}isActivation(g){switch(g.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(const g of this._nodes)if(g.opType==="Conv"){const j=this._allData[g.outputs[0]]._to;if(j.length===1&&this.isActivation(this._nodes[j[0]])){const rt=this._nodes[j[0]];if(rt.opType==="Clip")if(rt.inputs.length===1)try{g.attributes.set("activation_params","floats",[rt.attributes.getFloat("min"),rt.attributes.getFloat("max")])}catch{g.attributes.set("activation_params","floats",[$.MIN_CLIP,$.MAX_CLIP])}else{if(!(rt.inputs.length>=3&&this._allData[rt.inputs[1]].tensor!==void 0&&this._allData[rt.inputs[2]].tensor!==void 0))continue;g.attributes.set("activation_params","floats",[this._allData[rt.inputs[1]].tensor.floatData[0],this._allData[rt.inputs[2]].tensor.floatData[0]])}g.attributes.set("activation","string",rt.opType),this.deleteNode(j[0])}}}}},6231:(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.now=e.Profiler=e.Logger=void 0;const o={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},s={none:new class{log(et,d,a){}},console:new class{log(et,d,a){console.log(`${this.color(et)} ${a?"\x1B[35m"+a+"\x1B[0m ":""}${d}`)}color(et){switch(et){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${et}`)}}}},c={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1};let h={"":c};function _(et,d,a,g){if(d===void 0)return j=et,{verbose:_.verbose.bind(null,j),info:_.info.bind(null,j),warning:_.warning.bind(null,j),error:_.error.bind(null,j),fatal:_.fatal.bind(null,j)};if(a===void 0)$(et,d);else if(typeof a=="number"&&g===void 0)$(et,d);else if(typeof a=="string"&&g===void 0)$(et,a,0,d);else{if(typeof a!="string"||typeof g!="number")throw new TypeError("input is valid");$(et,a,0,d)}var j}function $(et,d,a,g){const j=h[g||""]||h[""];o[et]<o[j.minimalSeverity]||(j.logDateTime&&(d=`${new Date().toISOString()}|${d}`),j.logSourceLocation,s[j.provider].log(et,d,g))}(function(et){function d(g){h={},a("",g||{})}function a(g,j){if(g==="*")d(j);else{const rt=h[g]||c;h[g]={provider:j.provider||rt.provider,minimalSeverity:j.minimalSeverity||rt.minimalSeverity,logDateTime:j.logDateTime===void 0?rt.logDateTime:j.logDateTime,logSourceLocation:j.logSourceLocation===void 0?rt.logSourceLocation:j.logSourceLocation}}}et.verbose=function(g,j){et("verbose",g,j)},et.info=function(g,j){et("info",g,j)},et.warning=function(g,j){et("warning",g,j)},et.error=function(g,j){et("error",g,j)},et.fatal=function(g,j){et("fatal",g,j)},et.reset=d,et.set=a,et.setWithEnv=function(g){const j={};g.logLevel&&(j.minimalSeverity=g.logLevel),a("",j)}})(_||(_={})),e.Logger=_;class nt{constructor(d,a,g,j,rt,ot){this.category=d,this.name=a,this.startTime=g,this.endCallback=j,this.timer=rt,this.ctx=ot}end(){return this.endCallback(this)}async checkTimer(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}}class tt{constructor(d,a,g,j){this.category=d,this.name=a,this.startTime=g,this.endTime=j}}e.Profiler=class{static create(et){return et===void 0?new this:new this(et.maxNumberEvents,et.flushBatchSize,et.flushIntervalInMilliseconds)}constructor(et,d,a){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=et===void 0?1e4:et,this._flushBatchSize=d===void 0?10:d,this._flushIntervalInMilliseconds=a===void 0?5e3:a}start(){this._started=!0,this._timingEvents=[],this._flushTime=(0,e.now)(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(et,d,a,g){const j=this._started?this.begin(et,d,g):void 0;let rt=!1;const ot=a();if(ot&&typeof ot.then=="function")return rt=!0,new Promise((it,at)=>{ot.then(async lt=>{j&&await j.end(),it(lt)},async lt=>{j&&await j.end(),at(lt)})});if(!rt&&j){const it=j.end();if(it&&typeof it.then=="function")return new Promise((at,lt)=>{it.then(()=>{at(ot)},ct=>{lt(ct)})})}return ot}begin(et,d,a){if(!this._started)throw new Error("profiler is not started yet");if(a===void 0){const g=(0,e.now)();return this.flush(g),new nt(et,d,g,j=>this.endSync(j))}{const g=a.beginTimer();return new nt(et,d,0,async j=>this.end(j),g,a)}}async end(et){const d=await et.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new tt(et.category,et.name,et.startTime,d)),this.flush(d))}endSync(et){const d=(0,e.now)();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new tt(et.category,et.name,et.startTime,d)),this.flush(d))}logOneEvent(et){e.Logger.verbose(`Profiler.${et.category}`,`${(et.endTime-et.startTime).toFixed(2)}ms on event '${et.name}' at ${et.endTime.toFixed(2)}`)}flush(et){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||et-this._flushTime>=this._flushIntervalInMilliseconds){for(const d=this._flushPointer;this._flushPointer<d+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=(0,e.now)()}}get started(){return this._started}},e.now=typeof performance<"u"&&performance.now?()=>performance.now():Date.now},2644:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;const s=o(5686),c=o(1446),h=o(7070),_=o(9395),$=o(2517);var nt=_.onnxruntime.experimental.fbs;e.Model=class{constructor(){}load(tt,et,d){if(!d)try{return void this.loadFromOnnxFormat(tt,et)}catch(a){if(d!==void 0)throw a}this.loadFromOrtFormat(tt,et)}loadFromOnnxFormat(tt,et){const d=c.onnx.ModelProto.decode(tt);if($.LongUtil.longToNumber(d.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=d.opsetImport.map(a=>({domain:a.domain,version:$.LongUtil.longToNumber(a.version)})),this._graph=h.Graph.from(d.graph,et)}loadFromOrtFormat(tt,et){const d=new s.flatbuffers.ByteBuffer(tt),a=nt.InferenceSession.getRootAsInferenceSession(d).model();if($.LongUtil.longToNumber(a.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let g=0;g<a.opsetImportLength();g++){const j=a.opsetImport(g);this._opsets.push({domain:j==null?void 0:j.domain(),version:$.LongUtil.longToNumber(j.version())})}this._graph=h.Graph.from(a.graph(),et)}get graph(){return this._graph}get opsets(){return this._opsets}}},782:(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FLOAT_TYPES=e.INT_TYPES=e.NUMBER_TYPES=void 0,e.NUMBER_TYPES=["float32","float64","int32","int16","int8","uint16","uint32","uint8"],e.INT_TYPES=["int32","int16","int8","uint16","uint32","uint8"],e.FLOAT_TYPES=["float32","float64"]},1047:(i,e)=>{function o(s,c){if(c.endsWith("+")){const h=Number.parseInt(c.substring(0,c.length-1),10);return!isNaN(h)&&h<=s}if(c.split("-").length===2){const h=c.split("-"),_=Number.parseInt(h[0],10),$=Number.parseInt(h[1],10);return!isNaN(_)&&!isNaN($)&&_<=s&&s<=$}return Number.parseInt(c,10)===s}Object.defineProperty(e,"__esModule",{value:!0}),e.resolveOperator=void 0,e.resolveOperator=function(s,c,h){for(const _ of h){const $=_[0],nt=_[1],tt=_[2],et=_[3],d=_[4];if(s.opType===$){for(const a of c)if((a.domain===nt||a.domain==="ai.onnx"&&nt==="")&&o(a.version,tt))return{opImpl:et,opInit:d}}}throw new TypeError(`cannot resolve operator '${s.opType}' with opsets: ${c.map(_=>`${_.domain||"ai.onnx"} v${_.version}`).join(", ")}`)}},9395:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.onnxruntime=void 0;const s=o(5686);var c,h;c=e.onnxruntime||(e.onnxruntime={}),function(_){(function($){$[$.UNDEFINED=0]="UNDEFINED",$[$.FLOAT=1]="FLOAT",$[$.INT=2]="INT",$[$.STRING=3]="STRING",$[$.TENSOR=4]="TENSOR",$[$.GRAPH=5]="GRAPH",$[$.FLOATS=6]="FLOATS",$[$.INTS=7]="INTS",$[$.STRINGS=8]="STRINGS",$[$.TENSORS=9]="TENSORS",$[$.GRAPHS=10]="GRAPHS",$[$.SPARSE_TENSOR=11]="SPARSE_TENSOR",$[$.SPARSE_TENSORS=12]="SPARSE_TENSORS"})(_.AttributeType||(_.AttributeType={}))}((h=c.experimental||(c.experimental={})).fbs||(h.fbs={})),function(_){(function($){(function(nt){(function(tt){tt[tt.UNKNOWN=0]="UNKNOWN",tt[tt.VALUE=1]="VALUE",tt[tt.PARAM=2]="PARAM"})(nt.DimensionValueType||(nt.DimensionValueType={}))})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){(function(tt){tt[tt.UNDEFINED=0]="UNDEFINED",tt[tt.FLOAT=1]="FLOAT",tt[tt.UINT8=2]="UINT8",tt[tt.INT8=3]="INT8",tt[tt.UINT16=4]="UINT16",tt[tt.INT16=5]="INT16",tt[tt.INT32=6]="INT32",tt[tt.INT64=7]="INT64",tt[tt.STRING=8]="STRING",tt[tt.BOOL=9]="BOOL",tt[tt.FLOAT16=10]="FLOAT16",tt[tt.DOUBLE=11]="DOUBLE",tt[tt.UINT32=12]="UINT32",tt[tt.UINT64=13]="UINT64",tt[tt.COMPLEX64=14]="COMPLEX64",tt[tt.COMPLEX128=15]="COMPLEX128",tt[tt.BFLOAT16=16]="BFLOAT16"})(nt.TensorDataType||(nt.TensorDataType={}))})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){(function(tt){tt[tt.Primitive=0]="Primitive",tt[tt.Fused=1]="Fused"})(nt.NodeType||(nt.NodeType={}))})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){(function(tt){tt[tt.NONE=0]="NONE",tt[tt.tensor_type=1]="tensor_type",tt[tt.sequence_type=2]="sequence_type",tt[tt.map_type=3]="map_type"})(nt.TypeInfoValue||(nt.TypeInfoValue={}))})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsShape(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsShape(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}dim(d,a){let g=this.bb.__offset(this.bb_pos,4);return g?(a||new _.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}dimLength(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__vector_len(this.bb_pos+d):0}static startShape(d){d.startObject(1)}static addDim(d,a){d.addFieldOffset(0,a,0)}static createDimVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startDimVector(d,a){d.startVector(4,a,4)}static endShape(d){return d.endObject()}static createShape(d,a){return tt.startShape(d),tt.addDim(d,a),tt.endShape(d)}}nt.Shape=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsDimension(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsDimension(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}value(d){let a=this.bb.__offset(this.bb_pos,4);return a?(d||new _.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}denotation(d){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__string(this.bb_pos+a,d):null}static startDimension(d){d.startObject(2)}static addValue(d,a){d.addFieldOffset(0,a,0)}static addDenotation(d,a){d.addFieldOffset(1,a,0)}static endDimension(d){return d.endObject()}static createDimension(d,a,g){return tt.startDimension(d),tt.addValue(d,a),tt.addDenotation(d,g),tt.endDimension(d)}}nt.Dimension=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsDimensionValue(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsDimensionValue(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}dimType(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.readInt8(this.bb_pos+d):_.experimental.fbs.DimensionValueType.UNKNOWN}dimValue(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.readInt64(this.bb_pos+d):this.bb.createLong(0,0)}dimParam(d){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__string(this.bb_pos+a,d):null}static startDimensionValue(d){d.startObject(3)}static addDimType(d,a){d.addFieldInt8(0,a,_.experimental.fbs.DimensionValueType.UNKNOWN)}static addDimValue(d,a){d.addFieldInt64(1,a,d.createLong(0,0))}static addDimParam(d,a){d.addFieldOffset(2,a,0)}static endDimensionValue(d){return d.endObject()}static createDimensionValue(d,a,g,j){return tt.startDimensionValue(d),tt.addDimType(d,a),tt.addDimValue(d,g),tt.addDimParam(d,j),tt.endDimensionValue(d)}}nt.DimensionValue=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsTensorTypeAndShape(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsTensorTypeAndShape(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}elemType(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.readInt32(this.bb_pos+d):_.experimental.fbs.TensorDataType.UNDEFINED}shape(d){let a=this.bb.__offset(this.bb_pos,6);return a?(d||new _.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}static startTensorTypeAndShape(d){d.startObject(2)}static addElemType(d,a){d.addFieldInt32(0,a,_.experimental.fbs.TensorDataType.UNDEFINED)}static addShape(d,a){d.addFieldOffset(1,a,0)}static endTensorTypeAndShape(d){return d.endObject()}static createTensorTypeAndShape(d,a,g){return tt.startTensorTypeAndShape(d),tt.addElemType(d,a),tt.addShape(d,g),tt.endTensorTypeAndShape(d)}}nt.TensorTypeAndShape=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsMapType(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsMapType(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}keyType(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.readInt32(this.bb_pos+d):_.experimental.fbs.TensorDataType.UNDEFINED}valueType(d){let a=this.bb.__offset(this.bb_pos,6);return a?(d||new _.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}static startMapType(d){d.startObject(2)}static addKeyType(d,a){d.addFieldInt32(0,a,_.experimental.fbs.TensorDataType.UNDEFINED)}static addValueType(d,a){d.addFieldOffset(1,a,0)}static endMapType(d){return d.endObject()}static createMapType(d,a,g){return tt.startMapType(d),tt.addKeyType(d,a),tt.addValueType(d,g),tt.endMapType(d)}}nt.MapType=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsSequenceType(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsSequenceType(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}elemType(d){let a=this.bb.__offset(this.bb_pos,4);return a?(d||new _.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}static startSequenceType(d){d.startObject(1)}static addElemType(d,a){d.addFieldOffset(0,a,0)}static endSequenceType(d){return d.endObject()}static createSequenceType(d,a){return tt.startSequenceType(d),tt.addElemType(d,a),tt.endSequenceType(d)}}nt.SequenceType=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){($.fbs||($.fbs={})).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(nt,tt){return this.bb_pos=nt,this.bb=tt,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(nt,tt,et,d){return nt.prep(4,12),nt.writeInt32(d),nt.writeInt32(et),nt.writeInt32(tt),nt.offset()}}})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsNodeEdge(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsNodeEdge(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}nodeIndex(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.readUint32(this.bb_pos+d):0}inputEdges(d,a){let g=this.bb.__offset(this.bb_pos,6);return g?(a||new _.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+g)+12*d,this.bb):null}inputEdgesLength(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__vector_len(this.bb_pos+d):0}outputEdges(d,a){let g=this.bb.__offset(this.bb_pos,8);return g?(a||new _.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+g)+12*d,this.bb):null}outputEdgesLength(){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__vector_len(this.bb_pos+d):0}static startNodeEdge(d){d.startObject(3)}static addNodeIndex(d,a){d.addFieldInt32(0,a,0)}static addInputEdges(d,a){d.addFieldOffset(1,a,0)}static startInputEdgesVector(d,a){d.startVector(12,a,4)}static addOutputEdges(d,a){d.addFieldOffset(2,a,0)}static startOutputEdgesVector(d,a){d.startVector(12,a,4)}static endNodeEdge(d){return d.endObject()}static createNodeEdge(d,a,g,j){return tt.startNodeEdge(d),tt.addNodeIndex(d,a),tt.addInputEdges(d,g),tt.addOutputEdges(d,j),tt.endNodeEdge(d)}}nt.NodeEdge=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsNode(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsNode(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}name(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}docString(d){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__string(this.bb_pos+a,d):null}domain(d){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__string(this.bb_pos+a,d):null}sinceVersion(){let d=this.bb.__offset(this.bb_pos,10);return d?this.bb.readInt32(this.bb_pos+d):0}index(){let d=this.bb.__offset(this.bb_pos,12);return d?this.bb.readUint32(this.bb_pos+d):0}opType(d){let a=this.bb.__offset(this.bb_pos,14);return a?this.bb.__string(this.bb_pos+a,d):null}type(){let d=this.bb.__offset(this.bb_pos,16);return d?this.bb.readInt32(this.bb_pos+d):_.experimental.fbs.NodeType.Primitive}executionProviderType(d){let a=this.bb.__offset(this.bb_pos,18);return a?this.bb.__string(this.bb_pos+a,d):null}inputs(d,a){let g=this.bb.__offset(this.bb_pos,20);return g?this.bb.__string(this.bb.__vector(this.bb_pos+g)+4*d,a):null}inputsLength(){let d=this.bb.__offset(this.bb_pos,20);return d?this.bb.__vector_len(this.bb_pos+d):0}outputs(d,a){let g=this.bb.__offset(this.bb_pos,22);return g?this.bb.__string(this.bb.__vector(this.bb_pos+g)+4*d,a):null}outputsLength(){let d=this.bb.__offset(this.bb_pos,22);return d?this.bb.__vector_len(this.bb_pos+d):0}attributes(d,a){let g=this.bb.__offset(this.bb_pos,24);return g?(a||new _.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}attributesLength(){let d=this.bb.__offset(this.bb_pos,24);return d?this.bb.__vector_len(this.bb_pos+d):0}inputArgCounts(d){let a=this.bb.__offset(this.bb_pos,26);return a?this.bb.readInt32(this.bb.__vector(this.bb_pos+a)+4*d):0}inputArgCountsLength(){let d=this.bb.__offset(this.bb_pos,26);return d?this.bb.__vector_len(this.bb_pos+d):0}inputArgCountsArray(){let d=this.bb.__offset(this.bb_pos,26);return d?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+d),this.bb.__vector_len(this.bb_pos+d)):null}implicitInputs(d,a){let g=this.bb.__offset(this.bb_pos,28);return g?this.bb.__string(this.bb.__vector(this.bb_pos+g)+4*d,a):null}implicitInputsLength(){let d=this.bb.__offset(this.bb_pos,28);return d?this.bb.__vector_len(this.bb_pos+d):0}static startNode(d){d.startObject(13)}static addName(d,a){d.addFieldOffset(0,a,0)}static addDocString(d,a){d.addFieldOffset(1,a,0)}static addDomain(d,a){d.addFieldOffset(2,a,0)}static addSinceVersion(d,a){d.addFieldInt32(3,a,0)}static addIndex(d,a){d.addFieldInt32(4,a,0)}static addOpType(d,a){d.addFieldOffset(5,a,0)}static addType(d,a){d.addFieldInt32(6,a,_.experimental.fbs.NodeType.Primitive)}static addExecutionProviderType(d,a){d.addFieldOffset(7,a,0)}static addInputs(d,a){d.addFieldOffset(8,a,0)}static createInputsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startInputsVector(d,a){d.startVector(4,a,4)}static addOutputs(d,a){d.addFieldOffset(9,a,0)}static createOutputsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startOutputsVector(d,a){d.startVector(4,a,4)}static addAttributes(d,a){d.addFieldOffset(10,a,0)}static createAttributesVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startAttributesVector(d,a){d.startVector(4,a,4)}static addInputArgCounts(d,a){d.addFieldOffset(11,a,0)}static createInputArgCountsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addInt32(a[g]);return d.endVector()}static startInputArgCountsVector(d,a){d.startVector(4,a,4)}static addImplicitInputs(d,a){d.addFieldOffset(12,a,0)}static createImplicitInputsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startImplicitInputsVector(d,a){d.startVector(4,a,4)}static endNode(d){return d.endObject()}static createNode(d,a,g,j,rt,ot,it,at,lt,ct,dt,mt,ht,ft){return tt.startNode(d),tt.addName(d,a),tt.addDocString(d,g),tt.addDomain(d,j),tt.addSinceVersion(d,rt),tt.addIndex(d,ot),tt.addOpType(d,it),tt.addType(d,at),tt.addExecutionProviderType(d,lt),tt.addInputs(d,ct),tt.addOutputs(d,dt),tt.addAttributes(d,mt),tt.addInputArgCounts(d,ht),tt.addImplicitInputs(d,ft),tt.endNode(d)}}nt.Node=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsValueInfo(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsValueInfo(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}name(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}docString(d){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__string(this.bb_pos+a,d):null}type(d){let a=this.bb.__offset(this.bb_pos,8);return a?(d||new _.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}static startValueInfo(d){d.startObject(3)}static addName(d,a){d.addFieldOffset(0,a,0)}static addDocString(d,a){d.addFieldOffset(1,a,0)}static addType(d,a){d.addFieldOffset(2,a,0)}static endValueInfo(d){return d.endObject()}static createValueInfo(d,a,g,j){return tt.startValueInfo(d),tt.addName(d,a),tt.addDocString(d,g),tt.addType(d,j),tt.endValueInfo(d)}}nt.ValueInfo=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsTypeInfo(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsTypeInfo(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}denotation(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}valueType(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.readUint8(this.bb_pos+d):_.experimental.fbs.TypeInfoValue.NONE}value(d){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__union(d,this.bb_pos+a):null}static startTypeInfo(d){d.startObject(3)}static addDenotation(d,a){d.addFieldOffset(0,a,0)}static addValueType(d,a){d.addFieldInt8(1,a,_.experimental.fbs.TypeInfoValue.NONE)}static addValue(d,a){d.addFieldOffset(2,a,0)}static endTypeInfo(d){return d.endObject()}static createTypeInfo(d,a,g,j){return tt.startTypeInfo(d),tt.addDenotation(d,a),tt.addValueType(d,g),tt.addValue(d,j),tt.endTypeInfo(d)}}nt.TypeInfo=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsOperatorSetId(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsOperatorSetId(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}domain(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}version(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.readInt64(this.bb_pos+d):this.bb.createLong(0,0)}static startOperatorSetId(d){d.startObject(2)}static addDomain(d,a){d.addFieldOffset(0,a,0)}static addVersion(d,a){d.addFieldInt64(1,a,d.createLong(0,0))}static endOperatorSetId(d){return d.endObject()}static createOperatorSetId(d,a,g){return tt.startOperatorSetId(d),tt.addDomain(d,a),tt.addVersion(d,g),tt.endOperatorSetId(d)}}nt.OperatorSetId=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsTensor(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsTensor(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}name(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}docString(d){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__string(this.bb_pos+a,d):null}dims(d){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.readInt64(this.bb.__vector(this.bb_pos+a)+8*d):this.bb.createLong(0,0)}dimsLength(){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__vector_len(this.bb_pos+d):0}dataType(){let d=this.bb.__offset(this.bb_pos,10);return d?this.bb.readInt32(this.bb_pos+d):_.experimental.fbs.TensorDataType.UNDEFINED}rawData(d){let a=this.bb.__offset(this.bb_pos,12);return a?this.bb.readUint8(this.bb.__vector(this.bb_pos+a)+d):0}rawDataLength(){let d=this.bb.__offset(this.bb_pos,12);return d?this.bb.__vector_len(this.bb_pos+d):0}rawDataArray(){let d=this.bb.__offset(this.bb_pos,12);return d?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+d),this.bb.__vector_len(this.bb_pos+d)):null}stringData(d,a){let g=this.bb.__offset(this.bb_pos,14);return g?this.bb.__string(this.bb.__vector(this.bb_pos+g)+4*d,a):null}stringDataLength(){let d=this.bb.__offset(this.bb_pos,14);return d?this.bb.__vector_len(this.bb_pos+d):0}static startTensor(d){d.startObject(6)}static addName(d,a){d.addFieldOffset(0,a,0)}static addDocString(d,a){d.addFieldOffset(1,a,0)}static addDims(d,a){d.addFieldOffset(2,a,0)}static createDimsVector(d,a){d.startVector(8,a.length,8);for(let g=a.length-1;g>=0;g--)d.addInt64(a[g]);return d.endVector()}static startDimsVector(d,a){d.startVector(8,a,8)}static addDataType(d,a){d.addFieldInt32(3,a,_.experimental.fbs.TensorDataType.UNDEFINED)}static addRawData(d,a){d.addFieldOffset(4,a,0)}static createRawDataVector(d,a){d.startVector(1,a.length,1);for(let g=a.length-1;g>=0;g--)d.addInt8(a[g]);return d.endVector()}static startRawDataVector(d,a){d.startVector(1,a,1)}static addStringData(d,a){d.addFieldOffset(5,a,0)}static createStringDataVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startStringDataVector(d,a){d.startVector(4,a,4)}static endTensor(d){return d.endObject()}static createTensor(d,a,g,j,rt,ot,it){return tt.startTensor(d),tt.addName(d,a),tt.addDocString(d,g),tt.addDims(d,j),tt.addDataType(d,rt),tt.addRawData(d,ot),tt.addStringData(d,it),tt.endTensor(d)}}nt.Tensor=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsSparseTensor(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsSparseTensor(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}values(d){let a=this.bb.__offset(this.bb_pos,4);return a?(d||new _.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}indices(d){let a=this.bb.__offset(this.bb_pos,6);return a?(d||new _.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}dims(d){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.readInt64(this.bb.__vector(this.bb_pos+a)+8*d):this.bb.createLong(0,0)}dimsLength(){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__vector_len(this.bb_pos+d):0}static startSparseTensor(d){d.startObject(3)}static addValues(d,a){d.addFieldOffset(0,a,0)}static addIndices(d,a){d.addFieldOffset(1,a,0)}static addDims(d,a){d.addFieldOffset(2,a,0)}static createDimsVector(d,a){d.startVector(8,a.length,8);for(let g=a.length-1;g>=0;g--)d.addInt64(a[g]);return d.endVector()}static startDimsVector(d,a){d.startVector(8,a,8)}static endSparseTensor(d){return d.endObject()}static createSparseTensor(d,a,g,j){return tt.startSparseTensor(d),tt.addValues(d,a),tt.addIndices(d,g),tt.addDims(d,j),tt.endSparseTensor(d)}}nt.SparseTensor=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsAttribute(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsAttribute(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}name(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}docString(d){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__string(this.bb_pos+a,d):null}type(){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.readInt32(this.bb_pos+d):_.experimental.fbs.AttributeType.UNDEFINED}f(){let d=this.bb.__offset(this.bb_pos,10);return d?this.bb.readFloat32(this.bb_pos+d):0}i(){let d=this.bb.__offset(this.bb_pos,12);return d?this.bb.readInt64(this.bb_pos+d):this.bb.createLong(0,0)}s(d){let a=this.bb.__offset(this.bb_pos,14);return a?this.bb.__string(this.bb_pos+a,d):null}t(d){let a=this.bb.__offset(this.bb_pos,16);return a?(d||new _.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}g(d){let a=this.bb.__offset(this.bb_pos,18);return a?(d||new _.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}floats(d){let a=this.bb.__offset(this.bb_pos,20);return a?this.bb.readFloat32(this.bb.__vector(this.bb_pos+a)+4*d):0}floatsLength(){let d=this.bb.__offset(this.bb_pos,20);return d?this.bb.__vector_len(this.bb_pos+d):0}floatsArray(){let d=this.bb.__offset(this.bb_pos,20);return d?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+d),this.bb.__vector_len(this.bb_pos+d)):null}ints(d){let a=this.bb.__offset(this.bb_pos,22);return a?this.bb.readInt64(this.bb.__vector(this.bb_pos+a)+8*d):this.bb.createLong(0,0)}intsLength(){let d=this.bb.__offset(this.bb_pos,22);return d?this.bb.__vector_len(this.bb_pos+d):0}strings(d,a){let g=this.bb.__offset(this.bb_pos,24);return g?this.bb.__string(this.bb.__vector(this.bb_pos+g)+4*d,a):null}stringsLength(){let d=this.bb.__offset(this.bb_pos,24);return d?this.bb.__vector_len(this.bb_pos+d):0}tensors(d,a){let g=this.bb.__offset(this.bb_pos,26);return g?(a||new _.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}tensorsLength(){let d=this.bb.__offset(this.bb_pos,26);return d?this.bb.__vector_len(this.bb_pos+d):0}graphs(d,a){let g=this.bb.__offset(this.bb_pos,28);return g?(a||new _.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}graphsLength(){let d=this.bb.__offset(this.bb_pos,28);return d?this.bb.__vector_len(this.bb_pos+d):0}static startAttribute(d){d.startObject(13)}static addName(d,a){d.addFieldOffset(0,a,0)}static addDocString(d,a){d.addFieldOffset(1,a,0)}static addType(d,a){d.addFieldInt32(2,a,_.experimental.fbs.AttributeType.UNDEFINED)}static addF(d,a){d.addFieldFloat32(3,a,0)}static addI(d,a){d.addFieldInt64(4,a,d.createLong(0,0))}static addS(d,a){d.addFieldOffset(5,a,0)}static addT(d,a){d.addFieldOffset(6,a,0)}static addG(d,a){d.addFieldOffset(7,a,0)}static addFloats(d,a){d.addFieldOffset(8,a,0)}static createFloatsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addFloat32(a[g]);return d.endVector()}static startFloatsVector(d,a){d.startVector(4,a,4)}static addInts(d,a){d.addFieldOffset(9,a,0)}static createIntsVector(d,a){d.startVector(8,a.length,8);for(let g=a.length-1;g>=0;g--)d.addInt64(a[g]);return d.endVector()}static startIntsVector(d,a){d.startVector(8,a,8)}static addStrings(d,a){d.addFieldOffset(10,a,0)}static createStringsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startStringsVector(d,a){d.startVector(4,a,4)}static addTensors(d,a){d.addFieldOffset(11,a,0)}static createTensorsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startTensorsVector(d,a){d.startVector(4,a,4)}static addGraphs(d,a){d.addFieldOffset(12,a,0)}static createGraphsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startGraphsVector(d,a){d.startVector(4,a,4)}static endAttribute(d){return d.endObject()}static createAttribute(d,a,g,j,rt,ot,it,at,lt,ct,dt,mt,ht,ft){return tt.startAttribute(d),tt.addName(d,a),tt.addDocString(d,g),tt.addType(d,j),tt.addF(d,rt),tt.addI(d,ot),tt.addS(d,it),tt.addT(d,at),tt.addG(d,lt),tt.addFloats(d,ct),tt.addInts(d,dt),tt.addStrings(d,mt),tt.addTensors(d,ht),tt.addGraphs(d,ft),tt.endAttribute(d)}}nt.Attribute=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsGraph(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsGraph(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}initializers(d,a){let g=this.bb.__offset(this.bb_pos,4);return g?(a||new _.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}initializersLength(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__vector_len(this.bb_pos+d):0}nodeArgs(d,a){let g=this.bb.__offset(this.bb_pos,6);return g?(a||new _.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}nodeArgsLength(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__vector_len(this.bb_pos+d):0}nodes(d,a){let g=this.bb.__offset(this.bb_pos,8);return g?(a||new _.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}nodesLength(){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__vector_len(this.bb_pos+d):0}maxNodeIndex(){let d=this.bb.__offset(this.bb_pos,10);return d?this.bb.readUint32(this.bb_pos+d):0}nodeEdges(d,a){let g=this.bb.__offset(this.bb_pos,12);return g?(a||new _.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}nodeEdgesLength(){let d=this.bb.__offset(this.bb_pos,12);return d?this.bb.__vector_len(this.bb_pos+d):0}inputs(d,a){let g=this.bb.__offset(this.bb_pos,14);return g?this.bb.__string(this.bb.__vector(this.bb_pos+g)+4*d,a):null}inputsLength(){let d=this.bb.__offset(this.bb_pos,14);return d?this.bb.__vector_len(this.bb_pos+d):0}outputs(d,a){let g=this.bb.__offset(this.bb_pos,16);return g?this.bb.__string(this.bb.__vector(this.bb_pos+g)+4*d,a):null}outputsLength(){let d=this.bb.__offset(this.bb_pos,16);return d?this.bb.__vector_len(this.bb_pos+d):0}sparseInitializers(d,a){let g=this.bb.__offset(this.bb_pos,18);return g?(a||new _.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}sparseInitializersLength(){let d=this.bb.__offset(this.bb_pos,18);return d?this.bb.__vector_len(this.bb_pos+d):0}static startGraph(d){d.startObject(8)}static addInitializers(d,a){d.addFieldOffset(0,a,0)}static createInitializersVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startInitializersVector(d,a){d.startVector(4,a,4)}static addNodeArgs(d,a){d.addFieldOffset(1,a,0)}static createNodeArgsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startNodeArgsVector(d,a){d.startVector(4,a,4)}static addNodes(d,a){d.addFieldOffset(2,a,0)}static createNodesVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startNodesVector(d,a){d.startVector(4,a,4)}static addMaxNodeIndex(d,a){d.addFieldInt32(3,a,0)}static addNodeEdges(d,a){d.addFieldOffset(4,a,0)}static createNodeEdgesVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startNodeEdgesVector(d,a){d.startVector(4,a,4)}static addInputs(d,a){d.addFieldOffset(5,a,0)}static createInputsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startInputsVector(d,a){d.startVector(4,a,4)}static addOutputs(d,a){d.addFieldOffset(6,a,0)}static createOutputsVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startOutputsVector(d,a){d.startVector(4,a,4)}static addSparseInitializers(d,a){d.addFieldOffset(7,a,0)}static createSparseInitializersVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startSparseInitializersVector(d,a){d.startVector(4,a,4)}static endGraph(d){return d.endObject()}static createGraph(d,a,g,j,rt,ot,it,at,lt){return tt.startGraph(d),tt.addInitializers(d,a),tt.addNodeArgs(d,g),tt.addNodes(d,j),tt.addMaxNodeIndex(d,rt),tt.addNodeEdges(d,ot),tt.addInputs(d,it),tt.addOutputs(d,at),tt.addSparseInitializers(d,lt),tt.endGraph(d)}}nt.Graph=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsModel(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsModel(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}irVersion(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.readInt64(this.bb_pos+d):this.bb.createLong(0,0)}opsetImport(d,a){let g=this.bb.__offset(this.bb_pos,6);return g?(a||new _.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}opsetImportLength(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__vector_len(this.bb_pos+d):0}producerName(d){let a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__string(this.bb_pos+a,d):null}producerVersion(d){let a=this.bb.__offset(this.bb_pos,10);return a?this.bb.__string(this.bb_pos+a,d):null}domain(d){let a=this.bb.__offset(this.bb_pos,12);return a?this.bb.__string(this.bb_pos+a,d):null}modelVersion(){let d=this.bb.__offset(this.bb_pos,14);return d?this.bb.readInt64(this.bb_pos+d):this.bb.createLong(0,0)}docString(d){let a=this.bb.__offset(this.bb_pos,16);return a?this.bb.__string(this.bb_pos+a,d):null}graph(d){let a=this.bb.__offset(this.bb_pos,18);return a?(d||new _.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}graphDocString(d){let a=this.bb.__offset(this.bb_pos,20);return a?this.bb.__string(this.bb_pos+a,d):null}static startModel(d){d.startObject(9)}static addIrVersion(d,a){d.addFieldInt64(0,a,d.createLong(0,0))}static addOpsetImport(d,a){d.addFieldOffset(1,a,0)}static createOpsetImportVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startOpsetImportVector(d,a){d.startVector(4,a,4)}static addProducerName(d,a){d.addFieldOffset(2,a,0)}static addProducerVersion(d,a){d.addFieldOffset(3,a,0)}static addDomain(d,a){d.addFieldOffset(4,a,0)}static addModelVersion(d,a){d.addFieldInt64(5,a,d.createLong(0,0))}static addDocString(d,a){d.addFieldOffset(6,a,0)}static addGraph(d,a){d.addFieldOffset(7,a,0)}static addGraphDocString(d,a){d.addFieldOffset(8,a,0)}static endModel(d){return d.endObject()}static createModel(d,a,g,j,rt,ot,it,at,lt,ct){return tt.startModel(d),tt.addIrVersion(d,a),tt.addOpsetImport(d,g),tt.addProducerName(d,j),tt.addProducerVersion(d,rt),tt.addDomain(d,ot),tt.addModelVersion(d,it),tt.addDocString(d,at),tt.addGraph(d,lt),tt.addGraphDocString(d,ct),tt.endModel(d)}}nt.Model=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsKernelCreateInfos(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsKernelCreateInfos(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}nodeIndices(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readUint32(this.bb.__vector(this.bb_pos+a)+4*d):0}nodeIndicesLength(){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__vector_len(this.bb_pos+d):0}nodeIndicesArray(){let d=this.bb.__offset(this.bb_pos,4);return d?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+d),this.bb.__vector_len(this.bb_pos+d)):null}kernelDefHashes(d){let a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readUint64(this.bb.__vector(this.bb_pos+a)+8*d):this.bb.createLong(0,0)}kernelDefHashesLength(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__vector_len(this.bb_pos+d):0}static startKernelCreateInfos(d){d.startObject(2)}static addNodeIndices(d,a){d.addFieldOffset(0,a,0)}static createNodeIndicesVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addInt32(a[g]);return d.endVector()}static startNodeIndicesVector(d,a){d.startVector(4,a,4)}static addKernelDefHashes(d,a){d.addFieldOffset(1,a,0)}static createKernelDefHashesVector(d,a){d.startVector(8,a.length,8);for(let g=a.length-1;g>=0;g--)d.addInt64(a[g]);return d.endVector()}static startKernelDefHashesVector(d,a){d.startVector(8,a,8)}static endKernelCreateInfos(d){return d.endObject()}static createKernelCreateInfos(d,a,g){return tt.startKernelCreateInfos(d),tt.addNodeIndices(d,a),tt.addKernelDefHashes(d,g),tt.endKernelCreateInfos(d)}}nt.KernelCreateInfos=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsSubGraphSessionState(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsSubGraphSessionState(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}graphId(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}sessionState(d){let a=this.bb.__offset(this.bb_pos,6);return a?(d||new _.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}static startSubGraphSessionState(d){d.startObject(2)}static addGraphId(d,a){d.addFieldOffset(0,a,0)}static addSessionState(d,a){d.addFieldOffset(1,a,0)}static endSubGraphSessionState(d){let a=d.endObject();return d.requiredField(a,4),a}static createSubGraphSessionState(d,a,g){return tt.startSubGraphSessionState(d),tt.addGraphId(d,a),tt.addSessionState(d,g),tt.endSubGraphSessionState(d)}}nt.SubGraphSessionState=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsSessionState(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsSessionState(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}kernels(d){let a=this.bb.__offset(this.bb_pos,4);return a?(d||new _.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}subGraphSessionStates(d,a){let g=this.bb.__offset(this.bb_pos,6);return g?(a||new _.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+g)+4*d),this.bb):null}subGraphSessionStatesLength(){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__vector_len(this.bb_pos+d):0}static startSessionState(d){d.startObject(2)}static addKernels(d,a){d.addFieldOffset(0,a,0)}static addSubGraphSessionStates(d,a){d.addFieldOffset(1,a,0)}static createSubGraphSessionStatesVector(d,a){d.startVector(4,a.length,4);for(let g=a.length-1;g>=0;g--)d.addOffset(a[g]);return d.endVector()}static startSubGraphSessionStatesVector(d,a){d.startVector(4,a,4)}static endSessionState(d){return d.endObject()}static createSessionState(d,a,g){return tt.startSessionState(d),tt.addKernels(d,a),tt.addSubGraphSessionStates(d,g),tt.endSessionState(d)}}nt.SessionState=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={})),function(_){(function($){(function(nt){class tt{constructor(){this.bb=null,this.bb_pos=0}__init(d,a){return this.bb_pos=d,this.bb=a,this}static getRootAsInferenceSession(d,a){return(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static getSizePrefixedRootAsInferenceSession(d,a){return d.setPosition(d.position()+s.flatbuffers.SIZE_PREFIX_LENGTH),(a||new tt).__init(d.readInt32(d.position())+d.position(),d)}static bufferHasIdentifier(d){return d.__has_identifier("ORTM")}ortVersion(d){let a=this.bb.__offset(this.bb_pos,4);return a?this.bb.__string(this.bb_pos+a,d):null}model(d){let a=this.bb.__offset(this.bb_pos,6);return a?(d||new _.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}sessionState(d){let a=this.bb.__offset(this.bb_pos,8);return a?(d||new _.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+a),this.bb):null}static startInferenceSession(d){d.startObject(3)}static addOrtVersion(d,a){d.addFieldOffset(0,a,0)}static addModel(d,a){d.addFieldOffset(1,a,0)}static addSessionState(d,a){d.addFieldOffset(2,a,0)}static endInferenceSession(d){return d.endObject()}static finishInferenceSessionBuffer(d,a){d.finish(a,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(d,a){d.finish(a,"ORTM",!0)}static createInferenceSession(d,a,g,j){return tt.startInferenceSession(d),tt.addOrtVersion(d,a),tt.addModel(d,g),tt.addSessionState(d,j),tt.endInferenceSession(d)}}nt.InferenceSession=tt})($.fbs||($.fbs={}))})(_.experimental||(_.experimental={}))}(e.onnxruntime||(e.onnxruntime={}))},7448:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OnnxjsSessionHandler=void 0;const s=o(1670),c=o(9162);e.OnnxjsSessionHandler=class{constructor(h){this.session=h,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(h,_,$){const nt=new Map;for(const d in h)if(Object.hasOwnProperty.call(h,d)){const a=h[d];nt.set(d,new c.Tensor(a.dims,a.type,void 0,void 0,a.data))}const tt=await this.session.run(nt),et={};return tt.forEach((d,a)=>{et[a]=new s.Tensor(d.type,d.data,d.dims)}),et}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}},6919:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Session=void 0;const s=o(7067),c=o(1296),h=o(7091),_=o(1036),$=o(6231),nt=o(2644);e.Session=class{constructor(tt={}){this._initialized=!1,this.backendHint=tt.backendHint,this.profiler=$.Profiler.create(tt.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(tt,et,d){await this.profiler.event("session","Session.loadModel",async()=>{const a=await(0,h.resolveBackend)(this.backendHint);if(this.sessionHandler=a.createSessionHandler(this.context),this._model=new nt.Model,typeof tt=="string"){const g=tt.endsWith(".ort");if(typeof fetch>"u"){const j=await(0,c.promisify)(s.readFile)(tt);this.initialize(j,g)}else{const j=await fetch(tt),rt=await j.arrayBuffer();this.initialize(new Uint8Array(rt),g)}}else if(ArrayBuffer.isView(tt))this.initialize(tt);else{const g=new Uint8Array(tt,et||0,d||tt.byteLength);this.initialize(g)}})}initialize(tt,et){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{const d=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(tt,d,et),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new _.ExecutionPlan(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(tt){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{const et=this.normalizeAndValidateInputs(tt),d=await this._executionPlan.execute(this.sessionHandler,et);return this.createOutput(d)})}normalizeAndValidateInputs(tt){const et=this._model.graph.getInputNames();if(Array.isArray(tt)){if(tt.length!==et.length)throw new Error(`incorrect input array length: expected ${et.length} but got ${tt.length}`)}else{if(tt.size!==et.length)throw new Error(`incorrect input map size: expected ${et.length} but got ${tt.size}`);const d=new Array(tt.size);let a=0;for(let g=0;g<et.length;++g){const j=tt.get(et[g]);if(!j)throw new Error(`missing input tensor for: '${name}'`);d[a++]=j}tt=d}if(this.context.graphInputTypes&&this.context.graphInputTypes.length!==0&&this.context.graphInputDims&&this.context.graphInputDims.length!==0)this.validateInputTensorDims(this.context.graphInputDims,tt,!1);else{const d=this._model.graph.getInputIndices(),a=this._model.graph.getValues(),g=new Array(d.length);for(let j=0;j<d.length;++j){const rt=a[d[j]];g[j]=rt.type.shape.dims,this.context.graphInputTypes.push(rt.type.tensorType),this.context.graphInputDims.push(tt[j].dims)}this.validateInputTensorDims(g,tt,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,tt),tt}validateInputTensorTypes(tt,et){for(let d=0;d<et.length;d++){const a=tt[d],g=et[d].type;if(a!==g)throw new Error(`input tensor[${d}] check failed: expected type '${a}' but got ${g}`)}}validateInputTensorDims(tt,et,d){for(let a=0;a<et.length;a++){const g=tt[a],j=et[a].dims;if(!this.compareTensorDims(g,j,d))throw new Error(`input tensor[${a}] check failed: expected shape '[${g.join(",")}]' but got [${j.join(",")}]`)}}compareTensorDims(tt,et,d){if(tt.length!==et.length)return!1;for(let a=0;a<tt.length;++a)if(tt[a]!==et[a]&&(!d||tt[a]!==0))return!1;return!0}createOutput(tt){const et=this._model.graph.getOutputNames();if(tt.length!==et.length)throw new Error("expected number of outputs do not match number of generated outputs");const d=new Map;for(let a=0;a<et.length;++a)d.set(et[a],tt[a]);return d}initializeOps(tt){const et=tt.getNodes();this._ops=new Array(et.length);for(let d=0;d<et.length;d++)this._ops[d]=this.sessionHandler.resolve(et[d],this._model.opsets,tt)}}},9162:function(i,e,o){var s=this&&this.__importDefault||function(rt){return rt&&rt.__esModule?rt:{default:rt}};Object.defineProperty(e,"__esModule",{value:!0}),e.Tensor=void 0;const c=o(3442),h=s(o(3720)),_=o(1446),$=o(9395),nt=o(2517);var tt=$.onnxruntime.experimental.fbs;class et{get data(){if(this.cache===void 0){const ot=this.dataProvider(this.dataId);if(ot.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=ot}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(ot){return this.data[nt.ShapeUtil.indicesToOffset(ot,this.strides)]}set(ot,it){this.data[nt.ShapeUtil.indicesToOffset(ot,this.strides)]=it}async getData(){return this.cache===void 0&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=nt.ShapeUtil.computeStrides(this.dims)),this._strides}constructor(ot,it,at,lt,ct,dt=c.Guid.create()){this.dims=ot,this.type=it,this.dataProvider=at,this.asyncDataProvider=lt,this.cache=ct,this.dataId=dt,this.size=nt.ShapeUtil.validateDimsAndCalcSize(ot);const mt=this.size,ht=at===void 0&&lt===void 0&&ct===void 0;if(ct!==void 0&&ct.length!==mt)throw new RangeError("Input dims doesn't match data length.");if(it==="string"){if(!(ct===void 0||Array.isArray(ct)&&ct.every(ft=>typeof ft=="string")))throw new TypeError("cache should be a string array");ht&&(this.cache=new Array(mt))}else{if(ct!==void 0){const ft=a(it);if(!(ct instanceof ft))throw new TypeError(`cache should be type ${ft.name}`)}if(ht){const ft=new ArrayBuffer(mt*function(ut){switch(ut){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${ut}`)}}(it));this.cache=function(ut,_t){return new(a(_t))(ut)}(ft,it)}}}static fromProto(ot){if(!ot)throw new Error("cannot construct Value from an empty tensor");const it=nt.ProtoUtil.tensorDataTypeFromProto(ot.dataType),at=nt.ProtoUtil.tensorDimsFromProto(ot.dims),lt=new et(at,it);if(it==="string")ot.stringData.forEach((ct,dt)=>{lt.data[dt]=(0,nt.decodeUtf8String)(ct)});else if(ot.rawData&&typeof ot.rawData.byteLength=="number"&&ot.rawData.byteLength>0){const ct=lt.data,dt=new DataView(ot.rawData.buffer,ot.rawData.byteOffset,ot.rawData.byteLength),mt=d(ot.dataType),ht=ot.rawData.byteLength/mt;if(ot.rawData.byteLength%mt!=0)throw new Error("invalid buffer length");if(ct.length!==ht)throw new Error("buffer length mismatch");for(let ft=0;ft<ht;ft++){const ut=j(dt,ot.dataType,ft*mt);ct[ft]=ut}}else{let ct;switch(ot.dataType){case _.onnx.TensorProto.DataType.FLOAT:ct=ot.floatData;break;case _.onnx.TensorProto.DataType.INT32:case _.onnx.TensorProto.DataType.INT16:case _.onnx.TensorProto.DataType.UINT16:case _.onnx.TensorProto.DataType.INT8:case _.onnx.TensorProto.DataType.UINT8:case _.onnx.TensorProto.DataType.BOOL:ct=ot.int32Data;break;case _.onnx.TensorProto.DataType.INT64:ct=ot.int64Data;break;case _.onnx.TensorProto.DataType.DOUBLE:ct=ot.doubleData;break;case _.onnx.TensorProto.DataType.UINT32:case _.onnx.TensorProto.DataType.UINT64:ct=ot.uint64Data;break;default:throw new Error("unspecific error")}if(ct==null)throw new Error("failed to populate data from a tensorproto value");const dt=lt.data;if(dt.length!==ct.length)throw new Error("array length mismatch");for(let mt=0;mt<ct.length;mt++){const ht=ct[mt];h.default.isLong(ht)?dt[mt]=g(ht,ot.dataType):dt[mt]=ht}}return lt}static fromData(ot,it,at){return new et(it,at,void 0,void 0,ot)}static fromOrtTensor(ot){if(!ot)throw new Error("cannot construct Value from an empty tensor");const it=nt.ProtoUtil.tensorDimsFromORTFormat(ot),at=nt.ProtoUtil.tensorDataTypeFromProto(ot.dataType()),lt=new et(it,at);if(at==="string")for(let ct=0;ct<ot.stringDataLength();ct++)lt.data[ct]=ot.stringData(ct);else if(ot.rawDataArray()&&typeof ot.rawDataLength()=="number"&&ot.rawDataLength()>0){const ct=lt.data,dt=new DataView(ot.rawDataArray().buffer,ot.rawDataArray().byteOffset,ot.rawDataLength()),mt=d(ot.dataType()),ht=ot.rawDataLength()/mt;if(ot.rawDataLength()%mt!=0)throw new Error("invalid buffer length");if(ct.length!==ht)throw new Error("buffer length mismatch");for(let ft=0;ft<ht;ft++){const ut=j(dt,ot.dataType(),ft*mt);ct[ft]=ut}}return lt}}function d(rt){switch(rt){case _.onnx.TensorProto.DataType.UINT8:case _.onnx.TensorProto.DataType.INT8:case _.onnx.TensorProto.DataType.BOOL:return 1;case _.onnx.TensorProto.DataType.UINT16:case _.onnx.TensorProto.DataType.INT16:return 2;case _.onnx.TensorProto.DataType.FLOAT:case _.onnx.TensorProto.DataType.INT32:case _.onnx.TensorProto.DataType.UINT32:return 4;case _.onnx.TensorProto.DataType.INT64:case _.onnx.TensorProto.DataType.DOUBLE:case _.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${_.onnx.TensorProto.DataType[rt]}`)}}function a(rt){switch(rt){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function g(rt,ot){if(ot===_.onnx.TensorProto.DataType.INT64||ot===tt.TensorDataType.INT64){if(rt.greaterThanOrEqual(2147483648)||rt.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(ot!==_.onnx.TensorProto.DataType.UINT32&&ot!==tt.TensorDataType.UINT32&&ot!==_.onnx.TensorProto.DataType.UINT64&&ot!==tt.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${_.onnx.TensorProto.DataType[ot]}`);if(rt.greaterThanOrEqual(4294967296)||rt.lessThan(0))throw new TypeError("uint64 is not supported")}return rt.toNumber()}function j(rt,ot,it){switch(ot){case _.onnx.TensorProto.DataType.BOOL:case _.onnx.TensorProto.DataType.UINT8:return rt.getUint8(it);case _.onnx.TensorProto.DataType.INT8:return rt.getInt8(it);case _.onnx.TensorProto.DataType.UINT16:return rt.getUint16(it,!0);case _.onnx.TensorProto.DataType.INT16:return rt.getInt16(it,!0);case _.onnx.TensorProto.DataType.FLOAT:return rt.getFloat32(it,!0);case _.onnx.TensorProto.DataType.INT32:return rt.getInt32(it,!0);case _.onnx.TensorProto.DataType.UINT32:return rt.getUint32(it,!0);case _.onnx.TensorProto.DataType.INT64:return g(h.default.fromBits(rt.getUint32(it,!0),rt.getUint32(it+4,!0),!1),ot);case _.onnx.TensorProto.DataType.DOUBLE:return rt.getFloat64(it,!0);case _.onnx.TensorProto.DataType.UINT64:return g(h.default.fromBits(rt.getUint32(it,!0),rt.getUint32(it+4,!0),!0),ot);default:throw new Error(`cannot read from DataView for type ${_.onnx.TensorProto.DataType[ot]}`)}}e.Tensor=et},2517:function(i,e,o){var s=this&&this.__importDefault||function(ot){return ot&&ot.__esModule?ot:{default:ot}};Object.defineProperty(e,"__esModule",{value:!0}),e.decodeUtf8String=e.MAX_CLIP=e.MIN_CLIP=e.PoolConvUtil=e.ReduceUtil=e.SplitUtil=e.MathUtil=e.ShapeUtil=e.LongUtil=e.ProtoUtil=e.GemmUtil=e.arrayCopyHelper=e.BroadcastUtil=e.MatMulUtil=e.ArrayUtil=e.assert=e.checkInputsShape=void 0;const c=o(5686),h=s(o(3720)),_=o(1446),$=o(9162);e.checkInputsShape=function(ot,...it){if(!ot||ot.length!==it.length)return!1;for(let at=0;at<ot.length;at++)if(!ot[at].dims||ot[at].dims.length!==it[at])return!1;return!0},e.assert=function(ot,it){if(!ot)throw new Error(typeof it=="string"?it:it())},e.ArrayUtil=class{static arraysEqual(ot,it){if(ot.length!==it.length)return!1;for(let at=0;at<ot.length;at++)if(ot[at]!==it[at])return!1;return!0}};class nt{static preprocessInputShapes(it,at){return[it.length===1?[1,it[0]]:it,at.length===1?[at[0],1]:at]}static postprocessOutputShape(it,at,lt){at===1&&it.splice(it.length-2,1),lt===1&&it.pop()}static calcMatMulShape(it,at){return it[1]!==at[0]?void 0:[it[0],at[1]]}}e.MatMulUtil=nt;class tt{static calcShape(it,at,lt=!1){const ct=it.length,dt=at.length;if(ct===0)return at;if(dt===0)return it;const mt=Math.max(it.length,at.length),ht=new Array(mt);if(lt){if(ct<2||dt<2)return;const ft=nt.calcMatMulShape([it[ct-2],it[ct-1]],[at[dt-2],at[dt-1]]);if(ft===void 0)return;[ht[mt-2],ht[mt-1]]=ft}for(let ft=lt?3:1;ft<=mt;ft++){const ut=ct-ft<0?1:it[ct-ft],_t=dt-ft<0?1:at[dt-ft];if(ut!==_t&&ut>1&&_t>1)return;ht[mt-ft]=Math.max(ut,_t)}return ht}static index(it,at){const lt=new Array(at.length);return tt.fillIndex(it,at,lt),lt}static fillIndex(it,at,lt){const ct=it.length-at.length;for(let dt=0;dt<at.length;dt++)lt[dt]=it[ct+dt]%at[dt]}static calc(it,at,lt,ct,dt){const mt=tt.calcShape(it.dims,at.dims);if(mt){if(ct&&!a.areEqual(mt,it.dims))return;const ht=a.size(mt),ft=ct?it:new $.Tensor(mt,dt||it.type);if(mt.length===0)ft.set([],lt(it.get([]),at.get([])));else{const ut=new Array(mt.length),_t=new Array(it.dims.length),bt=new Array(at.dims.length);let vt,Tt=0,Mt=0,xt=!1,Pt=!1;it.dims.length===0&&(Tt=it.get([]),xt=!0),at.dims.length===0&&(Mt=at.get([]),Pt=!0);for(let It=0;It<ht;It++){vt=It;for(let Dt=mt.length-1;Dt>=0;Dt--)ut[Dt]=vt%mt[Dt],vt=Math.floor(vt/mt[Dt]);xt||(tt.fillIndex(ut,it.dims,_t),Tt=it.get(_t)),Pt||(tt.fillIndex(ut,at.dims,bt),Mt=at.get(bt)),ft.set(ut,lt(Tt,Mt))}}return ft}}static isValidBroadcast(it,at){const lt=it.length,ct=at.length;if(lt>ct)return!1;for(let dt=1;dt<=lt;dt++)if(it[lt-dt]!==1&&it[lt-dt]!==at[ct-dt])return!1;return!0}static getBroadcastDims(it,at){const lt=it.length,ct=[];for(let dt=0;dt<lt;dt++){const mt=lt-1-dt,ht=it[mt]||1;(at[at.length-1-dt]||1)>1&&ht===1&&ct.unshift(mt)}return ct}}e.BroadcastUtil=tt,e.arrayCopyHelper=function(ot,it,at,lt,ct){if(lt<0||lt>=it.length)throw new Error("sourceIndex out of bounds");if(at<0||at>=ot.length)throw new Error("targetIndex out of bounds");if(lt+ct>it.length)throw new Error("source indices to be copied are outside bounds");if(at+ct>ot.length)throw new Error("target array is too small to hold result");for(let dt=0;dt<ct;dt++)ot[at+dt]=it[lt+dt]},e.GemmUtil=class{static getShapeOfGemmResult(ot,it,at,lt,ct){if(ot.length!==2||at.length!==2)throw new Error("shape need to be of size 2");let dt,mt,ht;it?(dt=ot[1],mt=ot[0]):(dt=ot[0],mt=ot[1]);let ft=-1;if(lt?(ht=at[0],ft=1):(ht=at[1],ft=0),at[ft]!==mt)throw new Error("dimension mismatch");if(dt<=0||ht<=0||mt<=0)throw new Error("invalid shape specified");if(ct&&!tt.isValidBroadcast(ct,[dt,ht]))throw new Error("gemm: invalid bias shape for broadcast");return[dt,ht,mt]}};class et{static tensorDataTypeFromProto(it){switch(it){case _.onnx.TensorProto.DataType.INT8:return"int8";case _.onnx.TensorProto.DataType.UINT8:return"uint8";case _.onnx.TensorProto.DataType.BOOL:return"bool";case _.onnx.TensorProto.DataType.INT16:return"int16";case _.onnx.TensorProto.DataType.UINT16:return"uint16";case _.onnx.TensorProto.DataType.INT32:return"int32";case _.onnx.TensorProto.DataType.UINT32:return"uint32";case _.onnx.TensorProto.DataType.FLOAT:return"float32";case _.onnx.TensorProto.DataType.DOUBLE:return"float64";case _.onnx.TensorProto.DataType.STRING:return"string";case _.onnx.TensorProto.DataType.INT64:return"int32";case _.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${_.onnx.TensorProto.DataType[it]}`)}}static tensorDataTypeStringToEnum(it){switch(it){case"int8":return _.onnx.TensorProto.DataType.INT8;case"uint8":return _.onnx.TensorProto.DataType.UINT8;case"bool":return _.onnx.TensorProto.DataType.BOOL;case"int16":return _.onnx.TensorProto.DataType.INT16;case"uint16":return _.onnx.TensorProto.DataType.UINT16;case"int32":return _.onnx.TensorProto.DataType.INT32;case"uint32":return _.onnx.TensorProto.DataType.UINT32;case"float32":return _.onnx.TensorProto.DataType.FLOAT;case"float64":return _.onnx.TensorProto.DataType.DOUBLE;case"string":return _.onnx.TensorProto.DataType.STRING;case"int64":return _.onnx.TensorProto.DataType.INT64;case"uint64":return _.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${it}`)}}static tensorDimsFromProto(it){return it.map(at=>h.default.isLong(at)?at.toNumber():at)}static tensorValueTypeFromProto(it){return{tensorType:et.tensorDataTypeFromProto(it.elemType),shape:{dims:et.tensorDimsFromProto(it.shape.dim.map(at=>at.dimValue))}}}static tensorDimsFromORTFormat(it){const at=[];for(let lt=0;lt<it.dimsLength();lt++)at.push(d.longToNumber(it.dims(lt)));return at}static tensorAttributesFromORTFormat(it){const at=[];for(let lt=0;lt<it.attributesLength();lt++)at.push(it.attributes(lt));return at}}e.ProtoUtil=et;class d{static longToNumber(it,at){return h.default.isLong(it)?it.toNumber():it instanceof c.flatbuffers.Long?h.default.fromValue({low:it.low,high:it.high,unsigned:at!=null&&at}).toNumber():it}static isLong(it){return h.default.isLong(it)||it instanceof c.flatbuffers.Long}}e.LongUtil=d;class a{static size(it){return a.getSizeFromDimensionRange(it,0,it.length)}static sizeFromDimension(it,at){if(at<0||at>it.length)throw new Error(`invalid dimension of ${at} for sizeFromDimension as Tensor has ${it.length} dimensions.`);return a.getSizeFromDimensionRange(it,at,it.length)}static sizeToDimension(it,at){if(at<0||at>it.length)throw new Error(`invalid dimension of ${at} for sizeToDimension as Tensor has ${it.length} dimensions.`);return a.getSizeFromDimensionRange(it,0,at)}static getSizeFromDimensionRange(it,at,lt){let ct=1;for(let dt=at;dt<lt;dt++){if(it[dt]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");ct*=it[dt]}return ct}static computeStrides(it){const at=it.length;if(at===0)return[];if(at===1)return[1];const lt=new Array(at);lt[at-1]=1,lt[at-2]=it[at-1];for(let ct=at-3;ct>=0;--ct)lt[ct]=lt[ct+1]*it[ct+1];return lt}static transpose(it){return it.slice().reverse()}static indicesToOffset(it,at,lt){lt===void 0&&(lt=it.length);let ct=0;for(let dt=0;dt<lt;++dt)ct+=at[dt]*it[dt];return ct}static offsetToIndices(it,at){const lt=at.length;if(lt===0)return[];if(lt===1)return[it*at[0]];const ct=new Array(at.length);for(let dt=0;dt<ct.length-1;++dt)ct[dt]=Math.floor(it/at[dt]),it-=ct[dt]*at[dt];return ct[ct.length-1]=it,ct}static normalizeAxis(it,at){if(it<-at&&it>=at)throw new Error("unsupported axis for this operation.");return it<0?it+at:it}static normalizeAxes(it,at){return it.map(lt=>this.normalizeAxis(lt,at))}static incrementIndex(it,at,lt){if(at.length===0||it.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(lt===void 0)lt=at.length;else if(lt<=0||lt>at.length)throw new Error("Incorrect axis to increment on");for(let ct=lt-1;ct>=0&&(it[ct]++,!(it[ct]<at[ct]));--ct)it[ct]=0}static calculateReshapedDims(it,at){if(at.length===0){if(it.length===0||a.size(it)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}const lt=at.length,ct=new Array(lt);let dt=-1,mt=1;for(let ft=0;ft<lt;ft++){if(at[ft]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(at[ft]===-1){if(dt!==-1)throw new Error("at most one dimension in shape hints can be -1");dt=ft}else{if(at[ft]===0){if(ft>=it.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");ct[ft]=it[ft]}else ct[ft]=at[ft];mt*=ct[ft]}}const ht=a.size(it);if(dt!==-1){if(ht%mt!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${it}] Output shape: [${at}]`);ct[dt]=ht/mt}else if(mt!==ht)throw new Error("reshapedDims and originalDims don't have matching sizes");return ct}static sortBasedOnPerm(it,at){return at?at.map(lt=>it[lt]):it.slice().reverse()}static padShape(it,at){const lt=it.length;return it.map((ct,dt)=>ct+at[dt]+at[dt+lt])}static areEqual(it,at){return it.length===at.length&&it.every((lt,ct)=>lt===at[ct])}static validateDimsAndCalcSize(it){if(it.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let at=1;for(const lt of it){if(!Number.isInteger(lt))throw new TypeError(`Invalid shape: ${lt} is not an integer`);if(lt<0||lt>2147483647)throw new TypeError(`Invalid shape: length ${lt} is not allowed`);at*=lt}return at}static flattenShape(it,at){at<0&&(at+=it.length);const lt=it.reduce((dt,mt)=>dt*mt,1),ct=it.slice(at).reduce((dt,mt)=>dt*mt,1);return[lt/ct,ct]}static squeezeShape(it,at){const lt=new Array;at=a.normalizeAxes(at,it.length);for(let ct=0;ct<it.length;ct++){const dt=at.indexOf(ct)>=0;if(dt&&it[ct]!==1)throw new Error("squeeze an axis of size different than 1");(at.length===0&&it[ct]>1||at.length>0&&!dt)&&lt.push(it[ct])}return lt}static unsqueezeShape(it,at){const lt=new Array(it.length+at.length);lt.fill(0);for(let dt=0;dt<at.length;dt++){const mt=a.normalizeAxis(at[dt],lt.length);if(mt>=lt.length)throw new Error("'axes' has an out of range axis");if(lt[mt]!==0)throw new Error("'axes' has a duplicate axis");lt[mt]=1}let ct=0;for(let dt=0;dt<lt.length;dt++)lt[dt]===0&&(lt[dt]=it[ct++]);if(ct!==it.length)throw new Error("the unsqueezed dimension could not be established");return lt}}e.ShapeUtil=a,e.MathUtil=class{static sqr(ot,it,at,lt,ct){if(lt<0||lt>=it.length)throw new Error("sourceIndex out of bounds");if(at<0||at>=ot.length)throw new Error("targetIndex out of bounds");if(lt+ct>it.length)throw new Error("source indices to be copied are outside bounds");if(at+ct>ot.length)throw new Error("target array is too small to hold result");for(let dt=0;dt<ct;dt++)ot[at+dt]+=Math.pow(it[lt+dt],2)}static axpy(ot,it,at,lt,ct,dt){if(lt<0||lt>=it.length)throw new Error("sourceIndex out of bounds");if(at<0||at>=ot.length)throw new Error("targetIndex out of bounds");if(lt+ct>it.length)throw new Error("source indices to be copied are outside bounds");if(at+ct>ot.length)throw new Error("target array is too small to hold result");for(let mt=0;mt<ct;mt++)ot[at+mt]+=dt*it[lt+mt]}static powx(ot,it,at,lt,ct,dt){if(lt<0||lt>=it.length)throw new Error("sourceIndex out of bounds");if(at<0||at>=ot.length)throw new Error("targetIndex out of bounds");if(lt+ct>it.length)throw new Error("source indices to be copied are outside bounds");if(at+ct>ot.length)throw new Error("target array is too small to hold result");for(let mt=0;mt<ct;mt++)ot[at+mt]=Math.pow(it[lt+mt],dt)}static mul(ot,it,at,lt,ct){if(lt<0||lt>=it.length)throw new Error("sourceIndex out of bounds");if(at<0||at>=ot.length)throw new Error("targetIndex out of bounds");if(lt+ct>it.length)throw new Error("source indices to be copied are outside bounds");if(at+ct>ot.length)throw new Error("target array is too small to hold result");for(let dt=0;dt<ct;dt++)ot[at+dt]=it[lt+dt]*ot[at+dt]}};class g{static splitShape(it,at,lt,ct){if(lt.length===0){if(!ct)throw new Error("need to know number of outputs when the 'split' attribute is not specified");g.determineSplit(it[at],ct,lt)}const dt=[],mt=[0];for(let ht=0;ht<lt.length;++ht){ht!==0&&mt.push(mt[ht-1]+lt[ht-1]);const ft=it.slice();ft[at]=lt[ht],dt.push(ft)}return[dt,mt]}static determineSplit(it,at,lt){if(it%at!=0)throw new Error("cannot split tensor to equal sized parts");for(let ct=0;ct<at;++ct)lt.push(it/at)}}e.SplitUtil=g;class j{static calcReduce(it,at,lt,ct,dt){const mt=it.dims.slice(0);at.length===0&&mt.forEach((Tt,Mt)=>at.push(Mt));const ht=j.calcReduceShape(mt,at,!0),ft=a.size(ht),ut=new $.Tensor(ht,it.type),_t=a.computeStrides(ht),bt=a.computeStrides(mt),vt=new Array(mt.length);for(let Tt=0;Tt<ft;Tt++){const Mt=a.offsetToIndices(Tt,_t);tt.fillIndex(Mt,mt,vt),ut.set(Mt,j.calcReduceByAxis(it.numberData,at,mt,0,a.indicesToOffset(vt,bt),ct,dt))}return lt?ut:new $.Tensor(j.calcReduceShape(mt,at,lt),ut.type,void 0,void 0,ut.data,ut.dataId)}static calcReduceByAxis(it,at,lt,ct,dt,mt,ht){let ft=0;if(ct>=at.length)return mt(it[dt]);const ut=at[ct],_t=ut>=lt.length?1:a.size(lt.slice(ut+1));for(let bt=0;bt<lt[ut];bt++)ft=bt===0?j.calcReduceByAxis(it,at,lt,ct+1,dt,mt,ht):ht(ft,j.calcReduceByAxis(it,at,lt,ct+1,dt,mt,ht)),dt+=_t;return ft}static calcReduceShape(it,at,lt){const ct=it.slice();for(let dt=0;dt<at.length;dt++)ct[at[dt]]=lt?1:0;return ct.filter(dt=>dt!==0)}}e.ReduceUtil=j;class rt{static adjustPoolAttributes(it,at,lt,ct,dt,mt){if(!it&&lt.length!==at.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(it)for(let ht=0;ht<at.length-2;ht++)ht>=lt.length?lt.push(at[ht+2]):lt[ht]=at[ht+2];for(let ht=0;ht<lt.length;ht++)if(ht<ct.length){if(ct[ht]<0)throw new Error("strides should be greater than or equal to 1")}else ct.push(1);for(let ht=0;ht<lt.length;ht++)if(ht<dt.length){if(dt[ht]<0)throw new Error("dilations should be greater than or equal to 1")}else dt.push(1);for(let ht=0;ht<2*lt.length;ht++)if(ht<mt.length){if(mt[ht]<0)throw new Error("pad should be greater than or equal to 1")}else mt.push(0);for(let ht=0;ht<lt.length;ht++){if(lt[ht]<=0)throw new Error("kernel shapes need to be greater than 0");if(mt[ht]>=lt[ht]||mt[ht+lt.length]>=lt[ht])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(it,at,lt,ct,dt,mt){if(mt){if(dt.length!==2*(it.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(at.length!==it.length-2)throw new Error("length of strides should be the length of data dimensions");if(ct.length!==it.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let ht=0;ht<it.length-2;ht++)rt.adjustPadAndReturnShape(it[ht+2],at[ht],lt[ht],ct[ht],dt,ht,ht+it.length-2,mt)}}static computePoolOutputShape(it,at,lt,ct,dt,mt,ht){if(at.length<=0)throw new Error("input shape must be of size greater than 0");const ft=[at[0],at[1]];return rt.computeShapeHelper(it,at,ft,lt,ct,dt,mt,ht),ft}static computeConvOutputShape(it,at,lt,ct,dt,mt,ht){if(it.length<=0||at.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const ft=[it[0],at[0]];return rt.computeShapeHelper(!1,it,ft,lt,ct,dt,mt,ht),ft}static computeShapeHelper(it,at,lt,ct,dt,mt,ht,ft){if(it)for(let ut=0;ut<at.length-2;ut++)lt.push(1);else for(let ut=0;ut<at.length-2;ut++)lt.push(rt.adjustPadAndReturnShape(at[ut+2],ct[ut],dt[ut],mt[ut],ht,ut,ut+at.length-2,ft))}static adjustPadAndReturnShape(it,at,lt,ct,dt,mt,ht,ft){const ut=lt*(ct-1)+1;if(!ft||ft==="NOTSET")return Math.floor((it+dt[mt]+dt[ht]-ut)/at+1);switch(ft){case"VALID":return dt[mt]=0,dt[ht]=0,Math.floor((it-ut)/at+1);case"SAME_LOWER":case"SAME_UPPER":if(lt!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const _t=((it+at-1)/at-1)*at+ct-it;return dt[mt]=Math.floor(ft==="SAME_LOWER"?(_t+1)/2:_t/2),dt[ht]=_t-dt[mt],Math.floor((it+_t-ct)/at+1)}default:throw new Error("Unsupported AutoPad type")}}}e.PoolConvUtil=rt,e.MIN_CLIP=-34028234663852886e22,e.MAX_CLIP=34028234663852886e22,e.decodeUtf8String=function(ot){return new TextDecoder().decode(ot)}},7967:(i,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.iterateExtraOptions=void 0,e.iterateExtraOptions=(o,s,c,h)=>{if(typeof o=="object"&&o!==null){if(c.has(o))throw new Error("Circular reference in options");c.add(o)}Object.entries(o).forEach(([_,$])=>{const nt=s?s+_:_;if(typeof $=="object")(0,e.iterateExtraOptions)($,nt+".",c,h);else if(typeof $=="string"||typeof $=="number")h(nt,$.toString());else{if(typeof $!="boolean")throw new Error("Can't handle extra config type: "+typeof $);h(nt,$?"1":"0")}})}},2157:function(i,e,o){var s,c=this&&this.__createBinding||(Object.create?function(_t,bt,vt,Tt){Tt===void 0&&(Tt=vt);var Mt=Object.getOwnPropertyDescriptor(bt,vt);Mt&&!("get"in Mt?!bt.__esModule:Mt.writable||Mt.configurable)||(Mt={enumerable:!0,get:function(){return bt[vt]}}),Object.defineProperty(_t,Tt,Mt)}:function(_t,bt,vt,Tt){Tt===void 0&&(Tt=vt),_t[Tt]=bt[vt]}),h=this&&this.__setModuleDefault||(Object.create?function(_t,bt){Object.defineProperty(_t,"default",{enumerable:!0,value:bt})}:function(_t,bt){_t.default=bt}),_=this&&this.__importStar||function(_t){if(_t&&_t.__esModule)return _t;var bt={};if(_t!=null)for(var vt in _t)vt!=="default"&&Object.prototype.hasOwnProperty.call(_t,vt)&&c(bt,_t,vt);return h(bt,_t),bt};Object.defineProperty(e,"__esModule",{value:!0}),e.endProfiling=e.run=e.releaseSession=e.createSession=e.createSessionFinalize=e.createSessionAllocate=e.initOrt=e.initWasm=void 0;const $=o(1670),nt=_(o(349)),tt=o(6361),et=()=>!!$.env.wasm.proxy&&typeof document<"u";let d,a,g,j=!1,rt=!1,ot=!1;const it=[],at=[],lt=[],ct=[],dt=[],mt=[],ht=()=>{if(j||!rt||ot||!d)throw new Error("worker not ready")},ft=_t=>{switch(_t.data.type){case"init-wasm":j=!1,_t.data.err?(ot=!0,a[1](_t.data.err)):(rt=!0,a[0]());break;case"init-ort":_t.data.err?g[1](_t.data.err):g[0]();break;case"create_allocate":_t.data.err?it.shift()[1](_t.data.err):it.shift()[0](_t.data.out);break;case"create_finalize":_t.data.err?at.shift()[1](_t.data.err):at.shift()[0](_t.data.out);break;case"create":_t.data.err?lt.shift()[1](_t.data.err):lt.shift()[0](_t.data.out);break;case"release":_t.data.err?ct.shift()[1](_t.data.err):ct.shift()[0]();break;case"run":_t.data.err?dt.shift()[1](_t.data.err):dt.shift()[0](_t.data.out);break;case"end-profiling":_t.data.err?mt.shift()[1](_t.data.err):mt.shift()[0]()}},ut=typeof document<"u"?(s=document==null?void 0:document.currentScript)===null||s===void 0?void 0:s.src:void 0;e.initWasm=async()=>{if(et()){if(rt)return;if(j)throw new Error("multiple calls to 'initWasm()' detected.");if(ot)throw new Error("previous call to 'initWasm()' failed.");return j=!0,$.env.wasm.wasmPaths===void 0&&ut&&ut.indexOf("blob:")!==0&&($.env.wasm.wasmPaths=ut.substr(0,+ut.lastIndexOf("/")+1)),new Promise((_t,bt)=>{d==null||d.terminate(),d=o(9710).Z(),d.onmessage=ft,a=[_t,bt];const vt={type:"init-wasm",in:$.env.wasm};d.postMessage(vt)})}return(0,tt.initializeWebAssembly)($.env.wasm)},e.initOrt=async(_t,bt)=>{if(et())return ht(),new Promise((vt,Tt)=>{g=[vt,Tt];const Mt={type:"init-ort",in:{numThreads:_t,loggingLevel:bt}};d.postMessage(Mt)});nt.initOrt(_t,bt)},e.createSessionAllocate=async _t=>et()?(ht(),new Promise((bt,vt)=>{it.push([bt,vt]);const Tt={type:"create_allocate",in:{model:_t}};d.postMessage(Tt,[_t.buffer])})):nt.createSessionAllocate(_t),e.createSessionFinalize=async(_t,bt)=>et()?(ht(),new Promise((vt,Tt)=>{at.push([vt,Tt]);const Mt={type:"create_finalize",in:{modeldata:_t,options:bt}};d.postMessage(Mt)})):nt.createSessionFinalize(_t,bt),e.createSession=async(_t,bt)=>et()?(ht(),new Promise((vt,Tt)=>{lt.push([vt,Tt]);const Mt={type:"create",in:{model:_t,options:bt}};d.postMessage(Mt,[_t.buffer])})):nt.createSession(_t,bt),e.releaseSession=async _t=>{if(et())return ht(),new Promise((bt,vt)=>{ct.push([bt,vt]);const Tt={type:"release",in:_t};d.postMessage(Tt)});nt.releaseSession(_t)},e.run=async(_t,bt,vt,Tt,Mt)=>et()?(ht(),new Promise((xt,Pt)=>{dt.push([xt,Pt]);const It={type:"run",in:{sessionId:_t,inputIndices:bt,inputs:vt,outputIndices:Tt,options:Mt}};d.postMessage(It,nt.extractTransferableBuffers(vt))})):nt.run(_t,bt,vt,Tt,Mt),e.endProfiling=async _t=>{if(et())return ht(),new Promise((bt,vt)=>{mt.push([bt,vt]);const Tt={type:"end-profiling",in:_t};d.postMessage(Tt)});nt.endProfiling(_t)}},586:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setRunOptions=void 0;const s=o(7967),c=o(4983),h=o(6361);e.setRunOptions=_=>{const $=(0,h.getInstance)();let nt=0;const tt=[],et=_||{};try{if((_==null?void 0:_.logSeverityLevel)===void 0)et.logSeverityLevel=2;else if(typeof _.logSeverityLevel!="number"||!Number.isInteger(_.logSeverityLevel)||_.logSeverityLevel<0||_.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${_.logSeverityLevel}`);if((_==null?void 0:_.logVerbosityLevel)===void 0)et.logVerbosityLevel=0;else if(typeof _.logVerbosityLevel!="number"||!Number.isInteger(_.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${_.logVerbosityLevel}`);(_==null?void 0:_.terminate)===void 0&&(et.terminate=!1);let d=0;if((_==null?void 0:_.tag)!==void 0&&(d=(0,c.allocWasmString)(_.tag,tt)),nt=$._OrtCreateRunOptions(et.logSeverityLevel,et.logVerbosityLevel,!!et.terminate,d),nt===0)throw new Error("Can't create run options");return(_==null?void 0:_.extra)!==void 0&&(0,s.iterateExtraOptions)(_.extra,"",new WeakSet,(a,g)=>{const j=(0,c.allocWasmString)(a,tt),rt=(0,c.allocWasmString)(g,tt);if($._OrtAddRunConfigEntry(nt,j,rt)!==0)throw new Error(`Can't set a run config entry: ${a} - ${g}`)}),[nt,tt]}catch(d){throw nt!==0&&$._OrtReleaseRunOptions(nt),tt.forEach($._free),d}}},2306:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OnnxruntimeWebAssemblySessionHandler=void 0;const s=o(2806),c=o(1670),h=o(2850),_=o(2157);let $;e.OnnxruntimeWebAssemblySessionHandler=class{async createSessionAllocate(nt){const tt=await fetch(nt),et=await tt.arrayBuffer();return(0,_.createSessionAllocate)(new Uint8Array(et))}async loadModel(nt,tt){if($||(await(0,_.initOrt)(c.env.wasm.numThreads,(et=>{switch(et){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${et}`)}})(c.env.logLevel)),$=!0),typeof nt=="string")if(typeof fetch>"u"){const et=await(0,h.promisify)(s.readFile)(nt);[this.sessionId,this.inputNames,this.outputNames]=await(0,_.createSession)(et,tt)}else{const et=await this.createSessionAllocate(nt);[this.sessionId,this.inputNames,this.outputNames]=await(0,_.createSessionFinalize)(et,tt)}else[this.sessionId,this.inputNames,this.outputNames]=await(0,_.createSession)(nt,tt)}async dispose(){return(0,_.releaseSession)(this.sessionId)}async run(nt,tt,et){const d=[],a=[];Object.entries(nt).forEach(ot=>{const it=ot[0],at=ot[1],lt=this.inputNames.indexOf(it);if(lt===-1)throw new Error(`invalid input '${it}'`);d.push(at),a.push(lt)});const g=[];Object.entries(tt).forEach(ot=>{const it=ot[0],at=this.outputNames.indexOf(it);if(at===-1)throw new Error(`invalid output '${it}'`);g.push(at)});const j=await(0,_.run)(this.sessionId,a,d.map(ot=>[ot.type,ot.dims,ot.data]),g,et),rt={};for(let ot=0;ot<j.length;ot++)rt[this.outputNames[g[ot]]]=new c.Tensor(j[ot][0],j[ot][2],j[ot][1]);return rt}startProfiling(){}endProfiling(){(0,_.endProfiling)(this.sessionId)}}},4919:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setSessionOptions=void 0;const s=o(7967),c=o(4983),h=o(6361);e.setSessionOptions=_=>{const $=(0,h.getInstance)();let nt=0;const tt=[],et=_||{};(d=>{d.extra||(d.extra={}),d.extra.session||(d.extra.session={});const a=d.extra.session;a.use_ort_model_bytes_directly||(a.use_ort_model_bytes_directly="1")})(et);try{(_==null?void 0:_.graphOptimizationLevel)===void 0&&(et.graphOptimizationLevel="all");const d=(j=>{switch(j){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${j}`)}})(et.graphOptimizationLevel);(_==null?void 0:_.enableCpuMemArena)===void 0&&(et.enableCpuMemArena=!0),(_==null?void 0:_.enableMemPattern)===void 0&&(et.enableMemPattern=!0),(_==null?void 0:_.executionMode)===void 0&&(et.executionMode="sequential");const a=(j=>{switch(j){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${j}`)}})(et.executionMode);let g=0;if((_==null?void 0:_.logId)!==void 0&&(g=(0,c.allocWasmString)(_.logId,tt)),(_==null?void 0:_.logSeverityLevel)===void 0)et.logSeverityLevel=2;else if(typeof _.logSeverityLevel!="number"||!Number.isInteger(_.logSeverityLevel)||_.logSeverityLevel<0||_.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${_.logSeverityLevel}`);if((_==null?void 0:_.logVerbosityLevel)===void 0)et.logVerbosityLevel=0;else if(typeof _.logVerbosityLevel!="number"||!Number.isInteger(_.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${_.logVerbosityLevel}`);if((_==null?void 0:_.enableProfiling)===void 0&&(et.enableProfiling=!1),nt=$._OrtCreateSessionOptions(d,!!et.enableCpuMemArena,!!et.enableMemPattern,a,!!et.enableProfiling,0,g,et.logSeverityLevel,et.logVerbosityLevel),nt===0)throw new Error("Can't create session options");return _!=null&&_.executionProviders&&((j,rt,ot)=>{for(const it of rt){let at=typeof it=="string"?it:it.name;switch(at){case"xnnpack":at="XNNPACK";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${at}`)}const lt=(0,c.allocWasmString)(at,ot);if((0,h.getInstance)()._OrtAppendExecutionProvider(j,lt)!==0)throw new Error(`Can't append execution provider: ${at}`)}})(nt,_.executionProviders,tt),(_==null?void 0:_.extra)!==void 0&&(0,s.iterateExtraOptions)(_.extra,"",new WeakSet,(j,rt)=>{const ot=(0,c.allocWasmString)(j,tt),it=(0,c.allocWasmString)(rt,tt);if($._OrtAddSessionConfigEntry(nt,ot,it)!==0)throw new Error(`Can't set a session config entry: ${j} - ${rt}`)}),[nt,tt]}catch(d){throw nt!==0&&$._OrtReleaseSessionOptions(nt),tt.forEach($._free),d}}},4983:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.allocWasmString=void 0;const s=o(6361);e.allocWasmString=(c,h)=>{const _=(0,s.getInstance)(),$=_.lengthBytesUTF8(c)+1,nt=_._malloc($);return _.stringToUTF8(c,nt,$),h.push(nt),nt}},349:(i,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.extractTransferableBuffers=e.endProfiling=e.run=e.releaseSession=e.createSession=e.createSessionFinalize=e.createSessionAllocate=e.initOrt=void 0;const s=o(586),c=o(4919),h=o(4983),_=o(6361);e.initOrt=(d,a)=>{const g=(0,_.getInstance)()._OrtInit(d,a);if(g!==0)throw new Error(`Can't initialize onnxruntime. error code = ${g}`)};const $=new Map;e.createSessionAllocate=d=>{const a=(0,_.getInstance)(),g=a._malloc(d.byteLength);return a.HEAPU8.set(d,g),[g,d.byteLength]},e.createSessionFinalize=(d,a)=>{const g=(0,_.getInstance)();let j=0,rt=0,ot=[];try{if([rt,ot]=(0,c.setSessionOptions)(a),j=g._OrtCreateSession(d[0],d[1],rt),j===0)throw new Error("Can't create a session")}finally{g._free(d[0]),g._OrtReleaseSessionOptions(rt),ot.forEach(g._free)}const it=g._OrtGetInputCount(j),at=g._OrtGetOutputCount(j),lt=[],ct=[],dt=[],mt=[];for(let ht=0;ht<it;ht++){const ft=g._OrtGetInputName(j,ht);if(ft===0)throw new Error("Can't get an input name");ct.push(ft),lt.push(g.UTF8ToString(ft))}for(let ht=0;ht<at;ht++){const ft=g._OrtGetOutputName(j,ht);if(ft===0)throw new Error("Can't get an output name");mt.push(ft),dt.push(g.UTF8ToString(ft))}return $.set(j,[j,ct,mt]),[j,lt,dt]},e.createSession=(d,a)=>{const g=(0,e.createSessionAllocate)(d);return(0,e.createSessionFinalize)(g,a)},e.releaseSession=d=>{const a=(0,_.getInstance)(),g=$.get(d);if(!g)throw new Error("invalid session id");const j=g[0],rt=g[1],ot=g[2];rt.forEach(a._OrtFree),ot.forEach(a._OrtFree),a._OrtReleaseSession(j),$.delete(d)};const nt=d=>{switch(d){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${d}`)}},tt=d=>{switch(d){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${d}`)}},et=d=>{switch(d){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${d}`)}};e.run=(d,a,g,j,rt)=>{const ot=(0,_.getInstance)(),it=$.get(d);if(!it)throw new Error("invalid session id");const at=it[0],lt=it[1],ct=it[2],dt=a.length,mt=j.length;let ht=0,ft=[];const ut=[],_t=[];try{[ht,ft]=(0,s.setRunOptions)(rt);for(let Pt=0;Pt<dt;Pt++){const It=g[Pt][0],Dt=g[Pt][1],Ct=g[Pt][2];let Gt,Wt;if(Array.isArray(Ct)){Wt=4*Ct.length,Gt=ot._malloc(Wt),_t.push(Gt);let un=Gt/4;for(let en=0;en<Ct.length;en++){if(typeof Ct[en]!="string")throw new TypeError(`tensor data at index ${en} is not a string`);ot.HEAPU32[un++]=(0,h.allocWasmString)(Ct[en],_t)}}else Wt=Ct.byteLength,Gt=ot._malloc(Wt),_t.push(Gt),ot.HEAPU8.set(new Uint8Array(Ct.buffer,Ct.byteOffset,Wt),Gt);const Qt=ot.stackSave(),nn=ot.stackAlloc(4*Dt.length);try{let un=nn/4;Dt.forEach(cn=>ot.HEAP32[un++]=cn);const en=ot._OrtCreateTensor(nt(It),Gt,Wt,nn,Dt.length);if(en===0)throw new Error("Can't create a tensor");ut.push(en)}finally{ot.stackRestore(Qt)}}const bt=ot.stackSave(),vt=ot.stackAlloc(4*dt),Tt=ot.stackAlloc(4*dt),Mt=ot.stackAlloc(4*mt),xt=ot.stackAlloc(4*mt);try{let Pt=vt/4,It=Tt/4,Dt=Mt/4,Ct=xt/4;for(let Qt=0;Qt<dt;Qt++)ot.HEAPU32[Pt++]=ut[Qt],ot.HEAPU32[It++]=lt[a[Qt]];for(let Qt=0;Qt<mt;Qt++)ot.HEAPU32[Dt++]=0,ot.HEAPU32[Ct++]=ct[j[Qt]];let Gt=ot._OrtRun(at,Tt,vt,dt,xt,mt,Mt,ht);const Wt=[];if(Gt===0)for(let Qt=0;Qt<mt;Qt++){const nn=ot.HEAPU32[Mt/4+Qt],un=ot.stackSave(),en=ot.stackAlloc(16);let cn,an=0;try{if(Gt=ot._OrtGetTensorData(nn,en,en+4,en+8,en+12),Gt!==0)throw new Error(`Can't access output tensor data. error code = ${Gt}`);let kn=en/4;const jn=ot.HEAPU32[kn++];an=ot.HEAPU32[kn++];const bn=ot.HEAPU32[kn++],xn=ot.HEAPU32[kn++],On=[];for(let vn=0;vn<xn;vn++)On.push(ot.HEAPU32[bn/4+vn]);ot._OrtFree(bn);const An=On.length===0?1:On.reduce((vn,Bn)=>vn*Bn);if(cn=tt(jn),cn==="string"){const vn=[];let Bn=an/4;for(let zn=0;zn<An;zn++){const qn=ot.HEAPU32[Bn++],rr=zn===An-1?void 0:ot.HEAPU32[Bn]-qn;vn.push(ot.UTF8ToString(qn,rr))}Wt.push([cn,On,vn])}else{const vn=new(et(cn))(An);new Uint8Array(vn.buffer,vn.byteOffset,vn.byteLength).set(ot.HEAPU8.subarray(an,an+vn.byteLength)),Wt.push([cn,On,vn])}}finally{ot.stackRestore(un),cn==="string"&&an&&ot._free(an),ot._OrtReleaseTensor(nn)}}if(Gt===0)return Wt;throw new Error(`failed to call OrtRun(). error code = ${Gt}.`)}finally{ot.stackRestore(bt)}}finally{ut.forEach(ot._OrtReleaseTensor),_t.forEach(ot._free),ot._OrtReleaseRunOptions(ht),ft.forEach(ot._free)}},e.endProfiling=d=>{const a=(0,_.getInstance)(),g=$.get(d);if(!g)throw new Error("invalid session id");const j=g[0],rt=a._OrtEndProfiling(j);if(rt===0)throw new Error("Can't get an profile file name");a._OrtFree(rt)},e.extractTransferableBuffers=d=>{const a=[];for(const g of d){const j=g[2];!Array.isArray(j)&&j.buffer&&a.push(j.buffer)}return a}},6361:function(i,e,o){var s=this&&this.__createBinding||(Object.create?function(rt,ot,it,at){at===void 0&&(at=it);var lt=Object.getOwnPropertyDescriptor(ot,it);lt&&!("get"in lt?!ot.__esModule:lt.writable||lt.configurable)||(lt={enumerable:!0,get:function(){return ot[it]}}),Object.defineProperty(rt,at,lt)}:function(rt,ot,it,at){at===void 0&&(at=it),rt[at]=ot[it]}),c=this&&this.__setModuleDefault||(Object.create?function(rt,ot){Object.defineProperty(rt,"default",{enumerable:!0,value:ot})}:function(rt,ot){rt.default=ot}),h=this&&this.__importStar||function(rt){if(rt&&rt.__esModule)return rt;var ot={};if(rt!=null)for(var it in rt)it!=="default"&&Object.prototype.hasOwnProperty.call(rt,it)&&s(ot,rt,it);return c(ot,rt),ot},_=this&&this.__importDefault||function(rt){return rt&&rt.__esModule?rt:{default:rt}};Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.getInstance=e.initializeWebAssembly=void 0;const $=h(o(6449)),nt=_(o(932)),tt=o(3474);let et,d=!1,a=!1,g=!1;const j=(rt,ot)=>ot?rt?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":rt?"ort-wasm-simd.wasm":"ort-wasm.wasm";e.initializeWebAssembly=async rt=>{if(d)return Promise.resolve();if(a)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(g)throw new Error("previous call to 'initializeWebAssembly()' failed.");a=!0;const ot=rt.initTimeout,it=rt.numThreads,at=rt.simd,lt=it>1&&(()=>{try{return typeof SharedArrayBuffer<"u"&&(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}})(),ct=at&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}})(),dt=typeof rt.wasmPaths=="string"?rt.wasmPaths:void 0,mt=j(!1,lt),ht=j(ct,lt),ft=typeof rt.wasmPaths=="object"?rt.wasmPaths[ht]:void 0;let ut=!1;const _t=[];if(ot>0&&_t.push(new Promise(bt=>{setTimeout(()=>{ut=!0,bt()},ot)})),_t.push(new Promise((bt,vt)=>{const Tt=lt?tt:nt.default,Mt={locateFile:(xt,Pt)=>lt&&xt.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([o(4154)],{type:"text/javascript"})):xt===mt?ft??(dt??Pt)+ht:Pt+xt};if(lt)if(typeof Blob>"u")Mt.mainScriptUrlOrBlob=$.join("/","ort-wasm-threaded.js");else{const xt=`var ortWasmThreaded=(function(){var _scriptDir;return ${Tt.toString()}})();`;Mt.mainScriptUrlOrBlob=new Blob([xt],{type:"text/javascript"})}Tt(Mt).then(xt=>{a=!1,d=!0,et=xt,bt()},xt=>{a=!1,g=!0,vt(xt)})})),await Promise.race(_t),ut)throw new Error(`WebAssembly backend initializing failed due to timeout: ${ot}ms`)},e.getInstance=()=>{if(d&&et)return et;throw new Error("WebAssembly is not initialized yet.")},e.dispose=()=>{var rt;!d||a||g||(a=!0,(rt=et.PThread)===null||rt===void 0||rt.terminateAllThreads(),et=void 0,a=!1,d=!1,g=!0)}},9710:(i,e,o)=>{o.d(e,{Z:()=>h});var s=o(477),c=o.n(s);function h(){return c()('/*!\n* ONNX Runtime Web v1.14.0\n* Copyright (c) Microsoft Corporation. All rights reserved.\n* Licensed under the MIT License.\n*/\n(()=>{var t={474:(t,e,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(t){function e(){return j.buffer!=D&&N(j.buffer),P}function r(){return j.buffer!=D&&N(j.buffer),U}function a(){return j.buffer!=D&&N(j.buffer),F}function i(){return j.buffer!=D&&N(j.buffer),I}function o(){return j.buffer!=D&&N(j.buffer),W}var u,c,s;t=t||{},u||(u=void 0!==t?t:{}),u.ready=new Promise((function(t,e){c=t,s=e}));var l,f,p,h,d,y,b=Object.assign({},u),m="./this.program",g=(t,e)=>{throw e},v="object"==typeof window,w="function"==typeof importScripts,_="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,O=u.ENVIRONMENT_IS_PTHREAD||!1,A="";function S(t){return u.locateFile?u.locateFile(t,A):A+t}if(_){let e;A=w?n(908).dirname(A)+"/":"//",y=()=>{d||(h=n(384),d=n(908))},l=function(t,e){return y(),t=d.normalize(t),h.readFileSync(t,e?void 0:"utf8")},p=t=>((t=l(t,!0)).buffer||(t=new Uint8Array(t)),t),f=(t,e,n)=>{y(),t=d.normalize(t),h.readFile(t,(function(t,r){t?n(t):e(r.buffer)}))},1<process.argv.length&&(m=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(t){if(!(t instanceof ct))throw t})),process.on("unhandledRejection",(function(t){throw t})),g=(t,e)=>{if(Q())throw process.exitCode=t,e;e instanceof ct||x("exiting due to exception: "+e),process.exit(t)},u.inspect=function(){return"[Emscripten Module object]"};try{e=n(925)}catch(t){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),t}n.g.Worker=e.Worker}else(v||w)&&(w?A=self.location.href:"undefined"!=typeof document&&document.currentScript&&(A=document.currentScript.src),_scriptDir&&(A=_scriptDir),A=0!==A.indexOf("blob:")?A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1):"",_||(l=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},w&&(p=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),f=(t,e,n)=>{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?e(r.response):n()},r.onerror=n,r.send(null)}));_&&"undefined"==typeof performance&&(n.g.performance=n(953).performance);var T=console.log.bind(console),E=console.warn.bind(console);_&&(y(),T=t=>h.writeSync(1,t+"\\n"),E=t=>h.writeSync(2,t+"\\n"));var M,C=u.print||T,x=u.printErr||E;Object.assign(u,b),b=null,u.thisProgram&&(m=u.thisProgram),u.quit&&(g=u.quit),u.wasmBinary&&(M=u.wasmBinary);var R=u.noExitRuntime||!1;"object"!=typeof WebAssembly&&at("no native wasm support detected");var j,k,D,P,U,F,I,W,H=!1,L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function z(t,e,n){var r=(e>>>=0)+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.buffer&&L)return L.decode(t.buffer instanceof SharedArrayBuffer?t.slice(e,n):t.subarray(e,n));for(r="";e<n;){var a=t[e++];if(128&a){var i=63&t[e++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|i);else{var o=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&t[e++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function Y(t,e){return(t>>>=0)?z(r(),t,e):""}function B(t,e,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var i=0;i<t.length;++i){var o=t.charCodeAt(i);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++i)),127>=o){if(n>=r)break;e[n++>>>0]=o}else{if(2047>=o){if(n+1>=r)break;e[n++>>>0]=192|o>>6}else{if(65535>=o){if(n+2>=r)break;e[n++>>>0]=224|o>>12}else{if(n+3>=r)break;e[n++>>>0]=240|o>>18,e[n++>>>0]=128|o>>12&63}e[n++>>>0]=128|o>>6&63}e[n++>>>0]=128|63&o}}return e[n>>>0]=0,n-a}function G(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);127>=r?e++:2047>=r?e+=2:55296<=r&&57343>=r?(e+=4,++n):e+=3}return e}function N(t){D=t,u.HEAP8=P=new Int8Array(t),u.HEAP16=new Int16Array(t),u.HEAP32=F=new Int32Array(t),u.HEAPU8=U=new Uint8Array(t),u.HEAPU16=new Uint16Array(t),u.HEAPU32=I=new Uint32Array(t),u.HEAPF32=new Float32Array(t),u.HEAPF64=W=new Float64Array(t)}O&&(D=u.buffer);var V=u.INITIAL_MEMORY||16777216;if(O)j=u.wasmMemory,D=u.buffer;else if(u.wasmMemory)j=u.wasmMemory;else if(!((j=new WebAssembly.Memory({initial:V/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw x("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),_&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");j&&(D=j.buffer),V=D.byteLength,N(D);var $,q=[],X=[],J=[],Z=[];function Q(){return R||!1}function K(){var t=u.preRun.shift();q.unshift(t)}var tt,et=0,nt=null,rt=null;function at(t){throw O?postMessage({cmd:"onAbort",arg:t}):u.onAbort&&u.onAbort(t),x(t="Aborted("+t+")"),H=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),s(t),t}function it(){return tt.startsWith("data:application/octet-stream;base64,")}function ot(){var t=tt;try{if(t==tt&&M)return new Uint8Array(M);if(p)return p(t);throw"both async and sync fetching of the wasm failed"}catch(t){at(t)}}tt="ort-wasm-threaded.wasm",it()||(tt=S(tt));var ut={};function ct(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function st(t){(t=ht.Vb[t])||at(),ht.mc(t)}function lt(t){var e=ht.Cc();if(!e)return 6;ht.ac.push(e),ht.Vb[t.Ub]=e,e.Ub=t.Ub;var n={cmd:"run",start_routine:t.Ic,arg:t.zc,pthread_ptr:t.Ub};return e.$b=()=>{n.time=performance.now(),e.postMessage(n,t.Nc)},e.loaded&&(e.$b(),delete e.$b),0}function ft(t){if(O)return $t(1,1,t);Q()||(ht.oc(),u.onExit&&u.onExit(t),H=!0),g(t,new ct(t))}function pt(t,e){if(!e&&O)throw bt(t),"unwind";Q()||O||(me(),dt(J),be(0),re[1].length&&ae(1,10),re[2].length&&ae(2,10),ht.oc()),ft(t)}var ht={Yb:[],ac:[],qc:[],Vb:{},fc:function(){O&&ht.Ec()},Pc:function(){},Ec:function(){ht.receiveObjectTransfer=ht.Gc,ht.threadInitTLS=ht.pc,ht.setExitStatus=ht.nc,R=!1},nc:function(){},oc:function(){for(var t of Object.values(ht.Vb))ht.mc(t);for(t of ht.Yb)t.terminate();ht.Yb=[]},mc:function(t){var e=t.Ub;delete ht.Vb[e],ht.Yb.push(t),ht.ac.splice(ht.ac.indexOf(t),1),t.Ub=0,Oe(e)},Gc:function(){},pc:function(){ht.qc.forEach((t=>t()))},Fc:function(t,e){t.onmessage=n=>{var r=(n=n.data).cmd;if(t.Ub&&(ht.Bc=t.Ub),n.targetThread&&n.targetThread!=he()){var a=ht.Vb[n.Qc];a?a.postMessage(n,n.transferList):x(\'Internal error! Worker sent a message "\'+r+\'" to target pthread \'+n.targetThread+", but that thread no longer exists!")}else"processProxyingQueue"===r?zt(n.queue):"spawnThread"===r?lt(n):"cleanupThread"===r?st(n.thread):"killThread"===r?(n=n.thread,r=ht.Vb[n],delete ht.Vb[n],r.terminate(),Oe(n),ht.ac.splice(ht.ac.indexOf(r),1),r.Ub=0):"cancelThread"===r?ht.Vb[n.thread].postMessage({cmd:"cancel"}):"loaded"===r?(t.loaded=!0,e&&e(t),t.$b&&(t.$b(),delete t.$b)):"print"===r?C("Thread "+n.threadId+": "+n.text):"printErr"===r?x("Thread "+n.threadId+": "+n.text):"alert"===r?alert("Thread "+n.threadId+": "+n.text):"setimmediate"===n.target?t.postMessage(n):"onAbort"===r?u.onAbort&&u.onAbort(n.arg):r&&x("worker sent an unknown command "+r);ht.Bc=void 0},t.onerror=t=>{throw x("worker sent an error! "+t.filename+":"+t.lineno+": "+t.message),t},_&&(t.on("message",(function(e){t.onmessage({data:e})})),t.on("error",(function(e){t.onerror(e)})),t.on("detachedExit",(function(){}))),t.postMessage({cmd:"load",urlOrBlob:u.mainScriptUrlOrBlob||_scriptDir,wasmMemory:j,wasmModule:k})},yc:function(){var t=S("ort-wasm-threaded.worker.js");ht.Yb.push(new Worker(t))},Cc:function(){return 0==ht.Yb.length&&(ht.yc(),ht.Fc(ht.Yb[0])),ht.Yb.pop()}};function dt(t){for(;0<t.length;)t.shift()(u)}function yt(t){var e=Ee();return t=t(),Me(e),t}function bt(t){if(O)return $t(2,0,t);try{pt(t)}catch(t){t instanceof ct||"unwind"==t||g(1,t)}}u.PThread=ht,u.establishStackSpace=function(){var t=he(),e=a()[t+44>>2>>>0];t=a()[t+48>>2>>>0],Te(e,e-t),Me(e)};var mt=[];function gt(t){var e=mt[t];return e||(t>=mt.length&&(mt.length=t+1),mt[t]=e=$.get(t)),e}u.invokeEntryPoint=function(t,e){t=gt(t)(e),Q()?ht.nc(t):Ae(t)};var vt,wt,_t=[],Ot=0,At=0;function St(t){this.Zb=t,this.Sb=t-24,this.xc=function(t){i()[this.Sb+4>>2>>>0]=t},this.bc=function(){return i()[this.Sb+4>>2>>>0]},this.wc=function(t){i()[this.Sb+8>>2>>>0]=t},this.Dc=function(){return i()[this.Sb+8>>2>>>0]},this.rc=function(){a()[this.Sb>>2>>>0]=0},this.hc=function(t){t=t?1:0,e()[this.Sb+12>>0>>>0]=t},this.uc=function(){return 0!=e()[this.Sb+12>>0>>>0]},this.ic=function(t){t=t?1:0,e()[this.Sb+13>>0>>>0]=t},this.kc=function(){return 0!=e()[this.Sb+13>>0>>>0]},this.fc=function(t,e){this.cc(0),this.xc(t),this.wc(e),this.rc(),this.hc(!1),this.ic(!1)},this.sc=function(){Atomics.add(a(),this.Sb>>2,1)},this.Hc=function(){return 1===Atomics.sub(a(),this.Sb>>2,1)},this.cc=function(t){i()[this.Sb+16>>2>>>0]=t},this.tc=function(){return i()[this.Sb+16>>2>>>0]},this.vc=function(){if(Re(this.bc()))return i()[this.Zb>>2>>>0];var t=this.tc();return 0!==t?t:this.Zb}}function Tt(t){return ye(new St(t).Sb)}function Et(t,e,n,r){return O?$t(3,1,t,e,n,r):Mt(t,e,n,r)}function Mt(t,e,n,r){if("undefined"==typeof SharedArrayBuffer)return x("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var a=[];return O&&0===a.length?Et(t,e,n,r):(t={Ic:n,Ub:t,zc:r,Nc:a},O?(t.Oc="spawnThread",postMessage(t,a),0):lt(t))}function Ct(t,e,n){return O?$t(4,1,t,e,n):0}function xt(t,e){if(O)return $t(5,1,t,e)}function Rt(t,e){if(O)return $t(6,1,t,e)}function jt(t,e,n){if(O)return $t(7,1,t,e,n)}function kt(t,e,n){return O?$t(8,1,t,e,n):0}function Dt(t,e){if(O)return $t(9,1,t,e)}function Pt(t,e,n){if(O)return $t(10,1,t,e,n)}function Ut(t,e,n,r){if(O)return $t(11,1,t,e,n,r)}function Ft(t,e,n,r){if(O)return $t(12,1,t,e,n,r)}function It(t,e,n,r){if(O)return $t(13,1,t,e,n,r)}function Wt(t){if(O)return $t(14,1,t)}function Ht(t,e){if(O)return $t(15,1,t,e)}function Lt(t,e,n){if(O)return $t(16,1,t,e,n)}function zt(t){Atomics.store(a(),t>>2,1),he()&&_e(t),Atomics.compareExchange(a(),t>>2,1,0)}function Yt(t){return i()[t>>>2]+4294967296*a()[t+4>>>2]}function Bt(t,e,n,r,a,i){return O?$t(17,1,t,e,n,r,a,i):-52}function Gt(t,e,n,r,a,i){if(O)return $t(18,1,t,e,n,r,a,i)}function Nt(t){var n=G(t)+1,r=de(n);return r&&B(t,e(),r,n),r}function Vt(t,e,n){function r(t){return(t=t.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?t[1]:"GMT"}if(O)return $t(19,1,t,e,n);var o=(new Date).getFullYear(),u=new Date(o,0,1),c=new Date(o,6,1);o=u.getTimezoneOffset();var s=c.getTimezoneOffset(),l=Math.max(o,s);a()[t>>2>>>0]=60*l,a()[e>>2>>>0]=Number(o!=s),t=r(u),e=r(c),t=Nt(t),e=Nt(e),s<o?(i()[n>>2>>>0]=t,i()[n+4>>2>>>0]=e):(i()[n>>2>>>0]=e,i()[n+4>>2>>>0]=t)}function $t(t,e){var n=arguments.length-2,r=arguments;return yt((()=>{for(var a=Ce(8*n),i=a>>3,u=0;u<n;u++){var c=r[2+u];o()[i+u>>>0]=c}return we(t,n,a,e)}))}u.executeNotifiedProxyingQueue=zt,wt=_?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:O?()=>performance.now()-u.__performance_now_clock_drift:()=>performance.now();var qt,Xt=[],Jt={};function Zt(){if(!qt){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:m||"./this.program"};for(t in Jt)void 0===Jt[t]?delete e[t]:e[t]=Jt[t];var n=[];for(t in e)n.push(t+"="+e[t]);qt=n}return qt}function Qt(t,n){if(O)return $t(20,1,t,n);var r=0;return Zt().forEach((function(a,o){var u=n+r;for(o=i()[t+4*o>>2>>>0]=u,u=0;u<a.length;++u)e()[o++>>0>>>0]=a.charCodeAt(u);e()[o>>0>>>0]=0,r+=a.length+1})),0}function Kt(t,e){if(O)return $t(21,1,t,e);var n=Zt();i()[t>>2>>>0]=n.length;var r=0;return n.forEach((function(t){r+=t.length+1})),i()[e>>2>>>0]=r,0}function te(t){return O?$t(22,1,t):52}function ee(t,e,n,r){return O?$t(23,1,t,e,n,r):52}function ne(t,e,n,r,a){return O?$t(24,1,t,e,n,r,a):70}var re=[null,[],[]];function ae(t,e){var n=re[t];0===e||10===e?((1===t?C:x)(z(n,0)),n.length=0):n.push(e)}function ie(t,e,n,a){if(O)return $t(25,1,t,e,n,a);for(var o=0,u=0;u<n;u++){var c=i()[e>>2>>>0],s=i()[e+4>>2>>>0];e+=8;for(var l=0;l<s;l++)ae(t,r()[c+l>>>0]);o+=s}return i()[a>>2>>>0]=o,0}var oe=0;function ue(t){return 0==t%4&&(0!=t%100||0==t%400)}var ce=[31,29,31,30,31,30,31,31,30,31,30,31],se=[31,28,31,30,31,30,31,31,30,31,30,31];function le(t,n,r,i){function o(t,e,n){for(t="number"==typeof t?t.toString():t||"";t.length<e;)t=n[0]+t;return t}function u(t,e){return o(t,e,"0")}function c(t,e){function n(t){return 0>t?-1:0<t?1:0}var r;return 0===(r=n(t.getFullYear()-e.getFullYear()))&&0===(r=n(t.getMonth()-e.getMonth()))&&(r=n(t.getDate()-e.getDate())),r}function s(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function l(t){var e=t.Wb;for(t=new Date(new Date(t.Xb+1900,0,1).getTime());0<e;){var n=t.getMonth(),r=(ue(t.getFullYear())?ce:se)[n];if(!(e>r-t.getDate())){t.setDate(t.getDate()+e);break}e-=r-t.getDate()+1,t.setDate(1),11>n?t.setMonth(n+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1))}return n=new Date(t.getFullYear()+1,0,4),e=s(new Date(t.getFullYear(),0,4)),n=s(n),0>=c(e,t)?0>=c(n,t)?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var f=a()[i+40>>2>>>0];for(var p in i={Lc:a()[i>>2>>>0],Kc:a()[i+4>>2>>>0],dc:a()[i+8>>2>>>0],jc:a()[i+12>>2>>>0],ec:a()[i+16>>2>>>0],Xb:a()[i+20>>2>>>0],Tb:a()[i+24>>2>>>0],Wb:a()[i+28>>2>>>0],Rc:a()[i+32>>2>>>0],Jc:a()[i+36>>2>>>0],Mc:f?Y(f):""},r=Y(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(p,"g"),f[p]);var h="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d="January February March April May June July August September October November December".split(" ");for(p in f={"%a":function(t){return h[t.Tb].substring(0,3)},"%A":function(t){return h[t.Tb]},"%b":function(t){return d[t.ec].substring(0,3)},"%B":function(t){return d[t.ec]},"%C":function(t){return u((t.Xb+1900)/100|0,2)},"%d":function(t){return u(t.jc,2)},"%e":function(t){return o(t.jc,2," ")},"%g":function(t){return l(t).toString().substring(2)},"%G":function(t){return l(t)},"%H":function(t){return u(t.dc,2)},"%I":function(t){return 0==(t=t.dc)?t=12:12<t&&(t-=12),u(t,2)},"%j":function(t){for(var e=0,n=0;n<=t.ec-1;e+=(ue(t.Xb+1900)?ce:se)[n++]);return u(t.jc+e,3)},"%m":function(t){return u(t.ec+1,2)},"%M":function(t){return u(t.Kc,2)},"%n":function(){return"\\n"},"%p":function(t){return 0<=t.dc&&12>t.dc?"AM":"PM"},"%S":function(t){return u(t.Lc,2)},"%t":function(){return"\\t"},"%u":function(t){return t.Tb||7},"%U":function(t){return u(Math.floor((t.Wb+7-t.Tb)/7),2)},"%V":function(t){var e=Math.floor((t.Wb+7-(t.Tb+6)%7)/7);if(2>=(t.Tb+371-t.Wb-2)%7&&e++,e)53==e&&(4==(n=(t.Tb+371-t.Wb)%7)||3==n&&ue(t.Xb)||(e=1));else{e=52;var n=(t.Tb+7-t.Wb-1)%7;(4==n||5==n&&ue(t.Xb%400-1))&&e++}return u(e,2)},"%w":function(t){return t.Tb},"%W":function(t){return u(Math.floor((t.Wb+7-(t.Tb+6)%7)/7),2)},"%y":function(t){return(t.Xb+1900).toString().substring(2)},"%Y":function(t){return t.Xb+1900},"%z":function(t){var e=0<=(t=t.Jc);return t=Math.abs(t)/60,(e?"+":"-")+String("0000"+(t/60*100+t%60)).slice(-4)},"%Z":function(t){return t.Mc},"%%":function(){return"%"}},r=r.replace(/%%/g,"\\0\\0"),f)r.includes(p)&&(r=r.replace(new RegExp(p,"g"),f[p](i)));return p=function(t){var e=Array(G(t)+1);return B(t,e,0,e.length),e}(r=r.replace(/\\0\\0/g,"%")),p.length>n?0:(function(t,n){e().set(t,n>>>0)}(p,t),p.length-1)}ht.fc();var fe=[null,ft,bt,Et,Ct,xt,Rt,jt,kt,Dt,Pt,Ut,Ft,It,Wt,Ht,Lt,Bt,Gt,Vt,Qt,Kt,te,ee,ne,ie],pe={b:function(t){return de(t+24)+24},n:function(t){return(t=new St(t)).uc()||(t.hc(!0),Ot--),t.ic(!1),_t.push(t),t.sc(),t.vc()},ma:function(t){throw x("Unexpected exception thrown, this is not properly supported - aborting"),H=!0,t},x:function(){Se(0);var t=_t.pop();if(t.Hc()&&!t.kc()){var e=t.Dc();e&&gt(e)(t.Zb),Tt(t.Zb)}At=0},e:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},l:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},h:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},t:Tt,M:function(){var t=_t.pop();t||at("no exception to throw");var e=t.Zb;throw t.kc()||(_t.push(t),t.ic(!0),t.hc(!1),Ot++),At=e,e},c:function(t,e,n){throw new St(t).fc(e,n),At=t,Ot++,t},pa:function(){return Ot},Fa:function(t){ge(t,!w,1,!v),ht.pc()},T:function(t){O?postMessage({cmd:"cleanupThread",thread:t}):st(t)},xa:Mt,j:function(t){throw At||(At=t),t},H:Ct,Ma:xt,ua:Rt,wa:jt,oa:kt,Ka:Dt,Ca:Pt,Ja:Ut,V:Ft,va:It,sa:Wt,La:Ht,ta:Lt,Ta:function(){},X:function(){at("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ua:function(){at("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},W:function(){return Date.now()},ya:function(){return 2097152},Oa:function(){return!0},za:function(t,e,n,r){if(t==e)setTimeout((()=>zt(r)));else if(O)postMessage({targetThread:t,cmd:"processProxyingQueue",queue:r});else{if(!(t=ht.Vb[t]))return;t.postMessage({cmd:"processProxyingQueue",queue:r})}return 1},Ea:function(){return-1},Pa:function(t,e){t=new Date(1e3*Yt(t)),a()[e>>2>>>0]=t.getUTCSeconds(),a()[e+4>>2>>>0]=t.getUTCMinutes(),a()[e+8>>2>>>0]=t.getUTCHours(),a()[e+12>>2>>>0]=t.getUTCDate(),a()[e+16>>2>>>0]=t.getUTCMonth(),a()[e+20>>2>>>0]=t.getUTCFullYear()-1900,a()[e+24>>2>>>0]=t.getUTCDay(),t=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[e+28>>2>>>0]=t},Qa:function(t,e){t=new Date(1e3*Yt(t)),a()[e>>2>>>0]=t.getSeconds(),a()[e+4>>2>>>0]=t.getMinutes(),a()[e+8>>2>>>0]=t.getHours(),a()[e+12>>2>>>0]=t.getDate(),a()[e+16>>2>>>0]=t.getMonth(),a()[e+20>>2>>>0]=t.getFullYear()-1900,a()[e+24>>2>>>0]=t.getDay();var n=new Date(t.getFullYear(),0,1),r=(t.getTime()-n.getTime())/864e5|0;a()[e+28>>2>>>0]=r,a()[e+36>>2>>>0]=-60*t.getTimezoneOffset(),r=new Date(t.getFullYear(),6,1).getTimezoneOffset(),t=0|(r!=(n=n.getTimezoneOffset())&&t.getTimezoneOffset()==Math.min(n,r)),a()[e+32>>2>>>0]=t},Ra:function(t){var e=new Date(a()[t+20>>2>>>0]+1900,a()[t+16>>2>>>0],a()[t+12>>2>>>0],a()[t+8>>2>>>0],a()[t+4>>2>>>0],a()[t>>2>>>0],0),n=a()[t+32>>2>>>0],r=e.getTimezoneOffset(),i=new Date(e.getFullYear(),0,1),o=new Date(e.getFullYear(),6,1).getTimezoneOffset(),u=i.getTimezoneOffset(),c=Math.min(u,o);return 0>n?a()[t+32>>2>>>0]=Number(o!=u&&c==r):0<n!=(c==r)&&(o=Math.max(u,o),e.setTime(e.getTime()+6e4*((0<n?c:o)-r))),a()[t+24>>2>>>0]=e.getDay(),n=(e.getTime()-i.getTime())/864e5|0,a()[t+28>>2>>>0]=n,a()[t>>2>>>0]=e.getSeconds(),a()[t+4>>2>>>0]=e.getMinutes(),a()[t+8>>2>>>0]=e.getHours(),a()[t+12>>2>>>0]=e.getDate(),a()[t+16>>2>>>0]=e.getMonth(),e.getTime()/1e3|0},Aa:Bt,Ba:Gt,Sa:function t(e,n,r){t.Ac||(t.Ac=!0,Vt(e,n,r))},y:function(){at("")},U:function(){if(!_&&!w){var t="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";vt||(vt={}),vt[t]||(vt[t]=1,_&&(t="warning: "+t),x(t))}},ra:function(){return 4294901760},B:wt,Ia:function(t,e,n){r().copyWithin(t>>>0,e>>>0,e+n>>>0)},F:function(){return _?n(993).cpus().length:navigator.hardwareConcurrency},Da:function(t,e,n){Xt.length=e,n>>=3;for(var r=0;r<e;r++)Xt[r]=o()[n+r>>>0];return(0>t?ut[-t-1]:fe[t]).apply(null,Xt)},qa:function(t){var e=r().length;if((t>>>=0)<=e||4294901760<t)return!1;for(var n=1;4>=n;n*=2){var a=e*(1+.2/n);a=Math.min(a,t+100663296);var i=Math;a=Math.max(t,a),i=i.min.call(i,4294901760,a+(65536-a%65536)%65536);t:{try{j.grow(i-D.byteLength+65535>>>16),N(j.buffer);var o=1;break t}catch(t){}o=void 0}if(o)return!0}return!1},Na:function(){throw"unwind"},Ga:Qt,Ha:Kt,J:pt,I:te,S:ee,ga:ne,R:ie,d:function(){return oe},na:function t(r,a){t.lc||(t.lc=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>(crypto.getRandomValues(t),t[0])}if(_)try{var e=n(Object(function(){var t=new Error("Cannot find module \'crypto\'");throw t.code="MODULE_NOT_FOUND",t}()));return()=>e.randomBytes(1)[0]}catch(t){}return()=>at("randomDevice")}());for(var i=0;i<a;i++)e()[r+i>>0>>>0]=t.lc();return 0},ia:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},ja:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},K:function(t){var e=Ee();try{return gt(t)()}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},f:function(t,e){var n=Ee();try{return gt(t)(e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},P:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},Q:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},k:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},p:function(t,e,n,r){var a=Ee();try{return gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},q:function(t,e,n,r,a){var i=Ee();try{return gt(t)(e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},N:function(t,e,n,r,a,i){var o=Ee();try{return gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},s:function(t,e,n,r,a,i){var o=Ee();try{return gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},w:function(t,e,n,r,a,i,o){var u=Ee();try{return gt(t)(e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},L:function(t,e,n,r,a,i,o,u){var c=Ee();try{return gt(t)(e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},E:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=Ee();try{return gt(t)(e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(Me(p),t!==t+0)throw t;Se(1,0)}},aa:function(t,e,n,r,a,i,o,u){var c=Ee();try{return He(t,e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},_:function(t,e,n,r,a,i,o){var u=Ee();try{return ke(t,e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},Z:function(t,e,n,r,a){var i=Ee();try{return Le(t,e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},ca:function(t,e,n,r){var a=Ee();try{return Ie(t,e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},$:function(t){var e=Ee();try{return je(t)}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},ba:function(t,e){var n=Ee();try{return We(t,e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},Y:function(t,e,n){var r=Ee();try{return De(t,e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},g:function(t){var e=Ee();try{gt(t)()}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},r:function(t,e){var n=Ee();try{gt(t)(e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},i:function(t,e,n){var r=Ee();try{gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},ha:function(t,e,n,r){var a=Ee();try{gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},m:function(t,e,n,r){var a=Ee();try{gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},v:function(t,e,n,r,a){var i=Ee();try{gt(t)(e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},u:function(t,e,n,r,a,i){var o=Ee();try{gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},O:function(t,e,n,r,a,i,o){var u=Ee();try{gt(t)(e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},A:function(t,e,n,r,a,i,o,u){var c=Ee();try{gt(t)(e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},ka:function(t,e,n,r,a,i,o,u,c){var s=Ee();try{gt(t)(e,n,r,a,i,o,u,c)}catch(t){if(Me(s),t!==t+0)throw t;Se(1,0)}},C:function(t,e,n,r,a,i,o,u,c,s,l){var f=Ee();try{gt(t)(e,n,r,a,i,o,u,c,s,l)}catch(t){if(Me(f),t!==t+0)throw t;Se(1,0)}},D:function(t,e,n,r,a,i,o,u,c,s,l,f,p,h,d,y){var b=Ee();try{gt(t)(e,n,r,a,i,o,u,c,s,l,f,p,h,d,y)}catch(t){if(Me(b),t!==t+0)throw t;Se(1,0)}},fa:function(t,e,n,r,a,i,o,u){var c=Ee();try{Pe(t,e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},da:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=Ee();try{Fe(t,e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(Me(p),t!==t+0)throw t;Se(1,0)}},ea:function(t,e,n,r,a,i){var o=Ee();try{Ue(t,e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},o:function(t){return t},a:j||u.wasmMemory,G:function(t){oe=t},la:le,z:function(t,e,n,r){return le(t,e,n,r)}};!function(){function t(t,e){u.asm=t.exports,ht.qc.push(u.asm.sb),$=u.asm.ub,X.unshift(u.asm.Va),k=e,O||(et--,u.monitorRunDependencies&&u.monitorRunDependencies(et),0==et&&(null!==nt&&(clearInterval(nt),nt=null),rt&&(t=rt,rt=null,t())))}function e(e){t(e.instance,e.module)}function n(t){return function(){if(!M&&(v||w)){if("function"==typeof fetch&&!tt.startsWith("file://"))return fetch(tt,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at \'"+tt+"\'";return t.arrayBuffer()})).catch((function(){return ot()}));if(f)return new Promise((function(t,e){f(tt,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return ot()}))}().then((function(t){return WebAssembly.instantiate(t,r)})).then((function(t){return t})).then(t,(function(t){x("failed to asynchronously prepare wasm: "+t),at(t)}))}var r={a:pe};if(O||(et++,u.monitorRunDependencies&&u.monitorRunDependencies(et)),u.instantiateWasm)try{return u.instantiateWasm(r,t)}catch(t){return x("Module.instantiateWasm callback failed with error: "+t),!1}(M||"function"!=typeof WebAssembly.instantiateStreaming||it()||tt.startsWith("file://")||_||"function"!=typeof fetch?n(e):fetch(tt,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,r).then(e,(function(t){return x("wasm streaming compile failed: "+t),x("falling back to ArrayBuffer instantiation"),n(e)}))}))).catch(s)}(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.Va).apply(null,arguments)},u._OrtInit=function(){return(u._OrtInit=u.asm.Wa).apply(null,arguments)},u._OrtCreateSessionOptions=function(){return(u._OrtCreateSessionOptions=u.asm.Xa).apply(null,arguments)},u._OrtAppendExecutionProvider=function(){return(u._OrtAppendExecutionProvider=u.asm.Ya).apply(null,arguments)},u._OrtAddSessionConfigEntry=function(){return(u._OrtAddSessionConfigEntry=u.asm.Za).apply(null,arguments)},u._OrtReleaseSessionOptions=function(){return(u._OrtReleaseSessionOptions=u.asm._a).apply(null,arguments)},u._OrtCreateSession=function(){return(u._OrtCreateSession=u.asm.$a).apply(null,arguments)},u._OrtReleaseSession=function(){return(u._OrtReleaseSession=u.asm.ab).apply(null,arguments)},u._OrtGetInputCount=function(){return(u._OrtGetInputCount=u.asm.bb).apply(null,arguments)},u._OrtGetOutputCount=function(){return(u._OrtGetOutputCount=u.asm.cb).apply(null,arguments)},u._OrtGetInputName=function(){return(u._OrtGetInputName=u.asm.db).apply(null,arguments)},u._OrtGetOutputName=function(){return(u._OrtGetOutputName=u.asm.eb).apply(null,arguments)},u._OrtFree=function(){return(u._OrtFree=u.asm.fb).apply(null,arguments)},u._OrtCreateTensor=function(){return(u._OrtCreateTensor=u.asm.gb).apply(null,arguments)},u._OrtGetTensorData=function(){return(u._OrtGetTensorData=u.asm.hb).apply(null,arguments)},u._OrtReleaseTensor=function(){return(u._OrtReleaseTensor=u.asm.ib).apply(null,arguments)},u._OrtCreateRunOptions=function(){return(u._OrtCreateRunOptions=u.asm.jb).apply(null,arguments)},u._OrtAddRunConfigEntry=function(){return(u._OrtAddRunConfigEntry=u.asm.kb).apply(null,arguments)},u._OrtReleaseRunOptions=function(){return(u._OrtReleaseRunOptions=u.asm.lb).apply(null,arguments)},u._OrtRun=function(){return(u._OrtRun=u.asm.mb).apply(null,arguments)},u._OrtEndProfiling=function(){return(u._OrtEndProfiling=u.asm.nb).apply(null,arguments)};var he=u._pthread_self=function(){return(he=u._pthread_self=u.asm.ob).apply(null,arguments)},de=u._malloc=function(){return(de=u._malloc=u.asm.pb).apply(null,arguments)},ye=u._free=function(){return(ye=u._free=u.asm.qb).apply(null,arguments)},be=u._fflush=function(){return(be=u._fflush=u.asm.rb).apply(null,arguments)};u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm.sb).apply(null,arguments)};var me=u.___funcs_on_exit=function(){return(me=u.___funcs_on_exit=u.asm.tb).apply(null,arguments)},ge=u.__emscripten_thread_init=function(){return(ge=u.__emscripten_thread_init=u.asm.vb).apply(null,arguments)};u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm.wb).apply(null,arguments)};var ve,we=u._emscripten_run_in_main_runtime_thread_js=function(){return(we=u._emscripten_run_in_main_runtime_thread_js=u.asm.xb).apply(null,arguments)},_e=u.__emscripten_proxy_execute_task_queue=function(){return(_e=u.__emscripten_proxy_execute_task_queue=u.asm.yb).apply(null,arguments)},Oe=u.__emscripten_thread_free_data=function(){return(Oe=u.__emscripten_thread_free_data=u.asm.zb).apply(null,arguments)},Ae=u.__emscripten_thread_exit=function(){return(Ae=u.__emscripten_thread_exit=u.asm.Ab).apply(null,arguments)},Se=u._setThrew=function(){return(Se=u._setThrew=u.asm.Bb).apply(null,arguments)},Te=u._emscripten_stack_set_limits=function(){return(Te=u._emscripten_stack_set_limits=u.asm.Cb).apply(null,arguments)},Ee=u.stackSave=function(){return(Ee=u.stackSave=u.asm.Db).apply(null,arguments)},Me=u.stackRestore=function(){return(Me=u.stackRestore=u.asm.Eb).apply(null,arguments)},Ce=u.stackAlloc=function(){return(Ce=u.stackAlloc=u.asm.Fb).apply(null,arguments)},xe=u.___cxa_can_catch=function(){return(xe=u.___cxa_can_catch=u.asm.Gb).apply(null,arguments)},Re=u.___cxa_is_pointer_type=function(){return(Re=u.___cxa_is_pointer_type=u.asm.Hb).apply(null,arguments)},je=u.dynCall_j=function(){return(je=u.dynCall_j=u.asm.Ib).apply(null,arguments)},ke=u.dynCall_iiiiij=function(){return(ke=u.dynCall_iiiiij=u.asm.Jb).apply(null,arguments)},De=u.dynCall_jii=function(){return(De=u.dynCall_jii=u.asm.Kb).apply(null,arguments)},Pe=u.dynCall_viiiiij=function(){return(Pe=u.dynCall_viiiiij=u.asm.Lb).apply(null,arguments)},Ue=u.dynCall_vjji=function(){return(Ue=u.dynCall_vjji=u.asm.Mb).apply(null,arguments)},Fe=u.dynCall_viiijjjii=function(){return(Fe=u.dynCall_viiijjjii=u.asm.Nb).apply(null,arguments)},Ie=u.dynCall_iij=function(){return(Ie=u.dynCall_iij=u.asm.Ob).apply(null,arguments)},We=u.dynCall_ji=function(){return(We=u.dynCall_ji=u.asm.Pb).apply(null,arguments)},He=u.dynCall_iiiiiij=function(){return(He=u.dynCall_iiiiiij=u.asm.Qb).apply(null,arguments)},Le=u.dynCall_iiij=function(){return(Le=u.dynCall_iiij=u.asm.Rb).apply(null,arguments)};function ze(){function t(){if(!ve&&(ve=!0,u.calledRun=!0,!H)&&(O||dt(X),c(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),!O)){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;){var t=u.postRun.shift();Z.unshift(t)}dt(Z)}}if(!(0<et))if(O)c(u),O||dt(X),postMessage({cmd:"loaded"});else{if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)K();dt(q),0<et||(u.setStatus?(u.setStatus("Running..."),setTimeout((function(){setTimeout((function(){u.setStatus("")}),1),t()}),1)):t())}}if(u.UTF8ToString=Y,u.stringToUTF8=function(t,e,n){return B(t,r(),e,n)},u.lengthBytesUTF8=G,u.keepRuntimeAlive=Q,u.wasmMemory=j,u.stackSave=Ee,u.stackRestore=Me,u.stackAlloc=Ce,u.ExitStatus=ct,u.PThread=ht,rt=function t(){ve||ze(),ve||(rt=t)},u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);0<u.preInit.length;)u.preInit.pop()();return ze(),t.ready});t.exports=r},932:(t,e,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(t){var e,r,a;t=t||{},e||(e=void 0!==t?t:{}),e.ready=new Promise((function(t,e){r=t,a=e}));var i,o,u,c,s,l,f=Object.assign({},e),p="./this.program",h=(t,e)=>{throw e},d="object"==typeof window,y="function"==typeof importScripts,b="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,m="";b?(m=y?n(908).dirname(m)+"/":"//",l=()=>{s||(c=n(384),s=n(908))},i=function(t,e){return l(),t=s.normalize(t),c.readFileSync(t,e?void 0:"utf8")},u=t=>((t=i(t,!0)).buffer||(t=new Uint8Array(t)),t),o=(t,e,n)=>{l(),t=s.normalize(t),c.readFile(t,(function(t,r){t?n(t):e(r.buffer)}))},1<process.argv.length&&(p=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(t){if(!(t instanceof J))throw t})),process.on("unhandledRejection",(function(t){throw t})),h=(t,e)=>{if(_||0<L)throw process.exitCode=t,e;e instanceof J||w("exiting due to exception: "+e),process.exit(t)},e.inspect=function(){return"[Emscripten Module object]"}):(d||y)&&(y?m=self.location.href:"undefined"!=typeof document&&document.currentScript&&(m=document.currentScript.src),_scriptDir&&(m=_scriptDir),m=0!==m.indexOf("blob:")?m.substr(0,m.replace(/[?#].*/,"").lastIndexOf("/")+1):"",i=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},y&&(u=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),o=(t,e,n)=>{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?e(r.response):n()},r.onerror=n,r.send(null)});var g,v=e.print||console.log.bind(console),w=e.printErr||console.warn.bind(console);Object.assign(e,f),f=null,e.thisProgram&&(p=e.thisProgram),e.quit&&(h=e.quit),e.wasmBinary&&(g=e.wasmBinary);var _=e.noExitRuntime||!1;"object"!=typeof WebAssembly&&V("no native wasm support detected");var O,A,S,T,E,M,C=!1,x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function R(t,e,n){var r=(e>>>=0)+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.buffer&&x)return x.decode(t.subarray(e,n));for(r="";e<n;){var a=t[e++];if(128&a){var i=63&t[e++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|i);else{var o=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&t[e++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function j(t,e){return(t>>>=0)?R(T,t,e):""}function k(t,e,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var i=0;i<t.length;++i){var o=t.charCodeAt(i);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++i)),127>=o){if(n>=r)break;e[n++>>>0]=o}else{if(2047>=o){if(n+1>=r)break;e[n++>>>0]=192|o>>6}else{if(65535>=o){if(n+2>=r)break;e[n++>>>0]=224|o>>12}else{if(n+3>=r)break;e[n++>>>0]=240|o>>18,e[n++>>>0]=128|o>>12&63}e[n++>>>0]=128|o>>6&63}e[n++>>>0]=128|63&o}}return e[n>>>0]=0,n-a}function D(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);127>=r?e++:2047>=r?e+=2:55296<=r&&57343>=r?(e+=4,++n):e+=3}return e}function P(){var t=O.buffer;A=t,e.HEAP8=S=new Int8Array(t),e.HEAP16=new Int16Array(t),e.HEAP32=E=new Int32Array(t),e.HEAPU8=T=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=M=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}var U,F=[],I=[],W=[],H=[],L=0;function z(){var t=e.preRun.shift();F.unshift(t)}var Y,B=0,G=null,N=null;function V(t){throw e.onAbort&&e.onAbort(t),w(t="Aborted("+t+")"),C=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),a(t),t}function $(){return Y.startsWith("data:application/octet-stream;base64,")}if(Y="ort-wasm.wasm",!$()){var q=Y;Y=e.locateFile?e.locateFile(q,m):m+q}function X(){var t=Y;try{if(t==Y&&g)return new Uint8Array(g);if(u)return u(t);throw"both async and sync fetching of the wasm failed"}catch(t){V(t)}}function J(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function Z(t){for(;0<t.length;)t.shift()(e)}var Q=[],K=0,tt=0;function et(t){this.Db=t,this.zb=t-24,this.Ub=function(t){M[this.zb+4>>2>>>0]=t},this.Eb=function(){return M[this.zb+4>>2>>>0]},this.Sb=function(t){M[this.zb+8>>2>>>0]=t},this.Wb=function(){return M[this.zb+8>>2>>>0]},this.Tb=function(){E[this.zb>>2>>>0]=0},this.Ib=function(t){S[this.zb+12>>0>>>0]=t?1:0},this.Pb=function(){return 0!=S[this.zb+12>>0>>>0]},this.Jb=function(t){S[this.zb+13>>0>>>0]=t?1:0},this.Lb=function(){return 0!=S[this.zb+13>>0>>>0]},this.Rb=function(t,e){this.Fb(0),this.Ub(t),this.Sb(e),this.Tb(),this.Ib(!1),this.Jb(!1)},this.Nb=function(){E[this.zb>>2>>>0]+=1},this.Xb=function(){var t=E[this.zb>>2>>>0];return E[this.zb>>2>>>0]=t-1,1===t},this.Fb=function(t){M[this.zb+16>>2>>>0]=t},this.Ob=function(){return M[this.zb+16>>2>>>0]},this.Qb=function(){if(Mt(this.Eb()))return M[this.Db>>2>>>0];var t=this.Ob();return 0!==t?t:this.Db}}function nt(t){return vt(new et(t).zb)}var rt=[];function at(t){var e=rt[t];return e||(t>=rt.length&&(rt.length=t+1),rt[t]=e=U.get(t)),e}function it(t){var e=D(t)+1,n=gt(e);return n&&k(t,S,n,e),n}var ot={};function ut(){if(!ct){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(t in ot)void 0===ot[t]?delete e[t]:e[t]=ot[t];var n=[];for(t in e)n.push(t+"="+e[t]);ct=n}return ct}var ct,st=[null,[],[]];function lt(t,e){var n=st[t];0===e||10===e?((1===t?v:w)(R(n,0)),n.length=0):n.push(e)}var ft=0;function pt(t){return 0==t%4&&(0!=t%100||0==t%400)}var ht=[31,29,31,30,31,30,31,31,30,31,30,31],dt=[31,28,31,30,31,30,31,31,30,31,30,31];function yt(t,e,n,r){function a(t,e,n){for(t="number"==typeof t?t.toString():t||"";t.length<e;)t=n[0]+t;return t}function i(t,e){return a(t,e,"0")}function o(t,e){function n(t){return 0>t?-1:0<t?1:0}var r;return 0===(r=n(t.getFullYear()-e.getFullYear()))&&0===(r=n(t.getMonth()-e.getMonth()))&&(r=n(t.getDate()-e.getDate())),r}function u(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function c(t){var e=t.Bb;for(t=new Date(new Date(t.Cb+1900,0,1).getTime());0<e;){var n=t.getMonth(),r=(pt(t.getFullYear())?ht:dt)[n];if(!(e>r-t.getDate())){t.setDate(t.getDate()+e);break}e-=r-t.getDate()+1,t.setDate(1),11>n?t.setMonth(n+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1))}return n=new Date(t.getFullYear()+1,0,4),e=u(new Date(t.getFullYear(),0,4)),n=u(n),0>=o(e,t)?0>=o(n,t)?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var s=E[r+40>>2>>>0];for(var l in r={$b:E[r>>2>>>0],Zb:E[r+4>>2>>>0],Gb:E[r+8>>2>>>0],Kb:E[r+12>>2>>>0],Hb:E[r+16>>2>>>0],Cb:E[r+20>>2>>>0],Ab:E[r+24>>2>>>0],Bb:E[r+28>>2>>>0],bc:E[r+32>>2>>>0],Yb:E[r+36>>2>>>0],ac:s?j(s):""},n=j(n),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),s[l]);var f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(l in s={"%a":function(t){return f[t.Ab].substring(0,3)},"%A":function(t){return f[t.Ab]},"%b":function(t){return p[t.Hb].substring(0,3)},"%B":function(t){return p[t.Hb]},"%C":function(t){return i((t.Cb+1900)/100|0,2)},"%d":function(t){return i(t.Kb,2)},"%e":function(t){return a(t.Kb,2," ")},"%g":function(t){return c(t).toString().substring(2)},"%G":function(t){return c(t)},"%H":function(t){return i(t.Gb,2)},"%I":function(t){return 0==(t=t.Gb)?t=12:12<t&&(t-=12),i(t,2)},"%j":function(t){for(var e=0,n=0;n<=t.Hb-1;e+=(pt(t.Cb+1900)?ht:dt)[n++]);return i(t.Kb+e,3)},"%m":function(t){return i(t.Hb+1,2)},"%M":function(t){return i(t.Zb,2)},"%n":function(){return"\\n"},"%p":function(t){return 0<=t.Gb&&12>t.Gb?"AM":"PM"},"%S":function(t){return i(t.$b,2)},"%t":function(){return"\\t"},"%u":function(t){return t.Ab||7},"%U":function(t){return i(Math.floor((t.Bb+7-t.Ab)/7),2)},"%V":function(t){var e=Math.floor((t.Bb+7-(t.Ab+6)%7)/7);if(2>=(t.Ab+371-t.Bb-2)%7&&e++,e)53==e&&(4==(n=(t.Ab+371-t.Bb)%7)||3==n&&pt(t.Cb)||(e=1));else{e=52;var n=(t.Ab+7-t.Bb-1)%7;(4==n||5==n&&pt(t.Cb%400-1))&&e++}return i(e,2)},"%w":function(t){return t.Ab},"%W":function(t){return i(Math.floor((t.Bb+7-(t.Ab+6)%7)/7),2)},"%y":function(t){return(t.Cb+1900).toString().substring(2)},"%Y":function(t){return t.Cb+1900},"%z":function(t){var e=0<=(t=t.Yb);return t=Math.abs(t)/60,(e?"+":"-")+String("0000"+(t/60*100+t%60)).slice(-4)},"%Z":function(t){return t.ac},"%%":function(){return"%"}},n=n.replace(/%%/g,"\\0\\0"),s)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),s[l](r)));return l=function(t){var e=Array(D(t)+1);return k(t,e,0,e.length),e}(n=n.replace(/\\0\\0/g,"%")),l.length>e?0:(S.set(l,t>>>0),l.length-1)}var bt={a:function(t){return gt(t+24)+24},m:function(t){return(t=new et(t)).Pb()||(t.Ib(!0),K--),t.Jb(!1),Q.push(t),t.Nb(),t.Qb()},ia:function(t){throw w("Unexpected exception thrown, this is not properly supported - aborting"),C=!0,t},w:function(){Ot(0);var t=Q.pop();if(t.Xb()&&!t.Lb()){var e=t.Wb();e&&at(e)(t.Db),nt(t.Db)}tt=0},d:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},k:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},g:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},s:nt,L:function(){var t=Q.pop();t||V("no exception to throw");var e=t.Db;throw t.Lb()||(Q.push(t),t.Jb(!0),t.Ib(!1),K++),tt=e,e},b:function(t,e,n){throw new et(t).Rb(e,n),tt=t,K++,t},la:function(){return K},i:function(t){throw tt||(tt=t),t},H:function(){return 0},Ba:function(){},pa:function(){},ra:function(){},ka:function(){return 0},za:function(){},ua:function(){},ya:function(){},R:function(){},qa:function(){},na:function(){},Aa:function(){},oa:function(){},Ha:function(){},Ja:function(){V("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ia:function(){V("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},S:function(){return Date.now()},Ca:function(){return!0},Da:function(t,e){t=new Date(1e3*(M[t>>>2]+4294967296*E[t+4>>>2])),E[e>>2>>>0]=t.getUTCSeconds(),E[e+4>>2>>>0]=t.getUTCMinutes(),E[e+8>>2>>>0]=t.getUTCHours(),E[e+12>>2>>>0]=t.getUTCDate(),E[e+16>>2>>>0]=t.getUTCMonth(),E[e+20>>2>>>0]=t.getUTCFullYear()-1900,E[e+24>>2>>>0]=t.getUTCDay(),E[e+28>>2>>>0]=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},Ea:function(t,e){t=new Date(1e3*(M[t>>>2]+4294967296*E[t+4>>>2])),E[e>>2>>>0]=t.getSeconds(),E[e+4>>2>>>0]=t.getMinutes(),E[e+8>>2>>>0]=t.getHours(),E[e+12>>2>>>0]=t.getDate(),E[e+16>>2>>>0]=t.getMonth(),E[e+20>>2>>>0]=t.getFullYear()-1900,E[e+24>>2>>>0]=t.getDay();var n=new Date(t.getFullYear(),0,1);E[e+28>>2>>>0]=(t.getTime()-n.getTime())/864e5|0,E[e+36>>2>>>0]=-60*t.getTimezoneOffset();var r=new Date(t.getFullYear(),6,1).getTimezoneOffset();n=n.getTimezoneOffset(),E[e+32>>2>>>0]=0|(r!=n&&t.getTimezoneOffset()==Math.min(n,r))},Fa:function(t){var e=new Date(E[t+20>>2>>>0]+1900,E[t+16>>2>>>0],E[t+12>>2>>>0],E[t+8>>2>>>0],E[t+4>>2>>>0],E[t>>2>>>0],0),n=E[t+32>>2>>>0],r=e.getTimezoneOffset(),a=new Date(e.getFullYear(),0,1),i=new Date(e.getFullYear(),6,1).getTimezoneOffset(),o=a.getTimezoneOffset(),u=Math.min(o,i);return 0>n?E[t+32>>2>>>0]=Number(i!=o&&u==r):0<n!=(u==r)&&(i=Math.max(o,i),e.setTime(e.getTime()+6e4*((0<n?u:i)-r))),E[t+24>>2>>>0]=e.getDay(),E[t+28>>2>>>0]=(e.getTime()-a.getTime())/864e5|0,E[t>>2>>>0]=e.getSeconds(),E[t+4>>2>>>0]=e.getMinutes(),E[t+8>>2>>>0]=e.getHours(),E[t+12>>2>>>0]=e.getDate(),E[t+16>>2>>>0]=e.getMonth(),e.getTime()/1e3|0},sa:function(){return-52},ta:function(){},Ga:function t(e,n,r){t.Vb||(t.Vb=!0,function(t,e,n){function r(t){return(t=t.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?t[1]:"GMT"}var a=(new Date).getFullYear(),i=new Date(a,0,1),o=new Date(a,6,1);a=i.getTimezoneOffset();var u=o.getTimezoneOffset();E[t>>2>>>0]=60*Math.max(a,u),E[e>>2>>>0]=Number(a!=u),t=r(i),e=r(o),t=it(t),e=it(e),u<a?(M[n>>2>>>0]=t,M[n+4>>2>>>0]=e):(M[n>>2>>>0]=e,M[n+4>>2>>>0]=t)}(e,n,r))},B:function(){V("")},ma:function(){return 4294901760},I:b?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:()=>performance.now(),xa:function(t,e,n){T.copyWithin(t>>>0,e>>>0,e+n>>>0)},G:function(t){var e=T.length;if(4294901760<(t>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=e*(1+.2/n);r=Math.min(r,t+100663296);var a=Math;r=Math.max(t,r),a=a.min.call(a,4294901760,r+(65536-r%65536)%65536);t:{try{O.grow(a-A.byteLength+65535>>>16),P();var i=1;break t}catch(t){}i=void 0}if(i)return!0}return!1},va:function(t,e){var n=0;return ut().forEach((function(r,a){var i=e+n;for(a=M[t+4*a>>2>>>0]=i,i=0;i<r.length;++i)S[a++>>0>>>0]=r.charCodeAt(i);S[a>>0>>>0]=0,n+=r.length+1})),0},wa:function(t,e){var n=ut();M[t>>2>>>0]=n.length;var r=0;return n.forEach((function(t){r+=t.length+1})),M[e>>2>>>0]=r,0},ba:function(t){_||0<L||(_t(),Z(W),wt(0),st[1].length&&lt(1,10),st[2].length&&lt(2,10)),_||0<L||(e.onExit&&e.onExit(t),C=!0),h(t,new J(t))},E:function(){return 52},Q:function(){return 52},ca:function(){return 70},P:function(t,e,n,r){for(var a=0,i=0;i<n;i++){var o=M[e>>2>>>0],u=M[e+4>>2>>>0];e+=8;for(var c=0;c<u;c++)lt(t,T[o+c>>>0]);a+=u}return M[r>>2>>>0]=a,0},c:function(){return ft},ja:function t(e,r){t.Mb||(t.Mb=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>(crypto.getRandomValues(t),t[0])}if(b)try{var e=n(Object(function(){var t=new Error("Cannot find module \'crypto\'");throw t.code="MODULE_NOT_FOUND",t}()));return()=>e.randomBytes(1)[0]}catch(t){}return()=>V("randomDevice")}());for(var a=0;a<r;a++)S[e+a>>0>>>0]=t.Mb();return 0},ea:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},fa:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},J:function(t){var e=At();try{return at(t)()}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},e:function(t,e){var n=At();try{return at(t)(e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},N:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},O:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},j:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},o:function(t,e,n,r){var a=At();try{return at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},p:function(t,e,n,r,a){var i=At();try{return at(t)(e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},M:function(t,e,n,r,a,i){var o=At();try{return at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},r:function(t,e,n,r,a,i){var o=At();try{return at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},v:function(t,e,n,r,a,i,o){var u=At();try{return at(t)(e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},K:function(t,e,n,r,a,i,o,u){var c=At();try{return at(t)(e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},D:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=At();try{return at(t)(e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(St(p),t!==t+0)throw t;Ot(1,0)}},X:function(t,e,n,r,a,i,o,u){var c=At();try{return Ft(t,e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},V:function(t,e,n,r,a,i,o){var u=At();try{return xt(t,e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},U:function(t,e,n,r,a){var i=At();try{return It(t,e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},Z:function(t,e,n,r){var a=At();try{return Pt(t,e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},W:function(t){var e=At();try{return Ct(t)}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},Y:function(t,e){var n=At();try{return Ut(t,e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},T:function(t,e,n){var r=At();try{return Rt(t,e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},f:function(t){var e=At();try{at(t)()}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},q:function(t,e){var n=At();try{at(t)(e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},h:function(t,e,n){var r=At();try{at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},da:function(t,e,n,r){var a=At();try{at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},l:function(t,e,n,r){var a=At();try{at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},t:function(t,e,n,r,a){var i=At();try{at(t)(e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},u:function(t,e,n,r,a,i){var o=At();try{at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},x:function(t,e,n,r,a,i,o){var u=At();try{at(t)(e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},z:function(t,e,n,r,a,i,o,u){var c=At();try{at(t)(e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},ga:function(t,e,n,r,a,i,o,u,c){var s=At();try{at(t)(e,n,r,a,i,o,u,c)}catch(t){if(St(s),t!==t+0)throw t;Ot(1,0)}},A:function(t,e,n,r,a,i,o,u,c,s,l){var f=At();try{at(t)(e,n,r,a,i,o,u,c,s,l)}catch(t){if(St(f),t!==t+0)throw t;Ot(1,0)}},C:function(t,e,n,r,a,i,o,u,c,s,l,f,p,h,d,y){var b=At();try{at(t)(e,n,r,a,i,o,u,c,s,l,f,p,h,d,y)}catch(t){if(St(b),t!==t+0)throw t;Ot(1,0)}},aa:function(t,e,n,r,a,i,o,u){var c=At();try{jt(t,e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},_:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=At();try{Dt(t,e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(St(p),t!==t+0)throw t;Ot(1,0)}},$:function(t,e,n,r,a,i){var o=At();try{kt(t,e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},n:function(t){return t},F:function(t){ft=t},ha:yt,y:function(t,e,n,r){return yt(t,e,n,r)}};!function(){function t(t){e.asm=t.exports,O=e.asm.Ka,P(),U=e.asm.ib,I.unshift(e.asm.La),B--,e.monitorRunDependencies&&e.monitorRunDependencies(B),0==B&&(null!==G&&(clearInterval(G),G=null),N&&(t=N,N=null,t()))}function n(e){t(e.instance)}function r(t){return function(){if(!g&&(d||y)){if("function"==typeof fetch&&!Y.startsWith("file://"))return fetch(Y,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at \'"+Y+"\'";return t.arrayBuffer()})).catch((function(){return X()}));if(o)return new Promise((function(t,e){o(Y,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return X()}))}().then((function(t){return WebAssembly.instantiate(t,i)})).then((function(t){return t})).then(t,(function(t){w("failed to asynchronously prepare wasm: "+t),V(t)}))}var i={a:bt};if(B++,e.monitorRunDependencies&&e.monitorRunDependencies(B),e.instantiateWasm)try{return e.instantiateWasm(i,t)}catch(t){return w("Module.instantiateWasm callback failed with error: "+t),!1}(g||"function"!=typeof WebAssembly.instantiateStreaming||$()||Y.startsWith("file://")||b||"function"!=typeof fetch?r(n):fetch(Y,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,i).then(n,(function(t){return w("wasm streaming compile failed: "+t),w("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a)}(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.La).apply(null,arguments)},e._OrtInit=function(){return(e._OrtInit=e.asm.Ma).apply(null,arguments)},e._OrtCreateSessionOptions=function(){return(e._OrtCreateSessionOptions=e.asm.Na).apply(null,arguments)},e._OrtAppendExecutionProvider=function(){return(e._OrtAppendExecutionProvider=e.asm.Oa).apply(null,arguments)},e._OrtAddSessionConfigEntry=function(){return(e._OrtAddSessionConfigEntry=e.asm.Pa).apply(null,arguments)},e._OrtReleaseSessionOptions=function(){return(e._OrtReleaseSessionOptions=e.asm.Qa).apply(null,arguments)},e._OrtCreateSession=function(){return(e._OrtCreateSession=e.asm.Ra).apply(null,arguments)},e._OrtReleaseSession=function(){return(e._OrtReleaseSession=e.asm.Sa).apply(null,arguments)},e._OrtGetInputCount=function(){return(e._OrtGetInputCount=e.asm.Ta).apply(null,arguments)},e._OrtGetOutputCount=function(){return(e._OrtGetOutputCount=e.asm.Ua).apply(null,arguments)},e._OrtGetInputName=function(){return(e._OrtGetInputName=e.asm.Va).apply(null,arguments)},e._OrtGetOutputName=function(){return(e._OrtGetOutputName=e.asm.Wa).apply(null,arguments)},e._OrtFree=function(){return(e._OrtFree=e.asm.Xa).apply(null,arguments)},e._OrtCreateTensor=function(){return(e._OrtCreateTensor=e.asm.Ya).apply(null,arguments)},e._OrtGetTensorData=function(){return(e._OrtGetTensorData=e.asm.Za).apply(null,arguments)},e._OrtReleaseTensor=function(){return(e._OrtReleaseTensor=e.asm._a).apply(null,arguments)},e._OrtCreateRunOptions=function(){return(e._OrtCreateRunOptions=e.asm.$a).apply(null,arguments)},e._OrtAddRunConfigEntry=function(){return(e._OrtAddRunConfigEntry=e.asm.ab).apply(null,arguments)},e._OrtReleaseRunOptions=function(){return(e._OrtReleaseRunOptions=e.asm.bb).apply(null,arguments)},e._OrtRun=function(){return(e._OrtRun=e.asm.cb).apply(null,arguments)},e._OrtEndProfiling=function(){return(e._OrtEndProfiling=e.asm.db).apply(null,arguments)};var mt,gt=e._malloc=function(){return(gt=e._malloc=e.asm.eb).apply(null,arguments)},vt=e._free=function(){return(vt=e._free=e.asm.fb).apply(null,arguments)},wt=e._fflush=function(){return(wt=e._fflush=e.asm.gb).apply(null,arguments)},_t=e.___funcs_on_exit=function(){return(_t=e.___funcs_on_exit=e.asm.hb).apply(null,arguments)},Ot=e._setThrew=function(){return(Ot=e._setThrew=e.asm.jb).apply(null,arguments)},At=e.stackSave=function(){return(At=e.stackSave=e.asm.kb).apply(null,arguments)},St=e.stackRestore=function(){return(St=e.stackRestore=e.asm.lb).apply(null,arguments)},Tt=e.stackAlloc=function(){return(Tt=e.stackAlloc=e.asm.mb).apply(null,arguments)},Et=e.___cxa_can_catch=function(){return(Et=e.___cxa_can_catch=e.asm.nb).apply(null,arguments)},Mt=e.___cxa_is_pointer_type=function(){return(Mt=e.___cxa_is_pointer_type=e.asm.ob).apply(null,arguments)},Ct=e.dynCall_j=function(){return(Ct=e.dynCall_j=e.asm.pb).apply(null,arguments)},xt=e.dynCall_iiiiij=function(){return(xt=e.dynCall_iiiiij=e.asm.qb).apply(null,arguments)},Rt=e.dynCall_jii=function(){return(Rt=e.dynCall_jii=e.asm.rb).apply(null,arguments)},jt=e.dynCall_viiiiij=function(){return(jt=e.dynCall_viiiiij=e.asm.sb).apply(null,arguments)},kt=e.dynCall_vjji=function(){return(kt=e.dynCall_vjji=e.asm.tb).apply(null,arguments)},Dt=e.dynCall_viiijjjii=function(){return(Dt=e.dynCall_viiijjjii=e.asm.ub).apply(null,arguments)},Pt=e.dynCall_iij=function(){return(Pt=e.dynCall_iij=e.asm.vb).apply(null,arguments)},Ut=e.dynCall_ji=function(){return(Ut=e.dynCall_ji=e.asm.wb).apply(null,arguments)},Ft=e.dynCall_iiiiiij=function(){return(Ft=e.dynCall_iiiiiij=e.asm.xb).apply(null,arguments)},It=e.dynCall_iiij=function(){return(It=e.dynCall_iiij=e.asm.yb).apply(null,arguments)};function Wt(){function t(){if(!mt&&(mt=!0,e.calledRun=!0,!C)){if(Z(I),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var t=e.postRun.shift();H.unshift(t)}Z(H)}}if(!(0<B)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)z();Z(F),0<B||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t())}}if(e.UTF8ToString=j,e.stringToUTF8=function(t,e,n){return k(t,T,e,n)},e.lengthBytesUTF8=D,e.stackSave=At,e.stackRestore=St,e.stackAlloc=Tt,N=function t(){mt||Wt(),mt||(N=t)},e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return Wt(),t.ready});t.exports=r},967:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.iterateExtraOptions=void 0,e.iterateExtraOptions=(t,n,r,a)=>{if("object"==typeof t&&null!==t){if(r.has(t))throw new Error("Circular reference in options");r.add(t)}Object.entries(t).forEach((([t,i])=>{const o=n?n+t:t;if("object"==typeof i)(0,e.iterateExtraOptions)(i,o+".",r,a);else if("string"==typeof i||"number"==typeof i)a(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can\'t handle extra config type: "+typeof i);a(o,i?"1":"0")}}))}},586:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setRunOptions=void 0;const r=n(967),a=n(983),i=n(361);e.setRunOptions=t=>{const e=(0,i.getInstance)();let n=0;const o=[],u=t||{};try{if(void 0===(null==t?void 0:t.logSeverityLevel))u.logSeverityLevel=2;else if("number"!=typeof t.logSeverityLevel||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if(void 0===(null==t?void 0:t.logVerbosityLevel))u.logVerbosityLevel=0;else if("number"!=typeof t.logVerbosityLevel||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);void 0===(null==t?void 0:t.terminate)&&(u.terminate=!1);let i=0;if(void 0!==(null==t?void 0:t.tag)&&(i=(0,a.allocWasmString)(t.tag,o)),n=e._OrtCreateRunOptions(u.logSeverityLevel,u.logVerbosityLevel,!!u.terminate,i),0===n)throw new Error("Can\'t create run options");return void 0!==(null==t?void 0:t.extra)&&(0,r.iterateExtraOptions)(t.extra,"",new WeakSet,((t,r)=>{const i=(0,a.allocWasmString)(t,o),u=(0,a.allocWasmString)(r,o);if(0!==e._OrtAddRunConfigEntry(n,i,u))throw new Error(`Can\'t set a run config entry: ${t} - ${r}`)})),[n,o]}catch(t){throw 0!==n&&e._OrtReleaseRunOptions(n),o.forEach(e._free),t}}},919:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setSessionOptions=void 0;const r=n(967),a=n(983),i=n(361);e.setSessionOptions=t=>{const e=(0,i.getInstance)();let n=0;const o=[],u=t||{};(t=>{t.extra||(t.extra={}),t.extra.session||(t.extra.session={});const e=t.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1")})(u);try{void 0===(null==t?void 0:t.graphOptimizationLevel)&&(u.graphOptimizationLevel="all");const c=(t=>{switch(t){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${t}`)}})(u.graphOptimizationLevel);void 0===(null==t?void 0:t.enableCpuMemArena)&&(u.enableCpuMemArena=!0),void 0===(null==t?void 0:t.enableMemPattern)&&(u.enableMemPattern=!0),void 0===(null==t?void 0:t.executionMode)&&(u.executionMode="sequential");const s=(t=>{switch(t){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${t}`)}})(u.executionMode);let l=0;if(void 0!==(null==t?void 0:t.logId)&&(l=(0,a.allocWasmString)(t.logId,o)),void 0===(null==t?void 0:t.logSeverityLevel))u.logSeverityLevel=2;else if("number"!=typeof t.logSeverityLevel||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if(void 0===(null==t?void 0:t.logVerbosityLevel))u.logVerbosityLevel=0;else if("number"!=typeof t.logVerbosityLevel||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);if(void 0===(null==t?void 0:t.enableProfiling)&&(u.enableProfiling=!1),n=e._OrtCreateSessionOptions(c,!!u.enableCpuMemArena,!!u.enableMemPattern,s,!!u.enableProfiling,0,l,u.logSeverityLevel,u.logVerbosityLevel),0===n)throw new Error("Can\'t create session options");return(null==t?void 0:t.executionProviders)&&((t,e,n)=>{for(const r of e){let e="string"==typeof r?r:r.name;switch(e){case"xnnpack":e="XNNPACK";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${e}`)}const o=(0,a.allocWasmString)(e,n);if(0!==(0,i.getInstance)()._OrtAppendExecutionProvider(t,o))throw new Error(`Can\'t append execution provider: ${e}`)}})(n,t.executionProviders,o),void 0!==(null==t?void 0:t.extra)&&(0,r.iterateExtraOptions)(t.extra,"",new WeakSet,((t,r)=>{const i=(0,a.allocWasmString)(t,o),u=(0,a.allocWasmString)(r,o);if(0!==e._OrtAddSessionConfigEntry(n,i,u))throw new Error(`Can\'t set a session config entry: ${t} - ${r}`)})),[n,o]}catch(t){throw 0!==n&&e._OrtReleaseSessionOptions(n),o.forEach(e._free),t}}},983:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.allocWasmString=void 0;const r=n(361);e.allocWasmString=(t,e)=>{const n=(0,r.getInstance)(),a=n.lengthBytesUTF8(t)+1,i=n._malloc(a);return n.stringToUTF8(t,i,a),e.push(i),i}},349:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractTransferableBuffers=e.endProfiling=e.run=e.releaseSession=e.createSession=e.createSessionFinalize=e.createSessionAllocate=e.initOrt=void 0;const r=n(586),a=n(919),i=n(983),o=n(361);e.initOrt=(t,e)=>{const n=(0,o.getInstance)()._OrtInit(t,e);if(0!==n)throw new Error(`Can\'t initialize onnxruntime. error code = ${n}`)};const u=new Map;e.createSessionAllocate=t=>{const e=(0,o.getInstance)(),n=e._malloc(t.byteLength);return e.HEAPU8.set(t,n),[n,t.byteLength]},e.createSessionFinalize=(t,e)=>{const n=(0,o.getInstance)();let r=0,i=0,c=[];try{if([i,c]=(0,a.setSessionOptions)(e),r=n._OrtCreateSession(t[0],t[1],i),0===r)throw new Error("Can\'t create a session")}finally{n._free(t[0]),n._OrtReleaseSessionOptions(i),c.forEach(n._free)}const s=n._OrtGetInputCount(r),l=n._OrtGetOutputCount(r),f=[],p=[],h=[],d=[];for(let t=0;t<s;t++){const e=n._OrtGetInputName(r,t);if(0===e)throw new Error("Can\'t get an input name");p.push(e),f.push(n.UTF8ToString(e))}for(let t=0;t<l;t++){const e=n._OrtGetOutputName(r,t);if(0===e)throw new Error("Can\'t get an output name");d.push(e),h.push(n.UTF8ToString(e))}return u.set(r,[r,p,d]),[r,f,h]},e.createSession=(t,n)=>{const r=(0,e.createSessionAllocate)(t);return(0,e.createSessionFinalize)(r,n)},e.releaseSession=t=>{const e=(0,o.getInstance)(),n=u.get(t);if(!n)throw new Error("invalid session id");const r=n[0],a=n[1],i=n[2];a.forEach(e._OrtFree),i.forEach(e._OrtFree),e._OrtReleaseSession(r),u.delete(t)};const c=t=>{switch(t){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${t}`)}},s=t=>{switch(t){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${t}`)}},l=t=>{switch(t){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${t}`)}};e.run=(t,e,n,a,f)=>{const p=(0,o.getInstance)(),h=u.get(t);if(!h)throw new Error("invalid session id");const d=h[0],y=h[1],b=h[2],m=e.length,g=a.length;let v=0,w=[];const _=[],O=[];try{[v,w]=(0,r.setRunOptions)(f);for(let t=0;t<m;t++){const e=n[t][0],r=n[t][1],a=n[t][2];let o,u;if(Array.isArray(a)){u=4*a.length,o=p._malloc(u),O.push(o);let t=o/4;for(let e=0;e<a.length;e++){if("string"!=typeof a[e])throw new TypeError(`tensor data at index ${e} is not a string`);p.HEAPU32[t++]=(0,i.allocWasmString)(a[e],O)}}else u=a.byteLength,o=p._malloc(u),O.push(o),p.HEAPU8.set(new Uint8Array(a.buffer,a.byteOffset,u),o);const s=p.stackSave(),l=p.stackAlloc(4*r.length);try{let t=l/4;r.forEach((e=>p.HEAP32[t++]=e));const n=p._OrtCreateTensor(c(e),o,u,l,r.length);if(0===n)throw new Error("Can\'t create a tensor");_.push(n)}finally{p.stackRestore(s)}}const t=p.stackSave(),o=p.stackAlloc(4*m),u=p.stackAlloc(4*m),h=p.stackAlloc(4*g),A=p.stackAlloc(4*g);try{let n=o/4,r=u/4,i=h/4,c=A/4;for(let t=0;t<m;t++)p.HEAPU32[n++]=_[t],p.HEAPU32[r++]=y[e[t]];for(let t=0;t<g;t++)p.HEAPU32[i++]=0,p.HEAPU32[c++]=b[a[t]];let f=p._OrtRun(d,u,o,m,A,g,h,v);const w=[];if(0===f)for(let t=0;t<g;t++){const e=p.HEAPU32[h/4+t],n=p.stackSave(),r=p.stackAlloc(16);let a,i=0;try{if(f=p._OrtGetTensorData(e,r,r+4,r+8,r+12),0!==f)throw new Error(`Can\'t access output tensor data. error code = ${f}`);let t=r/4;const o=p.HEAPU32[t++];i=p.HEAPU32[t++];const u=p.HEAPU32[t++],c=p.HEAPU32[t++],h=[];for(let t=0;t<c;t++)h.push(p.HEAPU32[u/4+t]);p._OrtFree(u);const d=0===h.length?1:h.reduce(((t,e)=>t*e));if(a=s(o),"string"===a){const t=[];let e=i/4;for(let n=0;n<d;n++){const r=p.HEAPU32[e++],a=n===d-1?void 0:p.HEAPU32[e]-r;t.push(p.UTF8ToString(r,a))}w.push([a,h,t])}else{const t=new(l(a))(d);new Uint8Array(t.buffer,t.byteOffset,t.byteLength).set(p.HEAPU8.subarray(i,i+t.byteLength)),w.push([a,h,t])}}finally{p.stackRestore(n),"string"===a&&i&&p._free(i),p._OrtReleaseTensor(e)}}if(0===f)return w;throw new Error(`failed to call OrtRun(). error code = ${f}.`)}finally{p.stackRestore(t)}}finally{_.forEach(p._OrtReleaseTensor),O.forEach(p._free),p._OrtReleaseRunOptions(v),w.forEach(p._free)}},e.endProfiling=t=>{const e=(0,o.getInstance)(),n=u.get(t);if(!n)throw new Error("invalid session id");const r=n[0],a=e._OrtEndProfiling(r);if(0===a)throw new Error("Can\'t get an profile file name");e._OrtFree(a)},e.extractTransferableBuffers=t=>{const e=[];for(const n of t){const t=n[2];!Array.isArray(t)&&t.buffer&&e.push(t.buffer)}return e}},361:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(e,n);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,a)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return a(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.getInstance=e.initializeWebAssembly=void 0;const u=i(n(449)),c=o(n(932)),s=n(474);let l,f=!1,p=!1,h=!1;const d=(t,e)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":t?"ort-wasm-simd.wasm":"ort-wasm.wasm";e.initializeWebAssembly=async t=>{if(f)return Promise.resolve();if(p)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(h)throw new Error("previous call to \'initializeWebAssembly()\' failed.");p=!0;const e=t.initTimeout,r=t.numThreads,a=t.simd,i=r>1&&(()=>{try{return"undefined"!=typeof SharedArrayBuffer&&("undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch(t){return!1}})(),o=a&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(t){return!1}})(),y="string"==typeof t.wasmPaths?t.wasmPaths:void 0,b=d(!1,i),m=d(o,i),g="object"==typeof t.wasmPaths?t.wasmPaths[m]:void 0;let v=!1;const w=[];if(e>0&&w.push(new Promise((t=>{setTimeout((()=>{v=!0,t()}),e)}))),w.push(new Promise(((t,e)=>{const r=i?s:c.default,a={locateFile:(t,e)=>i&&t.endsWith(".worker.js")&&"undefined"!=typeof Blob?URL.createObjectURL(new Blob([n(154)],{type:"text/javascript"})):t===b?null!=g?g:(null!=y?y:e)+m:e+t};if(i)if("undefined"==typeof Blob)a.mainScriptUrlOrBlob=u.join("/","ort-wasm-threaded.js");else{const t=`var ortWasmThreaded=(function(){var _scriptDir;return ${r.toString()}})();`;a.mainScriptUrlOrBlob=new Blob([t],{type:"text/javascript"})}r(a).then((e=>{p=!1,f=!0,l=e,t()}),(t=>{p=!1,h=!0,e(t)}))}))),await Promise.race(w),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)},e.getInstance=()=>{if(f&&l)return l;throw new Error("WebAssembly is not initialized yet.")},e.dispose=()=>{var t;!f||p||h||(p=!0,null===(t=l.PThread)||void 0===t||t.terminateAllThreads(),l=void 0,p=!1,f=!1,h=!0)}},154:t=>{"use strict";t.exports=\'"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};\\n\'},384:()=>{},993:()=>{},908:()=>{},953:()=>{},925:()=>{},449:()=>{}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";const t=n(349),e=n(361);self.onmessage=n=>{switch(n.data.type){case"init-wasm":(0,e.initializeWebAssembly)(n.data.in).then((()=>postMessage({type:"init-wasm"})),(t=>postMessage({type:"init-wasm",err:t})));break;case"init-ort":try{const{numThreads:e,loggingLevel:r}=n.data.in;(0,t.initOrt)(e,r),postMessage({type:"init-ort"})}catch(t){postMessage({type:"init-ort",err:t})}break;case"create_allocate":try{const{model:e}=n.data.in,r=(0,t.createSessionAllocate)(e);postMessage({type:"create_allocate",out:r})}catch(t){postMessage({type:"create_allocate",err:t})}break;case"create_finalize":try{const{modeldata:e,options:r}=n.data.in,a=(0,t.createSessionFinalize)(e,r);postMessage({type:"create_finalize",out:a})}catch(t){postMessage({type:"create_finalize",err:t})}break;case"create":try{const{model:e,options:r}=n.data.in,a=(0,t.createSession)(e,r);postMessage({type:"create",out:a})}catch(t){postMessage({type:"create",err:t})}break;case"release":try{const e=n.data.in;(0,t.releaseSession)(e),postMessage({type:"release"})}catch(t){postMessage({type:"release",err:t})}break;case"run":try{const{sessionId:e,inputIndices:r,inputs:a,outputIndices:i,options:o}=n.data.in,u=(0,t.run)(e,r,a,i,o);postMessage({type:"run",out:u},(0,t.extractTransferableBuffers)(u))}catch(t){postMessage({type:"run",err:t})}break;case"end-profiling":try{const e=n.data.in;(0,t.endProfiling)(e),postMessage({type:"end-profiling"})}catch(t){postMessage({type:"end-profiling",err:t})}}}})()})();\n',"Worker",void 0,void 0)}},477:i=>{i.exports=function(e,o,s,c){var h=self||window;try{try{var _;try{_=new h.Blob([e])}catch{(_=new(h.BlobBuilder||h.WebKitBlobBuilder||h.MozBlobBuilder||h.MSBlobBuilder)).append(e),_=_.getBlob()}var $=h.URL||h.webkitURL,nt=$.createObjectURL(_),tt=new h[o](nt,s);return $.revokeObjectURL(nt),tt}catch{return new h[o]("data:application/javascript,".concat(encodeURIComponent(e)),s)}}catch{if(!c)throw Error("Inline worker is not supported");return new h[o](c,s)}}},4154:i=>{i.exports=`"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};
`},1670:i=>{i.exports=__WEBPACK_EXTERNAL_MODULE__1670__},7067:()=>{},1296:()=>{},1384:()=>{},3993:()=>{},908:()=>{},6953:()=>{},9925:()=>{},2806:()=>{},6449:()=>{},2850:()=>{},5381:()=>{},5686:(i,e,o)=>{o.r(e),o.d(e,{flatbuffers:()=>s});var s={};s.Offset,s.Table,s.SIZEOF_SHORT=2,s.SIZEOF_INT=4,s.FILE_IDENTIFIER_LENGTH=4,s.SIZE_PREFIX_LENGTH=4,s.Encoding={UTF8_BYTES:1,UTF16_STRING:2},s.int32=new Int32Array(2),s.float32=new Float32Array(s.int32.buffer),s.float64=new Float64Array(s.int32.buffer),s.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,s.Long=function(c,h){this.low=0|c,this.high=0|h},s.Long.create=function(c,h){return c==0&&h==0?s.Long.ZERO:new s.Long(c,h)},s.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},s.Long.prototype.equals=function(c){return this.low==c.low&&this.high==c.high},s.Long.ZERO=new s.Long(0,0),s.Builder=function(c){if(c)h=c;else var h=1024;this.bb=s.ByteBuffer.allocate(h),this.space=h,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},s.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},s.Builder.prototype.forceDefaults=function(c){this.force_defaults=c},s.Builder.prototype.dataBuffer=function(){return this.bb},s.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},s.Builder.prototype.prep=function(c,h){c>this.minalign&&(this.minalign=c);for(var _=1+~(this.bb.capacity()-this.space+h)&c-1;this.space<_+c+h;){var $=this.bb.capacity();this.bb=s.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-$}this.pad(_)},s.Builder.prototype.pad=function(c){for(var h=0;h<c;h++)this.bb.writeInt8(--this.space,0)},s.Builder.prototype.writeInt8=function(c){this.bb.writeInt8(this.space-=1,c)},s.Builder.prototype.writeInt16=function(c){this.bb.writeInt16(this.space-=2,c)},s.Builder.prototype.writeInt32=function(c){this.bb.writeInt32(this.space-=4,c)},s.Builder.prototype.writeInt64=function(c){this.bb.writeInt64(this.space-=8,c)},s.Builder.prototype.writeFloat32=function(c){this.bb.writeFloat32(this.space-=4,c)},s.Builder.prototype.writeFloat64=function(c){this.bb.writeFloat64(this.space-=8,c)},s.Builder.prototype.addInt8=function(c){this.prep(1,0),this.writeInt8(c)},s.Builder.prototype.addInt16=function(c){this.prep(2,0),this.writeInt16(c)},s.Builder.prototype.addInt32=function(c){this.prep(4,0),this.writeInt32(c)},s.Builder.prototype.addInt64=function(c){this.prep(8,0),this.writeInt64(c)},s.Builder.prototype.addFloat32=function(c){this.prep(4,0),this.writeFloat32(c)},s.Builder.prototype.addFloat64=function(c){this.prep(8,0),this.writeFloat64(c)},s.Builder.prototype.addFieldInt8=function(c,h,_){(this.force_defaults||h!=_)&&(this.addInt8(h),this.slot(c))},s.Builder.prototype.addFieldInt16=function(c,h,_){(this.force_defaults||h!=_)&&(this.addInt16(h),this.slot(c))},s.Builder.prototype.addFieldInt32=function(c,h,_){(this.force_defaults||h!=_)&&(this.addInt32(h),this.slot(c))},s.Builder.prototype.addFieldInt64=function(c,h,_){!this.force_defaults&&h.equals(_)||(this.addInt64(h),this.slot(c))},s.Builder.prototype.addFieldFloat32=function(c,h,_){(this.force_defaults||h!=_)&&(this.addFloat32(h),this.slot(c))},s.Builder.prototype.addFieldFloat64=function(c,h,_){(this.force_defaults||h!=_)&&(this.addFloat64(h),this.slot(c))},s.Builder.prototype.addFieldOffset=function(c,h,_){(this.force_defaults||h!=_)&&(this.addOffset(h),this.slot(c))},s.Builder.prototype.addFieldStruct=function(c,h,_){h!=_&&(this.nested(h),this.slot(c))},s.Builder.prototype.nested=function(c){if(c!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},s.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},s.Builder.prototype.slot=function(c){this.vtable[c]=this.offset()},s.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},s.Builder.growByteBuffer=function(c){var h=c.capacity();if(3221225472&h)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var _=h<<1,$=s.ByteBuffer.allocate(_);return $.setPosition(_-h),$.bytes().set(c.bytes(),_-h),$},s.Builder.prototype.addOffset=function(c){this.prep(s.SIZEOF_INT,0),this.writeInt32(this.offset()-c+s.SIZEOF_INT)},s.Builder.prototype.startObject=function(c){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=c;for(var h=0;h<c;h++)this.vtable[h]=0;this.isNested=!0,this.object_start=this.offset()},s.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var c=this.offset(),h=this.vtable_in_use-1;h>=0&&this.vtable[h]==0;h--);for(var _=h+1;h>=0;h--)this.addInt16(this.vtable[h]!=0?c-this.vtable[h]:0);this.addInt16(c-this.object_start);var $=(_+2)*s.SIZEOF_SHORT;this.addInt16($);var nt=0,tt=this.space;e:for(h=0;h<this.vtables.length;h++){var et=this.bb.capacity()-this.vtables[h];if($==this.bb.readInt16(et)){for(var d=s.SIZEOF_SHORT;d<$;d+=s.SIZEOF_SHORT)if(this.bb.readInt16(tt+d)!=this.bb.readInt16(et+d))continue e;nt=this.vtables[h];break}}return nt?(this.space=this.bb.capacity()-c,this.bb.writeInt32(this.space,nt-c)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-c,this.offset()-c)),this.isNested=!1,c},s.Builder.prototype.finish=function(c,h,_){var $=_?s.SIZE_PREFIX_LENGTH:0;if(h){var nt=h;if(this.prep(this.minalign,s.SIZEOF_INT+s.FILE_IDENTIFIER_LENGTH+$),nt.length!=s.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+s.FILE_IDENTIFIER_LENGTH);for(var tt=s.FILE_IDENTIFIER_LENGTH-1;tt>=0;tt--)this.writeInt8(nt.charCodeAt(tt))}this.prep(this.minalign,s.SIZEOF_INT+$),this.addOffset(c),$&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},s.Builder.prototype.finishSizePrefixed=function(c,h){this.finish(c,h,!0)},s.Builder.prototype.requiredField=function(c,h){var _=this.bb.capacity()-c,$=_-this.bb.readInt32(_);if(this.bb.readInt16($+h)==0)throw new Error("FlatBuffers: field "+h+" must be set")},s.Builder.prototype.startVector=function(c,h,_){this.notNested(),this.vector_num_elems=h,this.prep(s.SIZEOF_INT,c*h),this.prep(_,c*h)},s.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},s.Builder.prototype.createString=function(c){if(c instanceof Uint8Array)var h=c;else{h=[];for(var _=0;_<c.length;){var $,nt=c.charCodeAt(_++);($=nt<55296||nt>=56320?nt:(nt<<10)+c.charCodeAt(_++)+-56613888)<128?h.push($):($<2048?h.push($>>6&31|192):($<65536?h.push($>>12&15|224):h.push($>>18&7|240,$>>12&63|128),h.push($>>6&63|128)),h.push(63&$|128))}}this.addInt8(0),this.startVector(1,h.length,1),this.bb.setPosition(this.space-=h.length),_=0;for(var tt=this.space,et=this.bb.bytes();_<h.length;_++)et[tt++]=h[_];return this.endVector()},s.Builder.prototype.createLong=function(c,h){return s.Long.create(c,h)},s.ByteBuffer=function(c){this.bytes_=c,this.position_=0},s.ByteBuffer.allocate=function(c){return new s.ByteBuffer(new Uint8Array(c))},s.ByteBuffer.prototype.clear=function(){this.position_=0},s.ByteBuffer.prototype.bytes=function(){return this.bytes_},s.ByteBuffer.prototype.position=function(){return this.position_},s.ByteBuffer.prototype.setPosition=function(c){this.position_=c},s.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},s.ByteBuffer.prototype.readInt8=function(c){return this.readUint8(c)<<24>>24},s.ByteBuffer.prototype.readUint8=function(c){return this.bytes_[c]},s.ByteBuffer.prototype.readInt16=function(c){return this.readUint16(c)<<16>>16},s.ByteBuffer.prototype.readUint16=function(c){return this.bytes_[c]|this.bytes_[c+1]<<8},s.ByteBuffer.prototype.readInt32=function(c){return this.bytes_[c]|this.bytes_[c+1]<<8|this.bytes_[c+2]<<16|this.bytes_[c+3]<<24},s.ByteBuffer.prototype.readUint32=function(c){return this.readInt32(c)>>>0},s.ByteBuffer.prototype.readInt64=function(c){return new s.Long(this.readInt32(c),this.readInt32(c+4))},s.ByteBuffer.prototype.readUint64=function(c){return new s.Long(this.readUint32(c),this.readUint32(c+4))},s.ByteBuffer.prototype.readFloat32=function(c){return s.int32[0]=this.readInt32(c),s.float32[0]},s.ByteBuffer.prototype.readFloat64=function(c){return s.int32[s.isLittleEndian?0:1]=this.readInt32(c),s.int32[s.isLittleEndian?1:0]=this.readInt32(c+4),s.float64[0]},s.ByteBuffer.prototype.writeInt8=function(c,h){this.bytes_[c]=h},s.ByteBuffer.prototype.writeUint8=function(c,h){this.bytes_[c]=h},s.ByteBuffer.prototype.writeInt16=function(c,h){this.bytes_[c]=h,this.bytes_[c+1]=h>>8},s.ByteBuffer.prototype.writeUint16=function(c,h){this.bytes_[c]=h,this.bytes_[c+1]=h>>8},s.ByteBuffer.prototype.writeInt32=function(c,h){this.bytes_[c]=h,this.bytes_[c+1]=h>>8,this.bytes_[c+2]=h>>16,this.bytes_[c+3]=h>>24},s.ByteBuffer.prototype.writeUint32=function(c,h){this.bytes_[c]=h,this.bytes_[c+1]=h>>8,this.bytes_[c+2]=h>>16,this.bytes_[c+3]=h>>24},s.ByteBuffer.prototype.writeInt64=function(c,h){this.writeInt32(c,h.low),this.writeInt32(c+4,h.high)},s.ByteBuffer.prototype.writeUint64=function(c,h){this.writeUint32(c,h.low),this.writeUint32(c+4,h.high)},s.ByteBuffer.prototype.writeFloat32=function(c,h){s.float32[0]=h,this.writeInt32(c,s.int32[0])},s.ByteBuffer.prototype.writeFloat64=function(c,h){s.float64[0]=h,this.writeInt32(c,s.int32[s.isLittleEndian?0:1]),this.writeInt32(c+4,s.int32[s.isLittleEndian?1:0])},s.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+s.SIZEOF_INT+s.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var c="",h=0;h<s.FILE_IDENTIFIER_LENGTH;h++)c+=String.fromCharCode(this.readInt8(this.position_+s.SIZEOF_INT+h));return c},s.ByteBuffer.prototype.__offset=function(c,h){var _=c-this.readInt32(c);return h<this.readInt16(_)?this.readInt16(_+h):0},s.ByteBuffer.prototype.__union=function(c,h){return c.bb_pos=h+this.readInt32(h),c.bb=this,c},s.ByteBuffer.prototype.__string=function(c,h){c+=this.readInt32(c);var _=this.readInt32(c),$="",nt=0;if(c+=s.SIZEOF_INT,h===s.Encoding.UTF8_BYTES)return this.bytes_.subarray(c,c+_);for(;nt<_;){var tt,et=this.readUint8(c+nt++);if(et<192)tt=et;else{var d=this.readUint8(c+nt++);if(et<224)tt=(31&et)<<6|63&d;else{var a=this.readUint8(c+nt++);tt=et<240?(15&et)<<12|(63&d)<<6|63&a:(7&et)<<18|(63&d)<<12|(63&a)<<6|63&this.readUint8(c+nt++)}}tt<65536?$+=String.fromCharCode(tt):(tt-=65536,$+=String.fromCharCode(55296+(tt>>10),56320+(1023&tt)))}return $},s.ByteBuffer.prototype.__indirect=function(c){return c+this.readInt32(c)},s.ByteBuffer.prototype.__vector=function(c){return c+this.readInt32(c)+s.SIZEOF_INT},s.ByteBuffer.prototype.__vector_len=function(c){return this.readInt32(c+this.readInt32(c))},s.ByteBuffer.prototype.__has_identifier=function(c){if(c.length!=s.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+s.FILE_IDENTIFIER_LENGTH);for(var h=0;h<s.FILE_IDENTIFIER_LENGTH;h++)if(c.charCodeAt(h)!=this.readInt8(this.position_+s.SIZEOF_INT+h))return!1;return!0},s.ByteBuffer.prototype.createLong=function(c,h){return s.Long.create(c,h)}}},__webpack_module_cache__={};function __webpack_require__(i){var e=__webpack_module_cache__[i];if(e!==void 0)return e.exports;var o=__webpack_module_cache__[i]={exports:{}};return __webpack_modules__[i].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.n=i=>{var e=i&&i.__esModule?()=>i.default:()=>i;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(i,e)=>{for(var o in e)__webpack_require__.o(e,o)&&!__webpack_require__.o(i,o)&&Object.defineProperty(i,o,{enumerable:!0,get:e[o]})},__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),__webpack_require__.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),__webpack_require__.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(6018);return __webpack_exports__})())})(ortWeb_min$1);var ortWeb_minExports=ortWeb_min$1.exports;const ortWeb_min=getDefaultExportFromCjs(ortWeb_minExports),ONNX_WEB=_mergeNamespaces({__proto__:null,default:ortWeb_min},[ortWeb_minExports]);let ONNX;const executionProviders=["wasm"];var Uo;typeof process<"u"&&((Uo=process==null?void 0:process.release)==null?void 0:Uo.name)==="node"?(ONNX=sharp??ONNX_NODE,executionProviders.unshift("cpu")):(ONNX=ortWeb_min??ONNX_WEB,typeof navigator<"u"&&/iP(hone|od|ad).+16_4.+AppleWebKit/.test(navigator.userAgent)&&(ONNX.env.wasm.simd=!1));const{env:onnx_env}=ONNX,VERSION="2.17.2",WEB_CACHE_AVAILABLE=typeof self<"u"&&"caches"in self,FS_AVAILABLE=!isEmpty(sharp),PATH_AVAILABLE=!isEmpty(sharp),RUNNING_LOCALLY=FS_AVAILABLE&&PATH_AVAILABLE,__dirname=RUNNING_LOCALLY?sharp.dirname(sharp.dirname(sharp.fileURLToPath(import.meta.url))):"./",DEFAULT_CACHE_DIR=RUNNING_LOCALLY?sharp.join(__dirname,"/.cache/"):null,DEFAULT_LOCAL_MODEL_PATH="/models/",localModelPath=RUNNING_LOCALLY?sharp.join(__dirname,DEFAULT_LOCAL_MODEL_PATH):DEFAULT_LOCAL_MODEL_PATH;onnx_env!=null&&onnx_env.wasm&&(onnx_env.wasm.wasmPaths=RUNNING_LOCALLY?sharp.join(__dirname,"/dist/"):`https://cdn.jsdelivr.net/npm/@xenova/transformers@${VERSION}/dist/`);const env$1={version:VERSION,allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",localModelPath,useFS:FS_AVAILABLE,useBrowserCache:WEB_CACHE_AVAILABLE,useFSCache:FS_AVAILABLE,cacheDir:DEFAULT_CACHE_DIR,useCustomCache:!1};function isEmpty(i){return Object.keys(i).length===0}var define_process_env_default={};class FileResponse{constructor(e){qt(this,"_CONTENT_TYPE_MAP",{txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"});if(this.filePath=e,this.headers=new Headers,this.exists=sharp.existsSync(e),this.exists){this.status=200,this.statusText="OK";let o=sharp.statSync(e);this.headers.set("content-length",o.size.toString()),this.updateContentType();let s=this;this.body=new ReadableStream({start(c){s.arrayBuffer().then(h=>{c.enqueue(new Uint8Array(h)),c.close()})}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const e=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",this._CONTENT_TYPE_MAP[e]??"application/octet-stream")}clone(){let e=new FileResponse(this.filePath);return e.exists=this.exists,e.status=this.status,e.statusText=this.statusText,e.headers=new Headers(this.headers),e}async arrayBuffer(){return(await sharp.promises.readFile(this.filePath)).buffer}async blob(){const e=await sharp.promises.readFile(this.filePath);return new Blob([e],{type:this.headers.get("content-type")})}async text(){return await sharp.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function isValidUrl(i,e=null,o=null){let s;try{s=new URL(i)}catch{return!1}return!(e&&!e.includes(s.protocol)||o&&!o.includes(s.hostname))}async function getFile(i){var e;if(env$1.useFS&&!isValidUrl(i,["http:","https:","blob:"]))return new FileResponse(i);if(typeof process<"u"&&((e=process==null?void 0:process.release)==null?void 0:e.name)==="node"){const o=!!(define_process_env_default!=null&&define_process_env_default.TESTING_REMOTELY),s=env$1.version,c=new Headers;if(c.set("User-Agent",`transformers.js/${s}; is_ci/${o};`),isValidUrl(i,["http:","https:"],["huggingface.co","hf.co"])){const _=(define_process_env_default==null?void 0:define_process_env_default.HF_TOKEN)??(define_process_env_default==null?void 0:define_process_env_default.HF_ACCESS_TOKEN);_&&c.set("Authorization",`Bearer ${_}`)}return fetch(i,{headers:c})}else return fetch(i)}const ERROR_MAPPING={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function handleError(i,e,o){if(!o)return null;const s=ERROR_MAPPING[i]??`Error (${i}) occurred while trying to load file`;throw Error(`${s}: "${e}".`)}class FileCache{constructor(e){this.path=e}async match(e){let o=sharp.join(this.path,e),s=new FileResponse(o);if(s.exists)return s}async put(e,o){const s=Buffer.from(await o.arrayBuffer());let c=sharp.join(this.path,e);try{await sharp.promises.mkdir(sharp.dirname(c),{recursive:!0}),await sharp.promises.writeFile(c,s)}catch(h){console.warn("An error occurred while writing the file to cache:",h)}}}async function tryCache(i,...e){for(let o of e)try{let s=await i.match(o);if(s)return s}catch{continue}}async function getModelFile(i,e,o=!0,s={}){dispatchCallback(s.progress_callback,{status:"initiate",name:i,file:e});let c;if(!c&&env$1.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{c=await caches.open("transformers-cache")}catch(it){console.warn("An error occurred while opening the browser cache:",it)}}if(!c&&env$1.useFSCache&&(c=new FileCache(s.cache_dir??env$1.cacheDir)),!c&&env$1.useCustomCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");const h=s.revision??"main";let _=pathJoin(i,e),$=pathJoin(env$1.localModelPath,_),nt=pathJoin(env$1.remoteHost,env$1.remotePathTemplate.replaceAll("{model}",i).replaceAll("{revision}",encodeURIComponent(h)),e),tt=h==="main"?_:pathJoin(i,h,e),et,d=c instanceof FileCache?tt:nt,a=!1,g;c&&(g=await tryCache(c,$,d));const j=g!==void 0;if(g===void 0){if(isValidUrl(_,["http:","https:"])){if(s.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${_}.`)}else try{g=await getFile($),et=$}catch(at){console.warn(`Unable to load from local path "${$}": "${at}"`)}if(g===void 0||g.status===404){if(s.local_files_only||!env$1.allowRemoteModels){if(o)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${$}".`);return null}if(g=await getFile(nt),g.status!==200)return handleError(g.status,nt,o);et=d}a=c&&typeof Response<"u"&&g instanceof Response&&g.status===200}dispatchCallback(s.progress_callback,{status:"download",name:i,file:e});const rt={status:"progress",name:i,file:e};let ot;return s.progress_callback?j&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(ot=new Uint8Array(await g.arrayBuffer()),dispatchCallback(s.progress_callback,{...rt,progress:100,loaded:ot.length,total:ot.length})):ot=await readResponse(g,it=>{dispatchCallback(s.progress_callback,{...rt,...it})}):ot=new Uint8Array(await g.arrayBuffer()),a&&et&&await c.match(et)===void 0&&await c.put(et,new Response(ot,{headers:g.headers})).catch(it=>{console.warn(`Unable to add response to browser cache: ${it}.`)}),dispatchCallback(s.progress_callback,{status:"done",name:i,file:e}),ot}async function getModelJSON(i,e,o=!0,s={}){let c=await getModelFile(i,e,o,s);if(c===null)return{};let _=new TextDecoder("utf-8").decode(c);return JSON.parse(_)}async function readResponse(i,e){const o=i.headers.get("Content-Length");o===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let s=parseInt(o??"0"),c=new Uint8Array(s),h=0;const _=i.body.getReader();async function $(){const{done:nt,value:tt}=await _.read();if(nt)return;let et=h+tt.length;if(et>s){s=et;let a=new Uint8Array(s);a.set(c),c=a}c.set(tt,h),h=et;const d=h/s*100;return e({progress:d,loaded:h,total:s}),$()}return await $(),c}function pathJoin(...i){return i=i.map((e,o)=>(o&&(e=e.replace(new RegExp("^/"),"")),o!==i.length-1&&(e=e.replace(new RegExp("/$"),"")),e)),i.join("/")}function interpolate_data(i,[e,o,s],[c,h],_="bilinear",$=!1){const nt=h/s,tt=c/o,et=new i.constructor(c*h*e),d=o*s,a=c*h;for(let g=0;g<c;++g)for(let j=0;j<h;++j){const rt=g*h+j,ot=(j+.5)/nt-.5,it=(g+.5)/tt-.5;let at=Math.floor(ot),lt=Math.floor(it);const ct=Math.min(at+1,s-1),dt=Math.min(lt+1,o-1);at=Math.max(at,0),lt=Math.max(lt,0);const mt=ot-at,ht=it-lt,ft=(1-mt)*(1-ht),ut=mt*(1-ht),_t=(1-mt)*ht,bt=mt*ht,vt=lt*s,Tt=dt*s,Mt=vt+at,xt=vt+ct,Pt=Tt+at,It=Tt+ct;for(let Dt=0;Dt<e;++Dt){const Ct=Dt*d;et[Dt*a+rt]=ft*i[Ct+Mt]+ut*i[Ct+xt]+_t*i[Ct+Pt]+bt*i[Ct+It]}}return et}function permute_data(i,e,o){const s=new Array(o.length),c=new Array(o.length);for(let $=o.length-1,nt=1;$>=0;--$)c[$]=nt,s[$]=e[o[$]],nt*=s[$];const h=o.map(($,nt)=>c[o.indexOf(nt)]),_=new i.constructor(i.length);for(let $=0;$<i.length;++$){let nt=0;for(let tt=e.length-1,et=$;tt>=0;--tt)nt+=et%e[tt]*h[tt],et=Math.floor(et/e[tt]);_[nt]=i[$]}return[_,s]}function softmax(i){const e=max(i)[0],o=i.map(h=>Math.exp(h-e)),s=o.reduce((h,_)=>h+_,0);return o.map(h=>h/s)}function log_softmax(i){return softmax(i).map(s=>Math.log(s))}function getTopItems(i,e=0){return i=Array.from(i).map((o,s)=>[s,o]).sort((o,s)=>s[1]-o[1]),e!==null&&e>0&&(i=i.slice(0,e)),i}function min(i){if(i.length===0)throw Error("Array must not be empty");let e=i[0],o=0;for(let s=1;s<i.length;++s)i[s]<e&&(e=i[s],o=s);return[e,o]}function max(i){if(i.length===0)throw Error("Array must not be empty");let e=i[0],o=0;for(let s=1;s<i.length;++s)i[s]>e&&(e=i[s],o=s);return[Number(e),o]}function isPowerOfTwo(i){return i>0&&(i&i-1)===0}class P2FFT{constructor(e){if(this.size=e|0,this.size<=1||!isPowerOfTwo(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=e<<1,this.table=new Float64Array(this.size*2);for(let s=0;s<this.table.length;s+=2){const c=Math.PI*s/this.size;this.table[s]=Math.cos(c),this.table[s+1]=-Math.sin(c)}let o=0;for(let s=1;this.size>s;s<<=1)++o;this._width=o%2===0?o-1:o,this._bitrev=new Int32Array(1<<this._width);for(let s=0;s<this._bitrev.length;++s){this._bitrev[s]=0;for(let c=0;c<this._width;c+=2){const h=this._width-c-2;this._bitrev[s]|=(s>>>c&3)<<h}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(e,o){const s=o||new Array(e.length>>>1);for(let c=0;c<e.length;c+=2)s[c>>>1]=e[c];return s}toComplexArray(e,o){const s=o||this.createComplexArray();for(let c=0;c<s.length;c+=2)s[c]=e[c>>>1],s[c+1]=0;return s}transform(e,o){if(e===o)throw new Error("Input and output buffers must be different");this._transform4(e,o,1)}realTransform(e,o){if(e===o)throw new Error("Input and output buffers must be different");this._realTransform4(e,o,1)}inverseTransform(e,o){if(e===o)throw new Error("Input and output buffers must be different");this._transform4(e,o,-1);for(let s=0;s<e.length;++s)e[s]/=this.size}_transform4(e,o,s){const c=this._csize;let _=1<<this._width,$=c/_<<1,nt,tt;const et=this._bitrev;if($===4)for(nt=0,tt=0;nt<c;nt+=$,++tt){const a=et[tt];this._singleTransform2(o,e,nt,a,_)}else for(nt=0,tt=0;nt<c;nt+=$,++tt){const a=et[tt];this._singleTransform4(o,e,nt,a,_,s)}const d=this.table;for(_>>=2;_>=2;_>>=2){$=c/_<<1;const a=$>>>2;for(nt=0;nt<c;nt+=$){const g=nt+a-1;for(let j=nt,rt=0;j<g;j+=2,rt+=_){const ot=j,it=ot+a,at=it+a,lt=at+a,ct=e[ot],dt=e[ot+1],mt=e[it],ht=e[it+1],ft=e[at],ut=e[at+1],_t=e[lt],bt=e[lt+1],vt=d[rt],Tt=s*d[rt+1],Mt=mt*vt-ht*Tt,xt=mt*Tt+ht*vt,Pt=d[2*rt],It=s*d[2*rt+1],Dt=ft*Pt-ut*It,Ct=ft*It+ut*Pt,Gt=d[3*rt],Wt=s*d[3*rt+1],Qt=_t*Gt-bt*Wt,nn=_t*Wt+bt*Gt,un=ct+Dt,en=dt+Ct,cn=ct-Dt,an=dt-Ct,kn=Mt+Qt,jn=xt+nn,bn=s*(Mt-Qt),xn=s*(xt-nn);e[ot]=un+kn,e[ot+1]=en+jn,e[it]=cn+xn,e[it+1]=an-bn,e[at]=un-kn,e[at+1]=en-jn,e[lt]=cn-xn,e[lt+1]=an+bn}}}}_singleTransform2(e,o,s,c,h){const _=e[c],$=e[c+1],nt=e[c+h],tt=e[c+h+1];o[s]=_+nt,o[s+1]=$+tt,o[s+2]=_-nt,o[s+3]=$-tt}_singleTransform4(e,o,s,c,h,_){const $=h*2,nt=h*3,tt=e[c],et=e[c+1],d=e[c+h],a=e[c+h+1],g=e[c+$],j=e[c+$+1],rt=e[c+nt],ot=e[c+nt+1],it=tt+g,at=et+j,lt=tt-g,ct=et-j,dt=d+rt,mt=a+ot,ht=_*(d-rt),ft=_*(a-ot);o[s]=it+dt,o[s+1]=at+mt,o[s+2]=lt+ft,o[s+3]=ct-ht,o[s+4]=it-dt,o[s+5]=at-mt,o[s+6]=lt-ft,o[s+7]=ct+ht}_realTransform4(e,o,s){const c=this._csize;let _=1<<this._width,$=c/_<<1,nt,tt;const et=this._bitrev;if($===4)for(nt=0,tt=0;nt<c;nt+=$,++tt){const g=et[tt];this._singleRealTransform2(o,e,nt,g>>>1,_>>>1)}else for(nt=0,tt=0;nt<c;nt+=$,++tt){const g=et[tt];this._singleRealTransform4(o,e,nt,g>>>1,_>>>1,s)}const d=this.table;for(_>>=2;_>=2;_>>=2){$=c/_<<1;const g=$>>>1,j=g>>>1,rt=j>>>1;for(nt=0;nt<c;nt+=$)for(let ot=0,it=0;ot<=rt;ot+=2,it+=_){const at=nt+ot,lt=at+j,ct=lt+j,dt=ct+j,mt=e[at],ht=e[at+1],ft=e[lt],ut=e[lt+1],_t=e[ct],bt=e[ct+1],vt=e[dt],Tt=e[dt+1],Mt=mt,xt=ht,Pt=d[it],It=s*d[it+1],Dt=ft*Pt-ut*It,Ct=ft*It+ut*Pt,Gt=d[2*it],Wt=s*d[2*it+1],Qt=_t*Gt-bt*Wt,nn=_t*Wt+bt*Gt,un=d[3*it],en=s*d[3*it+1],cn=vt*un-Tt*en,an=vt*en+Tt*un,kn=Mt+Qt,jn=xt+nn,bn=Mt-Qt,xn=xt-nn,On=Dt+cn,An=Ct+an,vn=s*(Dt-cn),Bn=s*(Ct-an);if(e[at]=kn+On,e[at+1]=jn+An,e[lt]=bn+Bn,e[lt+1]=xn-vn,ot===0){e[ct]=kn-On,e[ct+1]=jn-An;continue}if(ot===rt)continue;const zn=nt+j-ot,qn=nt+g-ot;e[zn]=bn-s*Bn,e[zn+1]=-xn-s*vn,e[qn]=kn-s*On,e[qn+1]=-jn+s*An}}const a=c>>>1;for(let g=2;g<a;g+=2)e[c-g]=e[g],e[c-g+1]=-e[g+1]}_singleRealTransform2(e,o,s,c,h){const _=e[c],$=e[c+h];o[s]=_+$,o[s+1]=0,o[s+2]=_-$,o[s+3]=0}_singleRealTransform4(e,o,s,c,h,_){const $=h*2,nt=h*3,tt=e[c],et=e[c+h],d=e[c+$],a=e[c+nt],g=tt+d,j=tt-d,rt=et+a,ot=_*(et-a);o[s]=g+rt,o[s+1]=0,o[s+2]=j,o[s+3]=-ot,o[s+4]=g-rt,o[s+5]=0,o[s+6]=j,o[s+7]=ot}}class NP2FFT{constructor(e){const o=2*(e-1),s=2*(2*e-1),c=2**Math.ceil(Math.log2(s));this.bufferSize=c,this._a=o;const h=new Float64Array(s),_=new Float64Array(c);this._chirpBuffer=new Float64Array(c),this._buffer1=new Float64Array(c),this._buffer2=new Float64Array(c),this._outBuffer1=new Float64Array(c),this._outBuffer2=new Float64Array(c);const $=-2*Math.PI/e,nt=Math.cos($),tt=Math.sin($);for(let et=0;et<s>>1;++et){const d=(et+1-e)**2/2,a=Math.sqrt(nt**2+tt**2)**d,g=d*Math.atan2(tt,nt),j=2*et;h[j]=a*Math.cos(g),h[j+1]=a*Math.sin(g),_[j]=h[j],_[j+1]=-h[j+1]}this._slicedChirpBuffer=h.subarray(o,s),this._f=new P2FFT(c>>1),this._f.transform(this._chirpBuffer,_)}_transform(e,o,s){const c=this._buffer1,h=this._buffer2,_=this._outBuffer1,$=this._outBuffer2,nt=this._chirpBuffer,tt=this._slicedChirpBuffer,et=this._a;if(s)for(let d=0;d<tt.length;d+=2){const a=d+1,g=d>>1,j=o[g];c[d]=j*tt[d],c[a]=j*tt[a]}else for(let d=0;d<tt.length;d+=2){const a=d+1;c[d]=o[d]*tt[d]-o[a]*tt[a],c[a]=o[d]*tt[a]+o[a]*tt[d]}this._f.transform(_,c);for(let d=0;d<nt.length;d+=2){const a=d+1;h[d]=_[d]*nt[d]-_[a]*nt[a],h[a]=_[d]*nt[a]+_[a]*nt[d]}this._f.inverseTransform($,h);for(let d=0;d<$.length;d+=2){const a=$[d+et],g=$[d+et+1],j=tt[d],rt=tt[d+1];e[d]=a*j-g*rt,e[d+1]=a*rt+g*j}}transform(e,o){this._transform(e,o,!1)}realTransform(e,o){this._transform(e,o,!0)}}class FFT{constructor(e){this.fft_length=e,this.isPowerOfTwo=isPowerOfTwo(e),this.isPowerOfTwo?(this.fft=new P2FFT(e),this.outputBufferSize=2*e):(this.fft=new NP2FFT(e),this.outputBufferSize=this.fft.bufferSize)}realTransform(e,o){this.fft.realTransform(e,o)}transform(e,o){this.fft.transform(e,o)}}function medianFilter(i,e){if(e%2===0||e<=0)throw new Error("Window size must be a positive odd number");const o=new i.constructor(i.length),s=new i.constructor(e),c=Math.floor(e/2);for(let h=0;h<i.length;++h){let _=0;for(let $=-c;$<=c;++$){let nt=h+$;nt<0?nt=Math.abs(nt):nt>=i.length&&(nt=2*(i.length-1)-nt),s[_++]=i[nt]}s.sort(),o[h]=s[c]}return o}function round(i,e){const o=Math.pow(10,e);return Math.round(i*o)/o}function bankers_round(i){const e=Math.round(i);return Math.abs(i)%1===.5?e%2===0?e:e-1:e}const DataTypeMap=Object.freeze({float32:Float32Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array}),ONNXTensor$1=ONNX.Tensor;class Tensor{constructor(...e){qt(this,"dims");qt(this,"type");qt(this,"data");qt(this,"size");return e[0]instanceof ONNXTensor$1?Object.assign(this,e[0]):Object.assign(this,new ONNXTensor$1(e[0],e[1],e[2])),new Proxy(this,{get:(o,s)=>{if(typeof s=="string"){let c=Number(s);if(Number.isInteger(c))return o._getitem(c)}return o[s]},set:(o,s,c)=>o[s]=c})}*[Symbol.iterator](){const[e,...o]=this.dims;if(o.length>0){const s=o.reduce((c,h)=>c*h);for(let c=0;c<e;++c)yield this._subarray(c,s,o)}else yield*this.data}_getitem(e){const[o,...s]=this.dims;if(e=safeIndex(e,o),s.length>0){const c=s.reduce((h,_)=>h*_);return this._subarray(e,c,s)}else return new Tensor(this.type,[this.data[e]],s)}indexOf(e){for(let o=0;o<this.data.length;++o)if(this.data[o]==e)return o;return-1}_subarray(e,o,s){const c=e*o,h=(e+1)*o,_="subarray"in this.data?this.data.subarray(c,h):this.data.slice(c,h);return new Tensor(this.type,_,s)}item(){if(this.data.length!==1)throw new Error(`a Tensor with ${this.data.length} elements cannot be converted to Scalar`);return this.data[0]}tolist(){return reshape(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){for(let e=0;e<this.data.length;++e)this.data[e]=1/(1+Math.exp(-this.data[e]));return this}mul(e){return this.clone().mul_(e)}mul_(e){for(let o=0;o<this.data.length;++o)this.data[o]*=e;return this}add(e){return this.clone().add_(e)}add_(e){for(let o=0;o<this.data.length;++o)this.data[o]+=e;return this}clone(){return new Tensor(this.type,this.data.slice(),this.dims.slice())}slice(...e){let o=[],s=[];for(let nt=0;nt<this.dims.length;++nt){let tt=e[nt];if(tt==null)s.push([0,this.dims[nt]]),o.push(this.dims[nt]);else if(typeof tt=="number")tt=safeIndex(tt,this.dims[nt],nt),s.push([tt,tt+1]);else if(Array.isArray(tt)&&tt.length===2){if(tt[0]>tt[1])throw new Error(`Invalid slice: ${tt}`);let et=[Math.max(tt[0],0),Math.min(tt[1],this.dims[nt])];s.push(et),o.push(et[1]-et[0])}else throw new Error(`Invalid slice: ${tt}`)}let c=s.map(([nt,tt])=>tt-nt),h=c.reduce((nt,tt)=>nt*tt),_=new this.data.constructor(h);const $=this.stride();for(let nt=0;nt<h;++nt){let tt=0;for(let et=c.length-1,d=nt;et>=0;--et){const a=c[et];tt+=(d%a+s[et][0])*$[et],d=Math.floor(d/a)}_[nt]=this.data[tt]}return new Tensor(this.type,_,o)}permute(...e){return permute(this,e)}transpose(...e){return this.permute(...e)}sum(e=null,o=!1){return this.norm(1,e,o)}norm(e="fro",o=null,s=!1){if(e==="fro")e=2;else if(typeof e=="string")throw Error(`Unsupported norm: ${e}`);if(o===null){let _=this.data.reduce(($,nt)=>$+nt**e,0)**(1/e);return new Tensor(this.type,[_],[])}o=safeIndex(o,this.dims.length);const c=this.dims.slice();c[o]=1;const h=new this.data.constructor(this.data.length/this.dims[o]);for(let _=0;_<this.data.length;++_){let $=0;for(let nt=this.dims.length-1,tt=_,et=1;nt>=0;--nt){const d=this.dims[nt];if(nt!==o){const a=tt%d;$+=a*et,et*=c[nt]}tt=Math.floor(tt/d)}h[$]+=this.data[_]**e}if(e!==1)for(let _=0;_<h.length;++_)h[_]=h[_]**(1/e);return s||c.splice(o,1),new Tensor(this.type,h,c)}normalize_(e=2,o=1){o=safeIndex(o,this.dims.length);const s=this.norm(e,o,!0);for(let c=0;c<this.data.length;++c){let h=0;for(let _=this.dims.length-1,$=c,nt=1;_>=0;--_){const tt=this.dims[_];if(_!==o){const et=$%tt;h+=et*nt,nt*=this.dims[_]}$=Math.floor($/tt)}this.data[c]/=s.data[h]}return this}normalize(e=2,o=1){return this.clone().normalize_(e,o)}stride(){return dimsToStride(this.dims)}squeeze(e=null){return new Tensor(this.type,this.data,calc_squeeze_dims(this.dims,e))}squeeze_(e=null){return this.dims=calc_squeeze_dims(this.dims,e),this}unsqueeze(e=null){return new Tensor(this.type,this.data,calc_unsqueeze_dims(this.dims,e))}unsqueeze_(e=null){return this.dims=calc_unsqueeze_dims(this.dims,e),this}flatten_(e=0,o=-1){o=(o+this.dims.length)%this.dims.length;let s=this.dims.slice(0,e),c=this.dims.slice(e,o+1),h=this.dims.slice(o+1);return this.dims=[...s,c.reduce((_,$)=>_*$,1),...h],this}flatten(e=0,o=-1){return this.clone().flatten_(e,o)}view(...e){let o=-1;for(let s=0;s<e.length;++s)if(e[s]===-1){if(o!==-1)throw new Error("Only one dimension can be inferred");o=s}if(o!==-1){const s=e.reduce((c,h,_)=>_!==o?c*h:c,1);e[o]=this.data.length/s}return new Tensor(this.type,this.data,e)}neg_(){for(let e=0;e<this.data.length;++e)this.data[e]=-this.data[e];return this}neg(){return this.clone().neg_()}clamp_(e,o){for(let s=0;s<this.data.length;++s)this.data[s]=Math.min(Math.max(this.data[s],e),o);return this}clamp(e,o){return this.clone().clamp_(e,o)}round_(){for(let e=0;e<this.data.length;++e)this.data[e]=Math.round(this.data[e]);return this}round(){return this.clone().round_()}to(e){if(this.type===e)return this;if(!DataTypeMap.hasOwnProperty(e))throw new Error(`Unsupported type: ${e}`);return new Tensor(e,DataTypeMap[e].from(this.data),this.dims)}}function reshape(i,e){const o=i.length,s=e.reduce((h,_)=>h*_);if(o!==s)throw Error(`cannot reshape array of size ${o} into shape (${e})`);let c=i;for(let h=e.length-1;h>=0;h--)c=c.reduce((_,$)=>{let nt=_[_.length-1];return nt.length<e[h]?nt.push($):_.push([$]),_},[[]]);return c[0]}function permute(i,e){const[o,s]=permute_data(i.data,i.dims,e);return new Tensor(i.type,o,s)}function interpolate(i,[e,o],s="bilinear",c=!1){const h=i.dims.at(-3)??1,_=i.dims.at(-2),$=i.dims.at(-1);let nt=interpolate_data(i.data,[h,_,$],[e,o],s,c);return new Tensor(i.type,nt,[h,e,o])}function mean_pooling(i,e){let o=[i.dims[0],i.dims[2]],s=new i.data.constructor(o[0]*o[1]),[c,h,_]=i.dims,$=0;for(let nt=0;nt<c;++nt){let tt=nt*_*h;for(let et=0;et<_;++et){let d=0,a=0,g=nt*h,j=tt+et;for(let ot=0;ot<h;++ot){let it=Number(e.data[g+ot]);a+=it,d+=i.data[j+ot*_]*it}let rt=d/a;s[$++]=rt}}return new Tensor(i.type,s,o)}function calc_squeeze_dims(i,e){return i=i.slice(),e===null?i=i.filter(o=>o!==1):typeof e=="number"?i[e]===1&&i.splice(e,1):Array.isArray(e)&&(i=i.filter((o,s)=>o!==1||!e.includes(s))),i}function calc_unsqueeze_dims(i,e){return e=safeIndex(e,i.length+1),i=i.slice(),i.splice(e,0,1),i}function safeIndex(i,e,o=null){if(i<-e||i>=e)throw new Error(`IndexError: index ${i} is out of bounds for dimension${o===null?"":" "+o} with size ${e}`);return i<0&&(i=(i%e+e)%e),i}function cat(i,e=0){e=safeIndex(e,i[0].dims.length);const o=i[0].dims.slice();o[e]=i.reduce((_,$)=>_+$.dims[e],0);const s=o.reduce((_,$)=>_*$,1),c=new i[0].data.constructor(s),h=i[0].type;if(e===0){let _=0;for(let $ of i)c.set($.data,_),_+=$.data.length}else{let _=0;for(let $=0;$<i.length;++$){let nt=i[$];for(let tt=0;tt<nt.data.length;++tt){let et=0;for(let d=nt.dims.length-1,a=tt,g=1;d>=0;--d){const j=nt.dims[d];let rt=a%j;d===e&&(rt+=_),et+=rt*g,g*=o[d],a=Math.floor(a/j)}c[et]=nt.data[tt]}_+=nt.dims[e]}}return new Tensor(h,c,o)}function stack(i,e=0){return cat(i.map(o=>o.unsqueeze(e)),e)}function std_mean(i,e=null,o=1,s=!1){if(e===null){const tt=i.data.reduce((g,j)=>g+j,0)/i.data.length,et=Math.sqrt(i.data.reduce((g,j)=>g+(j-tt)**2,0)/(i.data.length-o)),d=new Tensor(i.type,[tt],[]);return[new Tensor(i.type,[et],[]),d]}e=safeIndex(e,i.dims.length);const c=mean(i,e,s),h=i.dims.slice();h[e]=1;const _=new i.data.constructor(i.data.length/i.dims[e]);for(let nt=0;nt<i.data.length;++nt){let tt=0;for(let et=i.dims.length-1,d=nt,a=1;et>=0;--et){const g=i.dims[et];if(et!==e){const j=d%g;tt+=j*a,a*=h[et]}d=Math.floor(d/g)}_[tt]+=(i.data[nt]-c.data[tt])**2}for(let nt=0;nt<_.length;++nt)_[nt]=Math.sqrt(_[nt]/(i.dims[e]-o));return s||h.splice(e,1),[new Tensor(i.type,_,h),c]}function mean(i,e=null,o=!1){if(e===null){let h=i.data.reduce((_,$)=>_+$,0);return new Tensor(i.type,[h/i.data.length],[])}e=safeIndex(e,i.dims.length);const s=i.dims.slice();s[e]=1;const c=new i.data.constructor(i.data.length/i.dims[e]);for(let h=0;h<i.data.length;++h){let _=0;for(let $=i.dims.length-1,nt=h,tt=1;$>=0;--$){const et=i.dims[$];if($!==e){const d=nt%et;_+=d*tt,tt*=s[$]}nt=Math.floor(nt/et)}c[_]+=i.data[h]}if(i.dims[e]!==1)for(let h=0;h<c.length;++h)c[h]=c[h]/i.dims[e];return o||s.splice(e,1),new Tensor(i.type,c,s)}function dynamicTimeWarping(i){const[e,o]=i.dims,s=[e+1,o+1],c=new Tensor("float32",new Float32Array(s[0]*s[1]).fill(1/0),s),h=new Tensor("float32",new Float32Array(s[0]*s[1]).fill(-1),s);c[0].data[0]=0;for(let et=1;et<o+1;++et)for(let d=1;d<e+1;++d){const a=c[d-1][et-1].item(),g=c[d-1][et].item(),j=c[d][et-1].item();let rt,ot;a<g&&a<j?(rt=a,ot=0):g<a&&g<j?(rt=g,ot=1):(rt=j,ot=2),c[d].data[et]=i[d-1][et-1].item()+rt,h[d].data[et]=ot}let _=e,$=o;h.data.fill(2,0,s[1]);for(let et=0;et<s[0];++et)h[et].data[0]=1;let nt=[],tt=[];for(;_>0||$>0;)switch(nt.push(_-1),tt.push($-1),h[_][$].item()){case 0:--_,--$;break;case 1:--_;break;case 2:--$;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${_}, ${$}]. Please file a bug report.`)}return nt.reverse(),tt.reverse(),[nt,tt]}function dimsToStride(i){const e=new Array(i.length);for(let o=i.length-1,s=1;o>=0;--o)e[o]=s,s*=i[o];return e}function ones(i){const e=i.reduce((o,s)=>o*s,1);return new Tensor("int64",new BigInt64Array(e).fill(1n),i)}function ones_like(i){return ones(i.dims)}function quantize_embeddings(i,e){if(i.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(i.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(e))throw new Error("The precision must be either 'binary' or 'ubinary'");const o=e==="binary",s=o?"int8":"uint8",c=o?Int8Array:Uint8Array,h=i.data,_=new c(h.length/8);for(let $=0;$<h.length;++$){const nt=h[$]>0?1:0,tt=Math.floor($/8),et=$%8;_[tt]|=nt<<7-et,o&&et===0&&(_[tt]-=128)}return new Tensor(s,_,[i.dims[0],i.dims[1]/8])}class PriorityQueue{constructor(e=(o,s)=>o>s){this._heap=[],this._comparator=e}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...e){return this.extend(e)}extend(e){for(const o of e)this._heap.push(o),this._siftUp();return this.size}pop(){const e=this.peek(),o=this.size-1;return o>0&&this._swap(0,o),this._heap.pop(),this._siftDown(),e}replace(e){const o=this.peek();return this._heap[0]=e,this._siftDown(),o}_parent(e){return(e+1>>>1)-1}_left(e){return(e<<1)+1}_right(e){return e+1<<1}_greater(e,o){return this._comparator(this._heap[e],this._heap[o])}_swap(e,o){const s=this._heap[e];this._heap[e]=this._heap[o],this._heap[o]=s}_siftUp(){let e=this.size-1;for(;e>0&&this._greater(e,this._parent(e));)this._swap(e,this._parent(e)),e=this._parent(e)}_siftDown(){let e=0;for(;this._left(e)<this.size&&this._greater(this._left(e),e)||this._right(e)<this.size&&this._greater(this._right(e),e);){const o=this._right(e)<this.size&&this._greater(this._right(e),this._left(e))?this._right(e):this._left(e);this._swap(e,o),e=o}}}class CharTrie{constructor(){this.root=CharTrieNode.default()}extend(e){for(let o of e)this.push(o)}push(e){let o=this.root;for(let s of e){let c=o.children.get(s);c===void 0&&(c=CharTrieNode.default(),o.children.set(s,c)),o=c}o.isLeaf=!0}*commonPrefixSearch(e){let o=this.root,s="";for(let c=0;c<e.length&&o!==void 0;++c){const h=e[c];s+=h,o=o.children.get(h),o!==void 0&&o.isLeaf&&(yield s)}}}class CharTrieNode{constructor(e,o){this.isLeaf=e,this.children=o}static default(){return new CharTrieNode(!1,new Map)}}class TokenLattice{constructor(e,o,s){this.sentence=e,this.len=e.length,this.bosTokenId=o,this.eosTokenId=s,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const c=new TokenLatticeNode(this.bosTokenId,0,0,0,0),h=new TokenLatticeNode(this.eosTokenId,1,this.len,0,0);this.nodes.push(c.clone()),this.nodes.push(h.clone()),this.beginNodes[this.len].push(h),this.endNodes[0].push(c)}insert(e,o,s,c){const h=this.nodes.length,_=new TokenLatticeNode(c,h,e,o,s);this.beginNodes[e].push(_),this.endNodes[e+o].push(_),this.nodes.push(_)}viterbi(){const e=this.len;let o=0;for(;o<=e;){if(this.beginNodes[o].length==0)return[];for(let $ of this.beginNodes[o]){$.prev=null;let nt=0,tt=null;for(let et of this.endNodes[o]){const d=et.backtraceScore+$.score;(tt===null||d>nt)&&(tt=et.clone(),nt=d)}if(tt!==null)$.prev=tt,$.backtraceScore=nt;else return[]}++o}const s=[],h=this.beginNodes[e][0].prev;if(h===null)return[];let _=h.clone();for(;_.prev!==null;)s.push(_.clone()),_=_.clone().prev.clone();return s.reverse(),s}piece(e){return this.sentence.slice(e.pos,e.pos+e.length)}tokens(){return this.viterbi().map(o=>this.piece(o))}tokenIds(){return this.viterbi().map(o=>o.tokenId)}}class TokenLatticeNode{constructor(e,o,s,c,h){this.tokenId=e,this.nodeId=o,this.pos=s,this.length=c,this.score=h,this.prev=null,this.backtraceScore=0}clone(){const e=new TokenLatticeNode(this.tokenId,this.nodeId,this.pos,this.length,this.score);return e.prev=this.prev,e.backtraceScore=this.backtraceScore,e}}var TOKEN_TYPES=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",BooleanLiteral:"BooleanLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Set:"Set",If:"If",For:"For",In:"In",Is:"Is",NotIn:"NotIn",Else:"Else",EndIf:"EndIf",ElseIf:"ElseIf",EndFor:"EndFor",And:"And",Or:"Or",Not:"UnaryOperator"}),KEYWORDS=Object.freeze({set:TOKEN_TYPES.Set,for:TOKEN_TYPES.For,in:TOKEN_TYPES.In,is:TOKEN_TYPES.Is,if:TOKEN_TYPES.If,else:TOKEN_TYPES.Else,endif:TOKEN_TYPES.EndIf,elif:TOKEN_TYPES.ElseIf,endfor:TOKEN_TYPES.EndFor,and:TOKEN_TYPES.And,or:TOKEN_TYPES.Or,not:TOKEN_TYPES.Not,"not in":TOKEN_TYPES.NotIn,true:TOKEN_TYPES.BooleanLiteral,false:TOKEN_TYPES.BooleanLiteral}),Token=class{constructor(i,e){this.value=i,this.type=e}};function isWord(i){return/\w/.test(i)}function isInteger(i){return/[0-9]/.test(i)}var ORDERED_MAPPING_TABLE=[["{%",TOKEN_TYPES.OpenStatement],["%}",TOKEN_TYPES.CloseStatement],["{{",TOKEN_TYPES.OpenExpression],["}}",TOKEN_TYPES.CloseExpression],["(",TOKEN_TYPES.OpenParen],[")",TOKEN_TYPES.CloseParen],["{",TOKEN_TYPES.OpenCurlyBracket],["}",TOKEN_TYPES.CloseCurlyBracket],["[",TOKEN_TYPES.OpenSquareBracket],["]",TOKEN_TYPES.CloseSquareBracket],[",",TOKEN_TYPES.Comma],[".",TOKEN_TYPES.Dot],[":",TOKEN_TYPES.Colon],["|",TOKEN_TYPES.Pipe],["<=",TOKEN_TYPES.ComparisonBinaryOperator],[">=",TOKEN_TYPES.ComparisonBinaryOperator],["==",TOKEN_TYPES.ComparisonBinaryOperator],["!=",TOKEN_TYPES.ComparisonBinaryOperator],["<",TOKEN_TYPES.ComparisonBinaryOperator],[">",TOKEN_TYPES.ComparisonBinaryOperator],["+",TOKEN_TYPES.AdditiveBinaryOperator],["-",TOKEN_TYPES.AdditiveBinaryOperator],["*",TOKEN_TYPES.MultiplicativeBinaryOperator],["/",TOKEN_TYPES.MultiplicativeBinaryOperator],["%",TOKEN_TYPES.MultiplicativeBinaryOperator],["=",TOKEN_TYPES.Equals]],ESCAPE_CHARACTERS=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function preprocess(i,e={}){return i.endsWith(`
`)&&(i=i.slice(0,-1)),i=i.replace(/{#.*?#}/gs,"{##}"),e.lstrip_blocks&&(i=i.replace(/^[ \t]*({[#%])/gm,"$1")),e.trim_blocks&&(i=i.replace(/([#%]})\n/g,"$1")),i.replace(/{##}/g,"").replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{")}function tokenize(i,e={}){var _,$,nt;const o=[],s=preprocess(i,e);let c=0;const h=tt=>{let et="";for(;tt(s[c]);){if(s[c]==="\\"){if(++c,c>=s.length)throw new SyntaxError("Unexpected end of input");const d=s[c++],a=ESCAPE_CHARACTERS.get(d);if(a===void 0)throw new SyntaxError(`Unexpected escaped character: ${d}`);et+=a;continue}if(et+=s[c++],c>=s.length)throw new SyntaxError("Unexpected end of input")}return et};e:for(;c<s.length;){const tt=(_=o.at(-1))==null?void 0:_.type;if(tt===void 0||tt===TOKEN_TYPES.CloseStatement||tt===TOKEN_TYPES.CloseExpression){let d="";for(;c<s.length&&!(s[c]==="{"&&(s[c+1]==="%"||s[c+1]==="{"));)d+=s[c++];if(d.length>0){o.push(new Token(d,TOKEN_TYPES.Text));continue}}h(d=>/\s/.test(d));const et=s[c];if(et==="-"||et==="+"){const d=($=o.at(-1))==null?void 0:$.type;if(d===TOKEN_TYPES.Text||d===void 0)throw new SyntaxError(`Unexpected character: ${et}`);switch(d){case TOKEN_TYPES.Identifier:case TOKEN_TYPES.NumericLiteral:case TOKEN_TYPES.BooleanLiteral:case TOKEN_TYPES.StringLiteral:case TOKEN_TYPES.CloseParen:case TOKEN_TYPES.CloseSquareBracket:break;default:{++c;const a=h(isInteger);o.push(new Token(`${et}${a}`,a.length>0?TOKEN_TYPES.NumericLiteral:TOKEN_TYPES.UnaryOperator));continue}}}for(const[d,a]of ORDERED_MAPPING_TABLE)if(s.slice(c,c+d.length)===d){o.push(new Token(d,a)),c+=d.length;continue e}if(et==="'"||et==='"'){++c;const d=h(a=>a!==et);o.push(new Token(d,TOKEN_TYPES.StringLiteral)),++c;continue}if(isInteger(et)){const d=h(isInteger);o.push(new Token(d,TOKEN_TYPES.NumericLiteral));continue}if(isWord(et)){const d=h(isWord),a=Object.hasOwn(KEYWORDS,d)?KEYWORDS[d]:TOKEN_TYPES.Identifier;a===TOKEN_TYPES.In&&((nt=o.at(-1))==null?void 0:nt.type)===TOKEN_TYPES.Not?(o.pop(),o.push(new Token("not in",TOKEN_TYPES.NotIn))):o.push(new Token(d,a));continue}throw new SyntaxError(`Unexpected character: ${et}`)}return o}var Statement=class{constructor(){qt(this,"type","Statement")}},Program=class extends Statement{constructor(e){super();qt(this,"type","Program");this.body=e}},If=class extends Statement{constructor(e,o,s){super();qt(this,"type","If");this.test=e,this.body=o,this.alternate=s}},For=class extends Statement{constructor(e,o,s){super();qt(this,"type","For");this.loopvar=e,this.iterable=o,this.body=s}},SetStatement=class extends Statement{constructor(e,o){super();qt(this,"type","Set");this.assignee=e,this.value=o}},Expression=class extends Statement{constructor(){super(...arguments);qt(this,"type","Expression")}},MemberExpression=class extends Expression{constructor(e,o,s){super();qt(this,"type","MemberExpression");this.object=e,this.property=o,this.computed=s}},CallExpression=class extends Expression{constructor(e,o){super();qt(this,"type","CallExpression");this.callee=e,this.args=o}},Identifier=class extends Expression{constructor(e){super();qt(this,"type","Identifier");this.value=e}},Literal=class extends Expression{constructor(e){super();qt(this,"type","Literal");this.value=e}},NumericLiteral=class extends Literal{constructor(){super(...arguments);qt(this,"type","NumericLiteral")}},StringLiteral=class extends Literal{constructor(){super(...arguments);qt(this,"type","StringLiteral")}},BooleanLiteral=class extends Literal{constructor(){super(...arguments);qt(this,"type","BooleanLiteral")}},ArrayLiteral=class extends Literal{constructor(){super(...arguments);qt(this,"type","ArrayLiteral")}},TupleLiteral=class extends Literal{constructor(){super(...arguments);qt(this,"type","TupleLiteral")}},ObjectLiteral=class extends Literal{constructor(){super(...arguments);qt(this,"type","ObjectLiteral")}},BinaryExpression=class extends Expression{constructor(e,o,s){super();qt(this,"type","BinaryExpression");this.operator=e,this.left=o,this.right=s}},FilterExpression=class extends Expression{constructor(e,o){super();qt(this,"type","FilterExpression");this.operand=e,this.filter=o}},TestExpression=class extends Expression{constructor(e,o,s){super();qt(this,"type","TestExpression");this.operand=e,this.negate=o,this.test=s}},UnaryExpression=class extends Expression{constructor(e,o){super();qt(this,"type","UnaryExpression");this.operator=e,this.argument=o}},SliceExpression=class extends Expression{constructor(e=void 0,o=void 0,s=void 0){super();qt(this,"type","SliceExpression");this.start=e,this.stop=o,this.step=s}},KeywordArgumentExpression=class extends Expression{constructor(e,o){super();qt(this,"type","KeywordArgumentExpression");this.key=e,this.value=o}};function parse(i){const e=new Program([]);let o=0;function s(xt,Pt){const It=i[o++];if(!It||It.type!==xt)throw new Error(`Parser Error: ${Pt}. ${It.type} !== ${xt}.`);return It}function c(){switch(i[o].type){case TOKEN_TYPES.Text:return $();case TOKEN_TYPES.OpenStatement:return nt();case TOKEN_TYPES.OpenExpression:return tt();default:throw new SyntaxError(`Unexpected token type: ${i[o].type}`)}}function h(...xt){return o+xt.length<=i.length&&xt.some((Pt,It)=>Pt!==i[o+It].type)}function _(...xt){return o+xt.length<=i.length&&xt.every((Pt,It)=>Pt===i[o+It].type)}function $(){return new StringLiteral(s(TOKEN_TYPES.Text,"Expected text token").value)}function nt(){s(TOKEN_TYPES.OpenStatement,"Expected opening statement token");let xt;switch(i[o].type){case TOKEN_TYPES.Set:++o,xt=et(),s(TOKEN_TYPES.CloseStatement,"Expected closing statement token");break;case TOKEN_TYPES.If:++o,xt=d(),s(TOKEN_TYPES.OpenStatement,"Expected {% token"),s(TOKEN_TYPES.EndIf,"Expected endif token"),s(TOKEN_TYPES.CloseStatement,"Expected %} token");break;case TOKEN_TYPES.For:++o,xt=g(),s(TOKEN_TYPES.OpenStatement,"Expected {% token"),s(TOKEN_TYPES.EndFor,"Expected endfor token"),s(TOKEN_TYPES.CloseStatement,"Expected %} token");break;default:throw new SyntaxError(`Unknown statement type: ${i[o].type}`)}return xt}function tt(){s(TOKEN_TYPES.OpenExpression,"Expected opening expression token");const xt=j();return s(TOKEN_TYPES.CloseExpression,"Expected closing expression token"),xt}function et(){const xt=j();if(_(TOKEN_TYPES.Equals)){++o;const Pt=et();return new SetStatement(xt,Pt)}return xt}function d(){var Dt,Ct,Gt,Wt,Qt,nn,un,en;const xt=j();s(TOKEN_TYPES.CloseStatement,"Expected closing statement token");const Pt=[],It=[];for(;!(((Dt=i[o])==null?void 0:Dt.type)===TOKEN_TYPES.OpenStatement&&(((Ct=i[o+1])==null?void 0:Ct.type)===TOKEN_TYPES.ElseIf||((Gt=i[o+1])==null?void 0:Gt.type)===TOKEN_TYPES.Else||((Wt=i[o+1])==null?void 0:Wt.type)===TOKEN_TYPES.EndIf));)Pt.push(c());if(((Qt=i[o])==null?void 0:Qt.type)===TOKEN_TYPES.OpenStatement&&((nn=i[o+1])==null?void 0:nn.type)!==TOKEN_TYPES.EndIf)if(++o,_(TOKEN_TYPES.ElseIf))s(TOKEN_TYPES.ElseIf,"Expected elseif token"),It.push(d());else for(s(TOKEN_TYPES.Else,"Expected else token"),s(TOKEN_TYPES.CloseStatement,"Expected closing statement token");!(((un=i[o])==null?void 0:un.type)===TOKEN_TYPES.OpenStatement&&((en=i[o+1])==null?void 0:en.type)===TOKEN_TYPES.EndIf);)It.push(c());return new If(xt,Pt,It)}function a(xt=!1){const Pt=xt?Mt:j,It=[Pt()],Dt=_(TOKEN_TYPES.Comma);for(;Dt&&(++o,It.push(Pt()),!!_(TOKEN_TYPES.Comma)););return Dt?new TupleLiteral(It):It[0]}function g(){const xt=a(!0);if(!(xt instanceof Identifier||xt instanceof TupleLiteral))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${xt.type} instead`);s(TOKEN_TYPES.In,"Expected `in` keyword following loop variable");const Pt=j();s(TOKEN_TYPES.CloseStatement,"Expected closing statement token");const It=[];for(;h(TOKEN_TYPES.OpenStatement,TOKEN_TYPES.EndFor);)It.push(c());return new For(xt,Pt,It)}function j(){return rt()}function rt(){const xt=ot();if(_(TOKEN_TYPES.If)){++o;const Pt=ot();s(TOKEN_TYPES.Else,"Expected else token");const It=ot();return new If(Pt,[xt],[It])}return xt}function ot(){let xt=it();for(;_(TOKEN_TYPES.Or);){const Pt=i[o];++o;const It=it();xt=new BinaryExpression(Pt,xt,It)}return xt}function it(){let xt=at();for(;_(TOKEN_TYPES.And);){const Pt=i[o];++o;const It=at();xt=new BinaryExpression(Pt,xt,It)}return xt}function at(){let xt;for(;_(TOKEN_TYPES.Not);){const Pt=i[o];++o;const It=at();xt=new UnaryExpression(Pt,It)}return xt??lt()}function lt(){let xt=ct();for(;_(TOKEN_TYPES.ComparisonBinaryOperator)||_(TOKEN_TYPES.In)||_(TOKEN_TYPES.NotIn);){const Pt=i[o];++o;const It=ct();xt=new BinaryExpression(Pt,xt,It)}return xt}function ct(){let xt=bt();for(;_(TOKEN_TYPES.AdditiveBinaryOperator);){const Pt=i[o];++o;const It=bt();xt=new BinaryExpression(Pt,xt,It)}return xt}function dt(){const xt=_t();return _(TOKEN_TYPES.OpenParen)?mt(xt):xt}function mt(xt){let Pt=new CallExpression(xt,ht());return _(TOKEN_TYPES.OpenParen)&&(Pt=mt(Pt)),Pt}function ht(){s(TOKEN_TYPES.OpenParen,"Expected opening parenthesis for arguments list");const xt=ft();return s(TOKEN_TYPES.CloseParen,"Expected closing parenthesis for arguments list"),xt}function ft(){const xt=[];for(;!_(TOKEN_TYPES.CloseParen);){let Pt=j();if(_(TOKEN_TYPES.Equals)){if(++o,!(Pt instanceof Identifier))throw new SyntaxError("Expected identifier for keyword argument");const It=j();Pt=new KeywordArgumentExpression(Pt,It)}xt.push(Pt),_(TOKEN_TYPES.Comma)&&++o}return xt}function ut(){const xt=[];let Pt=!1;for(;!_(TOKEN_TYPES.CloseSquareBracket);)_(TOKEN_TYPES.Colon)?(xt.push(void 0),++o,Pt=!0):(xt.push(j()),_(TOKEN_TYPES.Colon)&&(++o,Pt=!0));if(xt.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(Pt){if(xt.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new SliceExpression(...xt)}return xt[0]}function _t(){let xt=Mt();for(;_(TOKEN_TYPES.Dot)||_(TOKEN_TYPES.OpenSquareBracket);){const Pt=i[o];++o;let It;const Dt=Pt.type!==TOKEN_TYPES.Dot;if(Dt)It=ut(),s(TOKEN_TYPES.CloseSquareBracket,"Expected closing square bracket");else if(It=Mt(),It.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");xt=new MemberExpression(xt,It,Dt)}return xt}function bt(){let xt=vt();for(;_(TOKEN_TYPES.MultiplicativeBinaryOperator);){const Pt=i[o];++o;const It=vt();xt=new BinaryExpression(Pt,xt,It)}return xt}function vt(){let xt=Tt();for(;_(TOKEN_TYPES.Is);){++o;const Pt=_(TOKEN_TYPES.Not);Pt&&++o;let It=Mt();if(It instanceof BooleanLiteral&&(It=new Identifier(It.value.toString())),!(It instanceof Identifier))throw new SyntaxError("Expected identifier for the test");xt=new TestExpression(xt,Pt,It)}return xt}function Tt(){let xt=dt();for(;_(TOKEN_TYPES.Pipe);){++o;let Pt=Mt();if(!(Pt instanceof Identifier))throw new SyntaxError("Expected identifier for the filter");_(TOKEN_TYPES.OpenParen)&&(Pt=mt(Pt)),xt=new FilterExpression(xt,Pt)}return xt}function Mt(){const xt=i[o];switch(xt.type){case TOKEN_TYPES.NumericLiteral:return++o,new NumericLiteral(Number(xt.value));case TOKEN_TYPES.StringLiteral:return++o,new StringLiteral(xt.value);case TOKEN_TYPES.BooleanLiteral:return++o,new BooleanLiteral(xt.value==="true");case TOKEN_TYPES.Identifier:return++o,new Identifier(xt.value);case TOKEN_TYPES.OpenParen:{++o;const Pt=a();if(i[o].type!==TOKEN_TYPES.CloseParen)throw new SyntaxError(`Expected closing parenthesis, got ${i[o].type} instead`);return++o,Pt}case TOKEN_TYPES.OpenSquareBracket:{++o;const Pt=[];for(;!_(TOKEN_TYPES.CloseSquareBracket);)Pt.push(j()),_(TOKEN_TYPES.Comma)&&++o;return++o,new ArrayLiteral(Pt)}case TOKEN_TYPES.OpenCurlyBracket:{++o;const Pt=new Map;for(;!_(TOKEN_TYPES.CloseCurlyBracket);){const It=j();s(TOKEN_TYPES.Colon,"Expected colon between key and value in object literal");const Dt=j();Pt.set(It,Dt),_(TOKEN_TYPES.Comma)&&++o}return++o,new ObjectLiteral(Pt)}default:throw new SyntaxError(`Unexpected token: ${xt.type}`)}}for(;o<i.length;)e.body.push(c());return e}function range(i,e,o=1){e===void 0&&(e=i,i=0);const s=[];for(let c=i;c<e;c+=o)s.push(c);return s}function slice(i,e,o,s=1){const c=Math.sign(s);c>=0?(e=(e??(e=0))<0?Math.max(i.length+e,0):Math.min(e,i.length),o=(o??(o=i.length))<0?Math.max(i.length+o,0):Math.min(o,i.length)):(e=(e??(e=i.length-1))<0?Math.max(i.length+e,-1):Math.min(e,i.length-1),o=(o??(o=-1))<-1?Math.max(i.length+o,-1):Math.min(o,i.length-1));const h=[];for(let _=e;c*_<c*o;_+=s)h.push(i[_]);return h}function titleCase(i){return i.replace(/\b\w/g,e=>e.toUpperCase())}var RuntimeValue=class{constructor(i=void 0){qt(this,"type","RuntimeValue");qt(this,"value");qt(this,"builtins",new Map);this.value=i}__bool__(){return new BooleanValue(!!this.value)}},NumericValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","NumericValue")}},StringValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","StringValue");qt(this,"builtins",new Map([["upper",new FunctionValue(()=>new StringValue(this.value.toUpperCase()))],["lower",new FunctionValue(()=>new StringValue(this.value.toLowerCase()))],["strip",new FunctionValue(()=>new StringValue(this.value.trim()))],["title",new FunctionValue(()=>new StringValue(titleCase(this.value)))],["length",new NumericValue(this.value.length)]]))}},BooleanValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","BooleanValue")}},ObjectValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","ObjectValue");qt(this,"builtins",new Map([["get",new FunctionValue(([e,o])=>{if(!(e instanceof StringValue))throw new Error(`Object key must be a string: got ${e.type}`);return this.value.get(e.value)??o??new NullValue})],["items",new FunctionValue(()=>new ArrayValue(Array.from(this.value.entries()).map(([e,o])=>new ArrayValue([new StringValue(e),o]))))]]))}__bool__(){return new BooleanValue(this.value.size>0)}},ArrayValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","ArrayValue");qt(this,"builtins",new Map([["length",new NumericValue(this.value.length)]]))}__bool__(){return new BooleanValue(this.value.length>0)}},TupleValue=class extends ArrayValue{constructor(){super(...arguments);qt(this,"type","TupleValue")}},FunctionValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","FunctionValue")}},NullValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","NullValue")}},UndefinedValue=class extends RuntimeValue{constructor(){super(...arguments);qt(this,"type","UndefinedValue")}},Environment=class{constructor(i){qt(this,"variables",new Map([["namespace",new FunctionValue(i=>{if(i.length===0)return new ObjectValue(new Map);if(i.length!==1||!(i[0]instanceof ObjectValue))throw new Error("`namespace` expects either zero arguments or a single object argument");return i[0]})]]));qt(this,"tests",new Map([["boolean",i=>i.type==="BooleanValue"],["callable",i=>i instanceof FunctionValue],["odd",i=>{if(i.type!=="NumericValue")throw new Error(`Cannot apply test "odd" to type: ${i.type}`);return i.value%2!==0}],["even",i=>{if(i.type!=="NumericValue")throw new Error(`Cannot apply test "even" to type: ${i.type}`);return i.value%2===0}],["false",i=>i.type==="BooleanValue"&&!i.value],["true",i=>i.type==="BooleanValue"&&i.value],["number",i=>i.type==="NumericValue"],["integer",i=>i.type==="NumericValue"&&Number.isInteger(i.value)],["iterable",i=>i instanceof ArrayValue||i instanceof StringValue],["lower",i=>{const e=i.value;return i.type==="StringValue"&&e===e.toLowerCase()}],["upper",i=>{const e=i.value;return i.type==="StringValue"&&e===e.toUpperCase()}],["none",i=>i.type==="NullValue"],["defined",i=>i.type!=="UndefinedValue"],["undefined",i=>i.type==="UndefinedValue"],["equalto",(i,e)=>i.value===e.value]]));this.parent=i}set(i,e){return this.declareVariable(i,convertToRuntimeValues(e))}declareVariable(i,e){if(this.variables.has(i))throw new SyntaxError(`Variable already declared: ${i}`);return this.variables.set(i,e),e}setVariable(i,e){return this.variables.set(i,e),e}resolve(i){if(this.variables.has(i))return this;if(this.parent)return this.parent.resolve(i);throw new Error(`Unknown variable: ${i}`)}lookupVariable(i){try{return this.resolve(i).variables.get(i)??new UndefinedValue}catch{return new UndefinedValue}}},Interpreter=class{constructor(i){qt(this,"global");this.global=i??new Environment}run(i){return this.evaluate(i,this.global)}evaluateBinaryExpression(i,e){const o=this.evaluate(i.left,e);switch(i.operator.value){case"and":return o.__bool__().value?this.evaluate(i.right,e):o;case"or":return o.__bool__().value?o:this.evaluate(i.right,e)}const s=this.evaluate(i.right,e);switch(i.operator.value){case"==":return new BooleanValue(o.value==s.value);case"!=":return new BooleanValue(o.value!=s.value)}if(o instanceof UndefinedValue||s instanceof UndefinedValue)throw new Error("Cannot perform operation on undefined values");if(o instanceof NullValue||s instanceof NullValue)throw new Error("Cannot perform operation on null values");if(o instanceof NumericValue&&s instanceof NumericValue)switch(i.operator.value){case"+":return new NumericValue(o.value+s.value);case"-":return new NumericValue(o.value-s.value);case"*":return new NumericValue(o.value*s.value);case"/":return new NumericValue(o.value/s.value);case"%":return new NumericValue(o.value%s.value);case"<":return new BooleanValue(o.value<s.value);case">":return new BooleanValue(o.value>s.value);case">=":return new BooleanValue(o.value>=s.value);case"<=":return new BooleanValue(o.value<=s.value)}else if(o instanceof ArrayValue&&s instanceof ArrayValue)switch(i.operator.value){case"+":return new ArrayValue(o.value.concat(s.value))}else if(s instanceof ArrayValue){const c=s.value.find(h=>h.value===o.value)!==void 0;switch(i.operator.value){case"in":return new BooleanValue(c);case"not in":return new BooleanValue(!c)}}if(o instanceof StringValue||s instanceof StringValue)switch(i.operator.value){case"+":return new StringValue(o.value.toString()+s.value.toString())}if(o instanceof StringValue&&s instanceof StringValue)switch(i.operator.value){case"in":return new BooleanValue(s.value.includes(o.value));case"not in":return new BooleanValue(!s.value.includes(o.value))}if(o instanceof StringValue&&s instanceof ObjectValue)switch(i.operator.value){case"in":return new BooleanValue(s.value.has(o.value));case"not in":return new BooleanValue(!s.value.has(o.value))}throw new SyntaxError(`Unknown operator "${i.operator.value}" between ${o.type} and ${s.type}`)}evaluateFilterExpression(i,e){const o=this.evaluate(i.operand,e);if(i.filter.type==="Identifier"){const s=i.filter;if(o instanceof ArrayValue)switch(s.value){case"list":return o;case"first":return o.value[0];case"last":return o.value[o.value.length-1];case"length":return new NumericValue(o.value.length);case"reverse":return new ArrayValue(o.value.reverse());case"sort":return new ArrayValue(o.value.sort((c,h)=>{if(c.type!==h.type)throw new Error(`Cannot compare different types: ${c.type} and ${h.type}`);switch(c.type){case"NumericValue":return c.value-h.value;case"StringValue":return c.value.localeCompare(h.value);default:throw new Error(`Cannot compare type: ${c.type}`)}}));default:throw new Error(`Unknown ArrayValue filter: ${s.value}`)}else if(o instanceof StringValue)switch(s.value){case"length":return new NumericValue(o.value.length);case"upper":return new StringValue(o.value.toUpperCase());case"lower":return new StringValue(o.value.toLowerCase());case"title":return new StringValue(titleCase(o.value));case"capitalize":return new StringValue(o.value.charAt(0).toUpperCase()+o.value.slice(1));case"trim":return new StringValue(o.value.trim());default:throw new Error(`Unknown StringValue filter: ${s.value}`)}else if(o instanceof NumericValue)switch(s.value){case"abs":return new NumericValue(Math.abs(o.value));default:throw new Error(`Unknown NumericValue filter: ${s.value}`)}else if(o instanceof ObjectValue)switch(s.value){case"items":return new ArrayValue(Array.from(o.value.entries()).map(([c,h])=>new ArrayValue([new StringValue(c),h])));case"length":return new NumericValue(o.value.size);default:throw new Error(`Unknown ObjectValue filter: ${s.value}`)}throw new Error(`Cannot apply filter "${s.value}" to type: ${o.type}`)}else if(i.filter.type==="CallExpression"){const s=i.filter;if(s.callee.type!=="Identifier")throw new Error(`Unknown filter: ${s.callee.type}`);const c=s.callee.value;if(o instanceof ArrayValue){switch(c){case"selectattr":{if(o.value.some(et=>!(et instanceof ObjectValue)))throw new Error("`selectattr` can only be applied to array of objects");if(s.args.some(et=>et.type!=="StringLiteral"))throw new Error("arguments of `selectattr` must be strings");const[h,_,$]=s.args.map(et=>this.evaluate(et,e));let nt;if(_){const et=e.tests.get(_.value);if(!et)throw new Error(`Unknown test: ${_.value}`);nt=et}else nt=(...et)=>et[0].__bool__().value;const tt=o.value.filter(et=>{const d=et.value.get(h.value);return d?nt(d,$):!1});return new ArrayValue(tt)}}throw new Error(`Unknown ArrayValue filter: ${c}`)}else throw new Error(`Cannot apply filter "${c}" to type: ${o.type}`)}throw new Error(`Unknown filter: ${i.filter.type}`)}evaluateTestExpression(i,e){const o=this.evaluate(i.operand,e),s=e.tests.get(i.test.value);if(!s)throw new Error(`Unknown test: ${i.test.value}`);const c=s(o);return new BooleanValue(i.negate?!c:c)}evaluateUnaryExpression(i,e){const o=this.evaluate(i.argument,e);switch(i.operator.value){case"not":return new BooleanValue(!o.value);default:throw new SyntaxError(`Unknown operator: ${i.operator.value}`)}}evalProgram(i,e){return this.evaluateBlock(i.body,e)}evaluateBlock(i,e){let o="";for(const s of i){const c=this.evaluate(s,e);c.type!=="NullValue"&&c.type!=="UndefinedValue"&&(o+=c.value)}return new StringValue(o)}evaluateIdentifier(i,e){return e.lookupVariable(i.value)}evaluateCallExpression(i,e){const o=[],s=new Map;for(const h of i.args)if(h.type==="KeywordArgumentExpression"){const _=h;s.set(_.key.value,this.evaluate(_.value,e))}else o.push(this.evaluate(h,e));s.size>0&&o.push(new ObjectValue(s));const c=this.evaluate(i.callee,e);if(c.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${c.type}`);return c.value(o,e)}evaluateSliceExpression(i,e,o){if(!(i instanceof ArrayValue||i instanceof StringValue))throw new Error("Slice object must be an array or string");const s=this.evaluate(e.start,o),c=this.evaluate(e.stop,o),h=this.evaluate(e.step,o);if(!(s instanceof NumericValue||s instanceof UndefinedValue))throw new Error("Slice start must be numeric or undefined");if(!(c instanceof NumericValue||c instanceof UndefinedValue))throw new Error("Slice stop must be numeric or undefined");if(!(h instanceof NumericValue||h instanceof UndefinedValue))throw new Error("Slice step must be numeric or undefined");return i instanceof ArrayValue?new ArrayValue(slice(i.value,s.value,c.value,h.value)):new StringValue(slice(Array.from(i.value),s.value,c.value,h.value).join(""))}evaluateMemberExpression(i,e){const o=this.evaluate(i.object,e);let s;if(i.computed){if(i.property.type==="SliceExpression")return this.evaluateSliceExpression(o,i.property,e);s=this.evaluate(i.property,e)}else s=new StringValue(i.property.value);let c;if(o instanceof ObjectValue){if(!(s instanceof StringValue))throw new Error(`Cannot access property with non-string: got ${s.type}`);c=o.value.get(s.value)??o.builtins.get(s.value)}else if(o instanceof ArrayValue||o instanceof StringValue)if(s instanceof NumericValue)c=o.value.at(s.value),o instanceof StringValue&&(c=new StringValue(o.value.at(s.value)));else if(s instanceof StringValue)c=o.builtins.get(s.value);else throw new Error(`Cannot access property with non-string/non-number: got ${s.type}`);else{if(!(s instanceof StringValue))throw new Error(`Cannot access property with non-string: got ${s.type}`);c=o.builtins.get(s.value)}return c instanceof RuntimeValue?c:new UndefinedValue}evaluateSet(i,e){const o=this.evaluate(i.value,e);if(i.assignee.type==="Identifier"){const s=i.assignee.value;e.setVariable(s,o)}else if(i.assignee.type==="MemberExpression"){const s=i.assignee,c=this.evaluate(s.object,e);if(!(c instanceof ObjectValue))throw new Error("Cannot assign to member of non-object");if(s.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");c.value.set(s.property.value,o)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(i.assignee)}`);return new NullValue}evaluateIf(i,e){const o=this.evaluate(i.test,e);return this.evaluateBlock(o.__bool__().value?i.body:i.alternate,e)}evaluateFor(i,e){const o=new Environment(e),s=this.evaluate(i.iterable,o);if(!(s instanceof ArrayValue))throw new Error(`Expected iterable type in for loop: got ${s.type}`);let c="";for(let h=0;h<s.value.length;++h){const _=new Map([["index",new NumericValue(h+1)],["index0",new NumericValue(h)],["revindex",new NumericValue(s.value.length-h)],["revindex0",new NumericValue(s.value.length-h-1)],["first",new BooleanValue(h===0)],["last",new BooleanValue(h===s.value.length-1)],["length",new NumericValue(s.value.length)],["previtem",h>0?s.value[h-1]:new UndefinedValue],["nextitem",h<s.value.length-1?s.value[h+1]:new UndefinedValue]]);o.setVariable("loop",new ObjectValue(_));const $=s.value[h];if(i.loopvar.type==="Identifier")o.setVariable(i.loopvar.value,$);else if(i.loopvar.type==="TupleLiteral"){const tt=i.loopvar;if($.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${$.type}`);const et=$;if(tt.value.length!==et.value.length)throw new Error(`Too ${tt.value.length>et.value.length?"few":"many"} items to unpack`);for(let d=0;d<tt.value.length;++d){if(tt.value[d].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${tt.value[d].type}`);o.setVariable(tt.value[d].value,et.value[d])}}const nt=this.evaluateBlock(i.body,o);c+=nt.value}return new StringValue(c)}evaluate(i,e){if(i===void 0)return new UndefinedValue;switch(i.type){case"Program":return this.evalProgram(i,e);case"Set":return this.evaluateSet(i,e);case"If":return this.evaluateIf(i,e);case"For":return this.evaluateFor(i,e);case"NumericLiteral":return new NumericValue(Number(i.value));case"StringLiteral":return new StringValue(i.value);case"BooleanLiteral":return new BooleanValue(i.value);case"ArrayLiteral":return new ArrayValue(i.value.map(o=>this.evaluate(o,e)));case"TupleLiteral":return new TupleValue(i.value.map(o=>this.evaluate(o,e)));case"ObjectLiteral":{const o=new Map;for(const[s,c]of i.value){const h=this.evaluate(s,e);if(!(h instanceof StringValue))throw new Error(`Object keys must be strings: got ${h.type}`);o.set(h.value,this.evaluate(c,e))}return new ObjectValue(o)}case"Identifier":return this.evaluateIdentifier(i,e);case"CallExpression":return this.evaluateCallExpression(i,e);case"MemberExpression":return this.evaluateMemberExpression(i,e);case"UnaryExpression":return this.evaluateUnaryExpression(i,e);case"BinaryExpression":return this.evaluateBinaryExpression(i,e);case"FilterExpression":return this.evaluateFilterExpression(i,e);case"TestExpression":return this.evaluateTestExpression(i,e);default:throw new SyntaxError(`Unknown node type: ${i.type}`)}}};function convertToRuntimeValues(i){switch(typeof i){case"number":return new NumericValue(i);case"string":return new StringValue(i);case"boolean":return new BooleanValue(i);case"object":return i===null?new NullValue:Array.isArray(i)?new ArrayValue(i.map(convertToRuntimeValues)):new ObjectValue(new Map(Object.entries(i).map(([e,o])=>[e,convertToRuntimeValues(o)])));case"function":return new FunctionValue((e,o)=>{const s=i(...e.map(c=>c.value))??null;return convertToRuntimeValues(s)});default:throw new Error(`Cannot convert to runtime value: ${i}`)}}var Template=class{constructor(i){qt(this,"parsed");const e=tokenize(i,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=parse(e)}render(i){const e=new Environment;e.set("false",!1),e.set("true",!0),e.set("raise_exception",c=>{throw new Error(c)}),e.set("range",range);for(const[c,h]of Object.entries(i))e.set(c,h);return new Interpreter(e).run(this.parsed).value}};async function loadTokenizer(i,e){const o=await Promise.all([getModelJSON(i,"tokenizer.json",!0,e),getModelJSON(i,"tokenizer_config.json",!0,e)]);return e.legacy!==null&&(o[1].legacy=e.legacy),o}function regexSplit(i,e){const o=[];let s=0;for(const c of i.matchAll(e)){const h=c[0];s<c.index&&o.push(i.slice(s,c.index)),h.length>0&&o.push(h),s=c.index+h.length}return s<i.length&&o.push(i.slice(s)),o}function createPattern(i,e=!0){if(i.Regex!==void 0){let o=i.Regex.replace(/\\([#&~])/g,"$1");for(const[s,c]of PROBLEMATIC_REGEX_MAP)o=o.replaceAll(s,c);return new RegExp(o,"gu")}else if(i.String!==void 0){const o=escapeRegExp(i.String);return new RegExp(e?o:`(${o})`,"gu")}else return console.warn("Unknown pattern type:",i),null}function objectToMap(i){return new Map(Object.entries(i))}function prepareTensorForDecode(i){const e=i.dims;switch(e.length){case 1:return i.tolist();case 2:if(e[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return i.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${e.length}.`)}}function clean_up_tokenization(i){return i.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function remove_accents(i){return i.replace(/[\u0300-\u036f]/g,"")}function lowercase_and_remove_accent(i){return remove_accents(i.toLowerCase())}function fuse(i,e,o){const s=[];let c=0;for(;c<i.length;){if(s.push(i[c]),(o.get(i[c])??e)!==e){++c;continue}for(;c<i.length&&(o.get(i[c])??e)===e;)++c}return s}function whitespace_split(i){return i.match(/\S+/g)||[]}const PUNCTUATION_REGEX="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",PROBLEMATIC_REGEX_MAP=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"]]);class AddedToken{constructor(e){this.content=e.content,this.id=e.id,this.single_word=e.single_word??!1,this.lstrip=e.lstrip??!1,this.rstrip=e.rstrip??!1,this.special=e.special??!1,this.normalized=e.normalized??null}}class TokenizerModel extends Callable{constructor(e){super(),this.config=e,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(e,...o){switch(e.type){case"WordPiece":return new WordPieceTokenizer(e);case"Unigram":return new Unigram(e,...o);case"BPE":return new BPE(e);default:if(e.vocab)return new LegacyTokenizerModel(e,...o);throw new Error(`Unknown TokenizerModel type: ${e.type}`)}}_call(e){let o=this.encode(e);return this.fuse_unk&&(o=fuse(o,this.unk_token_id,this.tokens_to_ids)),o}encode(e){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(e){return e.map(o=>this.tokens_to_ids.get(o)??this.unk_token_id)}convert_ids_to_tokens(e){return e.map(o=>this.vocab[o]??this.unk_token)}}class WordPieceTokenizer extends TokenizerModel{constructor(e){super(e),this.tokens_to_ids=objectToMap(e.vocab),this.unk_token_id=this.tokens_to_ids.get(e.unk_token),this.unk_token=e.unk_token,this.max_input_chars_per_word=e.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[o,s]of this.tokens_to_ids)this.vocab[s]=o}encode(e){const o=[];for(const s of e){const c=[...s];if(c.length>this.max_input_chars_per_word){o.push(this.unk_token);continue}let h=!1,_=0;const $=[];for(;_<c.length;){let nt=c.length,tt=null;for(;_<nt;){let et=c.slice(_,nt).join("");if(_>0&&(et=this.config.continuing_subword_prefix+et),this.tokens_to_ids.has(et)){tt=et;break}--nt}if(tt===null){h=!0;break}$.push(tt),_=nt}h?o.push(this.unk_token):o.push(...$)}return o}}class Unigram extends TokenizerModel{constructor(e,o){super(e);const s=e.vocab.length;this.vocab=new Array(s),this.scores=new Array(s);for(let c=0;c<s;++c){const h=e.vocab[c];this.vocab[c]=h[0],this.scores[c]=h[1]}this.unk_token_id=e.unk_id,this.unk_token=this.vocab[e.unk_id],this.tokens_to_ids=new Map(this.vocab.map((c,h)=>[c,h])),this.bosToken=" ",this.bosTokenId=this.tokens_to_ids.get(this.bosToken),this.eosToken=o.eos_token,this.eosTokenId=this.tokens_to_ids.get(this.eosToken),this.unkToken=this.vocab[this.unk_token_id],this.minScore=min(this.scores)[0],this.unkScore=this.minScore-10,this.scores[this.unk_token_id]=this.unkScore,this.trie=new CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(e){const o=e.sentence,s=o.length;let c=0;for(;c<s;){let _=!1;for(let $ of this.trie.commonPrefixSearch(o.slice(c))){const nt=this.tokens_to_ids.get($),tt=this.scores[nt],et=$.length;e.insert(c,et,tt,nt),!_&&et===1&&(_=!0)}_||e.insert(c,1,this.unkScore,this.unk_token_id),c+=1}}tokenize(e){const o=new TokenLattice(e,this.bosTokenId,this.eosTokenId);return this.populateNodes(o),o.tokens()}encode(e){const o=[];for(const s of e){const c=this.tokenize(s);o.push(...c)}return o}}const BYTES_TO_UNICODE=(()=>{const i=[...Array.from({length:94},(c,h)=>h+33),...Array.from({length:12},(c,h)=>h+161),...Array.from({length:82},(c,h)=>h+174)],e=i.slice();let o=0;for(let c=0;c<256;++c)i.includes(c)||(i.push(c),e.push(256+o),o+=1);const s=e.map(c=>String.fromCharCode(c));return Object.fromEntries(i.map((c,h)=>[c,s[h]]))})(),UNICODE_TO_BYTES=reverseDictionary(BYTES_TO_UNICODE);class BPE extends TokenizerModel{constructor(e){super(e),this.BPE_SPLIT_TOKEN=" ",this.tokens_to_ids=objectToMap(e.vocab),this.unk_token_id=this.tokens_to_ids.get(e.unk_token),this.unk_token=e.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[o,s]of this.tokens_to_ids)this.vocab[s]=o;this.bpe_ranks=new Map(e.merges.map((o,s)=>[o,s])),this.merges=e.merges.map(o=>o.split(this.BPE_SPLIT_TOKEN)),this.end_of_word_suffix=e.end_of_word_suffix,this.continuing_subword_suffix=e.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.cache=new Map}bpe(e){if(e.length===0)return[];const o=this.cache.get(e);if(o!==void 0)return o;const s=Array.from(e);this.end_of_word_suffix&&(s[s.length-1]+=this.end_of_word_suffix);let c=[];if(s.length>1){const h=new PriorityQueue((nt,tt)=>nt.score<tt.score);let _={token:s[0],bias:0,prev:null,next:null},$=_;for(let nt=1;nt<s.length;++nt){const tt={bias:nt/s.length,token:s[nt],prev:$,next:null};$.next=tt,this._add_node(h,$),$=tt}for(;!h.isEmpty();){const nt=h.pop();if(nt.deleted||!nt.next||nt.next.deleted)continue;if(nt.deleted=!0,nt.next.deleted=!0,nt.prev){const et={...nt.prev};nt.prev.deleted=!0,nt.prev=et,et.prev?et.prev.next=et:_=et}const tt={token:nt.token+nt.next.token,bias:nt.bias,prev:nt.prev,next:nt.next.next};tt.prev?(tt.prev.next=tt,this._add_node(h,tt.prev)):_=tt,tt.next&&(tt.next.prev=tt,this._add_node(h,tt))}for(let nt=_;nt!==null;nt=nt.next)c.push(nt.token)}else c=s;if(this.continuing_subword_suffix)for(let h=0;h<c.length-1;++h)c[h]+=this.continuing_subword_suffix;return this.cache.set(e,c),c}_add_node(e,o){const s=this.bpe_ranks.get(o.token+this.BPE_SPLIT_TOKEN+o.next.token);s!==void 0&&(o.score=s+o.bias,e.push(o))}encode(e){const o=[];for(const s of e){if(this.ignore_merges&&this.tokens_to_ids.has(s)){o.push(s);continue}const c=this.bpe(s);for(const h of c)this.tokens_to_ids.has(h)?o.push(h):this.byte_fallback?o.push(...Array.from(this.text_encoder.encode(h)).map(_=>`<0x${_.toString(16).toUpperCase().padStart(2,"0")}>`)):o.push(this.unk_token)}return o}}class LegacyTokenizerModel extends TokenizerModel{constructor(e,o){super(e),this.tokens_to_ids=objectToMap(o.target_lang?e.vocab[o.target_lang]:e.vocab),this.bos_token=o.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=o.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=o.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=o.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[s,c]of this.tokens_to_ids)this.vocab[c]=s}encode(e){return e}}class Normalizer extends Callable{constructor(e){super(),this.config=e}static fromConfig(e){if(e===null)return null;switch(e.type){case"BertNormalizer":return new BertNormalizer(e);case"Precompiled":return new Precompiled(e);case"Sequence":return new NormalizerSequence(e);case"Replace":return new Replace(e);case"NFC":return new NFC(e);case"NFKC":return new NFKC(e);case"NFKD":return new NFKD(e);case"Strip":return new StripNormalizer(e);case"StripAccents":return new StripAccents(e);case"Lowercase":return new Lowercase(e);case"Prepend":return new Prepend(e);default:throw new Error(`Unknown Normalizer type: ${e.type}`)}}normalize(e){throw Error("normalize should be implemented in subclass.")}_call(e){return this.normalize(e)}}class Replace extends Normalizer{normalize(e){const o=createPattern(this.config.pattern);return o===null?e:e.replaceAll(o,this.config.content)}}class NFC extends Normalizer{normalize(e){return e=e.normalize("NFC"),e}}class NFKC extends Normalizer{normalize(e){return e=e.normalize("NFKC"),e}}class NFKD extends Normalizer{normalize(e){return e=e.normalize("NFKD"),e}}class StripNormalizer extends Normalizer{normalize(e){return this.config.strip_left&&this.config.strip_right?e=e.trim():(this.config.strip_left&&(e=e.trimStart()),this.config.strip_right&&(e=e.trimEnd())),e}}class StripAccents extends Normalizer{normalize(e){return e=remove_accents(e),e}}class Lowercase extends Normalizer{normalize(e){return e=e.toLowerCase(),e}}class Prepend extends Normalizer{normalize(e){return e=this.config.prepend+e,e}}class NormalizerSequence extends Normalizer{constructor(e){super(e),this.normalizers=e.normalizers.map(o=>Normalizer.fromConfig(o))}normalize(e){return this.normalizers.reduce((o,s)=>s.normalize(o),e)}}class BertNormalizer extends Normalizer{_tokenize_chinese_chars(e){const o=[];for(let s=0;s<e.length;++s){const c=e[s],h=c.charCodeAt(0);this._is_chinese_char(h)?(o.push(" "),o.push(c),o.push(" ")):o.push(c)}return o.join("")}_is_chinese_char(e){return e>=19968&&e<=40959||e>=13312&&e<=19903||e>=131072&&e<=173791||e>=173824&&e<=177983||e>=177984&&e<=178207||e>=178208&&e<=183983||e>=63744&&e<=64255||e>=194560&&e<=195103}stripAccents(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}_is_control(e){switch(e){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(e)}}_clean_text(e){const o=[];for(const s of e){const c=s.charCodeAt(0);c===0||c===65533||this._is_control(s)||(/^\s$/.test(s)?o.push(" "):o.push(s))}return o.join("")}normalize(e){return this.config.clean_text&&(e=this._clean_text(e)),this.config.handle_chinese_chars&&(e=this._tokenize_chinese_chars(e)),this.config.lowercase?(e=e.toLowerCase(),this.config.strip_accents!==!1&&(e=this.stripAccents(e))):this.config.strip_accents&&(e=this.stripAccents(e)),e}}class PreTokenizer extends Callable{static fromConfig(e){if(e===null)return null;switch(e.type){case"BertPreTokenizer":return new BertPreTokenizer(e);case"Sequence":return new PreTokenizerSequence(e);case"Whitespace":return new WhitespacePreTokenizer(e);case"WhitespaceSplit":return new WhitespaceSplit(e);case"Metaspace":return new MetaspacePreTokenizer(e);case"ByteLevel":return new ByteLevelPreTokenizer(e);case"Split":return new SplitPreTokenizer(e);case"Punctuation":return new PunctuationPreTokenizer(e);case"Digits":return new DigitsPreTokenizer(e);case"Replace":return new ReplacePreTokenizer(e);default:throw new Error(`Unknown PreTokenizer type: ${e.type}`)}}pre_tokenize_text(e,o){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(e,o){return(Array.isArray(e)?e.map(s=>this.pre_tokenize_text(s,o)):this.pre_tokenize_text(e,o)).flat()}_call(e,o){return this.pre_tokenize(e,o)}}class BertPreTokenizer extends PreTokenizer{constructor(e){super(),this.pattern=new RegExp(`[^\\s${PUNCTUATION_REGEX}]+|[${PUNCTUATION_REGEX}]`,"gu")}pre_tokenize_text(e,o){return e.trim().match(this.pattern)||[]}}class ByteLevelPreTokenizer extends PreTokenizer{constructor(e){super(),this.config=e,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=BYTES_TO_UNICODE,this.text_encoder=new TextEncoder}pre_tokenize_text(e,o){return this.add_prefix_space&&!e.startsWith(" ")&&(e=" "+e),(this.use_regex?e.match(this.pattern)||[]:[e]).map(c=>Array.from(this.text_encoder.encode(c),h=>this.byte_encoder[h]).join(""))}}class SplitPreTokenizer extends PreTokenizer{constructor(e){super(),this.config=e,this.pattern=createPattern(this.config.pattern,this.config.invert)}pre_tokenize_text(e,o){return this.pattern===null?[]:this.config.invert?e.match(this.pattern)||[]:regexSplit(e,this.pattern)}}class PunctuationPreTokenizer extends PreTokenizer{constructor(e){super(),this.config=e,this.pattern=new RegExp(`[^${PUNCTUATION_REGEX}]+|[${PUNCTUATION_REGEX}]+`,"gu")}pre_tokenize_text(e,o){return e.match(this.pattern)||[]}}class DigitsPreTokenizer extends PreTokenizer{constructor(e){super(),this.config=e;const o=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(o,"gu")}pre_tokenize_text(e,o){return e.match(this.pattern)||[]}}class PostProcessor extends Callable{constructor(e){super(),this.config=e}static fromConfig(e){if(e===null)return null;switch(e.type){case"TemplateProcessing":return new TemplateProcessing(e);case"ByteLevel":return new ByteLevelPostProcessor(e);case"RobertaProcessing":return new RobertaProcessing(e);case"BertProcessing":return new BertProcessing(e);case"Sequence":return new PostProcessorSequence(e);default:throw new Error(`Unknown PostProcessor type: ${e.type}`)}}post_process(e,...o){throw Error("post_process should be implemented in subclass.")}_call(e,...o){return this.post_process(e,...o)}}class BertProcessing extends PostProcessor{constructor(e){super(e),this.cls=e.cls[0],this.sep=e.sep[0]}post_process(e,o=null,{add_special_tokens:s=!0}={}){s&&(e=mergeArrays([this.cls],e,[this.sep]));let c=new Array(e.length).fill(0);if(o!==null){const h=s&&this instanceof RobertaProcessing?[this.sep]:[],_=s?[this.sep]:[];e=mergeArrays(e,h,o,_),c=mergeArrays(c,new Array(o.length+h.length+_.length).fill(1))}return{tokens:e,token_type_ids:c}}}class RobertaProcessing extends BertProcessing{}class TemplateProcessing extends PostProcessor{constructor(e){super(e),this.single=e.single,this.pair=e.pair}post_process(e,o=null,{add_special_tokens:s=!0}={}){const c=o===null?this.single:this.pair;let h=[],_=[];for(const $ of c)"SpecialToken"in $?s&&(h.push($.SpecialToken.id),_.push($.SpecialToken.type_id)):"Sequence"in $&&($.Sequence.id==="A"?(h=mergeArrays(h,e),_=mergeArrays(_,new Array(e.length).fill($.Sequence.type_id))):$.Sequence.id==="B"&&(h=mergeArrays(h,o),_=mergeArrays(_,new Array(o.length).fill($.Sequence.type_id))));return{tokens:h,token_type_ids:_}}}class ByteLevelPostProcessor extends PostProcessor{post_process(e,o=null){return o&&(e=mergeArrays(e,o)),{tokens:e}}}class PostProcessorSequence extends PostProcessor{constructor(e){super(e),this.processors=e.processors.map(o=>PostProcessor.fromConfig(o))}post_process(e,o=null,s={}){let c;for(const h of this.processors)if(h instanceof ByteLevelPostProcessor)e=h.post_process(e).tokens,o&&(o=h.post_process(o).tokens);else{const _=h.post_process(e,o,s);e=_.tokens,c=_.token_type_ids}return{tokens:e,token_type_ids:c}}}class Decoder extends Callable{constructor(e){super(),this.config=e,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=e.trim_offsets}static fromConfig(e){if(e===null)return null;switch(e.type){case"WordPiece":return new WordPieceDecoder(e);case"Metaspace":return new MetaspaceDecoder(e);case"ByteLevel":return new ByteLevelDecoder(e);case"Replace":return new ReplaceDecoder(e);case"ByteFallback":return new ByteFallback(e);case"Fuse":return new FuseDecoder(e);case"Strip":return new StripDecoder(e);case"Sequence":return new DecoderSequence(e);case"CTC":return new CTCDecoder(e);case"BPEDecoder":return new BPEDecoder(e);default:throw new Error(`Unknown Decoder type: ${e.type}`)}}_call(e){return this.decode(e)}decode(e){return this.decode_chain(e).join("")}decode_chain(e){throw Error("`decode_chain` should be implemented in subclass.")}}class ReplaceDecoder extends Decoder{decode_chain(e){const o=createPattern(this.config.pattern);return o===null?e:e.map(s=>s.replaceAll(o,this.config.content))}}class ByteFallback extends Decoder{constructor(e){super(e),this.text_decoder=new TextDecoder}decode_chain(e){const o=[];let s=[];for(const c of e){let h=null;if(c.length===6&&c.startsWith("<0x")&&c.endsWith(">")){const _=parseInt(c.slice(3,5),16);isNaN(_)||(h=_)}if(h!==null)s.push(h);else{if(s.length>0){const _=this.text_decoder.decode(Uint8Array.from(s));o.push(_),s=[]}o.push(c)}}if(s.length>0){const c=this.text_decoder.decode(Uint8Array.from(s));o.push(c),s=[]}return o}}class FuseDecoder extends Decoder{decode_chain(e){return[e.join("")]}}class StripDecoder extends Decoder{constructor(e){super(e),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(e){return e.map(o=>{let s=0;for(let h=0;h<this.start&&o[h]===this.content;++h){s=h+1;continue}let c=o.length;for(let h=0;h<this.stop;++h){const _=o.length-h-1;if(o[_]===this.content){c=_;continue}else break}return o.slice(s,c)})}}class WordPieceDecoder extends Decoder{constructor(e){super(e),this.cleanup=e.cleanup}decode_chain(e){return e.map((o,s)=>(s!==0&&(o.startsWith(this.config.prefix)?o=o.replace(this.config.prefix,""):o=" "+o),this.cleanup&&(o=clean_up_tokenization(o)),o))}}class ByteLevelDecoder extends Decoder{constructor(e){super(e),this.byte_decoder=UNICODE_TO_BYTES,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(e){const o=e.join(""),s=new Uint8Array([...o].map(h=>this.byte_decoder[h]));return this.text_decoder.decode(s)}decode_chain(e){const o=[];let s=[];for(const c of e)this.added_tokens.find(h=>h.content===c)!==void 0?(s.length>0&&(o.push(this.convert_tokens_to_string(s)),s=[]),o.push(c)):s.push(c);return s.length>0&&o.push(this.convert_tokens_to_string(s)),o}}class CTCDecoder extends Decoder{constructor(e){super(e),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(e){if(e.length===0)return"";const o=[e[0]];for(let h=1;h<e.length;++h)e[h]!==o.at(-1)&&o.push(e[h]);let c=o.filter(h=>h!==this.pad_token).join("");return this.cleanup&&(c=clean_up_tokenization(c).replaceAll(this.word_delimiter_token," ").trim()),c}decode_chain(e){return[this.convert_tokens_to_string(e)]}}class DecoderSequence extends Decoder{constructor(e){super(e),this.decoders=e.decoders.map(o=>Decoder.fromConfig(o))}decode_chain(e){return this.decoders.reduce((o,s)=>s.decode_chain(o),e)}}class BPEDecoder extends Decoder{constructor(e){super(e),this.suffix=this.config.suffix}decode_chain(e){return e.map((o,s)=>o.replaceAll(this.suffix,s===e.length-1?"":" "))}}class VitsDecoder extends Decoder{decode_chain(e){let o="";for(let s=1;s<e.length;s+=2)o+=e[s];return[o]}}class MetaspacePreTokenizer extends PreTokenizer{constructor(e){super(),this.addPrefixSpace=e.add_prefix_space,this.replacement=e.replacement,this.strRep=e.str_rep||this.replacement,this.prepend_scheme=e.prepend_scheme??"always"}pre_tokenize_text(e,{section_index:o=void 0}={}){let s=e.replaceAll(" ",this.strRep);return this.addPrefixSpace&&!s.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&o===0)&&(s=this.strRep+s),[s]}}class MetaspaceDecoder extends Decoder{constructor(e){super(e),this.addPrefixSpace=e.add_prefix_space,this.replacement=e.replacement}decode_chain(e){const o=[];for(let s=0;s<e.length;++s){let c=e[s].replaceAll(this.replacement," ");this.addPrefixSpace&&s==0&&c.startsWith(" ")&&(c=c.substring(1)),o.push(c)}return o}}class Precompiled extends Normalizer{constructor(e){super(e),this.charsmap=e.precompiled_charsmap}normalize(e){return e=e.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),e=e.replace(/[\u0009\u000A\u000C\u000D\u1680\u200B\u200C\u200E\u200F\u2028\u2029\u2581\uFEFF\uFFFD]/gm," "),e.includes("")?e=e.split("").map(s=>s.normalize("NFKC")).join(""):e=e.normalize("NFKC"),e}}class PreTokenizerSequence extends PreTokenizer{constructor(e){super(),this.tokenizers=e.pretokenizers.map(o=>PreTokenizer.fromConfig(o))}pre_tokenize_text(e,o){return this.tokenizers.reduce((s,c)=>c.pre_tokenize(s,o),[e])}}class WhitespacePreTokenizer extends PreTokenizer{constructor(e){super()}pre_tokenize_text(e,o){return e.match(/\w+|[^\w\s]+/g)||[]}}class WhitespaceSplit extends PreTokenizer{constructor(e){super()}pre_tokenize_text(e,o){return whitespace_split(e)}}class ReplacePreTokenizer extends PreTokenizer{constructor(e){super(),this.config=e,this.pattern=createPattern(this.config.pattern),this.content=this.config.content}pre_tokenize_text(e,o){return this.pattern===null?[e]:[e.replaceAll(this.pattern,this.config.content)]}}const SPECIAL_TOKEN_ATTRIBUTES=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function padHelper(i,e,o,s){for(const c of Object.keys(i)){const h=e-i[c].length,_=o(c),$=new Array(h).fill(_);i[c]=s==="right"?mergeArrays(i[c],$):mergeArrays($,i[c])}}function truncateHelper(i,e){for(const o of Object.keys(i))i[o].length=e}class PreTrainedTokenizer extends Callable{constructor(o,s){super();qt(this,"return_token_type_ids",!1);qt(this,"_default_chat_template",`{% for message in messages %}{{'<|im_start|>' + message['role'] + '
' + message['content'] + '<|im_end|>' + '
'}}{% endfor %}{% if add_generation_prompt %}{{ '<|im_start|>assistant
' }}{% endif %}`);this._tokenizer_config=s,this.normalizer=Normalizer.fromConfig(o.normalizer),this.pre_tokenizer=PreTokenizer.fromConfig(o.pre_tokenizer),this.model=TokenizerModel.fromConfig(o.model,s),this.post_processor=PostProcessor.fromConfig(o.post_processor),this.decoder=Decoder.fromConfig(o.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const c of o.added_tokens){const h=new AddedToken(c);this.added_tokens.push(h),this.model.tokens_to_ids.set(h.content,h.id),this.model.vocab[h.id]=h.content,h.special&&(this.special_tokens.push(h.content),this.all_special_ids.push(h.id))}if(this.additional_special_tokens=s.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_regex=this.added_tokens.length>0?new RegExp(this.added_tokens.map(c=>`${c.lstrip?"\\s*":""}(${escapeRegExp(c.content)})${c.rstrip?"\\s*":""}`).join("|")):null,this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.model_max_length=s.model_max_length,this.remove_space=s.remove_space,this.clean_up_tokenization_spaces=s.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=s.do_lowercase_and_remove_accent??!1,this.padding_side="right",this.legacy=!1,this.chat_template=s.chat_template??null,Array.isArray(this.chat_template)){const c=Object.create(null);for(const{name:h,template:_}of this.chat_template){if(typeof h!="string"||typeof _!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');c[h]=_}this.chat_template=c}this._compiled_template_cache=new Map}getToken(...o){for(const s of o){const c=this._tokenizer_config[s];if(c)if(typeof c=="object"){if(c.__type==="AddedToken")return c.content;throw Error(`Unknown token: ${c}`)}else return c}return null}static async from_pretrained(o,{progress_callback:s=null,config:c=null,cache_dir:h=null,local_files_only:_=!1,revision:$="main",legacy:nt=null}={}){const tt=await loadTokenizer(o,{progress_callback:s,config:c,cache_dir:h,local_files_only:_,revision:$,legacy:nt});return new this(...tt)}_call(o,{text_pair:s=null,add_special_tokens:c=!0,padding:h=!1,truncation:_=null,max_length:$=null,return_tensor:nt=!0,return_token_type_ids:tt=null}={}){const et=Array.isArray(o);let d;if(et){if(o.length===0)throw Error("text array must be non-empty");if(s!==null){if(Array.isArray(s)){if(o.length!==s.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");d=o.map((g,j)=>this._encode_plus(g,s[j],{add_special_tokens:c,return_token_type_ids:tt}))}else d=o.map(g=>this._encode_plus(g,null,{add_special_tokens:c,return_token_type_ids:tt}))}else{if(o==null)throw Error("text may not be null or undefined");if(Array.isArray(s))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");d=[this._encode_plus(o,s,{add_special_tokens:c,return_token_type_ids:tt})]}if($===null?h==="max_length"?$=this.model_max_length:$=max(d.map(g=>g.input_ids.length))[0]:_||console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation=true` to explicitly truncate examples to max length."),$=Math.min($,this.model_max_length),h||_)for(let g=0;g<d.length;++g)d[g].input_ids.length!==$&&(d[g].input_ids.length>$?_&&truncateHelper(d[g],$):h&&padHelper(d[g],$,j=>j==="input_ids"?this.pad_token_id:0,this.padding_side));const a={};if(nt){if(!(h&&_)&&d.some(j=>{var rt;for(const ot of Object.keys(j))if(j[ot].length!==((rt=d[0][ot])==null?void 0:rt.length))return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const g=[d.length,d[0].input_ids.length];for(const j of Object.keys(d[0]))a[j]=new Tensor("int64",BigInt64Array.from(d.flatMap(rt=>rt[j]).map(BigInt)),g)}else{for(const g of Object.keys(d[0]))a[g]=d.map(j=>j[g]);if(!et)for(const g of Object.keys(a))a[g]=a[g][0]}return a}_encode_text(o){return o===null?null:(this.added_tokens_regex?o.split(this.added_tokens_regex).filter(h=>h):[o]).map((h,_)=>{if(this.added_tokens.find(nt=>nt.content===h)!==void 0)return h;{if(this.remove_space===!0&&(h=h.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(h=lowercase_and_remove_accent(h)),this.normalizer!==null&&(h=this.normalizer(h)),h.length===0)return[];const nt=this.pre_tokenizer!==null?this.pre_tokenizer(h,{section_index:_}):[h];return this.model(nt)}}).flat()}_encode_plus(o,s=null,{add_special_tokens:c=!0,return_token_type_ids:h=null}={}){const _=this._encode_text(o),$=this._encode_text(s),nt=this.post_processor?this.post_processor(_,$,{add_special_tokens:c}):{tokens:mergeArrays(_??[],$??[])},tt=this.model.convert_tokens_to_ids(nt.tokens),et={input_ids:tt,attention_mask:new Array(tt.length).fill(1)};return(h??this.return_token_type_ids)&&nt.token_type_ids&&(et.token_type_ids=nt.token_type_ids),et}encode(o,s=null,{add_special_tokens:c=!0,return_token_type_ids:h=null}={}){const{input_ids:_}=this._encode_plus(o,s,{add_special_tokens:c,return_token_type_ids:h});return _}batch_decode(o,s={}){return o instanceof Tensor&&(o=o.tolist()),o.map(c=>this.decode(c,s))}decode(o,s={}){if(o instanceof Tensor&&(o=prepareTensorForDecode(o)),!Array.isArray(o)||o.length===0||!isIntegralNumber(o[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(o,s)}decode_single(o,{skip_special_tokens:s=!1,clean_up_tokenization_spaces:c=null}){let h=this.model.convert_ids_to_tokens(o);s&&(h=h.filter($=>!this.special_tokens.includes($)));let _=this.decoder?this.decoder(h):h.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(_=_.replaceAll(this.decoder.end_of_word_suffix," "),s&&(_=_.trim())),(c??this.clean_up_tokenization_spaces)&&(_=clean_up_tokenization(_)),_}get default_chat_template(){return this._warned_about_chat_template||(console.warn("No chat template is defined for this tokenizer - using a default chat template that implements the ChatML format. If the default is not appropriate for your model, please set `tokenizer.chat_template` to an appropriate template. See https://huggingface.co/docs/transformers/main/chat_templating for more information."),this._warned_about_chat_template=!0),this._default_chat_template}apply_chat_template(o,{chat_template:s=null,add_generation_prompt:c=!1,tokenize:h=!0,padding:_=!1,truncation:$=!1,max_length:nt=null,return_tensor:tt=!0,tokenizer_kwargs:et={},...d}={}){if(this.chat_template&&typeof this.chat_template=="object"||this.chat_template===null&&this.default_chat_template&&typeof this.default_chat_template=="object"){const rt=this.chat_template??this.default_chat_template;if(s!==null&&Object.hasOwn(rt,s))s=rt[s];else if(s===null&&"default"in rt)s=rt.default;else if(s===null)throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(rt).sort()}.`)}else s??(s=this.chat_template??this.default_chat_template);if(typeof s!="string")throw Error(`chat_template must be a string, but got ${typeof s}`);let a=this._compiled_template_cache.get(s);a===void 0&&(a=new Template(s),this._compiled_template_cache.set(s,a));const g=Object.create(null);for(const rt of SPECIAL_TOKEN_ATTRIBUTES){const ot=this.getToken(rt);ot&&(g[rt]=ot)}const j=a.render({messages:o,add_generation_prompt:c,...g,...d});return h?this._call(j,{add_special_tokens:!1,padding:_,truncation:$,max_length:nt,return_tensor:tt,...et}).input_ids:j}}class BertTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class AlbertTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class MobileBertTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class SqueezeBertTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class DebertaTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class DebertaV2Tokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class HerbertTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class ConvBertTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class RoFormerTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class DistilBertTokenizer extends PreTrainedTokenizer{}class CamembertTokenizer extends PreTrainedTokenizer{}class XLMTokenizer extends PreTrainedTokenizer{constructor(o,s){super(o,s);qt(this,"return_token_type_ids",!0);console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class ElectraTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"return_token_type_ids",!0)}}class T5Tokenizer extends PreTrainedTokenizer{}class GPT2Tokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"_default_chat_template",'{% for message in messages %}" "{{ message.content }}{{ eos_token }}" "{% endfor %}')}}class BartTokenizer extends PreTrainedTokenizer{}class MBartTokenizer extends PreTrainedTokenizer{constructor(e,o){super(e,o),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(s=>this.languageRegex.test(s)),this.lang_to_token=s=>s}_build_translation_inputs(e,o,s){return _build_translation_inputs(this,e,o,s)}}class MBart50Tokenizer extends MBartTokenizer{}class RobertaTokenizer extends PreTrainedTokenizer{}class BloomTokenizer extends GPT2Tokenizer{constructor(e,o){var h,_;const s=".,!?",c=(_=(h=e.pre_tokenizer)==null?void 0:h.pretokenizers[0])==null?void 0:_.pattern;c&&c.Regex===` ?[^(\\s|[${s}])]+`&&(c.Regex=` ?[^\\s${s}]+`),super(e,o)}}const SPIECE_UNDERLINE="";class LlamaTokenizer extends PreTrainedTokenizer{constructor(o,s){super(o,s);qt(this,"_default_chat_template",`{% if messages[0]['role'] == 'system' %}{% set loop_messages = messages[1:] %}{% set system_message = messages[0]['content'] %}{% elif USE_DEFAULT_PROMPT == true and not '<<SYS>>' in messages[0]['content'] %}{% set loop_messages = messages %}{% set system_message = 'DEFAULT_SYSTEM_MESSAGE' %}{% else %}{% set loop_messages = messages %}{% set system_message = false %}{% endif %}{% for message in loop_messages %}{% if (message['role'] == 'user') != (loop.index0 % 2 == 0) %}{{ raise_exception('Conversation roles must alternate user/assistant/user/assistant/...') }}{% endif %}{% if loop.index0 == 0 and system_message != false %}{% set content = '<<SYS>>
' + system_message + '
<</SYS>>

' + message['content'] %}{% else %}{% set content = message['content'] %}{% endif %}{% if message['role'] == 'user' %}{{ bos_token + '[INST] ' + content.strip() + ' [/INST]' }}{% elif message['role'] == 'system' %}{{ '<<SYS>>
' + content.strip() + '
<</SYS>>

' }}{% elif message['role'] == 'assistant' %}{{ ' '  + content.strip() + ' ' + eos_token }}{% endif %}{% endfor %}`);qt(this,"DEFAULT_SYSTEM_PROMPT",`You are a helpful, respectful and honest assistant. Always answer as helpfully as possible, while being safe. Your answers should not include any harmful, unethical, racist, sexist, toxic, dangerous, or illegal content. Please ensure that your responses are socially unbiased and positive in nature.

If a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information.`);this.use_default_system_prompt=s.use_default_system_prompt??!1,this.legacy=s.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new MetaspacePreTokenizer({replacement:SPIECE_UNDERLINE,add_prefix_space:!0,prepend_scheme:"first"}))}_encode_text(o){if(o===null)return null;if(this.legacy||o.length===0)return super._encode_text(o);let s=super._encode_text(SPIECE_UNDERLINE+o.replaceAll(SPIECE_UNDERLINE," "));return s.length>1&&s[0]===SPIECE_UNDERLINE&&this.special_tokens.includes(s[1])&&(s=s.slice(1)),s}get default_chat_template(){return super.default_chat_template.replaceAll("USE_DEFAULT_PROMPT",this.use_default_system_prompt?"true":"false").replaceAll("DEFAULT_SYSTEM_MESSAGE",this.DEFAULT_SYSTEM_PROMPT.replaceAll(`
`,"\\n").replaceAll("'","\\'"))}}class CodeLlamaTokenizer extends LlamaTokenizer{}class XLMRobertaTokenizer extends PreTrainedTokenizer{}class MPNetTokenizer extends PreTrainedTokenizer{}class FalconTokenizer extends PreTrainedTokenizer{}class GPTNeoXTokenizer extends PreTrainedTokenizer{}class EsmTokenizer extends PreTrainedTokenizer{}class Qwen2Tokenizer extends PreTrainedTokenizer{}class GemmaTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"_default_chat_template",`{% if messages[0]['role'] == 'system' %}{{ raise_exception('System role not supported') }}{% endif %}{% for message in messages %}{% if (message['role'] == 'user') != (loop.index0 % 2 == 0) %}{{ raise_exception('Conversation roles must alternate user/assistant/user/assistant/...') }}{% endif %}{% if (message['role'] == 'assistant') %}{% set role = 'model' %}{% else %}{% set role = message['role'] %}{% endif %}{{ '<start_of_turn>' + role + '
' + message['content'] | trim + '<end_of_turn>
' }}{% endfor %}{% if add_generation_prompt %}{{'<start_of_turn>model
'}}{% endif %}`)}}class Grok1Tokenizer extends PreTrainedTokenizer{}function _build_translation_inputs(i,e,o,s){if(!("language_codes"in i)||!Array.isArray(i.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in i)||!(i.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in i)||typeof i.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const c=s.src_lang,h=s.tgt_lang;if(!i.language_codes.includes(h))throw new Error(`Target language code "${h}" is not valid. Must be one of: {${i.language_codes.join(", ")}}`);if(c!==void 0){if(!i.language_codes.includes(c))throw new Error(`Source language code "${c}" is not valid. Must be one of: {${i.language_codes.join(", ")}}`);for(const _ of i.post_processor.config.single)if("SpecialToken"in _&&i.languageRegex.test(_.SpecialToken.id)){_.SpecialToken.id=i.lang_to_token(c);break}}return s.forced_bos_token_id=i.model.convert_tokens_to_ids([i.lang_to_token(h)])[0],i._call(e,o)}class NllbTokenizer extends PreTrainedTokenizer{constructor(e,o){super(e,o),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(s=>this.languageRegex.test(s)),this.lang_to_token=s=>s}_build_translation_inputs(e,o,s){return _build_translation_inputs(this,e,o,s)}}class M2M100Tokenizer extends PreTrainedTokenizer{constructor(e,o){super(e,o),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(s=>this.languageRegex.test(s)).map(s=>s.slice(2,-2)),this.lang_to_token=s=>`__${s}__`}_build_translation_inputs(e,o,s){return _build_translation_inputs(this,e,o,s)}}const WHISPER_LANGUAGES=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],WHISPER_LANGUAGE_MAPPING=new Map(WHISPER_LANGUAGES),WHISPER_TO_LANGUAGE_CODE_MAPPING=new Map([...WHISPER_LANGUAGES.map(([i,e])=>[e,i]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);class WhisperTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"_default_chat_template",'{% for message in messages %}" "{{ message.content }}{{ eos_token }}" "{% endfor %}')}_decode_asr(o,{return_timestamps:s=!1,return_language:c=!1,time_precision:h=null,force_full_sequences:_=!0}={}){if(h===null)throw Error("Must specify time_precision");let $=null;const nt=s==="word";function tt(){return{language:$,timestamp:[null,null],text:""}}const et=[];let d=tt(),a=0;const g=this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1;let j=[],rt=[],ot=!1,it=null;const at=new Set(this.all_special_ids);for(const dt of o){const mt=dt.tokens,ht=nt?dt.token_timestamps:null;let ft=null,ut=g;if("stride"in dt){const[vt,Tt,Mt]=dt.stride;if(a-=Tt,it=vt-Mt,Tt&&(ut=Tt/h+g),Mt)for(let xt=mt.length-1;xt>=0;--xt){const Pt=mt[xt];if(Pt>=g){if(ft!==null&&(Pt-g)*h<it)break;ft=Pt}}}let _t=[],bt=[];for(let vt=0;vt<mt.length;++vt){const Tt=mt[vt];if(at.has(Tt)){const Mt=this.decode([Tt]),xt=WHISPER_LANGUAGE_MAPPING.get(Mt.slice(2,-2));if(xt!==void 0){if($!==null&&xt!==$&&!s){j.push(_t);const Pt=this.findLongestCommonSequence(j)[0],It=this.decode(Pt);d.text=It,et.push(d),j=[],_t=[],d=tt()}$=d.language=xt}}else if(Tt>=g){const Mt=(Tt-g)*h+a,xt=round(Mt,2);if(ft!==null&&Tt>=ft)ot=!0;else if(ot||j.length>0&&Tt<ut)ot=!1;else if(d.timestamp[0]===null)d.timestamp[0]=xt;else if(xt!==d.timestamp[0]){d.timestamp[1]=xt,j.push(_t),nt&&rt.push(bt);const[Pt,It]=this.findLongestCommonSequence(j,rt),Dt=this.decode(Pt);d.text=Dt,nt&&(d.words=this.collateWordTimestamps(Pt,It,$)),et.push(d),j=[],_t=[],rt=[],bt=[],d=tt()}}else if(_t.push(Tt),nt){let Mt=round(ht[vt]+a,2),xt;vt+1<ht.length?xt=round(ht[vt+1]+a,2):xt=null,bt.push([Mt,xt])}}if("stride"in dt){const[vt,Tt,Mt]=dt.stride;a+=vt-Mt}_t.length>0?(j.push(_t),nt&&rt.push(bt)):j.every(vt=>vt.length===0)&&(d=tt(),j=[],_t=[],rt=[],bt=[])}if(j.length>0){if(_&&s)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[dt,mt]=this.findLongestCommonSequence(j,rt),ht=this.decode(dt);d.text=ht,nt&&(d.words=this.collateWordTimestamps(dt,mt,$)),et.push(d)}let lt=Object.create(null);const ct=et.map(dt=>dt.text).join("");if(s||c){for(let dt=0;dt<et.length;++dt){const mt=et[dt];s||delete mt.timestamp,c||delete mt.language}if(nt){const dt=[];for(const mt of et)for(const ht of mt.words)dt.push(ht);lt={chunks:dt}}else lt={chunks:et}}return[ct,lt]}findLongestCommonSequence(o,s=null){let c=o[0],h=c.length,_=[];const $=Array.isArray(s)&&s.length>0;let nt=$?[]:null,tt=$?s[0]:null;for(let et=1;et<o.length;++et){const d=o[et];let a=0,g=[h,h,0,0];const j=d.length;for(let dt=1;dt<h+j;++dt){const mt=dt/1e4,ht=Math.max(0,h-dt),ft=Math.min(h,h+j-dt),ut=c.slice(ht,ft),_t=Math.max(0,dt-h),bt=Math.min(j,dt),vt=d.slice(_t,bt);if(ut.length!==vt.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");const Tt=ut.filter((xt,Pt)=>xt===vt[Pt]).length,Mt=Tt/dt+mt;Tt>1&&Mt>a&&(a=Mt,g=[ht,ft,_t,bt])}const[rt,ot,it,at]=g,lt=Math.floor((ot+rt)/2),ct=Math.floor((at+it)/2);_.push(...c.slice(0,lt)),c=d.slice(ct),h=c.length,$&&(nt.push(...tt.slice(0,lt)),tt=s[et].slice(ct))}return _.push(...c),$?(nt.push(...tt),[_,nt]):[_,[]]}collateWordTimestamps(o,s,c){const[h,_,$]=this.combineTokensIntoWords(o,c),nt=[];for(let tt=0;tt<h.length;++tt){const et=$[tt];nt.push({text:h[tt],timestamp:[s[et.at(0)][0],s[et.at(-1)][1]]})}return nt}combineTokensIntoWords(o,s,c=`"'([{-`,h=`"'.,!?:)]}`){s=s??"english";let _,$,nt;return["chinese","japanese","thai","lao","myanmar"].includes(s)?[_,$,nt]=this.splitTokensOnUnicode(o):[_,$,nt]=this.splitTokensOnSpaces(o),this.mergePunctuations(_,$,nt,c,h)}decode(o,s){let c;return s&&s.decode_with_timestamps?(o instanceof Tensor&&(o=prepareTensorForDecode(o)),c=this.decodeWithTimestamps(o,s)):c=super.decode(o,s),c}decodeWithTimestamps(o,s){const c=(s==null?void 0:s.time_precision)??.02,h=Array.from(this.all_special_ids).at(-1)+1;let _=[[]];for(const $ of o)if($>=h){const nt=round(($-h)*c,2);_.push(`<|${nt}|>`),_.push([])}else _[_.length-1].push($);return _=_.map($=>typeof $=="string"?$:super.decode($,s)),_.join("")}splitTokensOnUnicode(o){const s=this.decode(o,{decode_with_timestamps:!0}),c="",h=[],_=[],$=[];let nt=[],tt=[],et=0;for(let d=0;d<o.length;++d){const a=o[d];nt.push(a),tt.push(d);const g=this.decode(nt,{decode_with_timestamps:!0});(!g.includes(c)||s[et+g.indexOf(c)]===c)&&(h.push(g),_.push(nt),$.push(tt),nt=[],tt=[],et+=g.length)}return[h,_,$]}splitTokensOnSpaces(o){const[s,c,h]=this.splitTokensOnUnicode(o),_=[],$=[],nt=[],tt=new RegExp(`^[${PUNCTUATION_REGEX}]$`,"gu");for(let et=0;et<s.length;++et){const d=s[et],a=c[et],g=h[et],j=a[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),rt=d.startsWith(" "),ot=d.trim(),it=tt.test(ot);if(j||rt||it||_.length===0)_.push(d),$.push(a),nt.push(g);else{const at=_.length-1;_[at]+=d,$[at].push(...a),nt[at].push(...g)}}return[_,$,nt]}mergePunctuations(o,s,c,h,_){const $=structuredClone(o),nt=structuredClone(s),tt=structuredClone(c);let et=$.length-2,d=$.length-1;for(;et>=0;)$[et].startsWith(" ")&&h.includes($[et].trim())?($[d]=$[et]+$[d],nt[d]=mergeArrays(nt[et],nt[d]),tt[d]=mergeArrays(tt[et],tt[d]),$[et]="",nt[et]=[],tt[et]=[]):d=et,--et;for(et=0,d=1;d<$.length;)!$[et].endsWith(" ")&&_.includes($[d])?($[et]+=$[d],nt[et]=mergeArrays(nt[et],nt[d]),tt[et]=mergeArrays(tt[et],tt[d]),$[d]="",nt[d]=[],tt[d]=[]):et=d,++d;return[$.filter(a=>a),nt.filter(a=>a.length>0),tt.filter(a=>a.length>0)]}get_decoder_prompt_ids({language:o=null,task:s=null,no_timestamps:c=!0}={}){const h=[];if(o){o=o.toLowerCase();let _=WHISPER_TO_LANGUAGE_CODE_MAPPING.get(o);if(_===void 0)if(WHISPER_LANGUAGE_MAPPING.has(o))_=o;else{const tt=o.length===2?WHISPER_LANGUAGE_MAPPING.keys():WHISPER_LANGUAGE_MAPPING.values();throw new Error(`Language "${o}" is not supported. Must be one of: ${JSON.stringify(tt)}`)}const $=this.model.tokens_to_ids.get(`<|${_}|>`);if($===void 0)throw new Error(`Unable to find language "${_}" in model vocabulary. Please report this issue at https://github.com/xenova/transformers.js/issues/new/choose.`);h.push($)}else h.push(null);if(s){if(s=s.toLowerCase(),s!=="transcribe"&&s!=="translate")throw new Error(`Task "${s}" is not supported. Must be one of: ["transcribe", "translate"]`);const _=this.model.tokens_to_ids.get(`<|${s}|>`);if(_===void 0)throw new Error(`Unable to find task "${s}" in model vocabulary. Please report this issue at https://github.com/xenova/transformers.js/issues/new/choose.`);h.push(_)}else h.push(null);if(c){const _=this.model.tokens_to_ids.get("<|notimestamps|>");if(_===void 0)throw new Error('Unable to find "<|notimestamps|>" in model vocabulary. Please report this issue at https://github.com/xenova/transformers.js/issues/new/choose.');h.push(_)}return h.map((_,$)=>[$+1,_]).filter(_=>_[1]!==null)}}class CodeGenTokenizer extends PreTrainedTokenizer{}class CLIPTokenizer extends PreTrainedTokenizer{}class SiglipTokenizer extends PreTrainedTokenizer{}class MarianTokenizer extends PreTrainedTokenizer{constructor(e,o){super(e,o),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(s=>this.languageRegex.test(s)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(e){if(e===null)return null;const[o,...s]=e.trim().split(this.languageRegex);if(s.length===0)return super._encode_text(o);if(s.length===2){const[c,h]=s;return this.supported_language_codes.includes(c)||console.warn(`Unsupported language code "${c}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),mergeArrays([c],super._encode_text(h))}}}class Wav2Vec2CTCTokenizer extends PreTrainedTokenizer{}class BlenderbotTokenizer extends PreTrainedTokenizer{constructor(){super(...arguments);qt(this,"_default_chat_template","{% for message in messages %}{% if message['role'] == 'user' %}{{ ' ' }}{% endif %}{{ message['content'] }}{% if not loop.last %}{{ '  ' }}{% endif %}{% endfor %}{{ eos_token }}")}}class BlenderbotSmallTokenizer extends BlenderbotTokenizer{}class SpeechT5Tokenizer extends PreTrainedTokenizer{}class NougatTokenizer extends PreTrainedTokenizer{}class VitsTokenizer extends PreTrainedTokenizer{constructor(e,o){super(e,o),this.decoder=new VitsDecoder({})}}class CohereTokenizer extends PreTrainedTokenizer{}class AutoTokenizer{static async from_pretrained(e,{quantized:o=!0,progress_callback:s=null,config:c=null,cache_dir:h=null,local_files_only:_=!1,revision:$="main",legacy:nt=null}={}){var g;const[tt,et]=await loadTokenizer(e,{quantized:o,progress_callback:s,config:c,cache_dir:h,local_files_only:_,revision:$,legacy:nt}),d=((g=et.tokenizer_class)==null?void 0:g.replace(/Fast$/,""))??"PreTrainedTokenizer";let a=this.TOKENIZER_CLASS_MAPPING[d];return a||(console.warn(`Unknown tokenizer class "${d}", attempting to construct from base class.`),a=PreTrainedTokenizer),new a(tt,et)}}qt(AutoTokenizer,"TOKENIZER_CLASS_MAPPING",{T5Tokenizer,DistilBertTokenizer,CamembertTokenizer,DebertaTokenizer,DebertaV2Tokenizer,BertTokenizer,HerbertTokenizer,ConvBertTokenizer,RoFormerTokenizer,XLMTokenizer,ElectraTokenizer,MobileBertTokenizer,SqueezeBertTokenizer,AlbertTokenizer,GPT2Tokenizer,BartTokenizer,MBartTokenizer,MBart50Tokenizer,RobertaTokenizer,WhisperTokenizer,CodeGenTokenizer,CLIPTokenizer,SiglipTokenizer,MarianTokenizer,BloomTokenizer,NllbTokenizer,M2M100Tokenizer,LlamaTokenizer,CodeLlamaTokenizer,XLMRobertaTokenizer,MPNetTokenizer,FalconTokenizer,GPTNeoXTokenizer,EsmTokenizer,Wav2Vec2CTCTokenizer,BlenderbotTokenizer,BlenderbotSmallTokenizer,SpeechT5Tokenizer,NougatTokenizer,VitsTokenizer,Qwen2Tokenizer,GemmaTokenizer,Grok1Tokenizer,CohereTokenizer,PreTrainedTokenizer});async function loadConfig(i,e){return await getModelJSON(i,"config.json",!0,e)}class PretrainedConfig{constructor(e){this.model_type=null,this.is_encoder_decoder=!1,Object.assign(this,e)}static async from_pretrained(e,{progress_callback:o=null,config:s=null,cache_dir:c=null,local_files_only:h=!1,revision:_="main"}={}){let $=s??await loadConfig(e,{progress_callback:o,config:s,cache_dir:c,local_files_only:h,revision:_});return new this($)}}class AutoConfig{static async from_pretrained(...e){return PretrainedConfig.from_pretrained(...e)}}class LogitsProcessorList extends Callable{constructor(){super(),this.processors=[]}push(e){this.processors.push(e)}extend(e){this.processors.push(...e)}_call(e,o){for(let s of o)this.processors.forEach(c=>c(e,s))}[Symbol.iterator](){return this.processors.values()}}class LogitsProcessor extends Callable{_call(e,o){throw Error("`_call` should be implemented in a subclass")}}class ForceTokensLogitsProcessor extends LogitsProcessor{constructor(e){super(),this.force_token_map=Object.fromEntries(e??[])}_call(e,o){let s=this.force_token_map[e.length];return exists(s)&&(o.data.fill(-1/0),o.data[s]=0),o}}class ForcedBOSTokenLogitsProcessor extends LogitsProcessor{constructor(e){super(),this.bos_token_id=e}_call(e,o){return e.length===1&&(o.data.fill(-1/0),o.data[this.bos_token_id]=0),o}}class ForcedEOSTokenLogitsProcessor extends LogitsProcessor{constructor(e,o){super(),this.max_length=e,this.forced_eos_token_id=o}_call(e,o){}}class SuppressTokensAtBeginLogitsProcessor extends LogitsProcessor{constructor(e,o){super(),this.begin_suppress_tokens=e,this.begin_index=o}_call(e,o){if(e.length===this.begin_index)for(let s of this.begin_suppress_tokens)o.data[s]=-1/0;return o}}class WhisperTimeStampLogitsProcessor extends LogitsProcessor{constructor(e){super(),this.eos_token_id=e.eos_token_id,this.no_timestamps_token_id=e.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=(e.forced_decoder_ids||[]).length+2,e.forced_decoder_ids.slice(-1)[0][1]===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=e.max_initial_timestamp_index}_call(e,o){const s=o.data;if(s[this.no_timestamps_token_id]=-1/0,e.length===this.begin_index-1)return s.fill(-1/0),s[this.timestamp_begin]=0,o;const c=e.slice(this.begin_index),h=c.length>=1&&c[c.length-1]>=this.timestamp_begin,_=c.length<2||c[c.length-2]>=this.timestamp_begin;if(h&&(_?s.subarray(this.timestamp_begin).fill(-1/0):s.subarray(0,this.eos_token_id).fill(-1/0)),e.length===this.begin_index&&this.max_initial_timestamp_index!==null){const et=this.timestamp_begin+this.max_initial_timestamp_index;s.subarray(et+1).fill(-1/0)}const $=log_softmax(s),nt=Math.log($.subarray(this.timestamp_begin).map(Math.exp).reduce((et,d)=>et+d)),tt=max($.subarray(0,this.timestamp_begin))[0];return nt>tt&&s.subarray(0,this.timestamp_begin).fill(-1/0),o}}class NoRepeatNGramLogitsProcessor extends LogitsProcessor{constructor(e){super(),this.no_repeat_ngram_size=e}getNgrams(e){const o=e.length,s=[];for(let h=0;h<o+1-this.no_repeat_ngram_size;++h){const _=[];for(let $=0;$<this.no_repeat_ngram_size;++$)_.push(e[h+$]);s.push(_)}const c=new Map;for(const h of s){const _=h.slice(0,h.length-1),$=JSON.stringify(_),nt=c.get($)??[];nt.push(h[h.length-1]),c.set($,nt)}return c}getGeneratedNgrams(e,o){const s=o.slice(o.length+1-this.no_repeat_ngram_size,o.length);return e.get(JSON.stringify(s))??[]}calcBannedNgramTokens(e){const o=[];if(e.length+1<this.no_repeat_ngram_size)return o;{const s=this.getNgrams(e);return this.getGeneratedNgrams(s,e)}}_call(e,o){const s=this.calcBannedNgramTokens(e);for(const c of s)o.data[c]=-1/0;return o}}class RepetitionPenaltyLogitsProcessor extends LogitsProcessor{constructor(e){super(),this.penalty=e}_call(e,o){for(const s of e)o.data[s]<0?o.data[s]*=this.penalty:o.data[s]/=this.penalty;return o}}class MinLengthLogitsProcessor extends LogitsProcessor{constructor(e,o){super(),this.min_length=e,this.eos_token_id=Array.isArray(o)?o:[o]}_call(e,o){if(e.length<this.min_length)for(const s of this.eos_token_id)o.data[s]=-1/0;return o}}class MinNewTokensLengthLogitsProcessor extends LogitsProcessor{constructor(e,o,s){super(),this.prompt_length_to_skip=e,this.min_new_tokens=o,this.eos_token_id=Array.isArray(s)?s:[s]}_call(e,o){if(e.length-this.prompt_length_to_skip<this.min_new_tokens)for(const c of this.eos_token_id)o.data[c]=-1/0;return o}}class NoBadWordsLogitsProcessor extends LogitsProcessor{constructor(e,o){super(),this.bad_words_ids=e,this.eos_token_id=Array.isArray(o)?o:[o]}_call(e,o){for(const s of this.bad_words_ids){let c=!0;for(let h=1;h<=s.length-1&&s.length<e.length;++h)if(s.at(-h-1)!==e.at(-h)){c=!1;break}c&&(o.data[s.at(-1)]=-1/0)}return o}}const GenerationConfig=class{constructor(i={}){this.max_length=i.max_length??20,this.max_new_tokens=i.max_new_tokens??null,this.min_length=i.min_length??0,this.min_new_tokens=i.min_new_tokens??null,this.early_stopping=i.early_stopping??!1,this.max_time=i.max_time??null,this.do_sample=i.do_sample??!1,this.num_beams=i.num_beams??1,this.num_beam_groups=i.num_beam_groups??1,this.penalty_alpha=i.penalty_alpha??null,this.use_cache=i.use_cache??!0,this.temperature=i.temperature??1,this.top_k=i.top_k??50,this.top_p=i.top_p??1,this.typical_p=i.typical_p??1,this.epsilon_cutoff=i.epsilon_cutoff??0,this.eta_cutoff=i.eta_cutoff??0,this.diversity_penalty=i.diversity_penalty??0,this.repetition_penalty=i.repetition_penalty??1,this.encoder_repetition_penalty=i.encoder_repetition_penalty??1,this.length_penalty=i.length_penalty??1,this.no_repeat_ngram_size=i.no_repeat_ngram_size??0,this.bad_words_ids=i.bad_words_ids??null,this.force_words_ids=i.force_words_ids??null,this.renormalize_logits=i.renormalize_logits??!1,this.constraints=i.constraints??null,this.forced_bos_token_id=i.forced_bos_token_id??null,this.forced_eos_token_id=i.forced_eos_token_id??null,this.remove_invalid_values=i.remove_invalid_values??!1,this.exponential_decay_length_penalty=i.exponential_decay_length_penalty??null,this.suppress_tokens=i.suppress_tokens??null,this.begin_suppress_tokens=i.begin_suppress_tokens??null,this.forced_decoder_ids=i.forced_decoder_ids??null,this.num_return_sequences=i.num_return_sequences??1,this.output_attentions=i.output_attentions??!1,this.output_hidden_states=i.output_hidden_states??!1,this.output_scores=i.output_scores??!1,this.return_dict_in_generate=i.return_dict_in_generate??!1,this.pad_token_id=i.pad_token_id??null,this.bos_token_id=i.bos_token_id??null,this.eos_token_id=i.eos_token_id??null,this.encoder_no_repeat_ngram_size=i.encoder_no_repeat_ngram_size??0,this.decoder_start_token_id=i.decoder_start_token_id??null,this.generation_kwargs=i.generation_kwargs??{}}};class Sampler extends Callable{constructor(e){super(),this.generation_config=e}_call(e,o=-1){return this.sample(e,o)}sample(e,o){throw Error("sample should be implemented in subclasses.")}getLogits(e,o){let s=e.dims.at(-1),c=e.data;if(o===-1)c=c.slice(-s);else{let h=o*s;c=c.slice(h,h+s)}return this.generation_config.temperature>0&&(c=c.map(h=>h/this.generation_config.temperature)),c}randomSelect(e){let o=e.reduce((c,h)=>c+h,0),s=Math.random()*o;for(let c=0;c<e.length;++c)if(s-=e[c],s<=0)return c;return 0}static getSampler(e){if(e.do_sample)return new MultinomialSampler(e);if(e.num_beams>1)return new BeamSearchSampler(e);if(e.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${e.num_return_sequences}.`);return new GreedySampler(e)}}class GreedySampler extends Sampler{sample(e,o=-1){let s=this.getLogits(e,o);return[[max(s)[1],0]]}}class MultinomialSampler extends Sampler{sample(e,o=-1){let s=e.dims.at(-1);this.generation_config.top_k>0&&(s=Math.min(this.generation_config.top_k,s));const c=this.getLogits(e,o),h=getTopItems(c,s),_=softmax(h.map($=>$[1]));return Array.from({length:this.generation_config.num_beams},()=>{const $=this.randomSelect(_);return[h[$][0],Math.log(_[$])]})}}class BeamSearchSampler extends Sampler{sample(e,o=-1){let s=e.dims.at(-1);this.generation_config.top_k>0&&(s=Math.min(this.generation_config.top_k,s));const c=this.getLogits(e,o),h=getTopItems(c,s),_=softmax(h.map($=>$[1]));return Array.from({length:this.generation_config.num_beams},($,nt)=>[h[nt][0],Math.log(_[nt])])}}const{InferenceSession,Tensor:ONNXTensor,env}=ONNX,MODEL_TYPES={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5},MODEL_TYPE_MAPPING=new Map,MODEL_NAME_TO_CLASS_MAPPING=new Map,MODEL_CLASS_TO_NAME_MAPPING=new Map;async function constructSession(i,e,o){let s=`onnx/${e}${o.quantized?"_quantized":""}.onnx`,c=await getModelFile(i,s,!0,o);try{return await InferenceSession.create(c,{executionProviders})}catch(h){if(executionProviders.length===1&&executionProviders[0]==="wasm")throw h;return console.warn(h),console.warn("Something went wrong during model construction (most likely a missing operation). Using `wasm` as a fallback. "),await InferenceSession.create(c,{executionProviders:["wasm"]})}}function validateInputs(i,e){const o=Object.create(null),s=[];for(const _ of i.inputNames){const $=e[_];if(!($ instanceof Tensor)){s.push(_);continue}o[_]=env.wasm.proxy?$.clone():$}if(s.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${s.join(", ")}.`);const c=Object.keys(e).length,h=i.inputNames.length;if(c>h){let _=Object.keys(e).filter($=>!i.inputNames.includes($));console.warn(`WARNING: Too many inputs were provided (${c} > ${h}). The following inputs will be ignored: "${_.join(", ")}".`)}return o}async function sessionRun(i,e){const o=validateInputs(i,e);try{let s=await i.run(o);return s=replaceTensors(s),s}catch(s){throw console.error(`An error occurred during model execution: "${s}".`),console.error("Inputs given to model:",o),s}}function replaceTensors(i){for(let e in i)i[e]instanceof ONNXTensor?i[e]=new Tensor(i[e]):typeof i[e]=="object"&&replaceTensors(i[e]);return i}function toI64Tensor(i){if(i instanceof Tensor)return i;if(i.length===0)throw Error("items must be non-empty");if(Array.isArray(i[0])){if(i.some(e=>e.length!==i[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new Tensor("int64",BigInt64Array.from(i.flat().map(e=>BigInt(e))),[i.length,i[0].length])}else return new Tensor("int64",BigInt64Array.from(i.map(e=>BigInt(e))),[1,i.length])}function prepareAttentionMask(i,e){let o=i.config.pad_token_id??null,s=i.config.eos_token_id??null;isIntegralNumber(s)&&(s=[s]);let c=e.indexOf(o)!==-1,h=s===null||!s.includes(o);if(c&&h){let _=BigInt64Array.from(e.data.map($=>$!=o));return new Tensor("int64",_,e.dims)}else return ones_like(e)}function preparePositionIds(i,e,o){if(!i.inputNames.includes("position_ids"))return;const s=new BigInt64Array(e.attention_mask.data.length);for(let c=0;c<e.attention_mask.dims[0];++c){let h=c*e.attention_mask.dims[1],_=BigInt(0);for(let $=0;$<e.attention_mask.dims[1];++$){const nt=h+$;e.attention_mask.data[nt]===0n?s[nt]=BigInt(1):(s[nt]=_,_+=e.attention_mask.data[nt])}}e.position_ids=new Tensor("int64",s,e.attention_mask.dims),o&&(e.position_ids=e.position_ids.slice(null,-1).unsqueeze_(-1))}function boolTensor(i){return new Tensor("bool",[i],[1])}async function seq2seqForward(i,e){let{encoder_outputs:o,past_key_values:s}=e;o||(o=(await encoderForward(i,e)).last_hidden_state);let c={input_ids:e.decoder_input_ids,encoder_hidden_states:o};const h=!!s;i.decoder_merged_session.inputNames.includes("use_cache_branch")&&(c.use_cache_branch=boolTensor(h)),i.decoder_merged_session.inputNames.includes("encoder_attention_mask")&&(c.encoder_attention_mask=e.attention_mask),preparePositionIds(i.decoder_merged_session,c,h),i.addPastKeyValues(c,s);const _=await sessionRun(i.decoder_merged_session,c);let $=_.logits;s=i.getPastKeyValues(_,s);const nt=i.getAttentions(_);return new Seq2SeqLMOutput({logits:$,past_key_values:s,encoder_outputs:o,...nt})}function seq2seqStartBeams(i,e,o,s){let c=[],h=0;const _=i.requires_attention_mask??!0;let $=o.decoder_input_ids??o.decoder_start_token_id??o.bos_token_id??o.eos_token_id;$ instanceof Tensor?$=$.tolist().flat():Array.isArray($)||($=[$]);for(let nt of e){nt.dims=[1,...nt.dims];let tt={inputs:nt,encoder_outputs:null,prev_model_outputs:null,output_token_ids:$,done:!1,score:0,id:h++};_&&(tt.attention_mask=prepareAttentionMask(i,nt)),c.push(tt)}return c}async function seq2seqRunBeam(i,e){var _;const o=i.main_input_name;let s=e.output_token_ids;e.prev_model_outputs&&(s=s.slice(-1));let c={[o]:e.inputs,decoder_input_ids:toI64Tensor(s),encoder_outputs:e.encoder_outputs,past_key_values:(_=e.prev_model_outputs)==null?void 0:_.past_key_values};e.attention_mask&&(c.attention_mask=e.attention_mask);let h=await i.forward(c);return e.prev_model_outputs=h,e.encoder_outputs=h.encoder_outputs,h}function seq2seqUpdatebeam(i,e){i.output_token_ids=[...i.output_token_ids,e]}async function encoderForward(i,e){const o=Object.create(null);for(const s of i.session.inputNames)o[s]=e[s];return i.session.inputNames.includes("token_type_ids")&&!o.token_type_ids&&(o.token_type_ids=new Tensor("int64",new BigInt64Array(o.input_ids.data.length),o.input_ids.dims)),await sessionRun(i.session,o)}async function decoderForward(i,e){let{input_ids:o,past_key_values:s,attention_mask:c}=e,h={input_ids:o,attention_mask:c??prepareAttentionMask(i,o)};const _=!!s;i.session.inputNames.includes("use_cache_branch")&&(h.use_cache_branch=boolTensor(_)),preparePositionIds(i.session,h,_),i.addPastKeyValues(h,s);let $=await sessionRun(i.session,h),nt=$.logits;return s=i.getPastKeyValues($,s),{logits:nt,past_key_values:s}}function decoderStartBeams(i,e,o,s,c){let h=[],_=0;for(let $ of e){let nt=$.tolist().map(Number);$.dims=[1,...$.dims];let tt;c?(tt=c[_],tt.dims=[1,...tt.dims]):tt=prepareAttentionMask(i,$);let et={input:$,model_input_ids:$,attention_mask:tt,prev_model_outputs:null,output_token_ids:nt,num_output_tokens:s,done:!1,score:0,id:_++};h.push(et)}return h}async function decoderRunBeam(i,e){var h;let o=new BigInt64Array(e.output_token_ids.length).fill(1n),s={input_ids:e.model_input_ids,attention_mask:new Tensor("int64",o,[1,o.length]),past_key_values:(h=e.prev_model_outputs)==null?void 0:h.past_key_values},c=await i.forward(s);return e.prev_model_outputs=c,c}function decoderUpdatebeam(i,e){i.output_token_ids=[...i.output_token_ids,e],i.model_input_ids=new Tensor("int64",[BigInt(e)],[1,1])}class PreTrainedModel extends Callable{constructor(o,s){super();qt(this,"main_input_name","input_ids");this.config=o,this.session=s;const c=MODEL_CLASS_TO_NAME_MAPPING.get(this.constructor),h=MODEL_TYPE_MAPPING.get(c);this.can_generate=!1,this._runBeam=null,this._getStartBeams=null,this._updateBeam=null,this._forward=null,h===MODEL_TYPES.DecoderOnly?(this.can_generate=!0,this._runBeam=decoderRunBeam,this._getStartBeams=decoderStartBeams,this._updateBeam=decoderUpdatebeam,this._forward=decoderForward):h===MODEL_TYPES.Seq2Seq||h===MODEL_TYPES.Vision2Seq?(this.can_generate=!0,this._runBeam=seq2seqRunBeam,this._getStartBeams=seq2seqStartBeams,this._updateBeam=seq2seqUpdatebeam,this._forward=seq2seqForward):h===MODEL_TYPES.EncoderDecoder?this._forward=encoderForward:this._forward=encoderForward}async dispose(){const o=[];for(let s of Object.keys(this)){const c=this[s];c instanceof InferenceSession&&o.push(c.handler.dispose())}return await Promise.all(o)}static async from_pretrained(o,{quantized:s=!0,progress_callback:c=null,config:h=null,cache_dir:_=null,local_files_only:$=!1,revision:nt="main",model_file_name:tt=null}={}){let et={quantized:s,progress_callback:c,config:h,cache_dir:_,local_files_only:$,revision:nt,model_file_name:tt};const d=MODEL_CLASS_TO_NAME_MAPPING.get(this),a=MODEL_TYPE_MAPPING.get(d);let g;return a===MODEL_TYPES.DecoderOnly?g=await Promise.all([AutoConfig.from_pretrained(o,et),constructSession(o,et.model_file_name??"decoder_model_merged",et),getModelJSON(o,"generation_config.json",!1,et)]):a===MODEL_TYPES.Seq2Seq||a===MODEL_TYPES.Vision2Seq?g=await Promise.all([AutoConfig.from_pretrained(o,et),constructSession(o,"encoder_model",et),constructSession(o,"decoder_model_merged",et),getModelJSON(o,"generation_config.json",!1,et)]):a===MODEL_TYPES.MaskGeneration?g=await Promise.all([AutoConfig.from_pretrained(o,et),constructSession(o,"vision_encoder",et),constructSession(o,"prompt_encoder_mask_decoder",et)]):a===MODEL_TYPES.EncoderDecoder?g=await Promise.all([AutoConfig.from_pretrained(o,et),constructSession(o,"encoder_model",et),constructSession(o,"decoder_model_merged",et)]):(a!==MODEL_TYPES.EncoderOnly&&console.warn(`Model type for '${d??(h==null?void 0:h.model_type)}' not found, assuming encoder-only architecture. Please report this at https://github.com/xenova/transformers.js/issues/new/choose.`),g=await Promise.all([AutoConfig.from_pretrained(o,et),constructSession(o,et.model_file_name??"model",et)])),new this(...g)}async _call(o){return await this.forward(o)}async forward(o){return await this._forward(this,o)}_get_logits_processor(o,s,c=null){const h=new LogitsProcessorList;if(o.repetition_penalty!==null&&o.repetition_penalty!==1&&h.push(new RepetitionPenaltyLogitsProcessor(o.repetition_penalty)),o.no_repeat_ngram_size!==null&&o.no_repeat_ngram_size>0&&h.push(new NoRepeatNGramLogitsProcessor(o.no_repeat_ngram_size)),o.bad_words_ids!==null&&h.push(new NoBadWordsLogitsProcessor(o.bad_words_ids,o.eos_token_id)),o.min_length!==null&&o.eos_token_id!==null&&o.min_length>0&&h.push(new MinLengthLogitsProcessor(o.min_length,o.eos_token_id)),o.min_new_tokens!==null&&o.eos_token_id!==null&&o.min_new_tokens>0&&h.push(new MinNewTokensLengthLogitsProcessor(s,o.min_new_tokens,o.eos_token_id)),o.forced_bos_token_id!==null&&h.push(new ForcedBOSTokenLogitsProcessor(o.forced_bos_token_id)),o.forced_eos_token_id!==null&&h.push(new ForcedEOSTokenLogitsProcessor(o.max_length,o.forced_eos_token_id)),o.begin_suppress_tokens!==null){let _=s>1||o.forced_bos_token_id===null?s:s+1;o.forced_decoder_ids!==null&&(_+=o.forced_decoder_ids[o.forced_decoder_ids.length-1][0]),h.push(new SuppressTokensAtBeginLogitsProcessor(o.begin_suppress_tokens,_))}return o.forced_decoder_ids!==null&&h.push(new ForceTokensLogitsProcessor(o.forced_decoder_ids)),c!==null&&h.extend(c),h}_get_generation_config(o){let s=new GenerationConfig(this.config);return"generation_config"in this&&Object.assign(s,this.generation_config),o!==null&&Object.assign(s,o),s}async generate(o,s=null,c=null,{inputs_attention_mask:h=null}={}){if(!this.can_generate){let it=`The current model class (${MODEL_CLASS_TO_NAME_MAPPING.get(this.constructor)}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;const at=this.config.model_type,lt=MODEL_WITH_LM_HEAD_MAPPING_NAMES.get(at)??MODEL_FOR_SEQ_TO_SEQ_CAUSAL_LM_MAPPING_NAMES.get(at)??MODEL_FOR_SPEECH_SEQ_2_SEQ_MAPPING_NAMES.get(at)??MODEL_FOR_VISION_2_SEQ_MAPPING_NAMES.get(at);throw lt&&(it+=` Please use the following class instead: '${lt[0]}'`),Error(it)}if(!(o instanceof Tensor)&&!isTypedArray(o)&&!Array.isArray(o))throw Error(`\`inputs\` must be a Tensor, TypedArray, or Array, but is "${o.constructor.name}".`);let _;if(this.config.is_encoder_decoder)_=0;else if(_=o instanceof Tensor?o.dims.at(-1):o.length,_===0)throw Error("Must supply a non-empty array of input token ids.");s=this._get_generation_config(s),c=c??new LogitsProcessorList,c=this._get_logits_processor(s,_,c);let $=s.eos_token_id;$!==null&&!Array.isArray($)&&($=[$]);let nt=1;const tt=nt+(s.max_new_tokens??1/0),et=Number.isInteger(s.max_length)&&(s.max_new_tokens??null)===null;let d=Sampler.getSampler(s),a=this.getStartBeams(o,s,nt,h);for(;a.some(ot=>!ot.done)&&nt<tt;){let ot=[];for(let it of a){if(it.done){ot.push(it);continue}if(et&&it.output_token_ids.length>=s.max_length){it.done=!0,ot.push(it);continue}let at=await this.runBeam(it);s.output_attentions&&this.addAttentionsToBeam(it,at),s.output_scores;let lt=at.logits.slice(null,-1,null);c(it.output_token_ids,lt);let ct=d(lt);for(let[dt,mt]of ct){let ht={...it};this.updateBeam(ht,dt),ht.score+=mt,$&&$.includes(dt)&&(ht.done=!0),ot.push(ht)}}++nt,ot=this.groupBeams(ot).map(it=>it.sort((at,lt)=>lt.score-at.score).slice(0,s.num_beams)),a=ot.flat(),s.callback_function&&s.callback_function(a)}const g=this.groupBeams(a),j=ot=>g.map(it=>s.num_return_sequences>1?it.slice(0,s.num_return_sequences).map(at=>at[ot]):[it[0][ot]]).flat(),rt=j("output_token_ids");if(s.return_dict_in_generate){const ot=j("decoder_attentions"),it=j("cross_attentions");return{sequences:rt,decoder_attentions:ot,cross_attentions:it}}else return rt}addAttentionsToBeam(o,s){if(this.config.is_encoder_decoder){if(!s.cross_attentions||s.cross_attentions.length===0)throw Error("`output_attentions` is true, but the model did not produce cross-attentions. This is most likely because the model was not exported with `output_attentions=True`.");o.cross_attentions||(o.cross_attentions=[]),o.cross_attentions.push(s.cross_attentions)}if(!s.decoder_attentions||s.decoder_attentions.length===0)throw Error("`output_attentions` is true, but the model did not produce decoder-attentions. This is most likely because the model was not exported with `output_attentions=True`.");o.decoder_attentions||(o.decoder_attentions=[]),o.decoder_attentions.push(s.decoder_attentions)}groupBeams(o){const s=Object.create(null);for(const c of o)s[c.id]===void 0?s[c.id]=[c]:s[c.id].push(c);return Object.values(s)}getPastKeyValues(o,s){const c=Object.create(null);for(const h in o)if(h.startsWith("present")){let _=h.replace("present","past_key_values");s&&h.includes("encoder")?c[_]=s[_]:c[_]=o[h]}return c}getAttentions(o){const s=Object.create(null);for(const c of["cross_attentions","decoder_attentions"]){const h=[];for(const _ in o)if(_.startsWith(c)){const $=_.split(".").pop();h[$]=o[_]}s[c]=h}return s}addPastKeyValues(o,s){if(s)Object.assign(o,s);else if(this.config.is_encoder_decoder&&(this.add_encoder_pkv??!0)){let h=[1,this.num_encoder_heads,0,this.encoder_dim_kv],_=[1,this.num_decoder_heads,0,this.decoder_dim_kv];for(let $=0;$<this.num_decoder_layers;++$)o[`past_key_values.${$}.encoder.key`]=new Tensor("float32",[],h),o[`past_key_values.${$}.encoder.value`]=new Tensor("float32",[],h),o[`past_key_values.${$}.decoder.key`]=new Tensor("float32",[],_),o[`past_key_values.${$}.decoder.value`]=new Tensor("float32",[],_)}else if(this.config.model_type==="falcon"){let h=[1*this.num_heads,0,this.dim_kv];for(let _=0;_<this.num_layers;++_)o[`past_key_values.${_}.key`]=new Tensor("float32",[],h),o[`past_key_values.${_}.value`]=new Tensor("float32",[],h)}else if(this.config.multi_query){let h=[1*this.num_heads,0,2*this.dim_kv];for(let _=0;_<this.num_layers;++_)o[`past_key_values.${_}.key_value`]=new Tensor("float32",[],h)}else if(this.config.model_type==="bloom"){let h=[1*this.num_heads,this.dim_kv,0],_=[1*this.num_heads,0,this.dim_kv];for(let $=0;$<this.num_layers;++$)o[`past_key_values.${$}.key`]=new Tensor("float32",[],h),o[`past_key_values.${$}.value`]=new Tensor("float32",[],_)}else{let h=[1,this.num_heads,0,this.dim_kv];for(let _=0;_<this.num_layers;++_)o[`past_key_values.${_}.key`]=new Tensor("float32",[],h),o[`past_key_values.${_}.value`]=new Tensor("float32",[],h)}}getStartBeams(o,s,c,h){return this._getStartBeams(this,o,s,c,h)}async runBeam(o){return await this._runBeam(this,o)}updateBeam(o,s){return this._updateBeam(o,s)}}class ModelOutput{}class BertPreTrainedModel extends PreTrainedModel{}class BertModel extends BertPreTrainedModel{}class BertForMaskedLM extends BertPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class BertForSequenceClassification extends BertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class BertForTokenClassification extends BertPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class BertForQuestionAnswering extends BertPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class NomicBertPreTrainedModel extends PreTrainedModel{}class NomicBertModel extends NomicBertPreTrainedModel{}class RoFormerPreTrainedModel extends PreTrainedModel{}class RoFormerModel extends RoFormerPreTrainedModel{}class RoFormerForMaskedLM extends RoFormerPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class RoFormerForSequenceClassification extends RoFormerPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class RoFormerForTokenClassification extends RoFormerPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class RoFormerForQuestionAnswering extends RoFormerPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class ConvBertPreTrainedModel extends PreTrainedModel{}class ConvBertModel extends ConvBertPreTrainedModel{}class ConvBertForMaskedLM extends ConvBertPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class ConvBertForSequenceClassification extends ConvBertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class ConvBertForTokenClassification extends ConvBertPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class ConvBertForQuestionAnswering extends ConvBertPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class ElectraPreTrainedModel extends PreTrainedModel{}class ElectraModel extends ElectraPreTrainedModel{}class ElectraForMaskedLM extends ElectraPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class ElectraForSequenceClassification extends ElectraPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class ElectraForTokenClassification extends ElectraPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class ElectraForQuestionAnswering extends ElectraPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class CamembertPreTrainedModel extends PreTrainedModel{}class CamembertModel extends CamembertPreTrainedModel{}class CamembertForMaskedLM extends CamembertPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class CamembertForSequenceClassification extends CamembertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class CamembertForTokenClassification extends CamembertPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class CamembertForQuestionAnswering extends CamembertPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class DebertaPreTrainedModel extends PreTrainedModel{}class DebertaModel extends DebertaPreTrainedModel{}class DebertaForMaskedLM extends DebertaPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class DebertaForSequenceClassification extends DebertaPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class DebertaForTokenClassification extends DebertaPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class DebertaForQuestionAnswering extends DebertaPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class DebertaV2PreTrainedModel extends PreTrainedModel{}class DebertaV2Model extends DebertaV2PreTrainedModel{}class DebertaV2ForMaskedLM extends DebertaV2PreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class DebertaV2ForSequenceClassification extends DebertaV2PreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class DebertaV2ForTokenClassification extends DebertaV2PreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class DebertaV2ForQuestionAnswering extends DebertaV2PreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class DistilBertPreTrainedModel extends PreTrainedModel{}class DistilBertModel extends DistilBertPreTrainedModel{}class DistilBertForSequenceClassification extends DistilBertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class DistilBertForTokenClassification extends DistilBertPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class DistilBertForQuestionAnswering extends DistilBertPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class DistilBertForMaskedLM extends DistilBertPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class EsmPreTrainedModel extends PreTrainedModel{}class EsmModel extends EsmPreTrainedModel{}class EsmForMaskedLM extends EsmPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class EsmForSequenceClassification extends EsmPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class EsmForTokenClassification extends EsmPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class MobileBertPreTrainedModel extends PreTrainedModel{}class MobileBertModel extends MobileBertPreTrainedModel{}class MobileBertForMaskedLM extends MobileBertPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class MobileBertForSequenceClassification extends MobileBertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class MobileBertForQuestionAnswering extends MobileBertPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class MPNetPreTrainedModel extends PreTrainedModel{}class MPNetModel extends MPNetPreTrainedModel{}class MPNetForMaskedLM extends MPNetPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class MPNetForSequenceClassification extends MPNetPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class MPNetForTokenClassification extends MPNetPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class MPNetForQuestionAnswering extends MPNetPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class SqueezeBertPreTrainedModel extends PreTrainedModel{}class SqueezeBertModel extends SqueezeBertPreTrainedModel{}class SqueezeBertForMaskedLM extends SqueezeBertPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class SqueezeBertForSequenceClassification extends SqueezeBertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class SqueezeBertForQuestionAnswering extends SqueezeBertPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class AlbertPreTrainedModel extends PreTrainedModel{}class AlbertModel extends AlbertPreTrainedModel{}class AlbertForSequenceClassification extends AlbertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class AlbertForQuestionAnswering extends AlbertPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class AlbertForMaskedLM extends AlbertPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class T5PreTrainedModel extends PreTrainedModel{}class T5Model extends T5PreTrainedModel{}class T5ForConditionalGeneration extends T5PreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.num_decoder_layers,this.num_decoder_heads=this.config.num_heads,this.decoder_dim_kv=this.config.d_kv,this.num_encoder_layers=this.config.num_layers,this.num_encoder_heads=this.config.num_heads,this.encoder_dim_kv=this.config.d_kv}}class LongT5PreTrainedModel extends PreTrainedModel{}class LongT5Model extends LongT5PreTrainedModel{}class LongT5ForConditionalGeneration extends LongT5PreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.num_decoder_layers,this.num_decoder_heads=this.config.num_heads,this.decoder_dim_kv=this.config.d_kv,this.num_encoder_layers=this.config.num_layers,this.num_encoder_heads=this.config.num_heads,this.encoder_dim_kv=this.config.d_kv}}class MT5PreTrainedModel extends PreTrainedModel{}class MT5Model extends MT5PreTrainedModel{}class MT5ForConditionalGeneration extends MT5PreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.num_decoder_layers,this.num_decoder_heads=this.config.num_heads,this.decoder_dim_kv=this.config.d_kv,this.num_encoder_layers=this.config.num_layers,this.num_encoder_heads=this.config.num_heads,this.encoder_dim_kv=this.config.d_kv}}class BartPretrainedModel extends PreTrainedModel{}class BartModel extends BartPretrainedModel{}class BartForConditionalGeneration extends BartPretrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class BartForSequenceClassification extends BartPretrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class MBartPreTrainedModel extends PreTrainedModel{}class MBartModel extends MBartPreTrainedModel{}class MBartForConditionalGeneration extends MBartPreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class MBartForSequenceClassification extends MBartPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class MBartForCausalLM extends MBartPreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class BlenderbotPreTrainedModel extends PreTrainedModel{}class BlenderbotModel extends BlenderbotPreTrainedModel{}class BlenderbotForConditionalGeneration extends BlenderbotPreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class BlenderbotSmallPreTrainedModel extends PreTrainedModel{}class BlenderbotSmallModel extends BlenderbotSmallPreTrainedModel{}class BlenderbotSmallForConditionalGeneration extends BlenderbotSmallPreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class RobertaPreTrainedModel extends PreTrainedModel{}class RobertaModel extends RobertaPreTrainedModel{}class RobertaForMaskedLM extends RobertaPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class RobertaForSequenceClassification extends RobertaPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class RobertaForTokenClassification extends RobertaPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class RobertaForQuestionAnswering extends RobertaPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class XLMPreTrainedModel extends PreTrainedModel{}class XLMModel extends XLMPreTrainedModel{}class XLMWithLMHeadModel extends XLMPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class XLMForSequenceClassification extends XLMPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class XLMForTokenClassification extends XLMPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class XLMForQuestionAnswering extends XLMPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class XLMRobertaPreTrainedModel extends PreTrainedModel{}class XLMRobertaModel extends XLMRobertaPreTrainedModel{}class XLMRobertaForMaskedLM extends XLMRobertaPreTrainedModel{async _call(e){return new MaskedLMOutput(await super._call(e))}}class XLMRobertaForSequenceClassification extends XLMRobertaPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class XLMRobertaForTokenClassification extends XLMRobertaPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class XLMRobertaForQuestionAnswering extends XLMRobertaPreTrainedModel{async _call(e){return new QuestionAnsweringModelOutput(await super._call(e))}}class ASTPreTrainedModel extends PreTrainedModel{}class ASTModel extends ASTPreTrainedModel{}class ASTForAudioClassification extends ASTPreTrainedModel{}class WhisperPreTrainedModel extends PreTrainedModel{}class WhisperModel extends WhisperPreTrainedModel{}class WhisperForConditionalGeneration extends WhisperPreTrainedModel{constructor(o,s,c,h){super(o,s);qt(this,"requires_attention_mask",!1);qt(this,"main_input_name","input_features");this.decoder_merged_session=c,this.generation_config=h,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}async generate(o,s=null,c=null){if(s=this._get_generation_config(s),s.return_timestamps??(s.return_timestamps=!1),s.return_timestamps&&(c=[new WhisperTimeStampLogitsProcessor(s)]),s.return_token_timestamps&&(s.output_attentions=!0,s.return_dict_in_generate=!0,s.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),!s.alignment_heads))throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");const h=await super.generate(o,s,c);return s.return_token_timestamps&&s.alignment_heads&&(h.token_timestamps=this._extract_token_timestamps(h,s.alignment_heads,s.num_frames)),h}_extract_token_timestamps(o,s,c=null,h=.02){if(!o.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");let _=this.config.median_filter_width;_===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),_=7);const $=o.cross_attentions.map(et=>{let d=Array.from({length:this.config.decoder_layers},(it,at)=>cat(et.map(lt=>lt[at]),2)),a=stack(s.map(([it,at])=>c?d[it].slice(null,at,null,[0,c]):d[it].slice(null,at)));a=a.transpose(1,0,2,3);let[g,j]=std_mean(a,-2,0,!0),rt=a.clone();for(let it=0;it<rt.dims[0];++it){let at=rt[it];for(let lt=0;lt<at.dims[0];++lt){let ct=at[lt];const dt=g[it][lt][0],mt=j[it][lt][0];for(let ht=0;ht<ct.dims[0];++ht){let ft=ct[ht];for(let ut=0;ut<ft.data.length;++ut)ft.data[ut]=(ft.data[ut]-mt.data[ut])/dt.data[ut];ft.data.set(medianFilter(ft.data,_))}}}return mean(rt,1)}),nt=[o.sequences.length,o.sequences[0].length],tt=new Tensor("float32",new Float32Array(nt[0]*nt[1]),nt);for(let et=0;et<nt[0];++et){const d=$[et].neg().squeeze_(0);let[a,g]=dynamicTimeWarping(d),j=Array.from({length:a.length-1},(it,at)=>a[at+1]-a[at]),rt=mergeArrays([1],j).map(it=>!!it),ot=[];for(let it=0;it<rt.length;++it)rt[it]&&ot.push(g[it]*h);tt[et].data.set(ot,1)}return tt}}class VisionEncoderDecoderModel extends PreTrainedModel{constructor(o,s,c,h){super(o,s);qt(this,"main_input_name","pixel_values");this.decoder_merged_session=c,this.generation_config=h;const _=this.config.encoder,$=this.config.decoder,nt=_.model_type;(MODEL_MAPPING_NAMES_ENCODER_ONLY.get(nt)??MODEL_MAPPING_NAMES_ENCODER_DECODER.get(nt))||console.warn(`Model type for encoder '${nt}' not found, assuming encoder-only architecture. Please report this at https://github.com/xenova/transformers.js/issues/new/choose.`);const et=MODEL_WITH_LM_HEAD_MAPPING_NAMES.get($.model_type);if(!et)throw new Error(`Unable to construct \`VisionEncoderDecoder\` due to unsupported decoder: "${this.config.decoder.model_type}"`);const d=et[1],a=new d($,c,h);this.add_encoder_pkv="num_decoder_layers"in a,this.add_encoder_pkv?(this.num_decoder_layers=a.num_decoder_layers,this.num_decoder_heads=a.num_decoder_heads,this.decoder_dim_kv=a.decoder_dim_kv,this.num_encoder_layers=a.num_encoder_layers,this.num_encoder_heads=a.num_encoder_heads,this.encoder_dim_kv=a.encoder_dim_kv):(this.num_layers=a.num_layers,this.num_heads=a.num_heads,this.dim_kv=a.dim_kv)}}class CLIPPreTrainedModel extends PreTrainedModel{}class CLIPModel extends CLIPPreTrainedModel{}class CLIPTextModelWithProjection extends CLIPPreTrainedModel{static async from_pretrained(e,o={}){return o.model_file_name??(o.model_file_name="text_model"),super.from_pretrained(e,o)}}class CLIPVisionModelWithProjection extends CLIPPreTrainedModel{static async from_pretrained(e,o={}){return o.model_file_name??(o.model_file_name="vision_model"),super.from_pretrained(e,o)}}class SiglipPreTrainedModel extends PreTrainedModel{}class SiglipModel extends SiglipPreTrainedModel{}class SiglipTextModel extends SiglipPreTrainedModel{static async from_pretrained(e,o={}){return o.model_file_name??(o.model_file_name="text_model"),super.from_pretrained(e,o)}}class SiglipVisionModel extends CLIPPreTrainedModel{static async from_pretrained(e,o={}){return o.model_file_name??(o.model_file_name="vision_model"),super.from_pretrained(e,o)}}class ChineseCLIPPreTrainedModel extends PreTrainedModel{}class ChineseCLIPModel extends ChineseCLIPPreTrainedModel{}class CLIPSegPreTrainedModel extends PreTrainedModel{}class CLIPSegModel extends CLIPSegPreTrainedModel{}class CLIPSegForImageSegmentation extends CLIPSegPreTrainedModel{}class GPT2PreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class GPT2Model extends GPT2PreTrainedModel{}class GPT2LMHeadModel extends GPT2PreTrainedModel{}class GPTNeoPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_heads,this.num_layers=this.config.num_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class GPTNeoModel extends GPTNeoPreTrainedModel{}class GPTNeoForCausalLM extends GPTNeoPreTrainedModel{}class GPTNeoXPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class GPTNeoXModel extends GPTNeoXPreTrainedModel{}class GPTNeoXForCausalLM extends GPTNeoXPreTrainedModel{}class GPTJPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class GPTJModel extends GPTJPreTrainedModel{}class GPTJForCausalLM extends GPTJPreTrainedModel{}class GPTBigCodePreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class GPTBigCodeModel extends GPTBigCodePreTrainedModel{}class GPTBigCodeForCausalLM extends GPTBigCodePreTrainedModel{}class CodeGenPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.n_embd/this.num_heads}}class CodeGenModel extends CodeGenPreTrainedModel{}class CodeGenForCausalLM extends CodeGenPreTrainedModel{}class LlamaPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_key_value_heads??this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class LlamaModel extends LlamaPreTrainedModel{}class LlamaForCausalLM extends LlamaPreTrainedModel{}class Qwen2PreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_key_value_heads??this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class Qwen2Model extends Qwen2PreTrainedModel{}class Qwen2ForCausalLM extends Qwen2PreTrainedModel{}class PhiPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class PhiModel extends PhiPreTrainedModel{}class PhiForCausalLM extends PhiPreTrainedModel{}class BloomPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_head,this.num_layers=this.config.n_layer,this.dim_kv=this.config.hidden_size/this.num_heads}}class BloomModel extends BloomPreTrainedModel{}class BloomForCausalLM extends BloomPreTrainedModel{}class MptPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.n_heads,this.num_layers=this.config.n_layers,this.dim_kv=this.config.d_model/this.num_heads}}class MptModel extends MptPreTrainedModel{}class MptForCausalLM extends MptPreTrainedModel{}class OPTPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class OPTModel extends OPTPreTrainedModel{}class OPTForCausalLM extends OPTPreTrainedModel{}class ViTPreTrainedModel extends PreTrainedModel{}class ViTModel extends ViTPreTrainedModel{}class ViTForImageClassification extends ViTPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class FastViTPreTrainedModel extends PreTrainedModel{}class FastViTModel extends FastViTPreTrainedModel{}class FastViTForImageClassification extends FastViTPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class VitMattePreTrainedModel extends PreTrainedModel{}class VitMatteForImageMatting extends VitMattePreTrainedModel{async _call(e){return new ImageMattingOutput(await super._call(e))}}class MobileViTPreTrainedModel extends PreTrainedModel{}class MobileViTModel extends MobileViTPreTrainedModel{}class MobileViTForImageClassification extends MobileViTPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class MobileViTV2PreTrainedModel extends PreTrainedModel{}class MobileViTV2Model extends MobileViTV2PreTrainedModel{}class MobileViTV2ForImageClassification extends MobileViTV2PreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class OwlViTPreTrainedModel extends PreTrainedModel{}class OwlViTModel extends OwlViTPreTrainedModel{}class OwlViTForObjectDetection extends OwlViTPreTrainedModel{}class Owlv2PreTrainedModel extends PreTrainedModel{}class Owlv2Model extends Owlv2PreTrainedModel{}class Owlv2ForObjectDetection extends Owlv2PreTrainedModel{}class BeitPreTrainedModel extends PreTrainedModel{}class BeitModel extends BeitPreTrainedModel{}class BeitForImageClassification extends BeitPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class DetrPreTrainedModel extends PreTrainedModel{}class DetrModel extends DetrPreTrainedModel{}class DetrForObjectDetection extends DetrPreTrainedModel{async _call(e){return new DetrObjectDetectionOutput(await super._call(e))}}class DetrForSegmentation extends DetrPreTrainedModel{async _call(e){return new DetrSegmentationOutput(await super._call(e))}}class DetrObjectDetectionOutput extends ModelOutput{constructor({logits:e,pred_boxes:o}){super(),this.logits=e,this.pred_boxes=o}}class DetrSegmentationOutput extends ModelOutput{constructor({logits:e,pred_boxes:o,pred_masks:s}){super(),this.logits=e,this.pred_boxes=o,this.pred_masks=s}}class TableTransformerPreTrainedModel extends PreTrainedModel{}class TableTransformerModel extends TableTransformerPreTrainedModel{}class TableTransformerForObjectDetection extends TableTransformerPreTrainedModel{async _call(e){return new TableTransformerObjectDetectionOutput(await super._call(e))}}class TableTransformerObjectDetectionOutput extends DetrObjectDetectionOutput{}class DeiTPreTrainedModel extends PreTrainedModel{}class DeiTModel extends DeiTPreTrainedModel{}class DeiTForImageClassification extends DeiTPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class ResNetPreTrainedModel extends PreTrainedModel{}class ResNetModel extends ResNetPreTrainedModel{}class ResNetForImageClassification extends ResNetPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class SwinPreTrainedModel extends PreTrainedModel{}class SwinModel extends SwinPreTrainedModel{}class SwinForImageClassification extends SwinPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class Swin2SRPreTrainedModel extends PreTrainedModel{}class Swin2SRModel extends Swin2SRPreTrainedModel{}class Swin2SRForImageSuperResolution extends Swin2SRPreTrainedModel{}class DPTPreTrainedModel extends PreTrainedModel{}class DPTModel extends DPTPreTrainedModel{}class DPTForDepthEstimation extends DPTPreTrainedModel{}class DepthAnythingPreTrainedModel extends PreTrainedModel{}class DepthAnythingForDepthEstimation extends DepthAnythingPreTrainedModel{}class GLPNPreTrainedModel extends PreTrainedModel{}class GLPNModel extends GLPNPreTrainedModel{}class GLPNForDepthEstimation extends GLPNPreTrainedModel{}class DonutSwinPreTrainedModel extends PreTrainedModel{}class DonutSwinModel extends DonutSwinPreTrainedModel{}class ConvNextPreTrainedModel extends PreTrainedModel{}class ConvNextModel extends ConvNextPreTrainedModel{}class ConvNextForImageClassification extends ConvNextPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class ConvNextV2PreTrainedModel extends PreTrainedModel{}class ConvNextV2Model extends ConvNextV2PreTrainedModel{}class ConvNextV2ForImageClassification extends ConvNextV2PreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class Dinov2PreTrainedModel extends PreTrainedModel{}class Dinov2Model extends Dinov2PreTrainedModel{}class Dinov2ForImageClassification extends Dinov2PreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class YolosPreTrainedModel extends PreTrainedModel{}class YolosModel extends YolosPreTrainedModel{}class YolosForObjectDetection extends YolosPreTrainedModel{async _call(e){return new YolosObjectDetectionOutput(await super._call(e))}}class YolosObjectDetectionOutput extends ModelOutput{constructor({logits:e,pred_boxes:o}){super(),this.logits=e,this.pred_boxes=o}}class SamPreTrainedModel extends PreTrainedModel{}class SamModel extends SamPreTrainedModel{constructor(e,o,s){super(e,o),this.prompt_encoder_mask_decoder=s}async get_image_embeddings({pixel_values:e}){return await encoderForward(this,{pixel_values:e})}async forward(e){if((!e.image_embeddings||!e.image_positional_embeddings)&&(e={...e,...await this.get_image_embeddings(e)}),!e.input_labels){const o=e.input_points.dims.slice(0,-1),s=o.reduce((c,h)=>c*h,1);e.input_labels=new Tensor("int64",new BigInt64Array(s).fill(1n),o)}return await sessionRun(this.prompt_encoder_mask_decoder,{input_points:e.input_points,input_labels:e.input_labels,image_embeddings:e.image_embeddings,image_positional_embeddings:e.image_positional_embeddings})}async _call(e){return new SamImageSegmentationOutput(await super._call(e))}}class SamImageSegmentationOutput extends ModelOutput{constructor({iou_scores:e,pred_masks:o}){super(),this.iou_scores=e,this.pred_masks=o}}class MarianPreTrainedModel extends PreTrainedModel{}class MarianModel extends MarianPreTrainedModel{}class MarianMTModel extends MarianPreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class M2M100PreTrainedModel extends PreTrainedModel{}class M2M100Model extends M2M100PreTrainedModel{}class M2M100ForConditionalGeneration extends M2M100PreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.d_model/this.num_encoder_heads}}class Wav2Vec2PreTrainedModel extends PreTrainedModel{}class Wav2Vec2Model extends Wav2Vec2PreTrainedModel{}class Wav2Vec2ForCTC extends Wav2Vec2PreTrainedModel{async _call(e){return new CausalLMOutput(await super._call(e))}}class Wav2Vec2ForSequenceClassification extends Wav2Vec2PreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class Wav2Vec2ForAudioFrameClassification extends Wav2Vec2PreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class UniSpeechPreTrainedModel extends PreTrainedModel{}class UniSpeechModel extends UniSpeechPreTrainedModel{}class UniSpeechForCTC extends UniSpeechPreTrainedModel{async _call(e){return new CausalLMOutput(await super._call(e))}}class UniSpeechForSequenceClassification extends UniSpeechPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class UniSpeechSatPreTrainedModel extends PreTrainedModel{}class UniSpeechSatModel extends UniSpeechSatPreTrainedModel{}class UniSpeechSatForCTC extends UniSpeechSatPreTrainedModel{async _call(e){return new CausalLMOutput(await super._call(e))}}class UniSpeechSatForSequenceClassification extends UniSpeechSatPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class UniSpeechSatForAudioFrameClassification extends UniSpeechSatPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class Wav2Vec2BertPreTrainedModel extends PreTrainedModel{}class Wav2Vec2BertModel extends Wav2Vec2BertPreTrainedModel{}class Wav2Vec2BertForCTC extends Wav2Vec2BertPreTrainedModel{async _call(e){return new CausalLMOutput(await super._call(e))}}class Wav2Vec2BertForSequenceClassification extends Wav2Vec2BertPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class HubertModel extends Wav2Vec2PreTrainedModel{}class HubertForCTC extends Wav2Vec2PreTrainedModel{async _call(e){return new CausalLMOutput(await super._call(e))}}class HubertForSequenceClassification extends Wav2Vec2PreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class WavLMPreTrainedModel extends PreTrainedModel{}class WavLMModel extends WavLMPreTrainedModel{}class WavLMForCTC extends WavLMPreTrainedModel{async _call(e){return new CausalLMOutput(await super._call(e))}}class WavLMForSequenceClassification extends WavLMPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class WavLMForXVector extends WavLMPreTrainedModel{async _call(e){return new XVectorOutput(await super._call(e))}}class WavLMForAudioFrameClassification extends WavLMPreTrainedModel{async _call(e){return new TokenClassifierOutput(await super._call(e))}}class SpeechT5PreTrainedModel extends PreTrainedModel{}class SpeechT5ForSpeechToText extends SpeechT5PreTrainedModel{}class SpeechT5ForTextToSpeech extends SpeechT5PreTrainedModel{constructor(e,o,s,c){super(e,o),this.decoder_merged_session=s,this.generation_config=c,this.num_decoder_layers=this.config.decoder_layers,this.num_decoder_heads=this.config.decoder_attention_heads,this.decoder_dim_kv=this.config.hidden_size/this.num_decoder_heads,this.num_encoder_layers=this.config.encoder_layers,this.num_encoder_heads=this.config.encoder_attention_heads,this.encoder_dim_kv=this.config.hidden_size/this.num_encoder_heads}async generate_speech(e,o,{threshold:s=.5,minlenratio:c=0,maxlenratio:h=20,vocoder:_=null}={}){const $={input_ids:e},{encoder_outputs:nt,encoder_attention_mask:tt}=await encoderForward(this,$),et=nt.dims[1]/this.config.reduction_factor,d=Math.floor(et*h),a=Math.floor(et*c),g=this.config.num_mel_bins;let j=[],rt=null,ot=null,it=0;for(;;){++it;const ct=boolTensor(!!ot);let dt;ot?dt=ot.output_sequence_out:dt=new Tensor("float32",new Float32Array(g),[1,1,g]);let mt={use_cache_branch:ct,output_sequence:dt,encoder_attention_mask:tt,speaker_embeddings:o,encoder_hidden_states:nt};this.addPastKeyValues(mt,rt),ot=await sessionRun(this.decoder_merged_session,mt),rt=this.getPastKeyValues(ot,rt);const{prob:ht,spectrum:ft}=ot;if(j.push(ft),it>=a&&(Array.from(ht.data).filter(ut=>ut>=s).length>0||it>=d))break}const at=cat(j),{waveform:lt}=await sessionRun(_.session,{spectrogram:at});return{spectrogram:at,waveform:lt}}}class SpeechT5HifiGan extends PreTrainedModel{constructor(){super(...arguments);qt(this,"main_input_name","spectrogram")}}class TrOCRPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_encoder_layers=this.num_decoder_layers=this.config.decoder_layers,this.num_encoder_heads=this.num_decoder_heads=this.config.decoder_attention_heads,this.encoder_dim_kv=this.decoder_dim_kv=this.config.d_model/this.num_decoder_heads}}class TrOCRForCausalLM extends TrOCRPreTrainedModel{}class MistralPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_key_value_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class MistralModel extends MistralPreTrainedModel{}class MistralForCausalLM extends MistralPreTrainedModel{}class Starcoder2PreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_key_value_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class Starcoder2Model extends Starcoder2PreTrainedModel{}class Starcoder2ForCausalLM extends Starcoder2PreTrainedModel{}class FalconPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.config.num_attention_heads}}class FalconModel extends FalconPreTrainedModel{}class FalconForCausalLM extends FalconPreTrainedModel{}class ClapPreTrainedModel extends PreTrainedModel{}class ClapModel extends ClapPreTrainedModel{}class ClapTextModelWithProjection extends ClapPreTrainedModel{static async from_pretrained(e,o={}){return o.model_file_name??(o.model_file_name="text_model"),super.from_pretrained(e,o)}}class ClapAudioModelWithProjection extends ClapPreTrainedModel{static async from_pretrained(e,o={}){return o.model_file_name??(o.model_file_name="audio_model"),super.from_pretrained(e,o)}}class VitsPreTrainedModel extends PreTrainedModel{}class VitsModel extends VitsPreTrainedModel{async _call(e){return new VitsModelOutput(await super._call(e))}}class SegformerPreTrainedModel extends PreTrainedModel{}class SegformerForImageClassification extends SegformerPreTrainedModel{}class SegformerForSemanticSegmentation extends SegformerPreTrainedModel{}class StableLmPreTrainedModel extends PreTrainedModel{constructor(e,o,s){super(e,o),this.generation_config=s,this.config.pad_token_id=this.config.eos_token_id,this.num_heads=this.config.num_attention_heads,this.num_layers=this.config.num_hidden_layers,this.dim_kv=this.config.hidden_size/this.num_heads}}class StableLmForCausalLM extends StableLmPreTrainedModel{}class EfficientNetPreTrainedModel extends PreTrainedModel{}class EfficientNetModel extends EfficientNetPreTrainedModel{}class EfficientNetForImageClassification extends EfficientNetPreTrainedModel{async _call(e){return new SequenceClassifierOutput(await super._call(e))}}class PretrainedMixin{static async from_pretrained(e,{quantized:o=!0,progress_callback:s=null,config:c=null,cache_dir:h=null,local_files_only:_=!1,revision:$="main",model_file_name:nt=null}={}){let tt={quantized:o,progress_callback:s,config:c,cache_dir:h,local_files_only:_,revision:$,model_file_name:nt};if(c=await AutoConfig.from_pretrained(e,tt),tt.config||(tt.config=c),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);for(let et of this.MODEL_CLASS_MAPPINGS){const d=et.get(c.model_type);if(d)return await d[1].from_pretrained(e,tt)}if(this.BASE_IF_FAIL)return console.warn(`Unknown model class "${c.model_type}", attempting to construct from base class.`),await PreTrainedModel.from_pretrained(e,tt);throw Error(`Unsupported model type: ${c.model_type}`)}}qt(PretrainedMixin,"MODEL_CLASS_MAPPINGS",null),qt(PretrainedMixin,"BASE_IF_FAIL",!1);const MODEL_MAPPING_NAMES_ENCODER_ONLY=new Map([["bert",["BertModel",BertModel]],["nomic_bert",["NomicBertModel",NomicBertModel]],["roformer",["RoFormerModel",RoFormerModel]],["electra",["ElectraModel",ElectraModel]],["esm",["EsmModel",EsmModel]],["convbert",["ConvBertModel",ConvBertModel]],["camembert",["CamembertModel",CamembertModel]],["deberta",["DebertaModel",DebertaModel]],["deberta-v2",["DebertaV2Model",DebertaV2Model]],["mpnet",["MPNetModel",MPNetModel]],["albert",["AlbertModel",AlbertModel]],["distilbert",["DistilBertModel",DistilBertModel]],["roberta",["RobertaModel",RobertaModel]],["xlm",["XLMModel",XLMModel]],["xlm-roberta",["XLMRobertaModel",XLMRobertaModel]],["clap",["ClapModel",ClapModel]],["clip",["CLIPModel",CLIPModel]],["clipseg",["CLIPSegModel",CLIPSegModel]],["chinese_clip",["ChineseCLIPModel",ChineseCLIPModel]],["siglip",["SiglipModel",SiglipModel]],["mobilebert",["MobileBertModel",MobileBertModel]],["squeezebert",["SqueezeBertModel",SqueezeBertModel]],["wav2vec2",["Wav2Vec2Model",Wav2Vec2Model]],["wav2vec2-bert",["Wav2Vec2BertModel",Wav2Vec2BertModel]],["unispeech",["UniSpeechModel",UniSpeechModel]],["unispeech-sat",["UniSpeechSatModel",UniSpeechSatModel]],["hubert",["HubertModel",HubertModel]],["wavlm",["WavLMModel",WavLMModel]],["audio-spectrogram-transformer",["ASTModel",ASTModel]],["vits",["VitsModel",VitsModel]],["detr",["DetrModel",DetrModel]],["table-transformer",["TableTransformerModel",TableTransformerModel]],["vit",["ViTModel",ViTModel]],["fastvit",["FastViTModel",FastViTModel]],["mobilevit",["MobileViTModel",MobileViTModel]],["mobilevitv2",["MobileViTV2Model",MobileViTV2Model]],["owlvit",["OwlViTModel",OwlViTModel]],["owlv2",["Owlv2Model",Owlv2Model]],["beit",["BeitModel",BeitModel]],["deit",["DeiTModel",DeiTModel]],["convnext",["ConvNextModel",ConvNextModel]],["convnextv2",["ConvNextV2Model",ConvNextV2Model]],["dinov2",["Dinov2Model",Dinov2Model]],["resnet",["ResNetModel",ResNetModel]],["swin",["SwinModel",SwinModel]],["swin2sr",["Swin2SRModel",Swin2SRModel]],["donut-swin",["DonutSwinModel",DonutSwinModel]],["yolos",["YolosModel",YolosModel]],["dpt",["DPTModel",DPTModel]],["glpn",["GLPNModel",GLPNModel]],["hifigan",["SpeechT5HifiGan",SpeechT5HifiGan]],["efficientnet",["EfficientNetModel",EfficientNetModel]]]),MODEL_MAPPING_NAMES_ENCODER_DECODER=new Map([["t5",["T5Model",T5Model]],["longt5",["LongT5Model",LongT5Model]],["mt5",["MT5Model",MT5Model]],["bart",["BartModel",BartModel]],["mbart",["MBartModel",MBartModel]],["marian",["MarianModel",MarianModel]],["whisper",["WhisperModel",WhisperModel]],["m2m_100",["M2M100Model",M2M100Model]],["blenderbot",["BlenderbotModel",BlenderbotModel]],["blenderbot-small",["BlenderbotSmallModel",BlenderbotSmallModel]]]),MODEL_MAPPING_NAMES_DECODER_ONLY=new Map([["bloom",["BloomModel",BloomModel]],["gpt2",["GPT2Model",GPT2Model]],["gptj",["GPTJModel",GPTJModel]],["gpt_bigcode",["GPTBigCodeModel",GPTBigCodeModel]],["gpt_neo",["GPTNeoModel",GPTNeoModel]],["gpt_neox",["GPTNeoXModel",GPTNeoXModel]],["codegen",["CodeGenModel",CodeGenModel]],["llama",["LlamaModel",LlamaModel]],["qwen2",["Qwen2Model",Qwen2Model]],["phi",["PhiModel",PhiModel]],["mpt",["MptModel",MptModel]],["opt",["OPTModel",OPTModel]],["mistral",["MistralModel",MistralModel]],["starcoder2",["Starcoder2Model",Starcoder2Model]],["falcon",["FalconModel",FalconModel]]]),MODEL_FOR_SPEECH_SEQ_2_SEQ_MAPPING_NAMES=new Map([["speecht5",["SpeechT5ForSpeechToText",SpeechT5ForSpeechToText]],["whisper",["WhisperForConditionalGeneration",WhisperForConditionalGeneration]]]),MODEL_FOR_TEXT_TO_SPECTROGRAM_MAPPING_NAMES=new Map([["speecht5",["SpeechT5ForTextToSpeech",SpeechT5ForTextToSpeech]]]),MODEL_FOR_TEXT_TO_WAVEFORM_MAPPING_NAMES=new Map([["vits",["VitsModel",VitsModel]]]),MODEL_FOR_SEQUENCE_CLASSIFICATION_MAPPING_NAMES=new Map([["bert",["BertForSequenceClassification",BertForSequenceClassification]],["roformer",["RoFormerForSequenceClassification",RoFormerForSequenceClassification]],["electra",["ElectraForSequenceClassification",ElectraForSequenceClassification]],["esm",["EsmForSequenceClassification",EsmForSequenceClassification]],["convbert",["ConvBertForSequenceClassification",ConvBertForSequenceClassification]],["camembert",["CamembertForSequenceClassification",CamembertForSequenceClassification]],["deberta",["DebertaForSequenceClassification",DebertaForSequenceClassification]],["deberta-v2",["DebertaV2ForSequenceClassification",DebertaV2ForSequenceClassification]],["mpnet",["MPNetForSequenceClassification",MPNetForSequenceClassification]],["albert",["AlbertForSequenceClassification",AlbertForSequenceClassification]],["distilbert",["DistilBertForSequenceClassification",DistilBertForSequenceClassification]],["roberta",["RobertaForSequenceClassification",RobertaForSequenceClassification]],["xlm",["XLMForSequenceClassification",XLMForSequenceClassification]],["xlm-roberta",["XLMRobertaForSequenceClassification",XLMRobertaForSequenceClassification]],["bart",["BartForSequenceClassification",BartForSequenceClassification]],["mbart",["MBartForSequenceClassification",MBartForSequenceClassification]],["mobilebert",["MobileBertForSequenceClassification",MobileBertForSequenceClassification]],["squeezebert",["SqueezeBertForSequenceClassification",SqueezeBertForSequenceClassification]]]),MODEL_FOR_TOKEN_CLASSIFICATION_MAPPING_NAMES=new Map([["bert",["BertForTokenClassification",BertForTokenClassification]],["roformer",["RoFormerForTokenClassification",RoFormerForTokenClassification]],["electra",["ElectraForTokenClassification",ElectraForTokenClassification]],["esm",["EsmForTokenClassification",EsmForTokenClassification]],["convbert",["ConvBertForTokenClassification",ConvBertForTokenClassification]],["camembert",["CamembertForTokenClassification",CamembertForTokenClassification]],["deberta",["DebertaForTokenClassification",DebertaForTokenClassification]],["deberta-v2",["DebertaV2ForTokenClassification",DebertaV2ForTokenClassification]],["mpnet",["MPNetForTokenClassification",MPNetForTokenClassification]],["distilbert",["DistilBertForTokenClassification",DistilBertForTokenClassification]],["roberta",["RobertaForTokenClassification",RobertaForTokenClassification]],["xlm",["XLMForTokenClassification",XLMForTokenClassification]],["xlm-roberta",["XLMRobertaForTokenClassification",XLMRobertaForTokenClassification]]]),MODEL_FOR_SEQ_TO_SEQ_CAUSAL_LM_MAPPING_NAMES=new Map([["t5",["T5ForConditionalGeneration",T5ForConditionalGeneration]],["longt5",["LongT5ForConditionalGeneration",LongT5ForConditionalGeneration]],["mt5",["MT5ForConditionalGeneration",MT5ForConditionalGeneration]],["bart",["BartForConditionalGeneration",BartForConditionalGeneration]],["mbart",["MBartForConditionalGeneration",MBartForConditionalGeneration]],["marian",["MarianMTModel",MarianMTModel]],["m2m_100",["M2M100ForConditionalGeneration",M2M100ForConditionalGeneration]],["blenderbot",["BlenderbotForConditionalGeneration",BlenderbotForConditionalGeneration]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",BlenderbotSmallForConditionalGeneration]]]),MODEL_WITH_LM_HEAD_MAPPING_NAMES=new Map([["bloom",["BloomForCausalLM",BloomForCausalLM]],["gpt2",["GPT2LMHeadModel",GPT2LMHeadModel]],["gptj",["GPTJForCausalLM",GPTJForCausalLM]],["gpt_bigcode",["GPTBigCodeForCausalLM",GPTBigCodeForCausalLM]],["gpt_neo",["GPTNeoForCausalLM",GPTNeoForCausalLM]],["gpt_neox",["GPTNeoXForCausalLM",GPTNeoXForCausalLM]],["codegen",["CodeGenForCausalLM",CodeGenForCausalLM]],["llama",["LlamaForCausalLM",LlamaForCausalLM]],["qwen2",["Qwen2ForCausalLM",Qwen2ForCausalLM]],["phi",["PhiForCausalLM",PhiForCausalLM]],["mpt",["MptForCausalLM",MptForCausalLM]],["opt",["OPTForCausalLM",OPTForCausalLM]],["mbart",["MBartForCausalLM",MBartForCausalLM]],["mistral",["MistralForCausalLM",MistralForCausalLM]],["starcoder2",["Starcoder2ForCausalLM",Starcoder2ForCausalLM]],["falcon",["FalconForCausalLM",FalconForCausalLM]],["trocr",["TrOCRForCausalLM",TrOCRForCausalLM]],["stablelm",["StableLmForCausalLM",StableLmForCausalLM]]]),MODEL_FOR_MASKED_LM_MAPPING_NAMES=new Map([["bert",["BertForMaskedLM",BertForMaskedLM]],["roformer",["RoFormerForMaskedLM",RoFormerForMaskedLM]],["electra",["ElectraForMaskedLM",ElectraForMaskedLM]],["esm",["EsmForMaskedLM",EsmForMaskedLM]],["convbert",["ConvBertForMaskedLM",ConvBertForMaskedLM]],["camembert",["CamembertForMaskedLM",CamembertForMaskedLM]],["deberta",["DebertaForMaskedLM",DebertaForMaskedLM]],["deberta-v2",["DebertaV2ForMaskedLM",DebertaV2ForMaskedLM]],["mpnet",["MPNetForMaskedLM",MPNetForMaskedLM]],["albert",["AlbertForMaskedLM",AlbertForMaskedLM]],["distilbert",["DistilBertForMaskedLM",DistilBertForMaskedLM]],["roberta",["RobertaForMaskedLM",RobertaForMaskedLM]],["xlm",["XLMWithLMHeadModel",XLMWithLMHeadModel]],["xlm-roberta",["XLMRobertaForMaskedLM",XLMRobertaForMaskedLM]],["mobilebert",["MobileBertForMaskedLM",MobileBertForMaskedLM]],["squeezebert",["SqueezeBertForMaskedLM",SqueezeBertForMaskedLM]]]),MODEL_FOR_QUESTION_ANSWERING_MAPPING_NAMES=new Map([["bert",["BertForQuestionAnswering",BertForQuestionAnswering]],["roformer",["RoFormerForQuestionAnswering",RoFormerForQuestionAnswering]],["electra",["ElectraForQuestionAnswering",ElectraForQuestionAnswering]],["convbert",["ConvBertForQuestionAnswering",ConvBertForQuestionAnswering]],["camembert",["CamembertForQuestionAnswering",CamembertForQuestionAnswering]],["deberta",["DebertaForQuestionAnswering",DebertaForQuestionAnswering]],["deberta-v2",["DebertaV2ForQuestionAnswering",DebertaV2ForQuestionAnswering]],["mpnet",["MPNetForQuestionAnswering",MPNetForQuestionAnswering]],["albert",["AlbertForQuestionAnswering",AlbertForQuestionAnswering]],["distilbert",["DistilBertForQuestionAnswering",DistilBertForQuestionAnswering]],["roberta",["RobertaForQuestionAnswering",RobertaForQuestionAnswering]],["xlm",["XLMForQuestionAnswering",XLMForQuestionAnswering]],["xlm-roberta",["XLMRobertaForQuestionAnswering",XLMRobertaForQuestionAnswering]],["mobilebert",["MobileBertForQuestionAnswering",MobileBertForQuestionAnswering]],["squeezebert",["SqueezeBertForQuestionAnswering",SqueezeBertForQuestionAnswering]]]),MODEL_FOR_VISION_2_SEQ_MAPPING_NAMES=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",VisionEncoderDecoderModel]]]),MODEL_FOR_DOCUMENT_QUESTION_ANSWERING_MAPPING_NAMES=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",VisionEncoderDecoderModel]]]),MODEL_FOR_IMAGE_CLASSIFICATION_MAPPING_NAMES=new Map([["vit",["ViTForImageClassification",ViTForImageClassification]],["fastvit",["FastViTForImageClassification",FastViTForImageClassification]],["mobilevit",["MobileViTForImageClassification",MobileViTForImageClassification]],["mobilevitv2",["MobileViTV2ForImageClassification",MobileViTV2ForImageClassification]],["beit",["BeitForImageClassification",BeitForImageClassification]],["deit",["DeiTForImageClassification",DeiTForImageClassification]],["convnext",["ConvNextForImageClassification",ConvNextForImageClassification]],["convnextv2",["ConvNextV2ForImageClassification",ConvNextV2ForImageClassification]],["dinov2",["Dinov2ForImageClassification",Dinov2ForImageClassification]],["resnet",["ResNetForImageClassification",ResNetForImageClassification]],["swin",["SwinForImageClassification",SwinForImageClassification]],["segformer",["SegformerForImageClassification",SegformerForImageClassification]],["efficientnet",["EfficientNetForImageClassification",EfficientNetForImageClassification]]]),MODEL_FOR_OBJECT_DETECTION_MAPPING_NAMES=new Map([["detr",["DetrForObjectDetection",DetrForObjectDetection]],["table-transformer",["TableTransformerForObjectDetection",TableTransformerForObjectDetection]],["yolos",["YolosForObjectDetection",YolosForObjectDetection]]]),MODEL_FOR_ZERO_SHOT_OBJECT_DETECTION_MAPPING_NAMES=new Map([["owlvit",["OwlViTForObjectDetection",OwlViTForObjectDetection]],["owlv2",["Owlv2ForObjectDetection",Owlv2ForObjectDetection]]]),MODEL_FOR_IMAGE_SEGMENTATION_MAPPING_NAMES=new Map([["detr",["DetrForSegmentation",DetrForSegmentation]],["clipseg",["CLIPSegForImageSegmentation",CLIPSegForImageSegmentation]]]),MODEL_FOR_SEMANTIC_SEGMENTATION_MAPPING_NAMES=new Map([["segformer",["SegformerForSemanticSegmentation",SegformerForSemanticSegmentation]]]),MODEL_FOR_MASK_GENERATION_MAPPING_NAMES=new Map([["sam",["SamModel",SamModel]]]),MODEL_FOR_CTC_MAPPING_NAMES=new Map([["wav2vec2",["Wav2Vec2ForCTC",Wav2Vec2ForCTC]],["wav2vec2-bert",["Wav2Vec2BertForCTC",Wav2Vec2BertForCTC]],["unispeech",["UniSpeechForCTC",UniSpeechForCTC]],["unispeech-sat",["UniSpeechSatForCTC",UniSpeechSatForCTC]],["wavlm",["WavLMForCTC",WavLMForCTC]],["hubert",["HubertForCTC",HubertForCTC]]]),MODEL_FOR_AUDIO_CLASSIFICATION_MAPPING_NAMES=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",Wav2Vec2ForSequenceClassification]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",Wav2Vec2BertForSequenceClassification]],["unispeech",["UniSpeechForSequenceClassification",UniSpeechForSequenceClassification]],["unispeech-sat",["UniSpeechSatForSequenceClassification",UniSpeechSatForSequenceClassification]],["wavlm",["WavLMForSequenceClassification",WavLMForSequenceClassification]],["hubert",["HubertForSequenceClassification",HubertForSequenceClassification]],["audio-spectrogram-transformer",["ASTForAudioClassification",ASTForAudioClassification]]]),MODEL_FOR_AUDIO_XVECTOR_MAPPING_NAMES=new Map([["wavlm",["WavLMForXVector",WavLMForXVector]]]),MODEL_FOR_AUDIO_FRAME_CLASSIFICATION_MAPPING_NAMES=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",UniSpeechSatForAudioFrameClassification]],["wavlm",["WavLMForAudioFrameClassification",WavLMForAudioFrameClassification]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",Wav2Vec2ForAudioFrameClassification]]]),MODEL_FOR_IMAGE_MATTING_MAPPING_NAMES=new Map([["vitmatte",["VitMatteForImageMatting",VitMatteForImageMatting]]]),MODEL_FOR_IMAGE_TO_IMAGE_MAPPING_NAMES=new Map([["swin2sr",["Swin2SRForImageSuperResolution",Swin2SRForImageSuperResolution]]]),MODEL_FOR_DEPTH_ESTIMATION_MAPPING_NAMES=new Map([["dpt",["DPTForDepthEstimation",DPTForDepthEstimation]],["depth_anything",["DepthAnythingForDepthEstimation",DepthAnythingForDepthEstimation]],["glpn",["GLPNForDepthEstimation",GLPNForDepthEstimation]]]),MODEL_FOR_IMAGE_FEATURE_EXTRACTION_MAPPING_NAMES=new Map([["clip",["CLIPVisionModelWithProjection",CLIPVisionModelWithProjection]],["siglip",["SiglipVisionModel",SiglipVisionModel]]]),MODEL_CLASS_TYPE_MAPPING=[[MODEL_MAPPING_NAMES_ENCODER_ONLY,MODEL_TYPES.EncoderOnly],[MODEL_MAPPING_NAMES_ENCODER_DECODER,MODEL_TYPES.EncoderDecoder],[MODEL_MAPPING_NAMES_DECODER_ONLY,MODEL_TYPES.DecoderOnly],[MODEL_FOR_SEQUENCE_CLASSIFICATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_TOKEN_CLASSIFICATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_SEQ_TO_SEQ_CAUSAL_LM_MAPPING_NAMES,MODEL_TYPES.Seq2Seq],[MODEL_FOR_SPEECH_SEQ_2_SEQ_MAPPING_NAMES,MODEL_TYPES.Seq2Seq],[MODEL_WITH_LM_HEAD_MAPPING_NAMES,MODEL_TYPES.DecoderOnly],[MODEL_FOR_MASKED_LM_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_QUESTION_ANSWERING_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_VISION_2_SEQ_MAPPING_NAMES,MODEL_TYPES.Vision2Seq],[MODEL_FOR_IMAGE_CLASSIFICATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_IMAGE_SEGMENTATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_SEMANTIC_SEGMENTATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_IMAGE_MATTING_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_IMAGE_TO_IMAGE_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_DEPTH_ESTIMATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_OBJECT_DETECTION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_ZERO_SHOT_OBJECT_DETECTION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_MASK_GENERATION_MAPPING_NAMES,MODEL_TYPES.MaskGeneration],[MODEL_FOR_CTC_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_AUDIO_CLASSIFICATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_TEXT_TO_SPECTROGRAM_MAPPING_NAMES,MODEL_TYPES.Seq2Seq],[MODEL_FOR_TEXT_TO_WAVEFORM_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_AUDIO_XVECTOR_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_AUDIO_FRAME_CLASSIFICATION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly],[MODEL_FOR_IMAGE_FEATURE_EXTRACTION_MAPPING_NAMES,MODEL_TYPES.EncoderOnly]];for(const[i,e]of MODEL_CLASS_TYPE_MAPPING)for(const[o,s]of i.values())MODEL_TYPE_MAPPING.set(o,e),MODEL_CLASS_TO_NAME_MAPPING.set(s,o),MODEL_NAME_TO_CLASS_MAPPING.set(o,s);const CUSTOM_MAPPING=[["CLIPTextModelWithProjection",CLIPTextModelWithProjection,MODEL_TYPES.EncoderOnly],["SiglipTextModel",SiglipTextModel,MODEL_TYPES.EncoderOnly],["ClapTextModelWithProjection",ClapTextModelWithProjection,MODEL_TYPES.EncoderOnly],["ClapAudioModelWithProjection",ClapAudioModelWithProjection,MODEL_TYPES.EncoderOnly]];for(const[i,e,o]of CUSTOM_MAPPING)MODEL_TYPE_MAPPING.set(i,o),MODEL_CLASS_TO_NAME_MAPPING.set(e,i),MODEL_NAME_TO_CLASS_MAPPING.set(i,e);class AutoModel extends PretrainedMixin{}qt(AutoModel,"MODEL_CLASS_MAPPINGS",MODEL_CLASS_TYPE_MAPPING.map(e=>e[0])),qt(AutoModel,"BASE_IF_FAIL",!0);class AutoModelForSequenceClassification extends PretrainedMixin{}qt(AutoModelForSequenceClassification,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_SEQUENCE_CLASSIFICATION_MAPPING_NAMES]);class AutoModelForTokenClassification extends PretrainedMixin{}qt(AutoModelForTokenClassification,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_TOKEN_CLASSIFICATION_MAPPING_NAMES]);class AutoModelForSeq2SeqLM extends PretrainedMixin{}qt(AutoModelForSeq2SeqLM,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_SEQ_TO_SEQ_CAUSAL_LM_MAPPING_NAMES]);class AutoModelForSpeechSeq2Seq extends PretrainedMixin{}qt(AutoModelForSpeechSeq2Seq,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_SPEECH_SEQ_2_SEQ_MAPPING_NAMES]);class AutoModelForTextToSpectrogram extends PretrainedMixin{}qt(AutoModelForTextToSpectrogram,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_TEXT_TO_SPECTROGRAM_MAPPING_NAMES]);class AutoModelForTextToWaveform extends PretrainedMixin{}qt(AutoModelForTextToWaveform,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_TEXT_TO_WAVEFORM_MAPPING_NAMES]);class AutoModelForCausalLM extends PretrainedMixin{}qt(AutoModelForCausalLM,"MODEL_CLASS_MAPPINGS",[MODEL_WITH_LM_HEAD_MAPPING_NAMES]);class AutoModelForMaskedLM extends PretrainedMixin{}qt(AutoModelForMaskedLM,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_MASKED_LM_MAPPING_NAMES]);class AutoModelForQuestionAnswering extends PretrainedMixin{}qt(AutoModelForQuestionAnswering,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_QUESTION_ANSWERING_MAPPING_NAMES]);class AutoModelForVision2Seq extends PretrainedMixin{}qt(AutoModelForVision2Seq,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_VISION_2_SEQ_MAPPING_NAMES]);class AutoModelForImageClassification extends PretrainedMixin{}qt(AutoModelForImageClassification,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_IMAGE_CLASSIFICATION_MAPPING_NAMES]);class AutoModelForImageSegmentation extends PretrainedMixin{}qt(AutoModelForImageSegmentation,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_IMAGE_SEGMENTATION_MAPPING_NAMES]);class AutoModelForSemanticSegmentation extends PretrainedMixin{}qt(AutoModelForSemanticSegmentation,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_SEMANTIC_SEGMENTATION_MAPPING_NAMES]);class AutoModelForObjectDetection extends PretrainedMixin{}qt(AutoModelForObjectDetection,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_OBJECT_DETECTION_MAPPING_NAMES]);class AutoModelForZeroShotObjectDetection extends PretrainedMixin{}qt(AutoModelForZeroShotObjectDetection,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_ZERO_SHOT_OBJECT_DETECTION_MAPPING_NAMES]);class AutoModelForCTC extends PretrainedMixin{}qt(AutoModelForCTC,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_CTC_MAPPING_NAMES]);class AutoModelForAudioClassification extends PretrainedMixin{}qt(AutoModelForAudioClassification,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_AUDIO_CLASSIFICATION_MAPPING_NAMES]);class AutoModelForDocumentQuestionAnswering extends PretrainedMixin{}qt(AutoModelForDocumentQuestionAnswering,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_DOCUMENT_QUESTION_ANSWERING_MAPPING_NAMES]);class AutoModelForImageToImage extends PretrainedMixin{}qt(AutoModelForImageToImage,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_IMAGE_TO_IMAGE_MAPPING_NAMES]);class AutoModelForDepthEstimation extends PretrainedMixin{}qt(AutoModelForDepthEstimation,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_DEPTH_ESTIMATION_MAPPING_NAMES]);class AutoModelForImageFeatureExtraction extends PretrainedMixin{}qt(AutoModelForImageFeatureExtraction,"MODEL_CLASS_MAPPINGS",[MODEL_FOR_IMAGE_FEATURE_EXTRACTION_MAPPING_NAMES]);class Seq2SeqLMOutput extends ModelOutput{constructor({logits:e,past_key_values:o,encoder_outputs:s,decoder_attentions:c=null,cross_attentions:h=null}){super(),this.logits=e,this.past_key_values=o,this.encoder_outputs=s,this.decoder_attentions=c,this.cross_attentions=h}}class SequenceClassifierOutput extends ModelOutput{constructor({logits:e}){super(),this.logits=e}}class XVectorOutput extends ModelOutput{constructor({logits:e,embeddings:o}){super(),this.logits=e,this.embeddings=o}}class TokenClassifierOutput extends ModelOutput{constructor({logits:e}){super(),this.logits=e}}class MaskedLMOutput extends ModelOutput{constructor({logits:e}){super(),this.logits=e}}class QuestionAnsweringModelOutput extends ModelOutput{constructor({start_logits:e,end_logits:o}){super(),this.start_logits=e,this.end_logits=o}}class CausalLMOutput extends ModelOutput{constructor({logits:e}){super(),this.logits=e}}class ImageMattingOutput extends ModelOutput{constructor({alphas:e}){super(),this.alphas=e}}class VitsModelOutput extends ModelOutput{constructor({waveform:e,spectrogram:o}){super(),this.waveform=e,this.spectrogram=o}}const BROWSER_ENV=typeof self<"u",WEBWORKER_ENV=BROWSER_ENV&&self.constructor.name==="DedicatedWorkerGlobalScope";let createCanvasFunction,ImageDataClass,loadImageFunction;if(BROWSER_ENV)createCanvasFunction=(i,e)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(i,e)},loadImageFunction=self.createImageBitmap,ImageDataClass=self.ImageData;else if(sharp)loadImageFunction=async i=>{const o=(await i.metadata()).channels;let{data:s,info:c}=await i.rotate().raw().toBuffer({resolveWithObject:!0});const h=new RawImage(new Uint8ClampedArray(s),c.width,c.height,c.channels);return o!==void 0&&o!==c.channels&&h.convert(o),h};else throw new Error("Unable to load image processing library.");const RESAMPLING_MAPPING={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},CONTENT_TYPE_MAP=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class RawImage{constructor(e,o,s,c){this.data=e,this.width=o,this.height=s,this.channels=c}get size(){return[this.width,this.height]}static async read(e){if(e instanceof RawImage)return e;if(typeof e=="string"||e instanceof URL)return await this.fromURL(e);throw new Error(`Unsupported input type: ${typeof e}`)}static async fromURL(e){let o=await getFile(e);if(o.status!==200)throw new Error(`Unable to read image from "${e}" (${o.status} ${o.statusText})`);let s=await o.blob();return this.fromBlob(s)}static async fromBlob(e){if(BROWSER_ENV){let o=await loadImageFunction(e);const s=createCanvasFunction(o.width,o.height).getContext("2d");return s.drawImage(o,0,0),new this(s.getImageData(0,0,o.width,o.height).data,o.width,o.height,4)}else{let o=sharp(await e.arrayBuffer());return await loadImageFunction(o)}}static fromTensor(e,o="CHW"){if(e.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${e.dims.length} dimensions.`);if(o==="CHW")e=e.transpose(1,2,0);else if(o!=="HWC")throw new Error(`Unsupported channel format: ${o}`);if(!(e.data instanceof Uint8ClampedArray||e.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${e.type}`);switch(e.dims[2]){case 1:case 2:case 3:case 4:return new RawImage(e.data,e.dims[1],e.dims[0],e.dims[2]);default:throw new Error(`Unsupported number of channels: ${e.dims[2]}`)}}grayscale(){if(this.channels===1)return this;let e=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let o=0,s=0;o<this.data.length;o+=this.channels){const c=this.data[o],h=this.data[o+1],_=this.data[o+2];e[s++]=Math.round(.2989*c+.587*h+.114*_)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(e,this.width,this.height,1)}rgb(){if(this.channels===3)return this;let e=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let o=0,s=0;o<this.data.length;++o)e[s++]=this.data[o],e[s++]=this.data[o],e[s++]=this.data[o];break;case 4:for(let o=0,s=0;o<this.data.length;o+=4)e[s++]=this.data[o],e[s++]=this.data[o+1],e[s++]=this.data[o+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(e,this.width,this.height,3)}rgba(){if(this.channels===4)return this;let e=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let o=0,s=0;o<this.data.length;++o)e[s++]=this.data[o],e[s++]=this.data[o],e[s++]=this.data[o],e[s++]=255;break;case 3:for(let o=0,s=0;o<this.data.length;o+=3)e[s++]=this.data[o],e[s++]=this.data[o+1],e[s++]=this.data[o+2],e[s++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(e,this.width,this.height,4)}async resize(e,o,{resample:s=2}={}){let c=RESAMPLING_MAPPING[s]??s;if(BROWSER_ENV){let h=this.channels,_=this.toCanvas();const $=createCanvasFunction(e,o).getContext("2d");return $.drawImage(_,0,0,e,o),new RawImage($.getImageData(0,0,e,o).data,e,o,4).convert(h)}else{let h=this.toSharp();switch(c){case"box":case"hamming":(c==="box"||c==="hamming")&&(console.warn(`Resampling method ${c} is not yet supported. Using bilinear instead.`),c="bilinear");case"nearest":case"bilinear":case"bicubic":h=h.affine([e/this.width,0,0,o/this.height],{interpolator:c});break;case"lanczos":h=h.resize({width:e,height:o,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${c} is not supported.`)}return await loadImageFunction(h)}}async pad([e,o,s,c]){if(e=Math.max(e,0),o=Math.max(o,0),s=Math.max(s,0),c=Math.max(c,0),e===0&&o===0&&s===0&&c===0)return this;if(BROWSER_ENV){let h=this.channels,_=this.toCanvas(),$=this.width+e+o,nt=this.height+s+c;const tt=createCanvasFunction($,nt).getContext("2d");return tt.drawImage(_,0,0,this.width,this.height,e,s,$,nt),new RawImage(tt.getImageData(0,0,$,nt).data,$,nt,4).convert(h)}else{let h=this.toSharp().extend({left:e,right:o,top:s,bottom:c});return await loadImageFunction(h)}}async crop([e,o,s,c]){if(e=Math.max(e,0),o=Math.max(o,0),s=Math.min(s,this.width-1),c=Math.min(c,this.height-1),e===0&&o===0&&s===this.width-1&&c===this.height-1)return this;const h=s-e+1,_=c-o+1;if(BROWSER_ENV){const $=this.channels,nt=this.toCanvas(),tt=createCanvasFunction(h,_).getContext("2d");return tt.drawImage(nt,e,o,h,_,0,0,h,_),new RawImage(tt.getImageData(0,0,h,_).data,h,_,4).convert($)}else{const $=this.toSharp().extract({left:e,top:o,width:h,height:_});return await loadImageFunction($)}}async center_crop(e,o){if(this.width===e&&this.height===o)return this;let s=(this.width-e)/2,c=(this.height-o)/2;if(BROWSER_ENV){let h=this.channels,_=this.toCanvas();const $=createCanvasFunction(e,o).getContext("2d");let nt=0,tt=0,et=0,d=0;return s>=0?nt=s:et=-s,c>=0?tt=c:d=-c,$.drawImage(_,nt,tt,e,o,et,d,e,o),new RawImage($.getImageData(0,0,e,o).data,e,o,4).convert(h)}else{let h=this.toSharp();if(s>=0&&c>=0)h=h.extract({left:Math.floor(s),top:Math.floor(c),width:e,height:o});else if(s<=0&&c<=0){let _=Math.floor(-c),$=Math.floor(-s);h=h.extend({top:_,left:$,right:e-this.width-$,bottom:o-this.height-_})}else{let _=[0,0],$=0;c<0?(_[0]=Math.floor(-c),_[1]=o-this.height-_[0]):$=Math.floor(c);let nt=[0,0],tt=0;s<0?(nt[0]=Math.floor(-s),nt[1]=e-this.width-nt[0]):tt=Math.floor(s),h=h.extend({top:_[0],bottom:_[1],left:nt[0],right:nt[1]}).extract({left:tt,top:$,width:e,height:o})}return await loadImageFunction(h)}}async toBlob(e="image/png",o=1){if(!BROWSER_ENV)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:e,quality:o})}toTensor(e="CHW"){let o=new Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(e!=="HWC")if(e==="CHW")o=o.permute(2,0,1);else throw new Error(`Unsupported channel format: ${e}`);return o}toCanvas(){if(!BROWSER_ENV)throw new Error("toCanvas() is only supported in browser environments.");let e=this.clone().rgba(),o=createCanvasFunction(e.width,e.height),s=new ImageDataClass(e.data,e.width,e.height);return o.getContext("2d").putImageData(s,0,0),o}_update(e,o,s,c=null){return this.data=e,this.width=o,this.height=s,c!==null&&(this.channels=c),this}clone(){return new RawImage(this.data.slice(),this.width,this.height,this.channels)}convert(e){if(this.channels===e)return this;switch(e){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(e){if(BROWSER_ENV){if(WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const o=e.split(".").pop().toLowerCase(),s=CONTENT_TYPE_MAP.get(o)??"image/png",c=await this.toBlob(s),h=URL.createObjectURL(c),_=document.createElement("a");_.href=h,_.download=e,_.click(),_.remove()}else{if(env$1.useFS)return await this.toSharp().toFile(e);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(BROWSER_ENV)throw new Error("toSharp() is only supported in server-side environments.");return sharp(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}async function read_audio(i,e){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const o=await(await getFile(i)).arrayBuffer(),s=new AudioContext({sampleRate:e});typeof e>"u"&&console.warn(`No sampling rate provided, using default of ${s.sampleRate}Hz.`);const c=await s.decodeAudioData(o);let h;if(c.numberOfChannels===2){const _=Math.sqrt(2),$=c.getChannelData(0),nt=c.getChannelData(1);h=new Float32Array($.length);for(let tt=0;tt<c.length;++tt)h[tt]=_*($[tt]+nt[tt])/2}else h=c.getChannelData(0);return h}function hanning(i){if(i<1)return new Float64Array;if(i===1)return new Float64Array([1]);const e=i-1,o=Math.PI/e,s=new Float64Array(i);for(let c=0;c<i;++c){const h=2*c-e;s[c]=.5+.5*Math.cos(o*h)}return s}const HERTZ_TO_MEL_MAPPING={htk:i=>2595*Math.log10(1+i/700),kaldi:i=>1127*Math.log(1+i/700),slaney:(i,e=1e3,o=15,s=27/Math.log(6.4))=>i>=e?o+Math.log(i/e)*s:3*i/200};function hertz_to_mel(i,e="htk"){const o=HERTZ_TO_MEL_MAPPING[e];if(!o)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof i=="number"?o(i):i.map(s=>o(s))}const MEL_TO_HERTZ_MAPPING={htk:i=>700*(10**(i/2595)-1),kaldi:i=>700*(Math.exp(i/1127)-1),slaney:(i,e=1e3,o=15,s=Math.log(6.4)/27)=>i>=o?e*Math.exp(s*(i-o)):200*i/3};function mel_to_hertz(i,e="htk"){const o=MEL_TO_HERTZ_MAPPING[e];if(!o)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof i=="number"?o(i):i.map(s=>o(s))}function _create_triangular_filter_bank(i,e){const o=Float64Array.from({length:e.length-1},(_,$)=>e[$+1]-e[$]),s=Array.from({length:i.length},()=>new Array(e.length));for(let _=0;_<i.length;++_){const $=s[_];for(let nt=0;nt<e.length;++nt)$[nt]=e[nt]-i[_]}const c=e.length-2,h=Array.from({length:c},()=>new Array(i.length));for(let _=0;_<i.length;++_){const $=s[_];for(let nt=0;nt<c;++nt){const tt=-$[nt]/o[nt],et=$[nt+2]/o[nt+1];h[nt][_]=Math.max(0,Math.min(tt,et))}}return h}function linspace(i,e,o){const s=(e-i)/(o-1);return Float64Array.from({length:o},(c,h)=>i+s*h)}function mel_filter_bank(i,e,o,s,c,h=null,_="htk",$=!1){if(h!==null&&h!=="slaney")throw new Error('norm must be one of null or "slaney"');const nt=hertz_to_mel(o,_),tt=hertz_to_mel(s,_),et=linspace(nt,tt,e+2);let d=mel_to_hertz(et,_),a;if($){const j=c/(i*2);a=hertz_to_mel(Float64Array.from({length:i},(rt,ot)=>ot*j),_),d=et}else a=linspace(0,Math.floor(c/2),i);const g=_create_triangular_filter_bank(a,d);if(h!==null&&h==="slaney")for(let j=0;j<e;++j){const rt=g[j],ot=2/(d[j+2]-d[j]);for(let it=0;it<i;++it)rt[it]*=ot}return g}function padReflect(i,e,o){const s=new i.constructor(i.length+e+o),c=i.length-1;for(let h=0;h<i.length;++h)s[e+h]=i[h];for(let h=1;h<=e;++h)s[e-h]=i[calculateReflectOffset(h,c)];for(let h=1;h<=o;++h)s[c+e+h]=i[calculateReflectOffset(c-h,c)];return s}function _db_conversion_helper(i,e,o,s,c){if(o<=0)throw new Error("reference must be greater than zero");if(s<=0)throw new Error("min_value must be greater than zero");o=Math.max(s,o);const h=Math.log10(o);for(let _=0;_<i.length;++_)i[_]=e*Math.log10(Math.max(s,i[_])-h);if(c!==null){if(c<=0)throw new Error("db_range must be greater than zero");const _=max(i)[0]-c;for(let $=0;$<i.length;++$)i[$]=Math.max(i[$],_)}return i}function amplitude_to_db(i,e=1,o=1e-5,s=null){return _db_conversion_helper(i,20,e,o,s)}function power_to_db(i,e=1,o=1e-10,s=null){return _db_conversion_helper(i,10,e,o,s)}function spectrogram(i,e,o,s,{fft_length:c=null,power:h=1,center:_=!0,pad_mode:$="reflect",onesided:nt=!0,preemphasis:tt=null,mel_filters:et=null,mel_floor:d=1e-10,log_mel:a=null,reference:g=1,min_value:j=1e-10,db_range:rt=null,remove_dc_offset:ot=null,max_num_frames:it=null,do_pad:at=!0,transpose:lt=!1}={}){const ct=e.length;if(c===null&&(c=o),o>c)throw Error(`frame_length (${o}) may not be larger than fft_length (${c})`);if(ct!==o)throw new Error(`Length of the window (${ct}) must equal frame_length (${o})`);if(s<=0)throw new Error("hop_length must be greater than zero");if(h===null&&et!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(_){if($!=="reflect")throw new Error(`pad_mode="${$}" not implemented yet.`);const Pt=Math.floor((c-1)/2)+1;i=padReflect(i,Pt,Pt)}const dt=Math.floor(1+Math.floor((i.length-o)/s)),mt=nt?Math.floor(c/2)+1:c;let ht=dt,ft=dt;it!==null&&(it>dt?at&&(ft=it):ft=ht=it);const ut=new FFT(c),_t=new Float64Array(c),bt=new Float64Array(ut.outputBufferSize),vt=new Array(ht);for(let Pt=0;Pt<ht;++Pt){const It=Pt*s;for(let Ct=0;Ct<o;++Ct)_t[Ct]=i[It+Ct];if(ot){let Ct=0;for(let Wt=0;Wt<o;++Wt)Ct+=_t[Wt];const Gt=Ct/o;for(let Wt=0;Wt<o;++Wt)_t[Wt]-=Gt}if(tt!==null){for(let Ct=o-1;Ct>=1;--Ct)_t[Ct]-=tt*_t[Ct-1];_t[0]*=1-tt}for(let Ct=0;Ct<e.length;++Ct)_t[Ct]*=e[Ct];ut.realTransform(bt,_t);const Dt=new Array(mt);for(let Ct=0;Ct<Dt.length;++Ct){const Gt=Ct<<1;Dt[Ct]=bt[Gt]**2+bt[Gt+1]**2}vt[Pt]=Dt}if(h!==null&&h!==2){const Pt=2/h;for(let It=0;It<vt.length;++It){const Dt=vt[It];for(let Ct=0;Ct<Dt.length;++Ct)Dt[Ct]**=Pt}}const Tt=et.length,Mt=new Float32Array(Tt*ft),xt=lt?[ft,Tt]:[Tt,ft];for(let Pt=0;Pt<Tt;++Pt){const It=et[Pt];for(let Dt=0;Dt<ht;++Dt){const Ct=vt[Dt];let Gt=0;for(let Wt=0;Wt<mt;++Wt)Gt+=It[Wt]*Ct[Wt];Mt[lt?Dt*Tt+Pt:Pt*ht+Dt]=Math.max(d,Gt)}}if(h!==null&&a!==null){const Pt=Math.min(Mt.length,ht*Tt);switch(a){case"log":for(let It=0;It<Pt;++It)Mt[It]=Math.log(Mt[It]);break;case"log10":for(let It=0;It<Pt;++It)Mt[It]=Math.log10(Mt[It]);break;case"dB":if(h===1)amplitude_to_db(Mt,g,j,rt);else if(h===2)power_to_db(Mt,g,j,rt);else throw new Error(`Cannot use log_mel option '${a}' with power ${h}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${a}'`)}}return{data:Mt,dims:xt}}function window_function(i,e,{periodic:o=!0,frame_length:s=null,center:c=!0}={}){const h=o?i+1:i;let _;switch(e){case"boxcar":_=new Float64Array(h).fill(1);break;case"hann":case"hann_window":_=hanning(h);break;case"povey":_=hanning(h).map($=>Math.pow($,.85));break;default:throw new Error(`Unknown window type ${e}.`)}if(o&&(_=_.subarray(0,i)),s===null)return _;if(i>s)throw new Error(`Length of the window (${i}) may not be larger than frame_length (${s})`);return _}function center_to_corners_format([i,e,o,s]){return[i-o/2,e-s/2,i+o/2,e+s/2]}function post_process_object_detection(i,e=.5,o=null,s=!1){const c=i.logits,h=i.pred_boxes,[_,$,nt]=c.dims;if(o!==null&&o.length!==_)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let tt=[];for(let et=0;et<_;++et){let d=o!==null?o[et]:null,a={boxes:[],classes:[],scores:[]},g=c[et],j=h[et];for(let rt=0;rt<$;++rt){let ot=g[rt],it=[],at;if(s){at=ot.sigmoid().data;for(let lt=0;lt<at.length;++lt)at[lt]>e&&it.push(lt)}else{let lt=max(ot.data)[1];if(lt===nt-1)continue;it.push(lt),at=softmax(ot.data)}for(const lt of it){let ct=j[rt].data;ct=center_to_corners_format(ct),d!==null&&(ct=ct.map((dt,mt)=>dt*d[(mt+1)%2])),a.boxes.push(ct),a.classes.push(lt),a.scores.push(at[lt])}}tt.push(a)}return tt}function validate_audio_inputs(i,e){var o;if(!(i instanceof Float32Array||i instanceof Float64Array))throw new Error(`${e} expects input to be a Float32Array or a Float64Array, but got ${((o=i==null?void 0:i.constructor)==null?void 0:o.name)??typeof i} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}function constraint_to_multiple_of(i,e,o=0,s=null){const c=i/e;let h=bankers_round(c)*e;return s!==null&&h>s&&(h=Math.floor(c)*e),h<o&&(h=Math.ceil(c)*e),h}function enforce_size_divisibility([i,e],o){return[Math.max(Math.floor(i/o),1)*o,Math.max(Math.floor(e/o),1)*o]}class FeatureExtractor extends Callable{constructor(e){super(),this.config=e}}class ImageFeatureExtractor extends FeatureExtractor{constructor(e){super(e),this.image_mean=this.config.image_mean??this.config.mean,this.image_std=this.config.image_std??this.config.std,this.resample=this.config.resample??2,this.do_rescale=this.config.do_rescale??!0,this.rescale_factor=this.config.rescale_factor??1/255,this.do_normalize=this.config.do_normalize,this.do_resize=this.config.do_resize,this.do_thumbnail=this.config.do_thumbnail,this.size=this.config.size,this.size_divisibility=this.config.size_divisibility??this.config.size_divisor,this.do_center_crop=this.config.do_center_crop,this.crop_size=this.config.crop_size,this.do_convert_rgb=this.config.do_convert_rgb??!0,this.do_crop_margin=this.config.do_crop_margin,this.pad_size=this.config.pad_size,this.do_pad=this.config.do_pad,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=this.config.do_flip_channel_order??!1}async thumbnail(e,o,s=2){const c=e.height,h=e.width,_=o.height,$=o.width;let nt=Math.min(c,_),tt=Math.min(h,$);return nt===c&&tt===h?e:(c>h?tt=Math.floor(h*nt/c):h>c&&(nt=Math.floor(c*tt/h)),await e.resize(tt,nt,{resample:s}))}async crop_margin(e,o=200){const s=e.clone().grayscale(),c=min(s.data)[0],_=max(s.data)[0]-c;if(_===0)return e;const $=o/255;let nt=s.width,tt=s.height,et=0,d=0;for(let a=0;a<s.height;++a){const g=a*s.width;for(let j=0;j<s.width;++j)(s.data[g+j]-c)/_<$&&(nt=Math.min(nt,j),tt=Math.min(tt,a),et=Math.max(et,j),d=Math.max(d,a))}return e=await e.crop([nt,tt,et,d]),e}pad_image(e,o,s,{mode:c="constant",center:h=!1,constant_values:_=0}={}){const[$,nt,tt]=o;let et,d;if(typeof s=="number"?(et=s,d=s):(et=s.width,d=s.height),et!==nt||d!==$){const a=new Float32Array(et*d*tt);if(Array.isArray(_))for(let rt=0;rt<a.length;++rt)a[rt]=_[rt%tt];else _!==0&&a.fill(_);const[g,j]=h?[Math.floor((et-nt)/2),Math.floor((d-$)/2)]:[0,0];for(let rt=0;rt<$;++rt){const ot=(rt+j)*et,it=rt*nt;for(let at=0;at<nt;++at){const lt=(ot+at+g)*tt,ct=(it+at)*tt;for(let dt=0;dt<tt;++dt)a[lt+dt]=e[ct+dt]}}if(c==="symmetric"){if(h)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const rt=$-1,ot=nt-1;for(let it=0;it<d;++it){const at=it*et,lt=calculateReflectOffset(it,rt)*nt;for(let ct=0;ct<et;++ct){if(it<$&&ct<nt)continue;const dt=(at+ct)*tt,mt=(lt+calculateReflectOffset(ct,ot))*tt;for(let ht=0;ht<tt;++ht)a[dt+ht]=e[mt+ht]}}}e=a,o=[d,et,tt]}return[e,o]}rescale(e){for(let o=0;o<e.length;++o)e[o]=this.rescale_factor*e[o]}get_resize_output_image_size(e,o){const[s,c]=e.size;let h,_;if(this.do_thumbnail){const{height:$,width:nt}=o;h=Math.min($,nt)}else Number.isInteger(o)?(h=o,_=this.config.max_size??h):o!==void 0&&(h=o.shortest_edge,_=o.longest_edge);if(h!==void 0||_!==void 0){const $=h===void 0?1:Math.max(h/s,h/c),nt=s*$,tt=c*$,et=_===void 0?1:Math.min(_/nt,_/tt);let d=Math.floor(Number((nt*et).toFixed(2))),a=Math.floor(Number((tt*et).toFixed(2)));return this.size_divisibility!==void 0&&([d,a]=enforce_size_divisibility([d,a],this.size_divisibility)),[d,a]}else if(o!==void 0&&o.width!==void 0&&o.height!==void 0){let $=o.width,nt=o.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let tt=nt/c,et=$/s;Math.abs(1-et)<Math.abs(1-tt)?tt=et:et=tt,nt=constraint_to_multiple_of(tt*c,this.config.ensure_multiple_of),$=constraint_to_multiple_of(et*s,this.config.ensure_multiple_of)}return[$,nt]}else{if(this.size_divisibility!==void 0)return enforce_size_divisibility([s,c],this.size_divisibility);throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(o)}`)}}async resize(e){const[o,s]=this.get_resize_output_image_size(e,this.size);return await e.resize(o,s,{resample:this.resample})}async preprocess(e,{do_normalize:o=null,do_pad:s=null,do_convert_rgb:c=null,do_convert_grayscale:h=null,do_flip_channel_order:_=null}={}){this.do_crop_margin&&(e=await this.crop_margin(e));const[$,nt]=e.size;if(c??this.do_convert_rgb?e=e.rgb():h&&(e=e.grayscale()),this.do_resize&&(e=await this.resize(e)),this.do_thumbnail&&(e=await this.thumbnail(e,this.size,this.resample)),this.do_center_crop){let g,j;Number.isInteger(this.crop_size)?(g=this.crop_size,j=this.crop_size):(g=this.crop_size.width,j=this.crop_size.height),e=await e.center_crop(g,j)}const tt=[e.height,e.width];let et=Float32Array.from(e.data),d=[e.height,e.width,e.channels];if(this.do_rescale&&this.rescale(et),o??this.do_normalize){let g=this.image_mean;Array.isArray(this.image_mean)||(g=new Array(e.channels).fill(g));let j=this.image_std;if(Array.isArray(this.image_std)||(j=new Array(e.channels).fill(g)),g.length!==e.channels||j.length!==e.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${g.length}) and \`image_std\` (${j.length}) must match the number of channels in the image (${e.channels}).`);for(let rt=0;rt<et.length;rt+=e.channels)for(let ot=0;ot<e.channels;++ot)et[rt+ot]=(et[rt+ot]-g[ot])/j[ot]}if(s??this.do_pad){if(this.pad_size)[et,d]=this.pad_image(et,[e.height,e.width,e.channels],this.pad_size);else if(this.size_divisibility){const[g,j]=enforce_size_divisibility([d[1],d[0]],this.size_divisibility);[et,d]=this.pad_image(et,d,{width:g,height:j})}}if(_??this.do_flip_channel_order){if(d[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let g=0;g<et.length;g+=3){const j=et[g];et[g]=et[g+2],et[g+2]=j}}const a=new Tensor("float32",et,d).permute(2,0,1);return{original_size:[nt,$],reshaped_input_size:tt,pixel_values:a}}async _call(e,...o){Array.isArray(e)||(e=[e]);const s=await Promise.all(e.map(h=>this.preprocess(h)));return{pixel_values:stack(s.map(h=>h.pixel_values),0),original_sizes:s.map(h=>h.original_size),reshaped_input_sizes:s.map(h=>h.reshaped_input_size)}}}class SegformerFeatureExtractor extends ImageFeatureExtractor{post_process_semantic_segmentation(e,o=null){const s=e.logits,c=s.dims[0];if(o!==null&&o.length!==c)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const h=[];for(let _=0;_<c;++_){const $=o!==null?o[_]:null;let nt=s[_];$!==null&&(nt=interpolate(nt,$,"bilinear",!1));const[tt,et]=$??nt.dims.slice(-2),d=new Tensor("int32",new Int32Array(tt*et),[tt,et]),a=nt[0].data;for(let ot=1;ot<nt.dims[0];++ot){const it=nt[ot].data;for(let at=0;at<it.length;++at)it[at]>a[at]&&(a[at]=it[at],d.data[at]=ot)}const g=new Array(nt.dims[0]),j=d.data;for(let ot=0;ot<j.length;++ot){const it=j[ot];g[it]=it}const rt=g.filter(ot=>ot!==void 0);h.push({segmentation:d,labels:rt})}return h}}class DPTFeatureExtractor extends ImageFeatureExtractor{}class DPTImageProcessor extends DPTFeatureExtractor{}class BitImageProcessor extends ImageFeatureExtractor{}class GLPNFeatureExtractor extends ImageFeatureExtractor{}class CLIPFeatureExtractor extends ImageFeatureExtractor{}class ChineseCLIPFeatureExtractor extends ImageFeatureExtractor{}class SiglipImageProcessor extends ImageFeatureExtractor{}class ConvNextFeatureExtractor extends ImageFeatureExtractor{constructor(e){super(e),this.crop_pct=this.config.crop_pct??224/256}async resize(e){var s;const o=(s=this.size)==null?void 0:s.shortest_edge;if(o===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(o<384){const c=Math.floor(o/this.crop_pct),[h,_]=this.get_resize_output_image_size(e,{shortest_edge:c});e=await e.resize(h,_,{resample:this.resample}),e=await e.center_crop(o,o)}else e=await e.resize(o,o,{resample:this.resample});return e}}class ConvNextImageProcessor extends ConvNextFeatureExtractor{}class ViTFeatureExtractor extends ImageFeatureExtractor{}class ViTImageProcessor extends ImageFeatureExtractor{}class EfficientNetImageProcessor extends ImageFeatureExtractor{constructor(e){super(e),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(o=>o*o))}}class MobileViTFeatureExtractor extends ImageFeatureExtractor{}class MobileViTImageProcessor extends MobileViTFeatureExtractor{}class OwlViTFeatureExtractor extends ImageFeatureExtractor{post_process_object_detection(...e){return post_process_object_detection(...e)}}class Owlv2ImageProcessor extends OwlViTFeatureExtractor{}class DeiTFeatureExtractor extends ImageFeatureExtractor{}class BeitFeatureExtractor extends ImageFeatureExtractor{}class DonutFeatureExtractor extends ImageFeatureExtractor{pad_image(e,o,s,c={}){const[h,_,$]=o;let nt=this.image_mean;Array.isArray(this.image_mean)||(nt=new Array($).fill(nt));let tt=this.image_std;Array.isArray(tt)||(tt=new Array($).fill(nt));const et=nt.map((d,a)=>-d/tt[a]);return super.pad_image(e,o,s,{center:!0,constant_values:et,...c})}}class NougatImageProcessor extends DonutFeatureExtractor{}class DetrFeatureExtractor extends ImageFeatureExtractor{async _call(e){const o=await super._call(e),s=[o.pixel_values.dims[0],64,64],c=new Tensor("int64",new BigInt64Array(s.reduce((h,_)=>h*_)).fill(1n),s);return{...o,pixel_mask:c}}post_process_object_detection(...e){return post_process_object_detection(...e)}remove_low_and_no_objects(e,o,s,c){let h=[],_=[],$=[];for(let nt=0;nt<e.dims[0];++nt){let tt=e[nt],et=o[nt],d=max(tt.data)[1];if(d===c)continue;let g=softmax(tt.data)[d];g>s&&(h.push(et),_.push(g),$.push(d))}return[h,_,$]}check_segment_validity(e,o,s,c=.5,h=.8){let _=[],$=0,nt=0;for(let et=0;et<e.length;++et)e[et]===s&&(_.push(et),++$),o[s].data[et]>=c&&++nt;let tt=$>0&&nt>0;return tt&&(tt=$/nt>h),[tt,_]}compute_segments(e,o,s,c,h,_=null,$=null){let[nt,tt]=$??e[0].dims,et=new Tensor("int32",new Int32Array(nt*tt),[nt,tt]),d=[];if($!==null)for(let rt=0;rt<e.length;++rt)e[rt]=interpolate(e[rt],$,"bilinear",!1);let a=new Int32Array(e[0].data.length),g=new Float32Array(e[0].data.length);for(let rt=0;rt<e.length;++rt){let ot=o[rt];for(let it=0;it<e[rt].data.length;++it)e[rt].data[it]*=ot,e[rt].data[it]>g[it]&&(a[it]=rt,g[it]=e[rt].data[it])}let j=0;for(let rt=0;rt<s.length;++rt){let ot=s[rt],[it,at]=this.check_segment_validity(a,e,rt,c,h);if(it){++j;for(let lt of at)et.data[lt]=j;d.push({id:j,label_id:ot,score:o[rt]})}}return[et,d]}post_process_panoptic_segmentation(e,o=.5,s=.5,c=.8,h=null,_=null){h===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),h=new Set);const $=e.logits,tt=e.pred_masks.sigmoid();let[et,d,a]=$.dims;if(a-=1,_!==null&&_.length!==et)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let g=[];for(let j=0;j<et;++j){let rt=_!==null?_[j]:null,ot=$[j],it=tt[j],[at,lt,ct]=this.remove_low_and_no_objects(ot,it,o,a);if(ct.length===0){let[ht,ft]=rt??it.dims.slice(-2),ut=new Tensor("int32",new Int32Array(ht*ft).fill(-1),[ht,ft]);g.push({segmentation:ut,segments_info:[]});continue}let[dt,mt]=this.compute_segments(at,lt,ct,s,c,h,rt);g.push({segmentation:dt,segments_info:mt})}return g}post_process_instance_segmentation(){throw Error("Not implemented yet")}}class YolosFeatureExtractor extends ImageFeatureExtractor{post_process_object_detection(...e){return post_process_object_detection(...e)}}class SamImageProcessor extends ImageFeatureExtractor{reshape_input_points(e,o,s){e=structuredClone(e);let c=calculateDimensions(e);if(c.length===3)c=[1,...c],e=[e];else if(c.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let h=0;h<e.length;++h){let _=o[h],$=s[h],nt=[$[0]/_[0],$[1]/_[1]];for(let tt=0;tt<e[h].length;++tt)for(let et=0;et<e[h][tt].length;++et)for(let d=0;d<e[h][tt][et].length;++d)e[h][tt][et][d]*=nt[d]}return new Tensor("float32",Float32Array.from(e.flat(1/0)),c)}add_input_labels(e,o){let s=calculateDimensions(e);if(s.length===2)s=[1,...s],e=[e];else if(s.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(s.some((c,h)=>c!==o.dims[h]))throw Error(`The first ${s.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new Tensor("int64",e.flat(1/0).map(BigInt),s)}async _call(e,o=null,s=null){const c=await super._call(e);if(o&&(c.input_points=this.reshape_input_points(o,c.original_sizes,c.reshaped_input_sizes)),s){if(!c.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");c.input_labels=this.add_input_labels(s,c.input_points)}return c}post_process_masks(e,o,s,{mask_threshold:c=0,binarize:h=!0,pad_size:_=null}={}){const $=[];_=_??this.pad_size;const nt=[_.height,_.width];for(let tt=0;tt<o.length;++tt){const et=o[tt],d=s[tt],a=e[tt],g=[];for(let j=0;j<a.dims[0];++j){const rt=a[j];let ot=interpolate(rt,nt,"bilinear",!1);if(ot=ot.slice(null,[0,d[0]],[0,d[1]]),ot=interpolate(ot,et,"bilinear",!1),h){const it=new Uint8Array(ot.data.length);for(let at=0;at<ot.data.length;++at)ot.data[at]>c&&(it[at]=1);ot=new Tensor("bool",it,ot.dims)}g.push(ot)}$.push(stack(g))}return $}}class Swin2SRImageProcessor extends ImageFeatureExtractor{pad_image(e,o,s,c={}){const[h,_,$]=o;return super.pad_image(e,o,{width:_+(s-_%s)%s,height:h+(s-h%s)%s},{mode:"symmetric",center:!1,constant_values:-1,...c})}}class VitMatteImageProcessor extends ImageFeatureExtractor{async _call(e,o){Array.isArray(e)||(e=[e]),Array.isArray(o)||(o=[o]);const s=await Promise.all(e.map(_=>this.preprocess(_))),c=await Promise.all(o.map(_=>this.preprocess(_,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:stack(s.map((_,$)=>cat([_.pixel_values,c[$].pixel_values],0)),0),original_sizes:s.map(_=>_.original_size),reshaped_input_sizes:s.map(_=>_.reshaped_input_size)}}}class WhisperFeatureExtractor extends FeatureExtractor{constructor(e){var o;super(e),(o=this.config).mel_filters??(o.mel_filters=mel_filter_bank(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney")),this.window=window_function(this.config.n_fft,"hann")}_extract_fbank_features(e){const{data:o,dims:s}=spectrogram(e,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:this.config.nb_max_frames}),c=max(o)[0];for(let h=0;h<o.length;++h)o[h]=(Math.max(o[h],c-8)+4)/4;return{data:o,dims:s}}async _call(e){validate_audio_inputs(e,"WhisperFeatureExtractor");let o;e.length>this.config.n_samples?(console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),o=e.slice(0,this.config.n_samples)):(o=new Float32Array(this.config.n_samples),o.set(e));const{data:s,dims:c}=this._extract_fbank_features(o);return{input_features:new Tensor("float32",s,[1,...c])}}}class Wav2Vec2FeatureExtractor extends FeatureExtractor{_zero_mean_unit_var_norm(e){const s=e.reduce((h,_)=>h+_,0)/e.length,c=e.reduce((h,_)=>h+(_-s)**2,0)/e.length;return e.map(h=>(h-s)/Math.sqrt(c+1e-7))}async _call(e){validate_audio_inputs(e,"Wav2Vec2FeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));let o=e;this.config.do_normalize&&(o=this._zero_mean_unit_var_norm(o));const s=[1,o.length];return{input_values:new Tensor("float32",o,s),attention_mask:new Tensor("int64",new BigInt64Array(o.length).fill(1n),s)}}}class SeamlessM4TFeatureExtractor extends FeatureExtractor{constructor(e){super(e);const o=this.config.sampling_rate,s=mel_filter_bank(256,this.config.num_mel_bins,20,Math.floor(o/2),o,null,"kaldi",!0);for(let c=0;c<s.length;++c)s[c].push(0);this.mel_filters=s,this.window=window_function(400,"povey",{periodic:!1})}_extract_fbank_features(e,o){return e=e.map(s=>s*32768),spectrogram(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:o,transpose:!0})}async _call(e,{padding:o=!0,pad_to_multiple_of:s=2,do_normalize_per_mel_bins:c=!0,return_attention_mask:h=!0}={}){validate_audio_inputs(e,"SeamlessM4TFeatureExtractor");let _=this._extract_fbank_features(e,this.config.max_length);if(c){const[j,rt]=_.dims;for(let ot=0;ot<rt;++ot){let it=0;for(let dt=0;dt<j;++dt)it+=_.data[dt*rt+ot];const at=it/j;let lt=0;for(let dt=0;dt<j;++dt)lt+=(_.data[dt*rt+ot]-at)**2;lt/=j-1;const ct=Math.sqrt(lt+1e-7);for(let dt=0;dt<j;++dt){const mt=dt*rt+ot;_.data[mt]=(_.data[mt]-at)/ct}}}let $;if(o){const[j,rt]=_.dims,ot=j%s;if(ot>0){const it=new Float32Array(rt*(j+ot));it.set(_.data),it.fill(this.config.padding_value,_.data.length);const at=j+ot;_={data:it,dims:[at,rt]},h&&($=new Tensor("int64",new BigInt64Array(at),[1,at]),$.data.fill(1n,0,j))}}const[nt,tt]=_.dims,et=this.config.stride;if(nt%et!==0)throw new Error(`The number of frames (${nt}) must be a multiple of the stride (${et}).`);const a=new Tensor("float32",_.data,_.dims).view(1,Math.floor(nt/et),tt*et),g={input_features:a};if(h){const j=a.dims[1],rt=new Tensor("int64",new BigInt64Array(j),[1,j]);if($)for(let ot=1,it=0;ot<nt;ot+=et,++it)rt.data[it]=$.data[ot];else rt.data.fill(1n);g.attention_mask=rt}return g}}class ASTFeatureExtractor extends FeatureExtractor{constructor(e){super(e);const o=this.config.sampling_rate,s=mel_filter_bank(256,this.config.num_mel_bins,20,Math.floor(o/2),o,null,"kaldi",!0);for(let c=0;c<s.length;++c)s[c].push(0);this.mel_filters=s,this.window=window_function(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}_extract_fbank_features(e,o){return spectrogram(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:o,transpose:!0})}async _call(e){validate_audio_inputs(e,"ASTFeatureExtractor");const o=this._extract_fbank_features(e,this.config.max_length);if(this.config.do_normalize){const s=this.std*2;for(let c=0;c<o.data.length;++c)o.data[c]=(o.data[c]-this.mean)/s}return{input_values:new Tensor("float32",o.data,[1,...o.dims])}}}class ClapFeatureExtractor extends FeatureExtractor{constructor(e){super(e),this.mel_filters=mel_filter_bank(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=mel_filter_bank(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=window_function(this.config.fft_window_size,"hann")}_get_input_mel(e,o,s,c){let h,_=!1;const $=e.length-o;if($>0)if(s==="rand_trunc"){_=!0;const nt=Math.floor(Math.random()*($+1));e=e.subarray(nt,nt+o),h=this._extract_fbank_features(e,this.mel_filters_slaney,this.config.nb_max_samples),h.dims=[1,...h.dims]}else throw new Error(`Truncation strategy "${s}" not implemented`);else{if($<0){let nt=new Float64Array(o);if(nt.set(e),c==="repeat")for(let tt=e.length;tt<o;tt+=e.length)nt.set(e.subarray(0,Math.min(e.length,o-tt)),tt);else if(c==="repeatpad")for(let tt=e.length;tt<-$;tt+=e.length)nt.set(e,tt);e=nt}if(s==="fusion")throw new Error(`Truncation strategy "${s}" not implemented`);h=this._extract_fbank_features(e,this.mel_filters_slaney,this.config.nb_max_samples),h.dims=[1,...h.dims]}return{...h,longer:_}}_extract_fbank_features(e,o,s=null){return spectrogram(e,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:o,log_mel:"dB",max_num_frames:s,do_pad:!1,transpose:!0})}async _call(e,{max_length:o=null}={}){validate_audio_inputs(e,"ClapFeatureExtractor");const s=this._get_input_mel(e,o??this.config.nb_max_samples,this.config.truncation,this.config.padding);return{input_features:new Tensor("float32",s.data,[1,...s.dims])}}}class SpeechT5FeatureExtractor extends FeatureExtractor{}class Processor extends Callable{constructor(e){super(),this.feature_extractor=e}async _call(e,...o){return await this.feature_extractor(e,...o)}}class SamProcessor extends Processor{async _call(...e){return await this.feature_extractor(...e)}post_process_masks(...e){return this.feature_extractor.post_process_masks(...e)}reshape_input_points(...e){return this.feature_extractor.reshape_input_points(...e)}}class WhisperProcessor extends Processor{async _call(e){return await this.feature_extractor(e)}}class Wav2Vec2ProcessorWithLM extends Processor{async _call(e){return await this.feature_extractor(e)}}class SpeechT5Processor extends Processor{async _call(e){return await this.feature_extractor(e)}}class OwlViTProcessor extends Processor{}class AutoProcessor{static async from_pretrained(e,{progress_callback:o=null,config:s=null,cache_dir:c=null,local_files_only:h=!1,revision:_="main"}={}){let $=s??await getModelJSON(e,"preprocessor_config.json",!0,{progress_callback:o,config:s,cache_dir:c,local_files_only:h,revision:_}),nt=$.feature_extractor_type??$.image_processor_type,tt=this.FEATURE_EXTRACTOR_CLASS_MAPPING[nt];if(!tt)if($.size!==void 0)console.warn(`Feature extractor type "${nt}" not found, assuming ImageFeatureExtractor due to size parameter in config.`),tt=ImageFeatureExtractor;else throw new Error(`Unknown Feature Extractor type: ${nt}`);let et=this.PROCESSOR_CLASS_MAPPING[$.processor_class]??Processor,d=new tt($);return new et(d)}}qt(AutoProcessor,"FEATURE_EXTRACTOR_CLASS_MAPPING",{ImageFeatureExtractor,WhisperFeatureExtractor,ViTFeatureExtractor,MobileViTFeatureExtractor,MobileViTImageProcessor,OwlViTFeatureExtractor,Owlv2ImageProcessor,CLIPFeatureExtractor,ChineseCLIPFeatureExtractor,SiglipImageProcessor,ConvNextFeatureExtractor,ConvNextImageProcessor,SegformerFeatureExtractor,BitImageProcessor,DPTImageProcessor,DPTFeatureExtractor,GLPNFeatureExtractor,BeitFeatureExtractor,DeiTFeatureExtractor,DetrFeatureExtractor,YolosFeatureExtractor,DonutFeatureExtractor,NougatImageProcessor,EfficientNetImageProcessor,ViTImageProcessor,VitMatteImageProcessor,SamImageProcessor,Swin2SRImageProcessor,Wav2Vec2FeatureExtractor,SeamlessM4TFeatureExtractor,SpeechT5FeatureExtractor,ASTFeatureExtractor,ClapFeatureExtractor}),qt(AutoProcessor,"PROCESSOR_CLASS_MAPPING",{WhisperProcessor,Wav2Vec2ProcessorWithLM,SamProcessor,SpeechT5Processor,OwlViTProcessor});async function prepareImages(i){return Array.isArray(i)||(i=[i]),await Promise.all(i.map(e=>RawImage.read(e)))}async function prepareAudios(i,e){return Array.isArray(i)||(i=[i]),await Promise.all(i.map(o=>typeof o=="string"||o instanceof URL?read_audio(o,e):o instanceof Float64Array?new Float32Array(o):o))}function get_bounding_box(i,e){e&&(i=i.map(_=>_|0));const[o,s,c,h]=i;return{xmin:o,ymin:s,xmax:c,ymax:h}}class Pipeline extends Callable{constructor({task:e,model:o,tokenizer:s=null,processor:c=null}){super(),this.task=e,this.model=o,this.tokenizer=s,this.processor=c}async dispose(){await this.model.dispose()}}class TextClassificationPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{topk:o=1}={}){const s=this.tokenizer(e,{padding:!0,truncation:!0}),c=await this.model(s),h=this.model.config.problem_type==="multi_label_classification"?nt=>nt.sigmoid().data:nt=>softmax(nt.data),_=this.model.config.id2label,$=[];for(const nt of c.logits){const tt=h(nt),d=getTopItems(tt,o).map(a=>({label:_[a[0]],score:a[1]}));o===1?$.push(...d):$.push(d)}return Array.isArray(e)||o===1?$:$[0]}}class TokenClassificationPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{ignore_labels:o=["O"]}={}){const s=Array.isArray(e),c=this.tokenizer(s?e:[e],{padding:!0,truncation:!0}),_=(await this.model(c)).logits,$=this.model.config.id2label,nt=[];for(let tt=0;tt<_.dims[0];++tt){const et=c.input_ids[tt],d=_[tt],a=[];for(let g=0;g<d.dims[0];++g){const j=d[g],rt=max(j.data)[1],ot=$?$[rt]:`LABEL_${rt}`;if(o.includes(ot))continue;const it=this.tokenizer.decode([et[g].item()],{skip_special_tokens:!0});if(it==="")continue;const at=softmax(j.data);a.push({entity:ot,score:at[rt],index:g,word:it,start:null,end:null})}nt.push(a)}return s?nt:nt[0]}}class QuestionAnsweringPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o,{topk:s=1}={}){const c=this.tokenizer(e,{text_pair:o,padding:!0,truncation:!0}),h=await this.model(c),_=[];for(let $=0;$<h.start_logits.dims[0];++$){const nt=c.input_ids[$],tt=nt.indexOf(this.tokenizer.sep_token_id),et=Array.from(softmax(h.start_logits[$].data)).map((g,j)=>[g,j]).filter(g=>g[1]>tt),d=Array.from(softmax(h.end_logits[$].data)).map((g,j)=>[g,j]).filter(g=>g[1]>tt),a=product(et,d).filter(g=>g[0][1]<=g[1][1]).map(g=>[g[0][1],g[1][1],g[0][0]*g[1][0]]).sort((g,j)=>j[2]-g[2]);for(let g=0;g<Math.min(a.length,s);++g){const[j,rt,ot]=a[g],it=[...nt].slice(j,rt+1),at=this.tokenizer.decode(it,{skip_special_tokens:!0});_.push({answer:at,score:ot})}}return s===1?_[0]:_}}class FillMaskPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{topk:o=5}={}){const s=this.tokenizer(e,{padding:!0,truncation:!0}),c=await this.model(s),h=[];for(let _=0;_<s.input_ids.dims[0];++_){const $=s.input_ids[_],nt=$.indexOf(this.tokenizer.mask_token_id);if(nt===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const et=c.logits[_][nt],d=getTopItems(softmax(et.data),o);h.push(d.map(a=>{const g=[...$];return g[nt]=a[0],{score:a[1],token:a[0],token_str:this.tokenizer.model.vocab[a[0]],sequence:this.tokenizer.decode(g,{skip_special_tokens:!0})}}))}return Array.isArray(e)?h:h[0]}}class Text2TextGenerationPipeline extends Pipeline{constructor(o){super(o);qt(this,"_key","generated_text")}async _call(o,s={}){Array.isArray(o)||(o=[o]),this.model.config.prefix&&(o=o.map(tt=>this.model.config.prefix+tt));const c=this.model.config.task_specific_params;c&&c[this.task]&&c[this.task].prefix&&(o=o.map(tt=>c[this.task].prefix+tt));const h=this.tokenizer,_={padding:!0,truncation:!0};let $;this instanceof TranslationPipeline&&"_build_translation_inputs"in h?$=h._build_translation_inputs(o,_,s).input_ids:$=h(o,_).input_ids;const nt=await this.model.generate($,s);return h.batch_decode(nt,{skip_special_tokens:!0}).map(tt=>({[this._key]:tt}))}}class SummarizationPipeline extends Text2TextGenerationPipeline{constructor(o){super(o);qt(this,"_key","summary_text")}}class TranslationPipeline extends Text2TextGenerationPipeline{constructor(o){super(o);qt(this,"_key","translation_text")}}function isChat(i){return Array.isArray(i)&&i.every(e=>"role"in e&&"content"in e)}class TextGenerationPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o={}){let s=!1,c=!1,h;if(typeof e=="string")h=e=[e];else if(Array.isArray(e)&&e.every(j=>typeof j=="string"))s=!0,h=e;else{if(isChat(e))e=[e];else if(Array.isArray(e)&&e.every(isChat))s=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");c=!0,h=e.map(j=>this.tokenizer.apply_chat_template(j,{tokenize:!1,add_generation_prompt:!0}))}const _=o.add_special_tokens??!1,$=c?!1:o.return_full_text??!0;this.tokenizer.padding_side="left";const{input_ids:nt,attention_mask:tt}=this.tokenizer(h,{add_special_tokens:_,padding:!0,truncation:!0}),et=await this.model.generate(nt,o,null,{inputs_attention_mask:tt});let d=this.tokenizer.batch_decode(et,{skip_special_tokens:!0}),a;!$&&nt.dims.at(-1)>0&&(a=this.tokenizer.batch_decode(nt,{skip_special_tokens:!0}).map(j=>j.length));const g=Array.from({length:e.length},j=>[]);for(let j=0;j<d.length;++j){const rt=Math.floor(j/et.length*e.length);a&&(d[j]=d[j].slice(a[rt])),g[rt].push({generated_text:c?[...e[rt],{role:"assistant",content:d[j]}]:d[j]})}return!s&&g.length===1?g[0]:g}}class ZeroShotClassificationPipeline extends Pipeline{constructor(e){super(e),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([o,s])=>[o.toLowerCase(),s])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(e,o,{hypothesis_template:s="This example is {}.",multi_label:c=!1}={}){const h=Array.isArray(e);h||(e=[e]),Array.isArray(o)||(o=[o]);const _=o.map(tt=>s.replace("{}",tt)),$=c||o.length===1,nt=[];for(const tt of e){const et=[];for(const g of _){const j=this.tokenizer(tt,{text_pair:g,padding:!0,truncation:!0}),rt=await this.model(j);$?et.push([rt.logits.data[this.contradiction_id],rt.logits.data[this.entailment_id]]):et.push(rt.logits.data[this.entailment_id])}const a=($?et.map(g=>softmax(g)[1]):softmax(et)).map((g,j)=>[g,j]).sort((g,j)=>j[0]-g[0]);nt.push({sequence:tt,labels:a.map(g=>o[g[1]]),scores:a.map(g=>g[0])})}return h?nt:nt[0]}}class FeatureExtractionPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{pooling:o="none",normalize:s=!1,quantize:c=!1,precision:h="binary"}={}){const _=this.tokenizer(e,{padding:!0,truncation:!0}),$=await this.model(_);let nt=$.last_hidden_state??$.logits??$.token_embeddings;if(o!=="none")if(o==="mean")nt=mean_pooling(nt,_.attention_mask);else if(o==="cls")nt=nt.slice(null,0);else throw Error(`Pooling method '${o}' not supported.`);return s&&(nt=nt.normalize(2,-1)),c&&(nt=quantize_embeddings(nt,h)),nt}}class ImageFeatureExtractionPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{pool:o=null}={}){const s=await prepareImages(e),{pixel_values:c}=await this.processor(s),h=await this.model({pixel_values:c});let _;if(o){if(!("pooler_output"in h))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");_=h.pooler_output}else _=h.last_hidden_state??h.logits??h.image_embeds;return _}}class AudioClassificationPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{topk:o=null}={}){const s=!Array.isArray(e),c=this.processor.feature_extractor.config.sampling_rate,h=await prepareAudios(e,c),_=this.model.config.id2label,$=[];for(const nt of h){const tt=await this.processor(nt),d=(await this.model(tt)).logits[0],g=getTopItems(softmax(d.data),o).map(j=>({label:_[j[0]],score:j[1]}));o===1?$.push(...g):$.push(g)}return!s||o===1?$:$[0]}}class ZeroShotAudioClassificationPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o,{hypothesis_template:s="This is a sound of {}."}={}){const c=!Array.isArray(e);c&&(e=[e]);const h=o.map(et=>s.replace("{}",et)),_=this.tokenizer(h,{padding:!0,truncation:!0}),$=this.processor.feature_extractor.config.sampling_rate,nt=await prepareAudios(e,$),tt=[];for(const et of nt){const d=await this.processor(et),a=await this.model({..._,...d}),g=softmax(a.logits_per_audio.data);tt.push([...g].map((j,rt)=>({score:j,label:o[rt]})))}return c?tt[0]:tt}}class AutomaticSpeechRecognitionPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o={}){switch(this.model.config.model_type){case"whisper":return this._call_whisper(e,o);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":return this._call_wav2vec2(e,o);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(e,o={}){o.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),o.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const s=!Array.isArray(e);s&&(e=[e]);const c=this.processor.feature_extractor.config.sampling_rate,h=await prepareAudios(e,c),_=[];for(const $ of h){const nt=await this.processor($),et=(await this.model(nt)).logits[0],d=[];for(const g of et)d.push(max(g.data)[1]);const a=this.tokenizer.decode(d);_.push({text:a})}return s?_[0]:_}async _call_whisper(e,o={}){const s=o.return_timestamps??!1,c=o.chunk_length_s??0,h=o.chunk_callback??null,_=o.force_full_sequences??!1;let $=o.stride_length_s??null;s==="word"&&(o.return_token_timestamps=!0);const nt=pop(o,"language",null),tt=pop(o,"task",null);if(nt||tt||s){if(o.forced_decoder_ids)throw new Error("Cannot specify `language`/`task`/`return_timestamps` and `forced_decoder_ids` at the same time.");const ot=this.tokenizer.get_decoder_prompt_ids({language:nt,task:tt,no_timestamps:!s});ot.length>0&&(o.forced_decoder_ids=ot)}const et=!Array.isArray(e);et&&(e=[e]);const d=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,a=this.processor.feature_extractor.config.hop_length,g=this.processor.feature_extractor.config.sampling_rate,j=await prepareAudios(e,g),rt=[];for(const ot of j){let it=[];if(c>0){if($===null)$=c/6;else if(c<=$)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const ct=g*c,dt=g*$,mt=ct-2*dt;let ht=0;for(;ht<ot.length;){const ft=ot.subarray(ht,ht+ct),ut=await this.processor(ft),_t=ht===0,bt=ht+mt>=ot.length;it.push({stride:[ft.length,_t?0:dt,bt?0:dt],input_features:ut.input_features,is_last:bt}),ht+=mt}}else it=[{stride:[ot.length,0,0],input_features:(await this.processor(ot)).input_features,is_last:!0}];for(const ct of it){o.num_frames=Math.floor(ct.stride[0]/a);const dt=await this.model.generate(ct.input_features,o);s==="word"?(ct.tokens=dt.sequences[0],ct.token_timestamps=dt.token_timestamps.tolist()[0].map(mt=>round(mt,2))):ct.tokens=dt[0],ct.stride=ct.stride.map(mt=>mt/g),h!==null&&h(ct)}const[at,lt]=this.tokenizer._decode_asr(it,{time_precision:d,return_timestamps:s,force_full_sequences:_});rt.push({text:at,...lt})}return et?rt[0]:rt}}class ImageToTextPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o={}){const s=Array.isArray(e),c=await prepareImages(e),{pixel_values:h}=await this.processor(c),_=[];for(const $ of h){$.dims=[1,...$.dims];const nt=await this.model.generate($,o),tt=this.tokenizer.batch_decode(nt,{skip_special_tokens:!0}).map(et=>({generated_text:et.trim()}));_.push(tt)}return s?_:_[0]}}class ImageClassificationPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{topk:o=1}={}){const s=Array.isArray(e),c=await prepareImages(e),{pixel_values:h}=await this.processor(c),_=await this.model({pixel_values:h}),$=this.model.config.id2label,nt=[];for(const tt of _.logits){const d=getTopItems(softmax(tt.data),o).map(a=>({label:$[a[0]],score:a[1]}));o===1?nt.push(...d):nt.push(d)}return s||o===1?nt:nt[0]}}class ImageSegmentationPipeline extends Pipeline{constructor(e){super(e),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(e,{threshold:o=.5,mask_threshold:s=.5,overlap_mask_area_threshold:c=.8,label_ids_to_fuse:h=null,target_sizes:_=null,subtask:$=null}={}){if(Array.isArray(e)&&e.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const tt=await prepareImages(e),et=tt.map(it=>[it.height,it.width]),{pixel_values:d,pixel_mask:a}=await this.processor(tt),g=await this.model({pixel_values:d,pixel_mask:a});let j=null;if($!==null)j=this.subtasks_mapping[$];else for(let[it,at]of Object.entries(this.subtasks_mapping))if(at in this.processor.feature_extractor){j=this.processor.feature_extractor[at].bind(this.processor.feature_extractor),$=it;break}const rt=this.model.config.id2label,ot=[];if($==="panoptic"||$==="instance"){const it=j(g,o,s,c,h,_??et)[0],at=it.segmentation;for(const lt of it.segments_info){const ct=new Uint8ClampedArray(at.data.length);for(let mt=0;mt<at.data.length;++mt)at.data[mt]===lt.id&&(ct[mt]=255);const dt=new RawImage(ct,at.dims[1],at.dims[0],1);ot.push({score:lt.score,label:rt[lt.label_id],mask:dt})}}else if($==="semantic"){const{segmentation:it,labels:at}=j(g,_??et)[0];for(const lt of at){const ct=new Uint8ClampedArray(it.data.length);for(let mt=0;mt<it.data.length;++mt)it.data[mt]===lt&&(ct[mt]=255);const dt=new RawImage(ct,it.dims[1],it.dims[0],1);ot.push({score:null,label:rt[lt],mask:dt})}}else throw Error(`Subtask ${$} not supported.`);return ot}}class ZeroShotImageClassificationPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o,{hypothesis_template:s="This is a photo of {}"}={}){const c=Array.isArray(e),h=await prepareImages(e),_=o.map(a=>s.replace("{}",a)),$=this.tokenizer(_,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:nt}=await this.processor(h),tt=await this.model({...$,pixel_values:nt}),et=this.model.config.model_type==="siglip"?a=>a.sigmoid().data:a=>softmax(a.data),d=[];for(const a of tt.logits_per_image){const j=[...et(a)].map((rt,ot)=>({score:rt,label:o[ot]}));j.sort((rt,ot)=>ot.score-rt.score),d.push(j)}return c?d:d[0]}}class ObjectDetectionPipeline extends Pipeline{constructor(e){super(e)}async _call(e,{threshold:o=.9,percentage:s=!1}={}){const c=Array.isArray(e);if(c&&e.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const h=await prepareImages(e),_=s?null:h.map(g=>[g.height,g.width]),{pixel_values:$,pixel_mask:nt}=await this.processor(h),tt=await this.model({pixel_values:$,pixel_mask:nt}),et=this.processor.feature_extractor.post_process_object_detection(tt,o,_),d=this.model.config.id2label,a=et.map(g=>g.boxes.map((j,rt)=>({score:g.scores[rt],label:d[g.classes[rt]],box:get_bounding_box(j,!s)})));return c?a:a[0]}}class ZeroShotObjectDetectionPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o,{threshold:s=.1,topk:c=null,percentage:h=!1}={}){const _=Array.isArray(e),$=await prepareImages(e),nt=this.tokenizer(o,{padding:!0,truncation:!0}),tt=await this.processor($),et=[];for(let d=0;d<$.length;++d){const a=$[d],g=h?null:[[a.height,a.width]],j=tt.pixel_values[d].unsqueeze_(0),rt=await this.model({...nt,pixel_values:j}),ot=this.processor.feature_extractor.post_process_object_detection(rt,s,g,!0)[0];let it=ot.boxes.map((at,lt)=>({score:ot.scores[lt],label:o[ot.classes[lt]],box:get_bounding_box(at,!h)})).sort((at,lt)=>lt.score-at.score);c!==null&&(it=it.slice(0,c)),et.push(it)}return _?et:et[0]}}class DocumentQuestionAnsweringPipeline extends Pipeline{constructor(e){super(e)}async _call(e,o,s={}){const c=(await prepareImages(e))[0],{pixel_values:h}=await this.processor(c),_=`<s_docvqa><s_question>${o}</s_question><s_answer>`,$=this.tokenizer(_,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,nt=await this.model.generate(h,{...s,decoder_input_ids:$,max_length:this.model.config.decoder.max_position_embeddings}),et=this.tokenizer.batch_decode(nt)[0].match(/<s_answer>(.*?)<\/s_answer>/);let d=null;return et&&et.length>=2&&(d=et[1].trim()),[{answer:d}]}}class TextToAudioPipeline extends Pipeline{constructor(o){super(o);qt(this,"DEFAULT_VOCODER_ID","Xenova/speecht5_hifigan");this.vocoder=o.vocoder??null}async _call(o,{speaker_embeddings:s=null}={}){return this.processor?this._call_text_to_spectrogram(o,{speaker_embeddings:s}):this._call_text_to_waveform(o)}async _call_text_to_waveform(o){const s=this.tokenizer(o,{padding:!0,truncation:!0}),{waveform:c}=await this.model(s),h=this.model.config.sampling_rate;return{audio:c.data,sampling_rate:h}}async _call_text_to_spectrogram(o,{speaker_embeddings:s}){if(this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{quantized:!1})),(typeof s=="string"||s instanceof URL)&&(s=new Float32Array(await(await fetch(s)).arrayBuffer())),s instanceof Float32Array)s=new Tensor("float32",s,[1,s.length]);else if(!(s instanceof Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");const{input_ids:c}=this.tokenizer(o,{padding:!0,truncation:!0}),{waveform:h}=await this.model.generate_speech(c,s,{vocoder:this.vocoder}),_=this.processor.feature_extractor.config.sampling_rate;return{audio:h.data,sampling_rate:_}}}class ImageToImagePipeline extends Pipeline{constructor(e){super(e)}async _call(e){const o=await prepareImages(e),s=await this.processor(o),c=await this.model(s),h=[];for(const _ of c.reconstruction){const $=_.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");h.push(RawImage.fromTensor($))}return h.length>1?h:h[0]}}class DepthEstimationPipeline extends Pipeline{constructor(e){super(e)}async _call(e){const o=await prepareImages(e),s=await this.processor(o),{predicted_depth:c}=await this.model(s),h=[];for(let _=0;_<o.length;++_){const $=interpolate(c[_],o[_].size.reverse(),"bilinear",!1),nt=$.mul_(255/max($.data)[0]).to("uint8");h.push({predicted_depth:c[_],depth:RawImage.fromTensor(nt)})}return h.length>1?h:h[0]}}const SUPPORTED_TASKS=Object.freeze({"text-classification":{tokenizer:AutoTokenizer,pipeline:TextClassificationPipeline,model:AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:AutoTokenizer,pipeline:TokenClassificationPipeline,model:AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:AutoTokenizer,pipeline:QuestionAnsweringPipeline,model:AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:AutoTokenizer,pipeline:FillMaskPipeline,model:AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:AutoTokenizer,pipeline:SummarizationPipeline,model:AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:AutoTokenizer,pipeline:TranslationPipeline,model:AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:AutoTokenizer,pipeline:Text2TextGenerationPipeline,model:AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:AutoTokenizer,pipeline:TextGenerationPipeline,model:AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:AutoTokenizer,pipeline:ZeroShotClassificationPipeline,model:AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:AudioClassificationPipeline,model:AutoModelForAudioClassification,processor:AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:AutoTokenizer,pipeline:ZeroShotAudioClassificationPipeline,model:AutoModel,processor:AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:AutoTokenizer,pipeline:AutomaticSpeechRecognitionPipeline,model:[AutoModelForSpeechSeq2Seq,AutoModelForCTC],processor:AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:AutoTokenizer,pipeline:TextToAudioPipeline,model:[AutoModelForTextToWaveform,AutoModelForTextToSpectrogram],processor:[AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:AutoTokenizer,pipeline:ImageToTextPipeline,model:AutoModelForVision2Seq,processor:AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:ImageClassificationPipeline,model:AutoModelForImageClassification,processor:AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:ImageSegmentationPipeline,model:[AutoModelForImageSegmentation,AutoModelForSemanticSegmentation],processor:AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"zero-shot-image-classification":{tokenizer:AutoTokenizer,pipeline:ZeroShotImageClassificationPipeline,model:AutoModel,processor:AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:ObjectDetectionPipeline,model:AutoModelForObjectDetection,processor:AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:AutoTokenizer,pipeline:ZeroShotObjectDetectionPipeline,model:AutoModelForZeroShotObjectDetection,processor:AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:AutoTokenizer,pipeline:DocumentQuestionAnsweringPipeline,model:AutoModelForDocumentQuestionAnswering,processor:AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:ImageToImagePipeline,model:AutoModelForImageToImage,processor:AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:DepthEstimationPipeline,model:AutoModelForDepthEstimation,processor:AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:AutoTokenizer,pipeline:FeatureExtractionPipeline,model:AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:AutoProcessor,pipeline:ImageFeatureExtractionPipeline,model:[AutoModelForImageFeatureExtraction,AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),TASK_ALIASES=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function pipeline(i,e=null,{quantized:o=!0,progress_callback:s=null,config:c=null,cache_dir:h=null,local_files_only:_=!1,revision:$="main",model_file_name:nt=null}={}){i=TASK_ALIASES[i]??i;const tt=SUPPORTED_TASKS[i.split("_",1)[0]];if(!tt)throw Error(`Unsupported pipeline: ${i}. Must be one of [${Object.keys(SUPPORTED_TASKS)}]`);e||(e=tt.default.model,console.log(`No model specified. Using default model: "${e}".`));const et={quantized:o,progress_callback:s,config:c,cache_dir:h,local_files_only:_,revision:$,model_file_name:nt},d=new Map([["tokenizer",tt.tokenizer],["model",tt.model],["processor",tt.processor]]),a=await loadItems(d,e,et);a.task=i,dispatchCallback(s,{status:"ready",task:i,model:e});const g=tt.pipeline;return new g(a)}async function loadItems(i,e,o){const s=Object.create(null),c=[];for(let[h,_]of i.entries()){if(!_)continue;let $;Array.isArray(_)?$=new Promise(async(nt,tt)=>{let et;for(let d of _){if(d===null){nt(null);return}try{nt(await d.from_pretrained(e,o));return}catch(a){et=a}}tt(et)}):$=_.from_pretrained(e,o),s[h]=$,c.push($)}await Promise.all(c);for(let[h,_]of Object.entries(s))s[h]=await _;return s}const firebaseConfig={apiKey:"AIzaSyDN1V-iVwPCTyvQO_jGafiCnq9aujCI4E8",authDomain:"video-chat-33799.firebaseapp.com",databaseURL:"https://video-chat-33799-default-rtdb.europe-west1.firebasedatabase.app",projectId:"video-chat-33799",storageBucket:"video-chat-33799.firebasestorage.app",messagingSenderId:"86088207916",appId:"1:86088207916:web:8dda01de508282b6e2cb89"},app=initializeApp(firebaseConfig),firestore=getFirestore(app),servers={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},App=()=>{const[i]=reactExports.useState(new RTCPeerConnection(servers)),[e,o]=reactExports.useState(null),[s,c]=reactExports.useState(null),h=reactExports.useRef(null),_=reactExports.useRef(null),$=reactExports.useRef(null),[nt,tt]=reactExports.useState(!1),[et,d]=reactExports.useState(!0),[a,g]=reactExports.useState(!0),[j,rt]=reactExports.useState(!0),[ot,it]=reactExports.useState("");let at,lt=[];const ct=async()=>{const ut=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});o(ut);const _t=new MediaStream;c(_t),ut.getTracks().forEach(bt=>{i.addTrack(bt,ut)}),i.ontrack=bt=>{bt.streams[0].getTracks().forEach(vt=>{_t.addTrack(vt)})},h.current&&(h.current.srcObject=ut),_.current&&(_.current.srcObject=_t),d(!1),g(!1),tt(!0)},dt=async()=>{const ut=doc(collection(firestore,"calls")),_t=collection(ut,"offerCandidates"),bt=collection(ut,"answerCandidates");$.current&&($.current.value=ut.id),i.onicecandidate=async Mt=>{Mt.candidate&&await addDoc(_t,Mt.candidate.toJSON())};const vt=await i.createOffer();await i.setLocalDescription(vt);const Tt={sdp:vt.sdp,type:vt.type};await setDoc(ut,{offer:Tt}),onSnapshot(ut,Mt=>{const xt=Mt.data();if(xt!=null&&xt.answer&&!i.currentRemoteDescription){const Pt=new RTCSessionDescription(xt.answer);i.setRemoteDescription(Pt)}}),onSnapshot(bt,Mt=>{Mt.docChanges().forEach(xt=>{if(xt.type==="added"){const Pt=new RTCIceCandidate(xt.doc.data());i.addIceCandidate(Pt)}})}),rt(!1)},mt=async()=>{var It;const ut=(It=$.current)==null?void 0:It.value;if(!ut)return;const _t=doc(firestore,"calls",ut),bt=collection(_t,"answerCandidates"),vt=collection(_t,"offerCandidates");i.onicecandidate=async Dt=>{Dt.candidate&&await addDoc(bt,Dt.candidate.toJSON())};const Tt=(await getDoc(_t)).data();if(!Tt)return;const Mt=Tt.offer;await i.setRemoteDescription(new RTCSessionDescription(Mt));const xt=await i.createAnswer();await i.setLocalDescription(xt);const Pt={type:xt.type,sdp:xt.sdp};await updateDoc(_t,{answer:Pt}),onSnapshot(vt,Dt=>{Dt.docChanges().forEach(Ct=>{if(Ct.type==="added"){const Gt=Ct.doc.data();i.addIceCandidate(new RTCIceCandidate(Gt))}})})},ht=async()=>{if(s){const ut=s.getAudioTracks();if(ut.length>0){const _t=new MediaStream([ut[0]]);at=new MediaRecorder(_t),at.ondataavailable=bt=>{lt.push(bt.data)},at.onstop=async()=>{const bt=new Blob(lt,{type:"audio/webm; codecs=opus"});await ft(bt),lt=[]},at.start(),setTimeout(()=>{at.stop()},5e3)}else alert("No audio track available in the remote stream.")}else alert("Remote stream is not available.")},ft=async ut=>{const _t=await ut.arrayBuffer(),Tt=(await new AudioContext().decodeAudioData(_t)).getChannelData(0),xt=await(await pipeline("automatic-speech-recognition","Xenova/whisper-tiny.en"))(Tt);if(Array.isArray(xt)){const Pt=xt.map(It=>It.text).join(" ");it(Pt)}else it(xt.text)};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{children:"1. Start your Webcam"}),jsxRuntimeExports.jsx("button",{onClick:ct,disabled:nt,children:"Start webcam"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("video",{className:"video",ref:h,autoPlay:!0,playsInline:!0,controls:!0}),jsxRuntimeExports.jsx("h2",{children:"2. Create a new Call"}),jsxRuntimeExports.jsx("button",{onClick:dt,disabled:et,children:"Create Call (offer)"}),jsxRuntimeExports.jsx("h2",{children:"3. Join a Call"}),jsxRuntimeExports.jsx("input",{ref:$}),jsxRuntimeExports.jsx("button",{onClick:mt,disabled:a,children:"Answer"}),jsxRuntimeExports.jsx("h2",{children:"4. Remote Stream"}),jsxRuntimeExports.jsx("video",{className:"video",ref:_,autoPlay:!0,playsInline:!0,controls:!0}),jsxRuntimeExports.jsx("button",{disabled:j,children:"Hangup"}),jsxRuntimeExports.jsx("h2",{children:"Speech Recognition"}),jsxRuntimeExports.jsx("button",{onClick:ht,children:"Start Speech Recognition"}),jsxRuntimeExports.jsxs("p",{children:["Transcribed Text: ",ot]})]})};createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
